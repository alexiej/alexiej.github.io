<!DOCTYPE html>
<html lang="en-EN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deep Learning | One Page Knowledge</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.cce75b30.css" as="style"><link rel="preload" href="/assets/js/app.5520a7e5.js" as="script"><link rel="preload" href="/assets/js/36.f1395db5.js" as="script"><link rel="preload" href="/assets/js/56.32200c53.js" as="script"><link rel="preload" href="/assets/js/53.93b8add4.js" as="script"><link rel="preload" href="/assets/js/50.010d3262.js" as="script"><link rel="preload" href="/assets/js/59.98832f60.js" as="script"><link rel="preload" href="/assets/js/52.b9c71886.js" as="script"><link rel="preload" href="/assets/js/55.d3513c09.js" as="script"><link rel="prefetch" href="/assets/js/1.f89fcd7d.js"><link rel="prefetch" href="/assets/js/2.01087ca9.js"><link rel="prefetch" href="/assets/js/3.f6942ffc.js"><link rel="prefetch" href="/assets/js/4.a768c011.js"><link rel="prefetch" href="/assets/js/5.554f7af0.js"><link rel="prefetch" href="/assets/js/6.ebe264ff.js"><link rel="prefetch" href="/assets/js/7.bb5208b2.js"><link rel="prefetch" href="/assets/js/8.853557f5.js"><link rel="prefetch" href="/assets/js/9.606d4a2c.js"><link rel="prefetch" href="/assets/js/10.a9d4fea8.js"><link rel="prefetch" href="/assets/js/11.0e17f3e0.js"><link rel="prefetch" href="/assets/js/12.0d86f299.js"><link rel="prefetch" href="/assets/js/13.48b6924d.js"><link rel="prefetch" href="/assets/js/14.df464c7b.js"><link rel="prefetch" href="/assets/js/15.31b13dfe.js"><link rel="prefetch" href="/assets/js/16.0643a0ce.js"><link rel="prefetch" href="/assets/js/17.09b3e80f.js"><link rel="prefetch" href="/assets/js/18.32454320.js"><link rel="prefetch" href="/assets/js/19.9a52450c.js"><link rel="prefetch" href="/assets/js/20.eb735f19.js"><link rel="prefetch" href="/assets/js/21.702c54f4.js"><link rel="prefetch" href="/assets/js/22.5956b3ec.js"><link rel="prefetch" href="/assets/js/23.0f3d0206.js"><link rel="prefetch" href="/assets/js/24.f7c4037a.js"><link rel="prefetch" href="/assets/js/25.5ae1b5f4.js"><link rel="prefetch" href="/assets/js/26.704d7891.js"><link rel="prefetch" href="/assets/js/27.40db17fb.js"><link rel="prefetch" href="/assets/js/28.949a3a33.js"><link rel="prefetch" href="/assets/js/29.6e711ee3.js"><link rel="prefetch" href="/assets/js/30.deb3f2c3.js"><link rel="prefetch" href="/assets/js/31.779a4619.js"><link rel="prefetch" href="/assets/js/32.2f51f7d7.js"><link rel="prefetch" href="/assets/js/33.17e27d9c.js"><link rel="prefetch" href="/assets/js/34.f3bd597a.js"><link rel="prefetch" href="/assets/js/35.8b2aeaa7.js"><link rel="prefetch" href="/assets/js/37.4ca12dec.js"><link rel="prefetch" href="/assets/js/38.c7cf4f34.js"><link rel="prefetch" href="/assets/js/39.992088aa.js"><link rel="prefetch" href="/assets/js/40.2b128bcf.js"><link rel="prefetch" href="/assets/js/41.82493afe.js"><link rel="prefetch" href="/assets/js/42.edabbac1.js"><link rel="prefetch" href="/assets/js/43.7e132bad.js"><link rel="prefetch" href="/assets/js/44.d0090ddb.js"><link rel="prefetch" href="/assets/js/45.a8948dba.js"><link rel="prefetch" href="/assets/js/46.7534324c.js"><link rel="prefetch" href="/assets/js/47.06aa10fc.js"><link rel="prefetch" href="/assets/js/48.b29e0cdd.js"><link rel="prefetch" href="/assets/js/49.76e21dfa.js"><link rel="prefetch" href="/assets/js/51.f707e421.js"><link rel="prefetch" href="/assets/js/54.3aefc9c9.js"><link rel="prefetch" href="/assets/js/57.80c74e3b.js"><link rel="prefetch" href="/assets/js/58.e63fa421.js"><link rel="prefetch" href="/assets/js/60.14252b42.js"><link rel="prefetch" href="/assets/js/61.0367b504.js"><link rel="prefetch" href="/assets/js/62.fcd5a2c4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cce75b30.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      One Page Knowledge
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Deep Learning</span><!----></p><ul class="sidebar-group-items"><li><a href="/deepnn/#gpu-servers" class="sidebar-link">GPU Servers</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/deepnn/#artificial-neural-network" class="sidebar-link">Artificial Neural Network</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#single-layer-perceptron" class="sidebar-link">Single Layer Perceptron</a></li><li class="sidebar-sub-header"><a href="/deepnn/#modern-neural-network" class="sidebar-link">Modern Neural Network</a></li></ul></li><li><a href="/deepnn/#activation-functions" class="sidebar-link">Activation Functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#sigmoid-function" class="sidebar-link">Sigmoid function</a></li></ul></li><li><a href="/deepnn/#pytorch" class="sidebar-link">PyTorch</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/deepnn/#fast-ai" class="sidebar-link">fast.ai</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#installation-v-0-7" class="sidebar-link">installation (v 0.7)</a></li><li class="sidebar-sub-header"><a href="/deepnn/#libraries" class="sidebar-link">Libraries</a></li></ul></li><li><a href="/deepnn/#fast-ai-help-functions" class="sidebar-link">fast.ai / Help functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#show-img" class="sidebar-link">show_img</a></li></ul></li><li><a href="/deepnn/#fast-ai-transforms-data" class="sidebar-link">fast.ai / Transforms Data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#tfms-from-model" class="sidebar-link">tfms_from_model</a></li><li class="sidebar-sub-header"><a href="/deepnn/#tfmtype" class="sidebar-link">TfmType</a></li><li class="sidebar-sub-header"><a href="/deepnn/#randomrotate" class="sidebar-link">RandomRotate</a></li><li class="sidebar-sub-header"><a href="/deepnn/#randomlighting" class="sidebar-link">RandomLighting</a></li><li class="sidebar-sub-header"><a href="/deepnn/#randomflip" class="sidebar-link">RandomFlip</a></li><li class="sidebar-sub-header"><a href="/deepnn/#transforms-basic" class="sidebar-link">transforms_basic</a></li><li class="sidebar-sub-header"><a href="/deepnn/#transforms-side-on" class="sidebar-link">transforms_side_on</a></li></ul></li><li><a href="/deepnn/#fast-ai-import-data" class="sidebar-link">fast.ai / Import Data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#imageclassifierdata" class="sidebar-link">ImageClassifierData</a></li></ul></li><li><a href="/deepnn/#fast-ai-learner" class="sidebar-link">fast.ai / Learner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#basic-functions" class="sidebar-link">Basic Functions</a></li><li class="sidebar-sub-header"><a href="/deepnn/#convlearner-pretrained" class="sidebar-link">ConvLearner.pretrained()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#fit" class="sidebar-link">fit()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#predict" class="sidebar-link">predict()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#lr-find" class="sidebar-link">lr_find()</a></li></ul></li><li><a href="/deepnn/#fast-ai-examples" class="sidebar-link">fast.ai / Examples</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#dog-cat-example" class="sidebar-link">dog-cat example</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"><div class="warning custom-block"><p class="custom-block-title">Source</p><p>The material based mostly on the free deep learning course and library <strong>fast.ai</strong> (from 2017)</p><p><a href="https://course.fast.ai/index.html" target="_blank" rel="noopener noreferrer">https://course.fast.ai/index.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div><h2 id="gpu-servers"><a href="#gpu-servers" aria-hidden="true" class="header-anchor">#</a> GPU Servers</h2><p>This is a short list of GPU Servers that can be used for fast.ai.</p><table><thead><tr><th>Server</th><th>Free</th><th>Description</th><th>Limitation</th></tr></thead><tbody><tr><td><a href="https://colab.research.google.com/" target="_blank" rel="noopener noreferrer">Google Colab<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>Yes</td><td>Free notebook for use (required setup a GPU)</td><td>12 continuus hours per session</td></tr><tr><td><a href="https://www.kaggle.com/" target="_blank" rel="noopener noreferrer">Kaggle Notebook<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>Yes</td><td>Free kaggle notebook <a href="https://www.kaggle.com/dansbecker/running-kaggle-kernels-with-a-gpu" target="_blank" title="https://www.kaggle.com/dansbecker/running-kaggle-kernels-with-a-gpu" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>60 continuus minutes per session.</td></tr><tr><td><a href="https://www.paperspace.com/" target="_blank" rel="noopener noreferrer">Paperspace<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No</td><td>Pay as you go consoles to run machines</td><td></td></tr><tr><td><a href="https://azure.microsoft.com/" target="_blank" rel="noopener noreferrer">Microsoft Azure ML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No/200$ for start</td><td>Free 200$ for machines that can have GPU inside</td><td></td></tr><tr><td><a href="https://cloud.google.com/" target="_blank" rel="noopener noreferrer">Google Cloud<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No/300$ for start</td><td>Free Tier to use $300 dolars <a href="https://cloud.google.com/free/docs/gcp-free-tier" target="_blank" title="https://cloud.google.com/free/docs/gcp-free-tier" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td></td></tr><tr><td><a href="https://aws.amazon.com/free/" target="_blank" rel="noopener noreferrer">Amazon AWS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No</td><td>Free Tier doesn’t have GPU machines.</td><td></td></tr></tbody></table><h2 id="artificial-neural-network"><a href="#artificial-neural-network" aria-hidden="true" class="header-anchor">#</a> Artificial Neural Network <a href="https://towardsdatascience.com/multi-layer-neural-networks-with-sigmoid-function-deep-learning-for-rookies-2-bf464f09eb7f" target="_blank" title="https://towardsdatascience.com/multi-layer-neural-networks-with-sigmoid-function-deep-learning-for-rookies-2-bf464f09eb7f" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Artificial Neural Network (ANN) is an paradigm for the deep learning method based on how the natural nervous system works.  They can be used in the ImageRecognition, SpeechRecognition,  natural language processing, desease recognition etc…</p><p>The simplest architecture of the Artifical Neural Network is a Single-layer Perceptron that was introduced in the 1957 by Frank Rosenblatt. <a href="https://en.wikipedia.org/wiki/Perceptron" target="_blank" title="https://en.wikipedia.org/wiki/Perceptron" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><h3 id="single-layer-perceptron"><a href="#single-layer-perceptron" aria-hidden="true" class="header-anchor">#</a> Single Layer Perceptron</h3><p>This architecture contains:</p><ul><li>Input <code>x</code> as a vector</li><li>Weights for each <code>x</code> input (<code>w</code>)</li><li>bias (<code>b</code>)</li><li>and Activation function that on output has been activated or not (<code>0</code> or <code>1</code>)</li></ul><div class="perceptron"><input placeholder="x1" size="mini" value="0.2" class="x1 red"><input placeholder="x2" size="mini" value="0.3" class="x2 green"><input placeholder="x3" size="mini" value="0.8" class="x3 blue"><input placeholder="w1" size="mini" value="0.2" class="w1 red"><input placeholder="w2" size="mini" value="0.3" class="w2 green"><input placeholder="w3" size="mini" value="0.5" class="w3 blue"><input placeholder="b" size="mini" value="0.1" class="b"><input placeholder="w1" size="mini" value="0.2" class="w1a red"><input placeholder="w2" size="mini" value="0.3" class="w2a green"><input placeholder="w3" size="mini" value="0.5" class="w3a blue"><input placeholder="x1" size="mini" value="0.2" class="x1a red"><input placeholder="x2" size="mini" value="0.3" class="x2a green"><input placeholder="x3" size="mini" value="0.8" class="x3a blue"><input readonly="readonly" size="mini" value="0.04" class="m1 red"><input readonly="readonly" size="mini" value="0.09" class="m2 green"><input readonly="readonly" size="mini" value="0.4" class="m3 blue"><input placeholder="b" size="mini" value="0.1" class="mb"><input readonly="readonly" size="mini" value="0.63" class="msum" style="color:green;"><img src="/deepnn/perceptron.png" alt="Card image cap" width="740" height="578" class="image"><span class="answer" style="background-color:green;">σ = 1 </span></div><h4 id="when-use"><a href="#when-use" aria-hidden="true" class="header-anchor">#</a> When Use?</h4><ul><li>Can only classify linearly separable cases with the binary output (0 or 1)</li><li>Single Layer perceptron cannot  solve non-linear problem.</li><li><strong>Not used in modern Deep Learning architecture</strong></li></ul><h3 id="modern-neural-network"><a href="#modern-neural-network" aria-hidden="true" class="header-anchor">#</a> Modern Neural Network</h3><p>Artificial Neural Network contains:</p><ul><li>Input Layer (<code>x</code>),
<ul><li>When single value, <code>x</code> is a scalar</li><li>When tabular data <code>x</code> is  a vector ( for example <code>x=[1,2,3,4]</code>)</li><li>When image <code>x</code> with one color <code>x</code> is a 2D matrix (for example <code>x=[[0,255,00],[0,255,0]]</code>)</li><li>When animations or image with RGB colors for example, <code>x</code> has more dimentions. (for image shape of the tensor is <code>3x ImageWidth x ImageHeight</code>)</li></ul></li><li>Hidden Layer</li><li>Output Layer (<code>y</code>)</li><li>Weight and Biases for each Layer (<code>W</code>,<code>b</code>)</li><li>Activation function for each hidden layer (<code>σ</code>)</li></ul><p><img src="/assets/img/300px-Colored_neural_network.svg.7f4840d9.png" alt="img"></p><p>*Glosser.ca [CC BY-SA 3.0 (https://creativecommons.org/licenses/by-sa/3.0)], from Wikimedia Commons</p><h2 id="activation-functions"><a href="#activation-functions" aria-hidden="true" class="header-anchor">#</a> Activation Functions <a href="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" target="_blank" title="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Instead of using perceptron with output <code>0 or 1</code>, better is use activation function that return values <code>between 0 and 1</code>. In Deep learning there are couple functions to use as an activation.</p><h3 id="sigmoid-function"><a href="#sigmoid-function" aria-hidden="true" class="header-anchor">#</a> Sigmoid function</h3><p>In sigmoid function the difference is in the activation function.</p><p>Logistic function is:</p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6f42e36c949c94189976ae00853af9a1b618e099" alt="{\displaystyle f(./assets/6f42e36c949c94189976ae00853af9a1b618e099.svg)={\frac {L}{1+e^{-k(x-x_{0})}}}}"></p><p>Sigmoid is a special case when <code>L=1, k=1, and x0 = 0</code>.</p><p><img src="/assets/img/1_Xu7B5y9gp0iL5ooBj7LtWw.07066668.png" alt="img"></p><p><img src="data:image/png;base64,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" alt="1543948420834"></p><div class="sigmoid"><input placeholder="x1" size="mini" value="0.2" class="x1 red"><input placeholder="x2" size="mini" value="0.3" class="x2 green"><input placeholder="x3" size="mini" value="0.8" class="x3 blue"><input placeholder="w1" size="mini" value="0.2" class="w1 red"><input placeholder="w2" size="mini" value="0.3" class="w2 green"><input placeholder="w3" size="mini" value="0.5" class="w3 blue"><input placeholder="b" size="mini" value="0.1" class="b"><input placeholder="w1" size="mini" value="0.2" class="w1a red"><input placeholder="w2" size="mini" value="0.3" class="w2a green"><input placeholder="w3" size="mini" value="0.5" class="w3a blue"><input placeholder="x1" size="mini" value="0.2" class="x1a red"><input placeholder="x2" size="mini" value="0.3" class="x2a green"><input placeholder="x3" size="mini" value="0.8" class="x3a blue"><input readonly="readonly" size="mini" value="0.04" class="m1 red"><input readonly="readonly" size="mini" value="0.09" class="m2 green"><input readonly="readonly" size="mini" value="0.4" class="m3 blue"><input placeholder="b" size="mini" value="0.1" class="mb"><input readonly="readonly" size="mini" value="0.63" class="msum" style="color:green;"><img src="/deepnn/sigmoid.png" alt="Card image cap" width="740" height="578" class="image"><span class="answer">σ = 0.652 </span></div><h4 id="when-use-2"><a href="#when-use-2" aria-hidden="true" class="header-anchor">#</a> When Use?</h4><ul><li>predict the probability of the output. (simple classification for example: ‘dog/cat’).</li></ul><h2 id="pytorch"><a href="#pytorch" aria-hidden="true" class="header-anchor">#</a> PyTorch <a href="https://pytorch.org/" target="_blank" title="https://pytorch.org/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>WebPage</span></a></h2><p>PyTorch is an optimized tensor library for deep learning using GPUs and CPUs.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
</code></pre></div><table><thead><tr><th>Command</th><th>Info</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.cuda.is_available()</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543956014633" data-v-336f4fea></code></span></td><td>Is CUDA Available (<code>On CPU returns False</code>)</td></tr><tr><td><code>torch.backends.cudnn.enabled</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543956000527" data-v-336f4fea></code></span></td><td>Is CUDA® Deep Neural Network library Available (used by fast.ai, <code>On CPU returns False</code>)</td></tr><tr><td><code>torch.cuda.device_count()</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955982482" data-v-336f4fea></code></span></td><td>Number of GPUs</td></tr><tr><td><code>torch.cuda.get_device_name(device)</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955759448" data-v-336f4fea></code></span></td><td>Gets the name of a device number</td></tr><tr><td><code>torch.cuda.set_device(device)</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955961561" data-v-336f4fea></code></span></td><td>Set the current GPU device</td></tr></tbody></table><h2 id="fast-ai"><a href="#fast-ai" aria-hidden="true" class="header-anchor">#</a> fast.ai <a href="https://github.com/fastai/fastai" target="_blank" title="https://github.com/fastai/fastai" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>github</span></a></h2><p>Fast.ai is a very popular library for deep learning based on the PyTorch. The library simplifies training fast and accurate neural nets using modern best practices. fast.ai doesn’t replace any base functionality from the PyTorch. It adds a lot of functions that can help you build a model faster.</p><div class="warning custom-block"><p class="custom-block-title">Version 0.7 and 1.0</p><p>Version 1.0 has completely different naming convention that is used in the below  sections and current available tutorial from 2018.  Below instructions are based on the version 0.7 and wouldn’t work with the installation from conda on the githup page.</p><p>I will update all examples to the new version from the beginning of 2019.</p></div><h3 id="installation-v-0-7"><a href="#installation-v-0-7" aria-hidden="true" class="header-anchor">#</a> installation (v 0.7)</h3><p>You can install fast.ai from the pip <code>pip install fastai==0.7.0</code> like in the google colab, but this is not the latest available version in the github.</p><p><span class="red" data-v-9e33b382>Requires Python &gt;=3.6</span> (<code>python --version</code>)</p><h4 id="linux-gpu-from-the-sources"><a href="#linux-gpu-from-the-sources" aria-hidden="true" class="header-anchor">#</a><strong>Linux GPU from the sources</strong></h4><p><a href="https://github.com/fastai/fastai/tree/master/old" target="_blank" rel="noopener noreferrer">https://github.com/fastai/fastai/tree/master/old<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><ol><li>clone git fastai repository</li></ol><div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">git</span> clone https://github.com/fastai/fastai.git
</code></pre></div><ol><li>Move into root folder</li></ol><div class="language-python extra-class"><pre class="language-python"><code>cd fastai
</code></pre></div><ol><li>Set up Python environment:</li></ol><div class="language-python extra-class"><pre class="language-python"><code>conda env update
</code></pre></div><ol><li>Activate Python environment</li></ol><div class="language-python extra-class"><pre class="language-python"><code>conda activate fastai
</code></pre></div><ol><li>If you want to run youpyter lab on the ssh. Run in the activate <code>fastai</code></li></ol><p><img src="/assets/img/1544123170872.afd10f68.png" alt="1544123170872"></p><p>Make sure that you have environment set to the <code>fastai</code>.</p><p><img src="data:image/png;base64,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" alt="1544123239627"></p><div class="tip custom-block"><p class="custom-block-title">running jupyter for the ssh</p><p>For run the notebook in the ssh please first on the ssh console run jupyter notebook</p><div class="language-bash extra-class"><pre class="language-bash"><code>ipython notebook --no-browser --port<span class="token operator">=</span>8002
</code></pre></div><p>Next on the local machine run ssh tunneling  (<code>localhost:8002</code> is local port, <code>localhost:8002</code> port run on the ipython notebook ,  <code>user</code> - user name, <code>ip_adress</code> - ip address for the ssh). You can set up both at the same port.</p><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ssh</span> -N -f -L localhost:8002:localhost:8002 user@ip_adress
</code></pre></div><p>next go to the selected (and replace running port <code>8000</code> with your local port <code>8002</code>)</p><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>I 11:59:16.597 NotebookApp<span class="token punctuation">]</span> The Jupyter Notebook is running at:
http://localhost:8000/?token<span class="token operator">=</span>c8de56fa4deed24899803e93c227592aef6538f93025fe01
</code></pre></div><p><img src="/assets/img/1544123827545.f14d43c0.png" alt="1544123827545"></p></div><ol><li>If you want to use in your own folder for the project you have to setup path to the old <code>fastai</code> library. In your notebook. For every new python script, or jupyter you have to add before import:</li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> sys
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">&quot;../fastai/old/&quot;</span><span class="token punctuation">)</span> <span class="token comment"># go to the old fastai folder</span>
</code></pre></div><p>Where <code>&quot;../fastai/old/&quot;</code> is path to the old folder of the fastai github library.</p><h4 id="using-pip-or-google-colab"><a href="#using-pip-or-google-colab" aria-hidden="true" class="header-anchor">#</a><strong>Using pip, or  Google COLAB :</strong></h4><p>Make sure that before you install everything change your Hardware Accelerator to <strong>GPU</strong>.</p><p><img src="/assets/img/1544122222151.9f80fa10.png" alt="1544122222151"></p><p><img src="/assets/img/1544122153030.406b00ac.png" alt="1544122153030"></p><div class="language-python extra-class"><pre class="language-python"><code>!pip install fastai<span class="token operator">==</span><span class="token number">0.7</span><span class="token number">.0</span>
<span class="token comment"># New version of torchtext returns this error: </span>
<span class="token comment"># AttributeError: module ‘torch’ has no attribute ‘float32’</span>
!pip install torchtext<span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.3</span> 
</code></pre></div><h4 id="additional-required-packackes-when-there-is-an-error-of-missed-package"><a href="#additional-required-packackes-when-there-is-an-error-of-missed-package" aria-hidden="true" class="header-anchor">#</a> Additional Required packackes (when there is an error of missed package) : <a href="https://medium.com/@GuruAtWork/fast-ai-lesson-1-7fc38e978d37" target="_blank" title="https://medium.com/@GuruAtWork/fast-ai-lesson-1-7fc38e978d37" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>This is happen when you don’t install by pip, or by <code>conda env update</code> command.</p><div class="language- extra-class"><pre class="language-text"><code>conda install -c anaconda bcolz
conda update -n base conda
pip install opencv-python
pip install graphviz
pip install sklearn_pandas
pip install isoweek
</code></pre></div><h3 id="libraries"><a href="#libraries" aria-hidden="true" class="header-anchor">#</a> Libraries</h3><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>imports <span class="token keyword">import</span> <span class="token operator">*</span>	<span class="token comment"># Import library</span>

<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>conv_learner <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>model <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>dataset <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>sgdr <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>plots <span class="token keyword">import</span> <span class="token operator">*</span>
</code></pre></div><h2 id="fast-ai-help-functions"><a href="#fast-ai-help-functions" aria-hidden="true" class="header-anchor">#</a> fast.ai / Help functions</h2><h3 id="show-img"><a href="#show-img" aria-hidden="true" class="header-anchor">#</a> show_img</h3><p>Show images from the model dataset. Denormilze the image before.</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><strong>ims</strong></td><td>images dataset</td></tr><tr><td><strong>idx</strong></td><td>index of the image</td></tr><tr><td><strong>figsize</strong></td><td>figure size</td></tr><tr><td><strong>denorm</strong></td><td>denormalization function</td></tr><tr><td><strong>ax</strong></td><td>a</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">show_img</span><span class="token punctuation">(</span>ims<span class="token punctuation">,</span> idx<span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> denorm<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ax<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> ax <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span> fig<span class="token punctuation">,</span>ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span>figsize<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">not</span> denorm <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span> ims <span class="token operator">=</span> denorm<span class="token punctuation">(</span>ims<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>      ims <span class="token operator">=</span> np<span class="token punctuation">.</span>rollaxis<span class="token punctuation">(</span>to_np<span class="token punctuation">(</span>ims<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>ims<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="example"><a href="#example" aria-hidden="true" class="header-anchor">#</a> Example:</h4><div class="language-python extra-class"><pre class="language-python"><code>fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>md<span class="token punctuation">.</span>aug_dl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    show_img<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> denorm<span class="token operator">=</span> md<span class="token punctuation">.</span>val_ds<span class="token punctuation">.</span>denorm<span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">.</span>flat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-94e700a2><button class="accordion" data-v-94e700a2><span class="badge secondary top badge-code" data-v-94e700a2>Full code</span></button><div class="panel" style="display:none;" data-v-94e700a2><div class="language-python extra-class" data-v-94e700a2><pre class="language-python" data-v-94e700a2><code data-v-94e700a2><span class="token comment" data-v-94e700a2># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>&quot;../fastai/old/&quot;</span>
FNAMES_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'../data/dogscats/valid/cats/'</span>
FNAME <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'cat.2209.jpg'</span>

<span class="token comment" data-v-94e700a2># IMPORTS</span>
<span class="token keyword" data-v-94e700a2>import</span> sys
<span class="token keyword" data-v-94e700a2>import</span> numpy <span class="token keyword" data-v-94e700a2>as</span> np
<span class="token keyword" data-v-94e700a2>import</span> cv2


<span class="token comment" data-v-94e700a2># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>append<span class="token punctuation" data-v-94e700a2>(</span>FASTAI_PATH<span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2># go to parent dir</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>transforms <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>conv_learner <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>

<span class="token comment" data-v-94e700a2># ARCHITECTURE</span>
arch <span class="token operator" data-v-94e700a2>=</span> resnet34
sz <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>256</span>
bs <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>2</span> 

<span class="token comment" data-v-94e700a2># HELP FUNCTIONS/CLASSES</span>
<span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>show_img</span><span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>,</span> idx<span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>5</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>5</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> denorm<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>,</span> ax<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    <span class="token keyword" data-v-94e700a2>if</span> ax <span class="token keyword" data-v-94e700a2>is</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>:</span> fig<span class="token punctuation" data-v-94e700a2>,</span>ax <span class="token operator" data-v-94e700a2>=</span> plt<span class="token punctuation" data-v-94e700a2>.</span>subplots<span class="token punctuation" data-v-94e700a2>(</span>figsize<span class="token operator" data-v-94e700a2>=</span>figsize<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>if</span> <span class="token operator" data-v-94e700a2>not</span> denorm <span class="token keyword" data-v-94e700a2>is</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>:</span> ims <span class="token operator" data-v-94e700a2>=</span> denorm<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>else</span><span class="token punctuation" data-v-94e700a2>:</span>      ims <span class="token operator" data-v-94e700a2>=</span> np<span class="token punctuation" data-v-94e700a2>.</span>rollaxis<span class="token punctuation" data-v-94e700a2>(</span>to_np<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>4</span><span class="token punctuation" data-v-94e700a2>)</span>
    ax<span class="token punctuation" data-v-94e700a2>.</span>imshow<span class="token punctuation" data-v-94e700a2>(</span>np<span class="token punctuation" data-v-94e700a2>.</span>clip<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>[</span>idx<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>
    ax<span class="token punctuation" data-v-94e700a2>.</span>axis<span class="token punctuation" data-v-94e700a2>(</span><span class="token string" data-v-94e700a2>'off'</span><span class="token punctuation" data-v-94e700a2>)</span>

<span class="token keyword" data-v-94e700a2>class</span> <span class="token class-name" data-v-94e700a2>MatchedFilesDataset</span><span class="token punctuation" data-v-94e700a2>(</span>FilesDataset<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token comment" data-v-94e700a2># LOADER FOR THE IMAGES</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>__init__</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>,</span> fnames<span class="token punctuation" data-v-94e700a2>,</span> y<span class="token punctuation" data-v-94e700a2>,</span> transform<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
        self<span class="token punctuation" data-v-94e700a2>.</span>y<span class="token operator" data-v-94e700a2>=</span>y
        <span class="token keyword" data-v-94e700a2>assert</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>fnames<span class="token punctuation" data-v-94e700a2>)</span><span class="token operator" data-v-94e700a2>==</span><span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>y<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
        <span class="token builtin" data-v-94e700a2>super</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>.</span>__init__<span class="token punctuation" data-v-94e700a2>(</span>fnames<span class="token punctuation" data-v-94e700a2>,</span> transform<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>get_y</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>,</span> i<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token keyword" data-v-94e700a2>return</span> open_image<span class="token punctuation" data-v-94e700a2>(</span>os<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>join<span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>,</span> self<span class="token punctuation" data-v-94e700a2>.</span>y<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>get_c</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token keyword" data-v-94e700a2>return</span> <span class="token number" data-v-94e700a2>0</span>

<span class="token comment" data-v-94e700a2># MAIN CODE</span>
aug_tfms <span class="token operator" data-v-94e700a2>=</span> RandomLighting<span class="token punctuation" data-v-94e700a2>(</span>b<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>,</span> c<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span> tfm_y<span class="token operator" data-v-94e700a2>=</span>TfmType<span class="token punctuation" data-v-94e700a2>.</span>NO<span class="token punctuation" data-v-94e700a2>)</span>

<span class="token comment" data-v-94e700a2># RESULTS</span>
tfms <span class="token operator" data-v-94e700a2>=</span> tfms_from_model<span class="token punctuation" data-v-94e700a2>(</span>arch<span class="token punctuation" data-v-94e700a2>,</span> sz<span class="token punctuation" data-v-94e700a2>,</span> aug_tfms<span class="token operator" data-v-94e700a2>=</span>aug_tfms<span class="token punctuation" data-v-94e700a2>)</span>
datasets <span class="token operator" data-v-94e700a2>=</span> ImageData<span class="token punctuation" data-v-94e700a2>.</span>get_ds<span class="token punctuation" data-v-94e700a2>(</span>MatchedFilesDataset<span class="token punctuation" data-v-94e700a2>,</span> 
                            <span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> 
                            <span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> 
                            tfms<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token operator" data-v-94e700a2>=</span>FNAMES_PATH<span class="token punctuation" data-v-94e700a2>)</span>
md <span class="token operator" data-v-94e700a2>=</span> ImageData<span class="token punctuation" data-v-94e700a2>(</span>FNAMES_PATH<span class="token punctuation" data-v-94e700a2>,</span> datasets<span class="token punctuation" data-v-94e700a2>,</span> bs<span class="token punctuation" data-v-94e700a2>,</span> num_workers<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>16</span><span class="token punctuation" data-v-94e700a2>,</span> classes<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2>#only for tests</span>

<span class="token comment" data-v-94e700a2># SHOW IMAGES</span>
fig<span class="token punctuation" data-v-94e700a2>,</span> axes <span class="token operator" data-v-94e700a2>=</span> plt<span class="token punctuation" data-v-94e700a2>.</span>subplots<span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>6</span><span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>18</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>9</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
<span class="token keyword" data-v-94e700a2>for</span> i<span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>(</span>x<span class="token punctuation" data-v-94e700a2>,</span>y<span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>in</span> <span class="token builtin" data-v-94e700a2>enumerate</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span><span class="token builtin" data-v-94e700a2>next</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token builtin" data-v-94e700a2>iter</span><span class="token punctuation" data-v-94e700a2>(</span>md<span class="token punctuation" data-v-94e700a2>.</span>aug_dl<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>for</span> i <span class="token keyword" data-v-94e700a2>in</span> <span class="token builtin" data-v-94e700a2>range</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>6</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    show_img<span class="token punctuation" data-v-94e700a2>(</span>x<span class="token punctuation" data-v-94e700a2>,</span> <span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>,</span> denorm<span class="token operator" data-v-94e700a2>=</span> md<span class="token punctuation" data-v-94e700a2>.</span>val_ds<span class="token punctuation" data-v-94e700a2>.</span>denorm<span class="token punctuation" data-v-94e700a2>,</span> ax<span class="token operator" data-v-94e700a2>=</span>axes<span class="token punctuation" data-v-94e700a2>.</span>flat<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544343317278.f7fc2c7f.png" alt="1544343317278"></p><h2 id="fast-ai-transforms-data"><a href="#fast-ai-transforms-data" aria-hidden="true" class="header-anchor">#</a> fast.ai / Transforms Data<a href="https://becominghuman.ai/data-augmentation-using-fastai-aefa88ca03f1" target="_blank" title="https://becominghuman.ai/data-augmentation-using-fastai-aefa88ca03f1" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Group of functions that changes your data without changing the meaning of the data. Usefull to test your model when you want to add some data augmentation. For example little zoom on the image, flip the image,  rotate in a small range).</p><h3 id="tfms-from-model"><a href="#tfms-from-model" aria-hidden="true" class="header-anchor">#</a> tfms_from_model</h3><p>Returns separate transformers of images for training and validation.</p><div class="language-python extra-class"><pre class="language-python"><code>sz <span class="token operator">=</span> <span class="token number">224</span>
tfms <span class="token operator">=</span> tfms_from_model<span class="token punctuation">(</span>resnet34<span class="token punctuation">,</span> sz<span class="token punctuation">,</span> aug_tfms<span class="token operator">=</span>transforms_side_on<span class="token punctuation">,</span> max_zoom<span class="token operator">=</span><span class="token number">1.1</span><span class="token punctuation">)</span>
</code></pre></div><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>f_model</strong></td><td>Model used in the network (required), becuase different models normalize data in different ways.</td></tr><tr><td><strong>sz</strong></td><td>size of the image to be cropped (224x224). Image must be cropped to be square before any further analysis.  If your image is wide or tall the crop could miss your data.</td></tr><tr><td><strong>aug_tfms</strong></td><td>Augmentation used in your source image, (as list)</td></tr><tr><td><strong>max_zoom</strong></td><td>Maximum zoom used in the image</td></tr></tbody></table><h3 id="tfmtype"><a href="#tfmtype" aria-hidden="true" class="header-anchor">#</a> TfmType</h3><p>Parametr for transformation. type of transform</p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><strong>TfmType.NO</strong></td><td>the <strong>default</strong>, y does not get transformed when x is transformed.</td></tr><tr><td><strong>TfmType.PIXEL</strong></td><td>x and y are images and should be transformed in the same way. Example: image segmentation</td></tr><tr><td><strong>TfmType.COORD</strong></td><td>y are coordinates (i.e bounding boxes)</td></tr><tr><td><strong>TfmType.CLASS</strong></td><td>y are class labels (same behaviour as PIXEL, except no normalization)</td></tr></tbody></table><h3 id="randomrotate"><a href="#randomrotate" aria-hidden="true" class="header-anchor">#</a> RandomRotate</h3><p>Class for random rotation</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>deg</strong></td><td>degree of rotation</td></tr><tr><td><strong>p</strong></td><td>probability of rotation</td></tr><tr><td><strong>mode</strong></td><td>Flag defining what kind of border to be added. It can be following types<a href="https://docs.opencv.org/3.0-beta/doc/py_tutorials/py_core/py_basic_ops/py_basic_ops.html" target="_blank" title="https://docs.opencv.org/3.0-beta/doc/py_tutorials/py_core/py_basic_ops/py_basic_ops.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><br>- <strong>cv2.BORDER_CONSTANT</strong> - Adds a constant colored border. The value should be given as next argument.<br>- <strong>cv2.BORDER_REFLECT</strong> - Border will be mirror reflection of the border elements, like this : fedcba<br>- <strong>cv2.BORDER_REFLECT_101</strong> or <strong>cv2.BORDER_DEFAULT</strong> - Same as above, but with a slight change, like this : gfedcb<br>- <strong>cv2.BORDER_REPLICATE</strong> - Last element is replicated throughout, like this: aaaaaa<br>- <strong>cv2.BORDER_WRAP</strong> - Can’t explain, it will look like this : cdefgh</td></tr><tr><td><strong>tfm_y</strong></td><td>Type of transformation.</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>aug_tfms <span class="token operator">=</span> RandomRotate<span class="token punctuation">(</span>deg<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> mode <span class="token operator">=</span> cv2<span class="token punctuation">.</span>BORDER_REFLECT<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-94e700a2><button class="accordion" data-v-94e700a2><span class="badge secondary top badge-code" data-v-94e700a2>Full code</span></button><div class="panel" style="display:none;" data-v-94e700a2><div class="language-python extra-class" data-v-94e700a2><pre class="language-python" data-v-94e700a2><code data-v-94e700a2><span class="token comment" data-v-94e700a2># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>&quot;../fastai/old/&quot;</span>
FNAMES_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'../data/dogscats/valid/cats/'</span>
FNAME <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'cat.2209.jpg'</span>

<span class="token comment" data-v-94e700a2># IMPORTS</span>
<span class="token keyword" data-v-94e700a2>import</span> sys
<span class="token keyword" data-v-94e700a2>import</span> numpy <span class="token keyword" data-v-94e700a2>as</span> np
<span class="token keyword" data-v-94e700a2>import</span> cv2


<span class="token comment" data-v-94e700a2># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>append<span class="token punctuation" data-v-94e700a2>(</span>FASTAI_PATH<span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2># go to parent dir</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>transforms <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>conv_learner <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>

<span class="token comment" data-v-94e700a2># ARCHITECTURE</span>
arch <span class="token operator" data-v-94e700a2>=</span> resnet34
sz <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>256</span>
bs <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>2</span> 

<span class="token comment" data-v-94e700a2># HELP FUNCTIONS/CLASSES</span>
<span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>show_img</span><span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>,</span> idx<span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>5</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>5</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> denorm<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>,</span> ax<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    <span class="token keyword" data-v-94e700a2>if</span> ax <span class="token keyword" data-v-94e700a2>is</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>:</span> fig<span class="token punctuation" data-v-94e700a2>,</span>ax <span class="token operator" data-v-94e700a2>=</span> plt<span class="token punctuation" data-v-94e700a2>.</span>subplots<span class="token punctuation" data-v-94e700a2>(</span>figsize<span class="token operator" data-v-94e700a2>=</span>figsize<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>if</span> <span class="token operator" data-v-94e700a2>not</span> denorm <span class="token keyword" data-v-94e700a2>is</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>:</span> ims <span class="token operator" data-v-94e700a2>=</span> denorm<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>else</span><span class="token punctuation" data-v-94e700a2>:</span>      ims <span class="token operator" data-v-94e700a2>=</span> np<span class="token punctuation" data-v-94e700a2>.</span>rollaxis<span class="token punctuation" data-v-94e700a2>(</span>to_np<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>4</span><span class="token punctuation" data-v-94e700a2>)</span>
    ax<span class="token punctuation" data-v-94e700a2>.</span>imshow<span class="token punctuation" data-v-94e700a2>(</span>np<span class="token punctuation" data-v-94e700a2>.</span>clip<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>[</span>idx<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>
    ax<span class="token punctuation" data-v-94e700a2>.</span>axis<span class="token punctuation" data-v-94e700a2>(</span><span class="token string" data-v-94e700a2>'off'</span><span class="token punctuation" data-v-94e700a2>)</span>

<span class="token keyword" data-v-94e700a2>class</span> <span class="token class-name" data-v-94e700a2>MatchedFilesDataset</span><span class="token punctuation" data-v-94e700a2>(</span>FilesDataset<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token comment" data-v-94e700a2># LOADER FOR THE IMAGES</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>__init__</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>,</span> fnames<span class="token punctuation" data-v-94e700a2>,</span> y<span class="token punctuation" data-v-94e700a2>,</span> transform<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
        self<span class="token punctuation" data-v-94e700a2>.</span>y<span class="token operator" data-v-94e700a2>=</span>y
        <span class="token keyword" data-v-94e700a2>assert</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>fnames<span class="token punctuation" data-v-94e700a2>)</span><span class="token operator" data-v-94e700a2>==</span><span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>y<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
        <span class="token builtin" data-v-94e700a2>super</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>.</span>__init__<span class="token punctuation" data-v-94e700a2>(</span>fnames<span class="token punctuation" data-v-94e700a2>,</span> transform<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>get_y</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>,</span> i<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token keyword" data-v-94e700a2>return</span> open_image<span class="token punctuation" data-v-94e700a2>(</span>os<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>join<span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>,</span> self<span class="token punctuation" data-v-94e700a2>.</span>y<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>get_c</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token keyword" data-v-94e700a2>return</span> <span class="token number" data-v-94e700a2>0</span>

<span class="token comment" data-v-94e700a2># MAIN CODE</span>
aug_tfms <span class="token operator" data-v-94e700a2>=</span> RandomRotate<span class="token punctuation" data-v-94e700a2>(</span>deg<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>120</span><span class="token punctuation" data-v-94e700a2>,</span>p<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>50</span><span class="token punctuation" data-v-94e700a2>,</span> mode <span class="token operator" data-v-94e700a2>=</span> cv2<span class="token punctuation" data-v-94e700a2>.</span>BORDER_REFLECT<span class="token punctuation" data-v-94e700a2>)</span>

<span class="token comment" data-v-94e700a2># RESULTS</span>
tfms <span class="token operator" data-v-94e700a2>=</span> tfms_from_model<span class="token punctuation" data-v-94e700a2>(</span>arch<span class="token punctuation" data-v-94e700a2>,</span> sz<span class="token punctuation" data-v-94e700a2>,</span> aug_tfms<span class="token operator" data-v-94e700a2>=</span>aug_tfms<span class="token punctuation" data-v-94e700a2>)</span>
datasets <span class="token operator" data-v-94e700a2>=</span> ImageData<span class="token punctuation" data-v-94e700a2>.</span>get_ds<span class="token punctuation" data-v-94e700a2>(</span>MatchedFilesDataset<span class="token punctuation" data-v-94e700a2>,</span> 
                            <span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> 
                            <span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> 
                            tfms<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token operator" data-v-94e700a2>=</span>FNAMES_PATH<span class="token punctuation" data-v-94e700a2>)</span>
md <span class="token operator" data-v-94e700a2>=</span> ImageData<span class="token punctuation" data-v-94e700a2>(</span>FNAMES_PATH<span class="token punctuation" data-v-94e700a2>,</span> datasets<span class="token punctuation" data-v-94e700a2>,</span> bs<span class="token punctuation" data-v-94e700a2>,</span> num_workers<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>16</span><span class="token punctuation" data-v-94e700a2>,</span> classes<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2>#only for tests</span>

<span class="token comment" data-v-94e700a2># SHOW IMAGES</span>
fig<span class="token punctuation" data-v-94e700a2>,</span> axes <span class="token operator" data-v-94e700a2>=</span> plt<span class="token punctuation" data-v-94e700a2>.</span>subplots<span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>6</span><span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>18</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>9</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
<span class="token keyword" data-v-94e700a2>for</span> i<span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>(</span>x<span class="token punctuation" data-v-94e700a2>,</span>y<span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>in</span> <span class="token builtin" data-v-94e700a2>enumerate</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span><span class="token builtin" data-v-94e700a2>next</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token builtin" data-v-94e700a2>iter</span><span class="token punctuation" data-v-94e700a2>(</span>md<span class="token punctuation" data-v-94e700a2>.</span>aug_dl<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>for</span> i <span class="token keyword" data-v-94e700a2>in</span> <span class="token builtin" data-v-94e700a2>range</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>6</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    show_img<span class="token punctuation" data-v-94e700a2>(</span>x<span class="token punctuation" data-v-94e700a2>,</span> <span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>,</span> denorm<span class="token operator" data-v-94e700a2>=</span> md<span class="token punctuation" data-v-94e700a2>.</span>val_ds<span class="token punctuation" data-v-94e700a2>.</span>denorm<span class="token punctuation" data-v-94e700a2>,</span> ax<span class="token operator" data-v-94e700a2>=</span>axes<span class="token punctuation" data-v-94e700a2>.</span>flat<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544349765110.b8a32e2e.png" alt="1544349765110"></p><h3 id="randomlighting"><a href="#randomlighting" aria-hidden="true" class="header-anchor">#</a> RandomLighting</h3><p>Class for random lighting</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>b</strong></td><td>balance (0 - no change)</td></tr><tr><td><strong>c</strong></td><td>contrast (0 - no change)</td></tr><tr><td><strong>tfm_y</strong></td><td>Type of transformation.</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>aug_tfms <span class="token operator">=</span> RandomLighting<span class="token punctuation">(</span>b<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-94e700a2><button class="accordion" data-v-94e700a2><span class="badge secondary top badge-code" data-v-94e700a2>Full code</span></button><div class="panel" style="display:none;" data-v-94e700a2><div class="language-python extra-class" data-v-94e700a2><pre class="language-python" data-v-94e700a2><code data-v-94e700a2><span class="token comment" data-v-94e700a2># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>&quot;../fastai/old/&quot;</span>
FNAMES_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'../data/dogscats/valid/cats/'</span>
FNAME <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'cat.2209.jpg'</span>

<span class="token comment" data-v-94e700a2># IMPORTS</span>
<span class="token keyword" data-v-94e700a2>import</span> sys
<span class="token keyword" data-v-94e700a2>import</span> numpy <span class="token keyword" data-v-94e700a2>as</span> np
<span class="token keyword" data-v-94e700a2>import</span> cv2


<span class="token comment" data-v-94e700a2># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>append<span class="token punctuation" data-v-94e700a2>(</span>FASTAI_PATH<span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2># go to parent dir</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>transforms <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>conv_learner <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>

<span class="token comment" data-v-94e700a2># ARCHITECTURE</span>
arch <span class="token operator" data-v-94e700a2>=</span> resnet34
sz <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>256</span>
bs <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>2</span> 

<span class="token comment" data-v-94e700a2># HELP FUNCTIONS/CLASSES</span>
<span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>show_img</span><span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>,</span> idx<span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>5</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>5</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> denorm<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>,</span> ax<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    <span class="token keyword" data-v-94e700a2>if</span> ax <span class="token keyword" data-v-94e700a2>is</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>:</span> fig<span class="token punctuation" data-v-94e700a2>,</span>ax <span class="token operator" data-v-94e700a2>=</span> plt<span class="token punctuation" data-v-94e700a2>.</span>subplots<span class="token punctuation" data-v-94e700a2>(</span>figsize<span class="token operator" data-v-94e700a2>=</span>figsize<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>if</span> <span class="token operator" data-v-94e700a2>not</span> denorm <span class="token keyword" data-v-94e700a2>is</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>:</span> ims <span class="token operator" data-v-94e700a2>=</span> denorm<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>else</span><span class="token punctuation" data-v-94e700a2>:</span>      ims <span class="token operator" data-v-94e700a2>=</span> np<span class="token punctuation" data-v-94e700a2>.</span>rollaxis<span class="token punctuation" data-v-94e700a2>(</span>to_np<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>4</span><span class="token punctuation" data-v-94e700a2>)</span>
    ax<span class="token punctuation" data-v-94e700a2>.</span>imshow<span class="token punctuation" data-v-94e700a2>(</span>np<span class="token punctuation" data-v-94e700a2>.</span>clip<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>[</span>idx<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>
    ax<span class="token punctuation" data-v-94e700a2>.</span>axis<span class="token punctuation" data-v-94e700a2>(</span><span class="token string" data-v-94e700a2>'off'</span><span class="token punctuation" data-v-94e700a2>)</span>

<span class="token keyword" data-v-94e700a2>class</span> <span class="token class-name" data-v-94e700a2>MatchedFilesDataset</span><span class="token punctuation" data-v-94e700a2>(</span>FilesDataset<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token comment" data-v-94e700a2># LOADER FOR THE IMAGES</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>__init__</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>,</span> fnames<span class="token punctuation" data-v-94e700a2>,</span> y<span class="token punctuation" data-v-94e700a2>,</span> transform<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
        self<span class="token punctuation" data-v-94e700a2>.</span>y<span class="token operator" data-v-94e700a2>=</span>y
        <span class="token keyword" data-v-94e700a2>assert</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>fnames<span class="token punctuation" data-v-94e700a2>)</span><span class="token operator" data-v-94e700a2>==</span><span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>y<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
        <span class="token builtin" data-v-94e700a2>super</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>.</span>__init__<span class="token punctuation" data-v-94e700a2>(</span>fnames<span class="token punctuation" data-v-94e700a2>,</span> transform<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>get_y</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>,</span> i<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token keyword" data-v-94e700a2>return</span> open_image<span class="token punctuation" data-v-94e700a2>(</span>os<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>join<span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>,</span> self<span class="token punctuation" data-v-94e700a2>.</span>y<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>get_c</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token keyword" data-v-94e700a2>return</span> <span class="token number" data-v-94e700a2>0</span>

<span class="token comment" data-v-94e700a2># MAIN CODE</span>
aug_tfms <span class="token operator" data-v-94e700a2>=</span> RandomLighting<span class="token punctuation" data-v-94e700a2>(</span>b<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>0.5</span><span class="token punctuation" data-v-94e700a2>,</span> c<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>0.5</span><span class="token punctuation" data-v-94e700a2>)</span>

<span class="token comment" data-v-94e700a2># RESULTS</span>
tfms <span class="token operator" data-v-94e700a2>=</span> tfms_from_model<span class="token punctuation" data-v-94e700a2>(</span>arch<span class="token punctuation" data-v-94e700a2>,</span> sz<span class="token punctuation" data-v-94e700a2>,</span> aug_tfms<span class="token operator" data-v-94e700a2>=</span>aug_tfms<span class="token punctuation" data-v-94e700a2>)</span>
datasets <span class="token operator" data-v-94e700a2>=</span> ImageData<span class="token punctuation" data-v-94e700a2>.</span>get_ds<span class="token punctuation" data-v-94e700a2>(</span>MatchedFilesDataset<span class="token punctuation" data-v-94e700a2>,</span> 
                            <span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> 
                            <span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> 
                            tfms<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token operator" data-v-94e700a2>=</span>FNAMES_PATH<span class="token punctuation" data-v-94e700a2>)</span>
md <span class="token operator" data-v-94e700a2>=</span> ImageData<span class="token punctuation" data-v-94e700a2>(</span>FNAMES_PATH<span class="token punctuation" data-v-94e700a2>,</span> datasets<span class="token punctuation" data-v-94e700a2>,</span> bs<span class="token punctuation" data-v-94e700a2>,</span> num_workers<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>16</span><span class="token punctuation" data-v-94e700a2>,</span> classes<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2>#only for tests</span>

<span class="token comment" data-v-94e700a2># SHOW IMAGES</span>
fig<span class="token punctuation" data-v-94e700a2>,</span> axes <span class="token operator" data-v-94e700a2>=</span> plt<span class="token punctuation" data-v-94e700a2>.</span>subplots<span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>6</span><span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>18</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>9</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
<span class="token keyword" data-v-94e700a2>for</span> i<span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>(</span>x<span class="token punctuation" data-v-94e700a2>,</span>y<span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>in</span> <span class="token builtin" data-v-94e700a2>enumerate</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span><span class="token builtin" data-v-94e700a2>next</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token builtin" data-v-94e700a2>iter</span><span class="token punctuation" data-v-94e700a2>(</span>md<span class="token punctuation" data-v-94e700a2>.</span>aug_dl<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>for</span> i <span class="token keyword" data-v-94e700a2>in</span> <span class="token builtin" data-v-94e700a2>range</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>6</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    show_img<span class="token punctuation" data-v-94e700a2>(</span>x<span class="token punctuation" data-v-94e700a2>,</span> <span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>,</span> denorm<span class="token operator" data-v-94e700a2>=</span> md<span class="token punctuation" data-v-94e700a2>.</span>val_ds<span class="token punctuation" data-v-94e700a2>.</span>denorm<span class="token punctuation" data-v-94e700a2>,</span> ax<span class="token operator" data-v-94e700a2>=</span>axes<span class="token punctuation" data-v-94e700a2>.</span>flat<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544349877751.44b1cf42.png" alt="1544349877751"></p><h3 id="randomflip"><a href="#randomflip" aria-hidden="true" class="header-anchor">#</a> RandomFlip</h3><p>Random flip image.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>tfm_y</strong></td><td>Type of transformation.</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>aug_tfms <span class="token operator">=</span> RandomFlip<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-94e700a2><button class="accordion" data-v-94e700a2><span class="badge secondary top badge-code" data-v-94e700a2>Full code</span></button><div class="panel" style="display:none;" data-v-94e700a2><div class="language-python extra-class" data-v-94e700a2><pre class="language-python" data-v-94e700a2><code data-v-94e700a2><span class="token comment" data-v-94e700a2># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>&quot;../fastai/old/&quot;</span>
FNAMES_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'../data/dogscats/valid/cats/'</span>
FNAME <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'cat.2209.jpg'</span>

<span class="token comment" data-v-94e700a2># IMPORTS</span>
<span class="token keyword" data-v-94e700a2>import</span> sys
<span class="token keyword" data-v-94e700a2>import</span> numpy <span class="token keyword" data-v-94e700a2>as</span> np
<span class="token keyword" data-v-94e700a2>import</span> cv2


<span class="token comment" data-v-94e700a2># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>append<span class="token punctuation" data-v-94e700a2>(</span>FASTAI_PATH<span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2># go to parent dir</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>transforms <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>conv_learner <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>

<span class="token comment" data-v-94e700a2># ARCHITECTURE</span>
arch <span class="token operator" data-v-94e700a2>=</span> resnet34
sz <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>256</span>
bs <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>2</span> 

<span class="token comment" data-v-94e700a2># HELP FUNCTIONS/CLASSES</span>
<span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>show_img</span><span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>,</span> idx<span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>5</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>5</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> denorm<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>,</span> ax<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    <span class="token keyword" data-v-94e700a2>if</span> ax <span class="token keyword" data-v-94e700a2>is</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>:</span> fig<span class="token punctuation" data-v-94e700a2>,</span>ax <span class="token operator" data-v-94e700a2>=</span> plt<span class="token punctuation" data-v-94e700a2>.</span>subplots<span class="token punctuation" data-v-94e700a2>(</span>figsize<span class="token operator" data-v-94e700a2>=</span>figsize<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>if</span> <span class="token operator" data-v-94e700a2>not</span> denorm <span class="token keyword" data-v-94e700a2>is</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>:</span> ims <span class="token operator" data-v-94e700a2>=</span> denorm<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>else</span><span class="token punctuation" data-v-94e700a2>:</span>      ims <span class="token operator" data-v-94e700a2>=</span> np<span class="token punctuation" data-v-94e700a2>.</span>rollaxis<span class="token punctuation" data-v-94e700a2>(</span>to_np<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>4</span><span class="token punctuation" data-v-94e700a2>)</span>
    ax<span class="token punctuation" data-v-94e700a2>.</span>imshow<span class="token punctuation" data-v-94e700a2>(</span>np<span class="token punctuation" data-v-94e700a2>.</span>clip<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>[</span>idx<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>
    ax<span class="token punctuation" data-v-94e700a2>.</span>axis<span class="token punctuation" data-v-94e700a2>(</span><span class="token string" data-v-94e700a2>'off'</span><span class="token punctuation" data-v-94e700a2>)</span>

<span class="token keyword" data-v-94e700a2>class</span> <span class="token class-name" data-v-94e700a2>MatchedFilesDataset</span><span class="token punctuation" data-v-94e700a2>(</span>FilesDataset<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token comment" data-v-94e700a2># LOADER FOR THE IMAGES</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>__init__</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>,</span> fnames<span class="token punctuation" data-v-94e700a2>,</span> y<span class="token punctuation" data-v-94e700a2>,</span> transform<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
        self<span class="token punctuation" data-v-94e700a2>.</span>y<span class="token operator" data-v-94e700a2>=</span>y
        <span class="token keyword" data-v-94e700a2>assert</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>fnames<span class="token punctuation" data-v-94e700a2>)</span><span class="token operator" data-v-94e700a2>==</span><span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>y<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
        <span class="token builtin" data-v-94e700a2>super</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>.</span>__init__<span class="token punctuation" data-v-94e700a2>(</span>fnames<span class="token punctuation" data-v-94e700a2>,</span> transform<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>get_y</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>,</span> i<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token keyword" data-v-94e700a2>return</span> open_image<span class="token punctuation" data-v-94e700a2>(</span>os<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>join<span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>,</span> self<span class="token punctuation" data-v-94e700a2>.</span>y<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>get_c</span><span class="token punctuation" data-v-94e700a2>(</span>self<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token keyword" data-v-94e700a2>return</span> <span class="token number" data-v-94e700a2>0</span>

<span class="token comment" data-v-94e700a2># MAIN CODE</span>
aug_tfms <span class="token operator" data-v-94e700a2>=</span> RandomFlip<span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>)</span>

<span class="token comment" data-v-94e700a2># RESULTS</span>
tfms <span class="token operator" data-v-94e700a2>=</span> tfms_from_model<span class="token punctuation" data-v-94e700a2>(</span>arch<span class="token punctuation" data-v-94e700a2>,</span> sz<span class="token punctuation" data-v-94e700a2>,</span> aug_tfms<span class="token operator" data-v-94e700a2>=</span>aug_tfms<span class="token punctuation" data-v-94e700a2>)</span>
datasets <span class="token operator" data-v-94e700a2>=</span> ImageData<span class="token punctuation" data-v-94e700a2>.</span>get_ds<span class="token punctuation" data-v-94e700a2>(</span>MatchedFilesDataset<span class="token punctuation" data-v-94e700a2>,</span> 
                            <span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> 
                            <span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>[</span>FNAME<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> 
                            tfms<span class="token punctuation" data-v-94e700a2>,</span> path<span class="token operator" data-v-94e700a2>=</span>FNAMES_PATH<span class="token punctuation" data-v-94e700a2>)</span>
md <span class="token operator" data-v-94e700a2>=</span> ImageData<span class="token punctuation" data-v-94e700a2>(</span>FNAMES_PATH<span class="token punctuation" data-v-94e700a2>,</span> datasets<span class="token punctuation" data-v-94e700a2>,</span> bs<span class="token punctuation" data-v-94e700a2>,</span> num_workers<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>16</span><span class="token punctuation" data-v-94e700a2>,</span> classes<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2>#only for tests</span>

<span class="token comment" data-v-94e700a2># SHOW IMAGES</span>
fig<span class="token punctuation" data-v-94e700a2>,</span> axes <span class="token operator" data-v-94e700a2>=</span> plt<span class="token punctuation" data-v-94e700a2>.</span>subplots<span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>6</span><span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>18</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>9</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
<span class="token keyword" data-v-94e700a2>for</span> i<span class="token punctuation" data-v-94e700a2>,</span><span class="token punctuation" data-v-94e700a2>(</span>x<span class="token punctuation" data-v-94e700a2>,</span>y<span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>in</span> <span class="token builtin" data-v-94e700a2>enumerate</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>[</span><span class="token builtin" data-v-94e700a2>next</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token builtin" data-v-94e700a2>iter</span><span class="token punctuation" data-v-94e700a2>(</span>md<span class="token punctuation" data-v-94e700a2>.</span>aug_dl<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>for</span> i <span class="token keyword" data-v-94e700a2>in</span> <span class="token builtin" data-v-94e700a2>range</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>6</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    show_img<span class="token punctuation" data-v-94e700a2>(</span>x<span class="token punctuation" data-v-94e700a2>,</span> <span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>,</span> denorm<span class="token operator" data-v-94e700a2>=</span> md<span class="token punctuation" data-v-94e700a2>.</span>val_ds<span class="token punctuation" data-v-94e700a2>.</span>denorm<span class="token punctuation" data-v-94e700a2>,</span> ax<span class="token operator" data-v-94e700a2>=</span>axes<span class="token punctuation" data-v-94e700a2>.</span>flat<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544350244740.ca57eb8b.png" alt="1544350244740"></p><h3 id="transforms-basic"><a href="#transforms-basic" aria-hidden="true" class="header-anchor">#</a> transforms_basic</h3><p>Contains two transforms for the image</p><div class="language-python extra-class"><pre class="language-python"><code>transform_basic <span class="token operator">=</span> <span class="token punctuation">[</span>RandomRotate<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RandomLighting<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="transforms-side-on"><a href="#transforms-side-on" aria-hidden="true" class="header-anchor">#</a> transforms_side_on</h3><div class="language-python extra-class"><pre class="language-python"><code>transforms_side_on <span class="token operator">=</span> <span class="token punctuation">[</span>RandomRotate<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RandomLighting<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RandomFlip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
</code></pre></div><h2 id="fast-ai-import-data"><a href="#fast-ai-import-data" aria-hidden="true" class="header-anchor">#</a> fast.ai / Import Data</h2><h3 id="imageclassifierdata"><a href="#imageclassifierdata" aria-hidden="true" class="header-anchor">#</a> ImageClassifierData</h3><p>Class for image classification tasks.</p><h4 id="imageclassifierdata-from-paths"><a href="#imageclassifierdata-from-paths" aria-hidden="true" class="header-anchor">#</a> ImageClassifierData.from_paths</h4><p>A function that returns class ImageClassifierData where each class has different folder (for examples <code>dogscat/dogs</code>, <code>dogscat/cats</code>).</p><p><img src="data:image/png;base64,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" alt="1544370816367"></p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><strong>path</strong></td><td>a root path of the data (used for storing trained models, precomputed values, etc)</td></tr><tr><td><strong>bs</strong></td><td>Batch size. Make as large as possible (preferably work with multiples of 2). Determines how many data points go into each loss value that gets backgrpagaed.  When it’s too big than you can run out of the memory. (default: <code>64</code>)</td></tr><tr><td><strong>tmfs</strong></td><td>transformations (for data agumentations), e.g. output of ‘tfms_from_model’</td></tr><tr><td><strong>trn_name</strong></td><td>a name of the folder that contatins training images (default: <code>train</code>)</td></tr><tr><td><strong>val_name</strong></td><td>a name of the folder that contatins validation images (default: <code>valid</code>)</td></tr><tr><td><strong>test_name</strong></td><td>a name of the folder that contatins test images (default: <code>None</code>)</td></tr><tr><td><strong>num_workers</strong></td><td>a number of workers (default: <code>8</code>)</td></tr></tbody></table><h2 id="fast-ai-learner"><a href="#fast-ai-learner" aria-hidden="true" class="header-anchor">#</a> fast.ai / Learner</h2><h3 id="basic-functions"><a href="#basic-functions" aria-hidden="true" class="header-anchor">#</a> Basic Functions</h3><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>learn.save('filename')</code></td><td>Save learner</td></tr><tr><td><code>learn.load('filename')</code></td><td>Load learner from the file</td></tr></tbody></table><h3 id="convlearner-pretrained"><a href="#convlearner-pretrained" aria-hidden="true" class="header-anchor">#</a> ConvLearner.pretrained()</h3><p>A function that load’s pretrained architectures as a class <strong>ConvLearner:</strong> (<em>Class used to train a chosen supported covnet model. Eg. ResNet-34, etc.</em> )</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><strong>cls</strong></td><td>a model creation function (e.g. resnet34, resnet50, vgg16, dn201…)</td></tr><tr><td><strong>data</strong></td><td>training data for model (e.g. ImageClassifierData)</td></tr><tr><td><strong>precompute</strong></td><td>bool to reuse precomputed activations</td></tr></tbody></table><h3 id="fit"><a href="#fit" aria-hidden="true" class="header-anchor">#</a> fit()</h3><p>function that train the model based on the train dataset.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>lrs</strong></td><td>Learning Rate</td></tr><tr><td><strong>n_cycle</strong></td><td>Number of cycles (or iterations) to fi the model for</td></tr></tbody></table><h3 id="predict"><a href="#predict" aria-hidden="true" class="header-anchor">#</a> predict()</h3><p>predict the test/validation dataset and returns  and array with the probability of each class. Prediction are in the log scale.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>is_test</strong></td><td><code>False</code>: is validataion dataset <code>val_ds</code>, <code>True</code>: is train dataset <code>test_ds</code></td></tr></tbody></table><h3 id="lr-find"><a href="#lr-find" aria-hidden="true" class="header-anchor">#</a> lr_find() <a href="https://arxiv.org/abs/1506.01186" target="_blank" title="https://arxiv.org/abs/1506.01186" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Find best learning rate for a model. Determines how you update the weights or parameters.</p><div class="language-python extra-class"><pre class="language-python"><code>lrf<span class="token operator">=</span>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong><code>start_lr</code></strong></td><td>start learning rate <code>float</code> number or <code>numpy array</code> (for example <code>learn.lr_find(np.array([1e-4,1e-3,1e-2]))</code>)</td></tr><tr><td><strong><code>end_lr</code></strong></td><td>The maximum learning rate to try.</td></tr><tr><td><code>wbs</code></td><td>weight decay parameter(s) (specifies regularization in the neural network.) <a href="https://openreview.net/pdf?id=B1lz-3Rct7" target="_blank" title="https://openreview.net/pdf?id=B1lz-3Rct7" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>sched<span class="token punctuation">.</span>plot_lr<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>schedule plot for the learning rate.</p><p><img src="/assets/img/1544619773797.0c9dc24c.png" alt="1544619773797"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>sched<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Plots the loss function with respect to learning rate.</p><p><img src="/assets/img/1544619887418.ac4b2774.png" alt="1544619887418"></p><p>It’s good to chose the learning just  one order of magnitude before incerease.</p><p><img src="/assets/img/1544620113338.5becf0f8.png" alt="1544620113338"></p><h2 id="fast-ai-examples"><a href="#fast-ai-examples" aria-hidden="true" class="header-anchor">#</a> fast.ai / Examples</h2><h3 id="dog-cat-example"><a href="#dog-cat-example" aria-hidden="true" class="header-anchor">#</a> dog-cat example</h3><h4 id="download"><a href="#download" aria-hidden="true" class="header-anchor">#</a> download</h4><div class="language-python extra-class"><pre class="language-python"><code>!wget http<span class="token punctuation">:</span><span class="token operator">//</span>files<span class="token punctuation">.</span>fast<span class="token punctuation">.</span>ai<span class="token operator">/</span>data<span class="token operator">/</span>dogscats<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> unzip dogscats<span class="token punctuation">.</span><span class="token builtin">zip</span>
!ls dogscats<span class="token operator">/</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1544129618067"></p><h4 id="train-model"><a href="#train-model" aria-hidden="true" class="header-anchor">#</a> Train model</h4><p>Train the model based on the previous learned model: <em>resnet34</em> with <em>learning reate=0.01</em> and <em>2 cycles</em>.</p><div class="language-python extra-class"><pre class="language-python"><code>PATH <span class="token operator">=</span> <span class="token string">&quot;./dogscats/&quot;</span>

arch <span class="token operator">=</span> resnet34
sz <span class="token operator">=</span> <span class="token number">256</span>
bs <span class="token operator">=</span> <span class="token number">64</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>arch <span class="token operator">=</span> resnet34
data <span class="token operator">=</span> ImageClassifierData<span class="token punctuation">.</span>from_paths<span class="token punctuation">(</span>PATH<span class="token punctuation">,</span> bs<span class="token punctuation">,</span> tfms<span class="token operator">=</span>tfms_from_model<span class="token punctuation">(</span>arch<span class="token punctuation">,</span> sz<span class="token punctuation">)</span><span class="token punctuation">)</span>
learn <span class="token operator">=</span> ConvLearner<span class="token punctuation">.</span>pretrained<span class="token punctuation">(</span>arch<span class="token punctuation">,</span> data<span class="token punctuation">,</span> precompute<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>lrs<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>n_cycle<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-94e700a2><button class="accordion" data-v-94e700a2><span class="badge secondary top badge-code" data-v-94e700a2>Full code</span></button><div class="panel" style="display:none;" data-v-94e700a2><div class="language-python extra-class" data-v-94e700a2><pre class="language-python" data-v-94e700a2><code data-v-94e700a2><span class="token comment" data-v-94e700a2># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>&quot;../fastai/old/&quot;</span>
PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>&quot;./dogscats/&quot;</span>

<span class="token comment" data-v-94e700a2># IMPORTS</span>
<span class="token keyword" data-v-94e700a2>import</span> sys
<span class="token keyword" data-v-94e700a2>import</span> numpy <span class="token keyword" data-v-94e700a2>as</span> np
<span class="token keyword" data-v-94e700a2>import</span> cv2

<span class="token comment" data-v-94e700a2># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>append<span class="token punctuation" data-v-94e700a2>(</span>FASTAI_PATH<span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2># go to parent dir</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>transforms <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>conv_learner <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>

<span class="token comment" data-v-94e700a2># ARCHITECTURE</span>
arch <span class="token operator" data-v-94e700a2>=</span> resnet34
sz <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>256</span>
bs <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>64</span>

<span class="token comment" data-v-94e700a2># MAIN CALCULATION</span>
data <span class="token operator" data-v-94e700a2>=</span> ImageClassifierData<span class="token punctuation" data-v-94e700a2>.</span>from_paths<span class="token punctuation" data-v-94e700a2>(</span>PATH<span class="token punctuation" data-v-94e700a2>,</span> bs<span class="token punctuation" data-v-94e700a2>,</span> tfms<span class="token operator" data-v-94e700a2>=</span>tfms_from_model<span class="token punctuation" data-v-94e700a2>(</span>arch<span class="token punctuation" data-v-94e700a2>,</span> sz<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
learn <span class="token operator" data-v-94e700a2>=</span> ConvLearner<span class="token punctuation" data-v-94e700a2>.</span>pretrained<span class="token punctuation" data-v-94e700a2>(</span>arch<span class="token punctuation" data-v-94e700a2>,</span> data<span class="token punctuation" data-v-94e700a2>,</span> precompute<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>True</span><span class="token punctuation" data-v-94e700a2>)</span>
learn<span class="token punctuation" data-v-94e700a2>.</span>fit<span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>0.01</span><span class="token punctuation" data-v-94e700a2>,</span> <span class="token number" data-v-94e700a2>2</span><span class="token punctuation" data-v-94e700a2>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiUAAABwCAYAAADBsQCGAAAX8ElEQVR4nO3dPYzbTH4G8IcvDpcqd60E7CYQ4DJuVC0FuBHiMkAs3RqwVCQvXLpbuFt5Cy3VLdy5NHxXiAtYkJwg5RuoeQFxKzW+0gCBrACpvUuVayYFv4fDIbWrD0r7/AADXlEihzMjzp8zQ40hhBCQBC8ZhiFvIiIiInowXYxhxIMSIQQDESIiItoJOe74KWsDERER0TYZhoH4gM1PAAMSIiIi2o94YGKo5pQQERER7dpPjEmIiIho34QQ0ZwSIiIion3i8A0RERGVAntKiIiIqBQYlBAREVEp/GbfCSiL//6fKf745z/hL3/7676TQkQ78vvf/g7//k//hn/+h+a+k0JEYE9JiAEJ0dPzl7/9FX/885/2nQwi8jEo8TEgIXqa+N0nKg8GJURERFQKWwtKVrdtGIah/De429pRYb820L5dbesARPTEONeKa8rCRju4pr22kdzqYBBe7wZwMj6X2OfCRlt+bzolsf1mHdffRzx9hgHjOmPPsfeF1+WHnluWu4FiP0XPOTu9j0ub/r3O9UPaK6/9MYrkO6Q2UjqX+PENow17UTQNfh1Y2GirPqcq75LZbk/J+RBLISCkf5dnWz0qEdFGONcGGlfyqyvYF13AXkKIJYbo4l0swHCuG+j1ZxBCYNbvoRE2TN7n6o6AEDPUO+/CRsP50kXduYSZmZIV7NcNzO2lfx31jluNN3oLF/PzGmpwMDgNjuMdy7pqaG7WLMzC6/JDzy3D3QCG2Uu/vrDRPu1iov90Og82lDbte+8GaFx5eSIcCz2zaODkwh21MLyPtXcfMkr0boBqp+4dQyrL1W0bje9R27m0ge5pwTSEdSBxthgEQchJB2OxxPC80AntBYdviIhSvAt547sFS76AL6YYj1pov6gAqKBzYWHyberf6TqYXgHWS68xMn8eonU1jTUoLdRO5P3ZuPk+xFvtzVoFna8C4zeV8O/mqxbw3Q3vsFe/joFXTVRg4jJx82ei2QcmP9z8037UuSU51wYMcw6r30q8vrptwzjtot638tODFezX/h3/xtKmf6/zSw/oN70A8ewthuc9TIv0KixczFFPl6/qrNw5EAYPybKsvBlDfO0gLOkXbbQwh1ugtySsAycdjMUYnQJpKZs9BiXBUIsddaNJXVi67q1k96TcTTVdv4uRiCim6QiIr2+lu04ACxcTufEZuXD9bfNU4BFvUCax/3v7cL50Ub+IGqGHWWH6DX6D/QiPOLfVbTs5XPFyBiHGePtMOkbtPZZC4PKlLiHBUMg74KPfuG4qbdr3ruB+B1rPkqU+dwtMCVi4mKR6KdQqtXqUdqww/TZB61WzUB1IDO0k2sVYHQiHb7weth6AnlneIZu47QYloy6q8pwSKbiYdMao3Su6IzXdW5C7J516ontr0nHRDD53XqCLkYgowYSp67mINz4nNST7AmIN50kN9fD1Cjofh5ibBgyjgbn9FmahXhIVB5878YbMhTvKuEtf2LiJ9QzketC5+Xf4seEK80x9vMqZqWl848GIgJDv9jeUNt17AaBei3qkas8zE5tMuTuX2jzNDfHZJcR9DTeGAcOowr2I94IlOV+6mJy30TyBN7QUG9qZPY8PYanqQAWdrzNYACznMKZO7H5OyVfpjqD/3q90Xncc/G60RBeatA13U/RgoRlk8NklhIjGY1v22/BzRSsUEdHWnXQw9q+F4zeVqJfkbrDGxEr/7vd8iE9BQ3Y3RS+8XsZ5N3CT/uwAGiQHA7+BTgUjB8D9MUm0ebN+Dw3VBF8EQ1gu3vvvbf6inhS7um2jcdXC8GOs3Rx18dmvI+aHWDCTWQcOy97nlCS6ycLIV92FFkiOxxER7VjY9Q5/WCEuNlyzcDHP2kfYS7KC/XHuTZC8H2KunVi5gv26ii6GWMZu8FbuXHG9dDAw/AmdWRMut3VuD2LiUixR+6h54mRjadO/Nxqu8dqiQqn/kLzpNn8eojUaY5o6D3+4Jrx5Dua13CTOeXXbRrUDDO9jAdrZpT/5Nv10kLoOHJ69ByWJyVdhJfN6OLImZiXH44iIdig1bIDoJkkxFICMyY/RXBIX7ijadz1zUqMfkDyfST3OqvkkXkAyt5frBSQbOreH8yb0CvEJuJCCk02lTftede96NJyzrofljxeQ1DFT9RidXYYjD0u75T8dtKE5RSWw96AkHJLBCvbHaMjGfGllbsNZExZiM6KznskmItq0kyba5z3c3K4QXJuiuR0mmv0Jul+8K5fzpYuJqks9MZekhlrwhI/mCQ7n2u8hkYOMxRRj+HMOAITDO/1Z5jyFrZ7bRsSDE//avrG06d9rvrQw6Xz2pwp8RncUmyqQSf6NLO/xZXUavKdtwmMgPW/E6yFJPyK+um0n5mVWanUvMEvVgcO13QX5Rl1UjW7q5Za9xPiN//8+cGMYXg/JeewLd3aJpd1G1TC8v+PbYOLyfoj2qQF/KyxHoHOygr3F0yEiCiasjk+rMDrwrk2xxt/8MINlNGBcAd5vgChmenzpon4h/Aa1gs5FHcapgS68a5lqbsj0CgDka6qFmQNMnjcxDl5aTDEeARgFafCdJ4d8Nn1uq9s2qj/er9czk6uCztdx9P8NpU1bRmeXmPUNNAzv91US5XE3gPGxpsjHCjpfl8BrP22A1GY5GBg3qPlDMZU3Y8x+RMeIl43zi/da168PAcsRuPQ/F9WBFob3l6gsBsk6kOA9Et4wDcxjbW9ZGUIIsZ9De12R41fL9aP5LfiX/3i17yQQ0Z78179+23cS9mNho33q4r3Q/XAbRVawr6dofnjsI9z75LW97kU5n8bZ//ANERHRIVhM4T4r9nsi9DAMSoiInrQeGiVeC6VUTjq4LEHP/oMtbLSNKrqj/Lfuyx6Hb8qFwzdET9eTHb4hKhn2lPh+/9vf7TsJRLQH/O4Tlcd2n745IOf/+Ad8ufuCv/7f/+47KUS0I7/7u7/H+dkf9p0MIvJx+IaIiIhKgcM3REREVAoMSoiIiKgUGJQQERFRKTAoISIiolJgUEJERESlwKCEiIiISoFBCREREZUCgxIiIiIqBQYlREREVAoMSoiIiKgUGJQQERFRKTAoISIiolJgUEJERESlwKCEiIiISoFBCREREZUCgxIiIiIqBQYlREREVAoMSoiIiKgUGJQQERFRKTAoISIiolI4qqBkdduGce3sOxlHZXXbhmEY3j/mrWdhox3kiTHAurniXBthnrZvV1tJIhHRITqqoOSo3Q1gvLax6yas8mYMIQSWdmvHRy6xkw7GQkDcD/GQXDE/CAghMOtvPGVERAeNQQkRERGVwnaCkrtB1OVvtGEvok2r2zbat6tEF/bgLv5hBwMj2pbuHVjBfh3brug+z973AQqGCsweMOqiqjhv59obBogPtYTnfTeAce0ktm10yCAxlKEY4knUBfnY+WW5DavbdqpepV6T0r3LehSvv/L3Jz/P8r4/W5SbZzlpy6wrDgZSPgR1PvzcaxureF1M1EMpzxR5khimDNPufU5VZznsRrQlYtPuh6KFlhje+387lgAsMfP/XNotAUC07KVi+1IMz2Pb/L/Rn2X8nSTve2m3BM6HYql894FxrMxzmfUhgChfEuftWIltcnkUtbRbinyfCQsQlpP8Oyq/mbDidaHQPndArqPCy8NEuuPpysqz+6FoPSAv1cf0yHXWq9PS90eTZ6p97kZensl1Q+JYApl1JV2PEucZ1PHgeFL5Lm0r9ln5GpPO47jUNURRd4hoczYelCztlnTh8S4CQcOVvqjGLjiqi3/8wp/ToKb2/chGo1TygpLUhTOWZ4nP6QOFLKrGUBn0JY6nb4h0jcG2pYIQbToy8mzjQYkc5Amh/P5ojpmqC3uTzDP9DUI6UNDtSwhVUNJKBR7JfIwdLVGXVXmecx77CKSJnoiND9+4PyaYdKqxrtAquqO8T03gBl2z5zXUMt61cufa7U9Z61UTleCPkw7G4hLmLg78vBYdN8XE5f0QCOtDcqih8maMWb+Hxh6eRDFfWph8m3rd+HdT9PrNRH4lh1Aa6O0sZS3UTrK35uWZ+WGJIaJhvv0NOyXzzP0x0dQVF+4IqNeya1Ku8zaaYb5V0PkqcHnm/ykNMVY7k+hzCxdzbZ6baPYnGP+6ArDC9Bsw/Hkn3yyiJ2krc0pa9hLC64UJ/4UXCPUnoovCyIUb37RwEVxCKrX6NpJLj/HdTc7NcOfJ7cGTKkJgac/RkAKT4EkUIWaod6q7C0zOmrBGY0wXgPNLD9bLqKFZ3bbRuLIwE1HarN2kCokAHUDQYMfp88xrkIX/dNDc3E1gkpdntWe655RqqJ1vK2UOBqddIHZNSjxJdlJD3lUlDGAXU4wRD36IaNM2HpSYLy1MOu+kyXnZnOsGesFdzlkTFnq4CS+yK9gfe2jZb7272LMmrFEX757iJLOTGlp+I1oWlRdttEZdfA4bPQefOxNYFx3lHbE+qNxmw6Ti3QG7CwfT70O8lYPmWI+cc72rnhITzT7Q+xhNxFzd3qB3rkgfgNw8K9DgbpQmzyov2mhdNTICpAqar1rombqJzlGw5gVA6yUt7IVZ2HgX7ynx60H3QjMh+Owthuji3cUY9Yy6TUQbspVBoXDiGZIT0EQ0GTX8lxpn9sZ4w+0Zkysz932sc0qEnHfReWknNz5qTok/sRjSv1QeR9sS6UjVg/S4f+Z+d8FPezrvknWsZQ/T8wrkPClcz+T6m863cOJyar95eZbe9+4mverzTAiRqivyd1/O18y61J+l55Ro5tHI35uhYl5IMs/Tc0z2Of+J6CkxhBBicyFOvtVtG9Uf7yE+cFyWiA4Dr1tEu/GbfSeAiKjUFjbedYDhPQMSom3jL7o+YcmnJeR/u/khs+Mi/TiY/I9rBx2W4Kmd0y7qzhgdTnAl2rqdD98QERERqbCnhIiIiEqBQQkRERGVAoMSIiIiKgUGJURERFQKRxeUJJcgP54nSB51Xokl4dsZv7YbLO+u2p58qiTxq5zSuiJZP2kePOkT3y4//bPLdVrkc1r35+215aHNkyCfM8pD+qz81E5unsmff635pdJNK1TPsuSUR04905VHcts+6hoRFbbf327bMGkV4fKsmPpIjzmv1DLu6l+m9H4N18r8FU71KqrSCqtZy7o7lsC5JSzNyq27XRJeWpVWe44K2vJYiuF57DxSK9jq9yXuh6L1wLJN/1pv3uq7G1SwnqnJ6ZRX7s2pZznfj/TK5URUVkcUlCguwDtt6Lblcec166t/ijzRAIf7Uy8Rr10CXmpA0z95HxxPv5z8ej9//0hyICBU+ZRl3fJQ5HecvBTCOkGJnGeKZRW0SxBsUKF6lkVRHvElI/T1LL88GJQQHY4jGr5x4Y5aaL8IlsvyVgedpFZdPTSPOa8V3O+IrYC7gv3aWyht7sYWPbzoAvYnxY9DOZhetVBzB9lDFdJy9LVnLUx+ROs8O9cN9PqznFWiAdxNo4UZt2zlzoF+E2GuBAu8SSseq222nq1+HWMSS8ta5Dw7aaJ93kMjGLK5G6BxFU/rthSpZzlii/kB/uKN8fLIrGfH+r0nepqOKCgJBGP2DcARmPXXuDCW2uPOy5uLUMX41RJLOxY43H1GF0N8eqNouBYu5pig+6MZLvs+60eNnrfy6000d0BegXVh4+bKwixzvZDY/Aqzl7m68Nb4cyCq39pY3g/RGrlw8z/lK1Ye3irY8iq/0fyJagcY/izlz6iLaub8IV2eVdD5KrB8NfY+bwIzsdtfIs2sZzr+6t/x1aYHZrTGcG49A5BXHpNOlb+sS3QI9t1VsznRKqVRl3HekMEheMx5RavKyqvQen/LQyb5wwHya4kVWM+HYhZ2lctpzEvz7uY/hGmODwnkrDQbKV4exeZV6Ic59PuQ88wv7/iwxzpzZR4sr54VkFhR2hIzx0oMB2XXs3W/H8k8IqJyOaKgRNWo7XCewtY87rzSY/2xC3aiIZD+9Wfq46gCFel4liPSy9RrlqwPU6ZYUn4rcuYw6BUrD68RLV5GmY13Tn4n0p11XjuY7K2tZw+QNw8kmuu0/vdjZ/WMiNZ2REFJuiHY1QV52wqdVxAEyK/7gUfYOCgaroh6omv8Aq6bEKqfLFpkouuuerX8u+swrepjz/ryHbgnrzzWCUj0k2Tz7uqldKee9Nlhr0Chehb0qOjzJu97K9eztb736z5pRUQ7dVRBiRDpbt5DD0gCueeVFZQIke4azzyK6g4z6poH5AYu6jqXu+4VZ6Aczon3oOy2oUimXXXsrKBECF15JPebfo+8XdXDkpWn+Xkmf36nPQK59SwrKNHVMSGK1LPs8pDz7NB7TomOG1cJJiIiolI4wqdviIiI6BAxKCEiIqJSYFBCREREpcCghIiIiEqBQQkRERGVAoMSIiIiKgUGJURERFQKRxmUeIuCtaMFvI7A6radvVJvnrv4Kr9Z+RIsaKba7i8gF6w+qzuGtNiZVxb+v9Tno4XpHnRej5I8dvt2vUUbteWxsNGO7Xtwl7GTjDzzj5BRHro8iy3Wpy3rLSlUz7LklEdOnurKI7ktp0yIaK+OLCjxLmzTZ0O09p2UTboboNqpY6ZYqTfXwkbbnGN47312aQPd03Tjv7p9h+5zC5bi2IYxRc3W5aiDgTmH1ZfeczdAAzN/heElhuiiGjbA3vL2cERyBeKdrODqHXtuL71j3w+BTrV4Q6UtjxXsizHafn4Lx0LPzAj0VHkWpFBZHnl55q0SHGwTTl1Z1ltRsJ6pSeUhZqgnysPB4LSLenDe90PM43la4PvRCvft/bs8AxGV0U5/P3bLZn3/J6S164kcGsWCY2ucX3o9GsU6L+H+FKsG+z/ZrVtPJDhG3kJnyX1kLGK3pwX59Ov2xK1bHpp1dbLyTFce6+RZzmJ+m1SonmXJWSBRVfeiRQzzyyNvcT8iKo+j6ikxP4zROdl3KjbNhTtqof2i4v/t3TVOMIGb2z2+gvsdsF6a4d/26wZ6AObuKnrtogvYnxR5Z+LyawcV+eW4uwEaVxZmH0zduxRMNPuT6G56YeNdZxJL6/as3DnQbyLMlds2GlcAvrsFep8eUx4+bZ7py2OdPFv9OsYkdp7bU6Se5TivoRb7s1KrJ8vjeS1RD2vPWpj8cLGR8iCi0jiqoOS4BfMFvO77WX+NCz6CuR1VjF8tsbSDCzqAu8/oYohPb7ShR3aaPvZgOZf5DV/QgF5EQY75QUA4QMMwYJx6Qx477Vb350BUv7WxvB+iNXLhFv5wsfJwrhvonQ/x9iz2OV2e5ZRHfp5FczOqHWD48/ZDksTRs+qZzlkT1qiLz/HhGrMXbq68aKN1dRMN1/h1KUlfHpNONZpTspMhQiJ6CAYlB2GC7mkV7kUwHu7dmdZrxQKJnmng5pk3pj5+U4H7Y4LWsxqCeQ3Djzm9IRm8eQ+zAoGEd/cKe5l4r3NtwPhYwzKc/7D+hNMHu2pEx/7aQWXhYiLdrWcrVh5eD4yFWay3SZ9n+eWRn2cmLsO5E+/hnu5uUmd2Pctj4tKx0DODiahTNB0r6h056eCTDXRP/e0XwHu7Fdu3vjwqb8ax+SRLDL83GJgQldX+Ro626NjnlCjmFmRJj/V7+7McIS01D+2S9+lxfXlJ+Kzl4f1l5zPnTcReU8wt2IqcOQx6xcpjabekfIg+m5ln/5lTHg/Is2juxXZp69kD5M0DmfWDfa///djZ3CUiWhuDkgMgN3DKSaf3Q9EC0q/7gUfYOGgbseyLuW6ia+I9ismOygbAT2+80Zr1FenfCjldmsmoitfzykMdkKjpG0ipPNbNs11+DwrVsyAo06cpr67JAVCh70dAkYdEVB5HFZR4FyfdXfvhSpyb6oKbFZQIIfWI6Hoi5KAk484+44IvN7Dq8pAbrvz9bocfmMhpir8jIygRQlceyf2um2fpNKp6RrL2Kx97x3U/t55lBSVSPUvlR/K8VD0o2eUh1+HjuB4QHStDCCEeNf5DREREtAGc6EpERESlwKCEiIiISoFBCREREZUCgxIiIiIqBQYlREREVAoMSoiIiKgUGJQQERFRKTAoISIiolJgUEJERESl8BN/0JWIiIj2TQjBnhIiIiIqh58Mw9h3GoiIiIi8nhIO4RAREdG+CCFgGAa4SjARERGVQmJOCeMTIiIi2hU57vhN/A/DMMI3cK4JERERbUNWrPH/XIe+RckcS+IAAAAASUVORK5CYII=" alt="1544620798523"></p><h4 id="predict-validation-dataset"><a href="#predict-validation-dataset" aria-hidden="true" class="header-anchor">#</a> Predict validation dataset:</h4><div class="language-python extra-class"><pre class="language-python"><code>log_preds <span class="token operator">=</span> learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cat_preds <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>log_preds<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#predict for first class (cats)</span>
dog_preds <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>log_preds<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#predict for second class (dogs)</span>
preds <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>log_preds<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#prediction for binary class</span>

<span class="token comment">#how close is to the dog</span>
plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span>dog_preds<span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><div class="step" data-v-94e700a2><button class="accordion" data-v-94e700a2><span class="badge secondary top badge-code" data-v-94e700a2>Full code</span></button><div class="panel" style="display:none;" data-v-94e700a2><div class="language-python extra-class" data-v-94e700a2><pre class="language-python" data-v-94e700a2><code data-v-94e700a2><span class="token comment" data-v-94e700a2># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>&quot;../fastai/old/&quot;</span>
PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'../data/dogscats/'</span>

<span class="token comment" data-v-94e700a2># IMPORTS</span>
<span class="token keyword" data-v-94e700a2>import</span> sys
<span class="token keyword" data-v-94e700a2>import</span> numpy <span class="token keyword" data-v-94e700a2>as</span> np
<span class="token keyword" data-v-94e700a2>import</span> cv2

<span class="token comment" data-v-94e700a2># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>append<span class="token punctuation" data-v-94e700a2>(</span>FASTAI_PATH<span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2># go to parent dir</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>transforms <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>conv_learner <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>

<span class="token comment" data-v-94e700a2># ARCHITECTURE</span>
arch <span class="token operator" data-v-94e700a2>=</span> resnet34
sz <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>256</span>
bs <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>64</span>

<span class="token comment" data-v-94e700a2># MAIN CALCULATION</span>
data <span class="token operator" data-v-94e700a2>=</span> ImageClassifierData<span class="token punctuation" data-v-94e700a2>.</span>from_paths<span class="token punctuation" data-v-94e700a2>(</span>PATH<span class="token punctuation" data-v-94e700a2>,</span> bs<span class="token punctuation" data-v-94e700a2>,</span> tfms<span class="token operator" data-v-94e700a2>=</span>tfms_from_model<span class="token punctuation" data-v-94e700a2>(</span>arch<span class="token punctuation" data-v-94e700a2>,</span> sz<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>
learn <span class="token operator" data-v-94e700a2>=</span> ConvLearner<span class="token punctuation" data-v-94e700a2>.</span>pretrained<span class="token punctuation" data-v-94e700a2>(</span>arch<span class="token punctuation" data-v-94e700a2>,</span> data<span class="token punctuation" data-v-94e700a2>,</span> precompute<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>True</span><span class="token punctuation" data-v-94e700a2>)</span>
learn<span class="token punctuation" data-v-94e700a2>.</span>fit<span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>0.01</span><span class="token punctuation" data-v-94e700a2>,</span> <span class="token number" data-v-94e700a2>2</span><span class="token punctuation" data-v-94e700a2>)</span>

<span class="token comment" data-v-94e700a2># HELP FUNCTIONS</span>
<span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>load_img_id</span><span class="token punctuation" data-v-94e700a2>(</span>ds<span class="token punctuation" data-v-94e700a2>,</span> idx<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span> <span class="token keyword" data-v-94e700a2>return</span> np<span class="token punctuation" data-v-94e700a2>.</span>array<span class="token punctuation" data-v-94e700a2>(</span>PIL<span class="token punctuation" data-v-94e700a2>.</span>Image<span class="token punctuation" data-v-94e700a2>.</span><span class="token builtin" data-v-94e700a2>open</span><span class="token punctuation" data-v-94e700a2>(</span>PATH<span class="token operator" data-v-94e700a2>+</span>ds<span class="token punctuation" data-v-94e700a2>.</span>fnames<span class="token punctuation" data-v-94e700a2>[</span>idx<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span>

<span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>plots</span><span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>12</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>6</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> rows<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>,</span> titles<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    f <span class="token operator" data-v-94e700a2>=</span> plt<span class="token punctuation" data-v-94e700a2>.</span>figure<span class="token punctuation" data-v-94e700a2>(</span>figsize<span class="token operator" data-v-94e700a2>=</span>figsize<span class="token punctuation" data-v-94e700a2>)</span>
    <span class="token keyword" data-v-94e700a2>for</span> i <span class="token keyword" data-v-94e700a2>in</span> <span class="token builtin" data-v-94e700a2>range</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
        sp <span class="token operator" data-v-94e700a2>=</span> f<span class="token punctuation" data-v-94e700a2>.</span>add_subplot<span class="token punctuation" data-v-94e700a2>(</span>rows<span class="token punctuation" data-v-94e700a2>,</span> <span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>)</span><span class="token operator" data-v-94e700a2>//</span>rows<span class="token punctuation" data-v-94e700a2>,</span> i<span class="token operator" data-v-94e700a2>+</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>)</span>
        sp<span class="token punctuation" data-v-94e700a2>.</span>axis<span class="token punctuation" data-v-94e700a2>(</span><span class="token string" data-v-94e700a2>'Off'</span><span class="token punctuation" data-v-94e700a2>)</span>
        <span class="token keyword" data-v-94e700a2>if</span> titles <span class="token keyword" data-v-94e700a2>is</span> <span class="token operator" data-v-94e700a2>not</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>:</span> sp<span class="token punctuation" data-v-94e700a2>.</span>set_title<span class="token punctuation" data-v-94e700a2>(</span>titles<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>,</span> fontsize<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>16</span><span class="token punctuation" data-v-94e700a2>)</span>
        plt<span class="token punctuation" data-v-94e700a2>.</span>imshow<span class="token punctuation" data-v-94e700a2>(</span>ims<span class="token punctuation" data-v-94e700a2>[</span>i<span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>

<span class="token keyword" data-v-94e700a2>def</span> <span class="token function" data-v-94e700a2>plot_with_preds</span><span class="token punctuation" data-v-94e700a2>(</span>dataset<span class="token punctuation" data-v-94e700a2>,</span> preds<span class="token punctuation" data-v-94e700a2>,</span> idxs<span class="token punctuation" data-v-94e700a2>,</span> y_truth <span class="token operator" data-v-94e700a2>=</span> <span class="token boolean" data-v-94e700a2>None</span><span class="token punctuation" data-v-94e700a2>,</span> rows <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>:</span>
    imgs <span class="token operator" data-v-94e700a2>=</span> <span class="token punctuation" data-v-94e700a2>[</span>load_img_id<span class="token punctuation" data-v-94e700a2>(</span>dataset<span class="token punctuation" data-v-94e700a2>,</span>x<span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>for</span> x <span class="token keyword" data-v-94e700a2>in</span> idxs<span class="token punctuation" data-v-94e700a2>]</span>
    title_probs <span class="token operator" data-v-94e700a2>=</span> <span class="token punctuation" data-v-94e700a2>[</span>f<span class="token string" data-v-94e700a2>'{x}:prob={preds[x]:.4f}'</span> <span class="token operator" data-v-94e700a2>+</span> <span class="token punctuation" data-v-94e700a2>(</span><span class="token string" data-v-94e700a2>''</span> <span class="token keyword" data-v-94e700a2>if</span> y_truth <span class="token keyword" data-v-94e700a2>is</span> <span class="token boolean" data-v-94e700a2>None</span> <span class="token keyword" data-v-94e700a2>else</span> f<span class="token string" data-v-94e700a2>', y={y_truth[x]}'</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>for</span> x <span class="token keyword" data-v-94e700a2>in</span> idxs<span class="token punctuation" data-v-94e700a2>]</span>
    <span class="token keyword" data-v-94e700a2>return</span> plots<span class="token punctuation" data-v-94e700a2>(</span>imgs<span class="token punctuation" data-v-94e700a2>,</span> rows<span class="token operator" data-v-94e700a2>=</span>rows<span class="token punctuation" data-v-94e700a2>,</span> titles<span class="token operator" data-v-94e700a2>=</span>title_probs<span class="token punctuation" data-v-94e700a2>,</span> figsize<span class="token operator" data-v-94e700a2>=</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>16</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>8</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token keyword" data-v-94e700a2>if</span> <span class="token builtin" data-v-94e700a2>len</span><span class="token punctuation" data-v-94e700a2>(</span>imgs<span class="token punctuation" data-v-94e700a2>)</span><span class="token operator" data-v-94e700a2>&gt;</span><span class="token number" data-v-94e700a2>0</span> <span class="token keyword" data-v-94e700a2>else</span> <span class="token keyword" data-v-94e700a2>print</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token string" data-v-94e700a2>'Not Found.'</span><span class="token punctuation" data-v-94e700a2>)</span>

log_preds <span class="token operator" data-v-94e700a2>=</span> learn<span class="token punctuation" data-v-94e700a2>.</span>predict<span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>;</span>
cat_preds <span class="token operator" data-v-94e700a2>=</span> np<span class="token punctuation" data-v-94e700a2>.</span>exp<span class="token punctuation" data-v-94e700a2>(</span>log_preds<span class="token punctuation" data-v-94e700a2>[</span><span class="token punctuation" data-v-94e700a2>:</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>0</span><span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>  <span class="token comment" data-v-94e700a2>#predict for first class (cats)</span>
dog_preds <span class="token operator" data-v-94e700a2>=</span> np<span class="token punctuation" data-v-94e700a2>.</span>exp<span class="token punctuation" data-v-94e700a2>(</span>log_preds<span class="token punctuation" data-v-94e700a2>[</span><span class="token punctuation" data-v-94e700a2>:</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>]</span><span class="token punctuation" data-v-94e700a2>)</span>  <span class="token comment" data-v-94e700a2>#predict for second class (dogs)</span>
preds <span class="token operator" data-v-94e700a2>=</span> np<span class="token punctuation" data-v-94e700a2>.</span>argmax<span class="token punctuation" data-v-94e700a2>(</span>log_preds<span class="token punctuation" data-v-94e700a2>,</span> axis<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2>#prediction for binary class</span>

plot_with_preds<span class="token punctuation" data-v-94e700a2>(</span>data<span class="token punctuation" data-v-94e700a2>.</span>val_ds<span class="token punctuation" data-v-94e700a2>,</span>dog_preds<span class="token punctuation" data-v-94e700a2>,</span> <span class="token builtin" data-v-94e700a2>range</span><span class="token punctuation" data-v-94e700a2>(</span><span class="token number" data-v-94e700a2>100</span><span class="token punctuation" data-v-94e700a2>,</span><span class="token number" data-v-94e700a2>104</span><span class="token punctuation" data-v-94e700a2>)</span><span class="token punctuation" data-v-94e700a2>,</span> data<span class="token punctuation" data-v-94e700a2>.</span>val_y<span class="token punctuation" data-v-94e700a2>,</span>rows <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>1</span><span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2>#how close is to the dog</span>
</code></pre></div></div></div><p><img src="/assets/img/1544379918611.40222976.png" alt="1544379918611"></p><h4 id="most-correct-incorrect"><a href="#most-correct-incorrect" aria-hidden="true" class="header-anchor">#</a> Most correct/incorrect</h4><p>Returns most correct or incorrect datasets</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><strong>probs</strong></td><td>array of predictions for datasets</td></tr><tr><td><strong>y_truth</strong></td><td>True value for dataset</td></tr><tr><td><strong>y</strong></td><td>class of dataset (<code>0</code> - cat, <code>1</code> - dog)</td></tr><tr><td><strong>is_correct</strong></td><td><code>True</code> - most correct, <code>False</code> - most incorrect</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">most_by_mask</span><span class="token punctuation">(</span>probs<span class="token punctuation">,</span> mask<span class="token punctuation">,</span> mult<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idxs <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> idxs<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>mult <span class="token operator">*</span> probs<span class="token punctuation">[</span>idxs<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">most_by_correct</span><span class="token punctuation">(</span>probs<span class="token punctuation">,</span> y_truth<span class="token punctuation">,</span> y<span class="token punctuation">,</span> is_correct<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    mult <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span>is_correct <span class="token keyword">else</span> <span class="token number">1</span>
    <span class="token keyword">return</span> most_by_mask<span class="token punctuation">(</span>probs<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>preds <span class="token operator">==</span> y_truth<span class="token punctuation">)</span><span class="token operator">==</span>is_correct<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>y_truth <span class="token operator">==</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> mult<span class="token punctuation">)</span>
</code></pre></div><h4 id="most-correct-cats"><a href="#most-correct-cats" aria-hidden="true" class="header-anchor">#</a> Most correct cats</h4><div class="language-python extra-class"><pre class="language-python"><code>plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span> dog_preds<span class="token punctuation">,</span> 
                most_by_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><p><img src="/assets/img/1544380350810.0b06d149.png" alt="1544380350810"></p><h4 id="most-correct-dogs"><a href="#most-correct-dogs" aria-hidden="true" class="header-anchor">#</a> Most correct dogs</h4><div class="language-python extra-class"><pre class="language-python"><code>plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span> dog_preds<span class="token punctuation">,</span> 
                most_by_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><p><img src="/assets/img/1544380396392.2068e557.png" alt="1544380396392"></p><h4 id="most-incorrect-cats"><a href="#most-incorrect-cats" aria-hidden="true" class="header-anchor">#</a> Most incorrect cats</h4><div class="language-python extra-class"><pre class="language-python"><code>plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span> dog_preds<span class="token punctuation">,</span> 
                most_by_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><p><img src="/assets/img/1544380456620.55c06fed.png" alt="1544380456620"></p><h4 id="most-incorrect-dogs"><a href="#most-incorrect-dogs" aria-hidden="true" class="header-anchor">#</a> Most incorrect dogs</h4><div class="language-python extra-class"><pre class="language-python"><code>plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span> dog_preds<span class="token punctuation">,</span> 
                most_by_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><p><img src="/assets/img/1544380476885.8d894ea3.png" alt="1544380476885"></p><h4 id="improve-model"><a href="#improve-model" aria-hidden="true" class="header-anchor">#</a> Improve model</h4><ul><li>adding data augmentation</li><li>find better learn_fs</li></ul><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> tfms_from_model<span class="token punctuation">(</span>resnet34<span class="token punctuation">,</span> sz<span class="token punctuation">,</span> aug_tfms<span class="token operator">=</span>transforms_side_on<span class="token punctuation">,</span> max_zoom<span class="token operator">=</span><span class="token number">1.1</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>sched<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-94e700a2><button class="accordion" data-v-94e700a2><span class="badge secondary top badge-code" data-v-94e700a2>Full code</span></button><div class="panel" style="display:none;" data-v-94e700a2><div class="language-python extra-class" data-v-94e700a2><pre class="language-python" data-v-94e700a2><code data-v-94e700a2><span class="token comment" data-v-94e700a2># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>&quot;../fastai/old/&quot;</span>
PATH <span class="token operator" data-v-94e700a2>=</span> <span class="token string" data-v-94e700a2>'../data/dogscats/'</span>

<span class="token comment" data-v-94e700a2># IMPORTS</span>
<span class="token keyword" data-v-94e700a2>import</span> sys
<span class="token keyword" data-v-94e700a2>import</span> numpy <span class="token keyword" data-v-94e700a2>as</span> np
<span class="token keyword" data-v-94e700a2>import</span> cv2

<span class="token comment" data-v-94e700a2># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-94e700a2>.</span>path<span class="token punctuation" data-v-94e700a2>.</span>append<span class="token punctuation" data-v-94e700a2>(</span>FASTAI_PATH<span class="token punctuation" data-v-94e700a2>)</span> <span class="token comment" data-v-94e700a2># go to parent dir</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>transforms <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>
<span class="token keyword" data-v-94e700a2>from</span> fastai<span class="token punctuation" data-v-94e700a2>.</span>conv_learner <span class="token keyword" data-v-94e700a2>import</span> <span class="token operator" data-v-94e700a2>*</span>

<span class="token comment" data-v-94e700a2># ARCHITECTURE</span>
arch <span class="token operator" data-v-94e700a2>=</span> resnet34
sz <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>256</span>
bs <span class="token operator" data-v-94e700a2>=</span> <span class="token number" data-v-94e700a2>64</span>



<span class="token comment" data-v-94e700a2># MAIN CALCULATION</span>
tfms <span class="token operator" data-v-94e700a2>=</span> tfms_from_model<span class="token punctuation" data-v-94e700a2>(</span>resnet34<span class="token punctuation" data-v-94e700a2>,</span> sz<span class="token punctuation" data-v-94e700a2>,</span> aug_tfms<span class="token operator" data-v-94e700a2>=</span>transforms_side_on<span class="token punctuation" data-v-94e700a2>,</span> max_zoom<span class="token operator" data-v-94e700a2>=</span><span class="token number" data-v-94e700a2>1.1</span><span class="token punctuation" data-v-94e700a2>)</span>
data <span class="token operator" data-v-94e700a2>=</span> ImageClassifierData<span class="token punctuation" data-v-94e700a2>.</span>from_paths<span class="token punctuation" data-v-94e700a2>(</span>PATH<span class="token punctuation" data-v-94e700a2>,</span> bs<span class="token punctuation" data-v-94e700a2>,</span> tfms<span class="token operator" data-v-94e700a2>=</span>tfms<span class="token punctuation" data-v-94e700a2>)</span>
learn <span class="token operator" data-v-94e700a2>=</span> ConvLearner<span class="token punctuation" data-v-94e700a2>.</span>pretrained<span class="token punctuation" data-v-94e700a2>(</span>arch<span class="token punctuation" data-v-94e700a2>,</span> data<span class="token punctuation" data-v-94e700a2>,</span> precompute<span class="token operator" data-v-94e700a2>=</span><span class="token boolean" data-v-94e700a2>True</span><span class="token punctuation" data-v-94e700a2>)</span>
learn<span class="token punctuation" data-v-94e700a2>.</span>lr_find<span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>)</span>
learn<span class="token punctuation" data-v-94e700a2>.</span>sched<span class="token punctuation" data-v-94e700a2>.</span>plot<span class="token punctuation" data-v-94e700a2>(</span><span class="token punctuation" data-v-94e700a2>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544620630913.3d40f085.png" alt="1544620630913"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1544620891292"></p><p>Our model val improve from <code>0.024483</code> to <code>0.022073</code></p></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/36.f1395db5.js" defer></script><script src="/assets/js/56.32200c53.js" defer></script><script src="/assets/js/53.93b8add4.js" defer></script><script src="/assets/js/50.010d3262.js" defer></script><script src="/assets/js/59.98832f60.js" defer></script><script src="/assets/js/52.b9c71886.js" defer></script><script src="/assets/js/55.d3513c09.js" defer></script><script src="/assets/js/app.5520a7e5.js" defer></script>
  </body>
</html>
