<!DOCTYPE html>
<html lang="en-EN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deep Learning | One Page Knowledge</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.a202ab74.css" as="style"><link rel="preload" href="/assets/js/app.59fe83e9.js" as="script"><link rel="preload" href="/assets/js/40.aee014e6.js" as="script"><link rel="preload" href="/assets/js/73.087e681b.js" as="script"><link rel="preload" href="/assets/js/61.c7f5657d.js" as="script"><link rel="preload" href="/assets/js/65.4dceeb43.js" as="script"><link rel="preload" href="/assets/js/63.e1ab2c6b.js" as="script"><link rel="preload" href="/assets/js/72.1fe6a8a2.js" as="script"><link rel="preload" href="/assets/js/71.6ada6e59.js" as="script"><link rel="preload" href="/assets/js/70.861e664c.js" as="script"><link rel="preload" href="/assets/js/69.56cedfc5.js" as="script"><link rel="preload" href="/assets/js/68.8ff4e941.js" as="script"><link rel="preload" href="/assets/js/67.fc848148.js" as="script"><link rel="preload" href="/assets/js/66.ddf0dd8b.js" as="script"><link rel="preload" href="/assets/js/57.06646fcd.js" as="script"><link rel="preload" href="/assets/js/59.f921245b.js" as="script"><link rel="preload" href="/assets/js/76.77a97c63.js" as="script"><link rel="prefetch" href="/assets/js/1.5343983f.js"><link rel="prefetch" href="/assets/js/2.3ed7d082.js"><link rel="prefetch" href="/assets/js/3.1a3188ff.js"><link rel="prefetch" href="/assets/js/4.4ef5e6ab.js"><link rel="prefetch" href="/assets/js/5.e969f405.js"><link rel="prefetch" href="/assets/js/6.c6ffaaba.js"><link rel="prefetch" href="/assets/js/7.3cb60fc7.js"><link rel="prefetch" href="/assets/js/8.980671a4.js"><link rel="prefetch" href="/assets/js/9.c9a0e71d.js"><link rel="prefetch" href="/assets/js/10.3961734b.js"><link rel="prefetch" href="/assets/js/11.df7fb2ee.js"><link rel="prefetch" href="/assets/js/12.48df953f.js"><link rel="prefetch" href="/assets/js/13.7536fc62.js"><link rel="prefetch" href="/assets/js/14.b5d390a8.js"><link rel="prefetch" href="/assets/js/15.a9b03276.js"><link rel="prefetch" href="/assets/js/16.ebd5e4b3.js"><link rel="prefetch" href="/assets/js/17.ae2bdaba.js"><link rel="prefetch" href="/assets/js/18.468c115e.js"><link rel="prefetch" href="/assets/js/19.51f81cb1.js"><link rel="prefetch" href="/assets/js/20.7b641ac5.js"><link rel="prefetch" href="/assets/js/21.3e66c247.js"><link rel="prefetch" href="/assets/js/22.f6f65168.js"><link rel="prefetch" href="/assets/js/23.700c5ef7.js"><link rel="prefetch" href="/assets/js/24.78e51b75.js"><link rel="prefetch" href="/assets/js/25.8ee3d0fe.js"><link rel="prefetch" href="/assets/js/26.be8b4685.js"><link rel="prefetch" href="/assets/js/27.35b55268.js"><link rel="prefetch" href="/assets/js/28.764ab87c.js"><link rel="prefetch" href="/assets/js/29.127d4fff.js"><link rel="prefetch" href="/assets/js/30.e06dfaec.js"><link rel="prefetch" href="/assets/js/31.0146a132.js"><link rel="prefetch" href="/assets/js/32.bfa2a8d9.js"><link rel="prefetch" href="/assets/js/33.6c3d82c6.js"><link rel="prefetch" href="/assets/js/34.c1619b57.js"><link rel="prefetch" href="/assets/js/35.b5ebb943.js"><link rel="prefetch" href="/assets/js/36.223441c7.js"><link rel="prefetch" href="/assets/js/37.1fbbb7e8.js"><link rel="prefetch" href="/assets/js/38.737104d3.js"><link rel="prefetch" href="/assets/js/39.9c636a81.js"><link rel="prefetch" href="/assets/js/41.8d4468f2.js"><link rel="prefetch" href="/assets/js/42.eae53ff8.js"><link rel="prefetch" href="/assets/js/43.4b92d5f3.js"><link rel="prefetch" href="/assets/js/44.0fe1e70f.js"><link rel="prefetch" href="/assets/js/45.a816ff01.js"><link rel="prefetch" href="/assets/js/46.e9e8ee31.js"><link rel="prefetch" href="/assets/js/47.317b6106.js"><link rel="prefetch" href="/assets/js/48.1db4080f.js"><link rel="prefetch" href="/assets/js/49.74f914ff.js"><link rel="prefetch" href="/assets/js/50.ea04d82d.js"><link rel="prefetch" href="/assets/js/51.6e12eacc.js"><link rel="prefetch" href="/assets/js/52.62bd4baa.js"><link rel="prefetch" href="/assets/js/53.aec5efbd.js"><link rel="prefetch" href="/assets/js/54.62c0fc64.js"><link rel="prefetch" href="/assets/js/55.a5f1ac47.js"><link rel="prefetch" href="/assets/js/56.5c4aa20e.js"><link rel="prefetch" href="/assets/js/58.1b571047.js"><link rel="prefetch" href="/assets/js/60.92b01702.js"><link rel="prefetch" href="/assets/js/62.43aff8b6.js"><link rel="prefetch" href="/assets/js/64.3b772e1a.js"><link rel="prefetch" href="/assets/js/74.5d811365.js"><link rel="prefetch" href="/assets/js/75.f5bdf632.js"><link rel="prefetch" href="/assets/js/77.2dcfe674.js"><link rel="prefetch" href="/assets/js/78.76f10420.js"><link rel="prefetch" href="/assets/js/79.1d0dc9f0.js"><link rel="prefetch" href="/assets/js/80.6bc844b3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a202ab74.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      One Page Knowledge
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Deep Learning</span><!----></p><ul class="sidebar-group-items"><li><a href="/deepnn/#gpu-servers" class="sidebar-link">GPU Servers</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/deepnn/#artificial-neural-network" class="sidebar-link">Artificial Neural Network</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#single-layer-perceptron" class="sidebar-link">Single Layer Perceptron</a></li><li class="sidebar-sub-header"><a href="/deepnn/#modern-neural-network" class="sidebar-link">Modern Neural Network</a></li><li class="sidebar-sub-header"><a href="/deepnn/#forward-function" class="sidebar-link">Forward Function</a></li><li class="sidebar-sub-header"><a href="/deepnn/#gradient-descent" class="sidebar-link">Gradient Descent</a></li><li class="sidebar-sub-header"><a href="/deepnn/#backpropagation" class="sidebar-link">Backpropagation</a></li><li class="sidebar-sub-header"><a href="/deepnn/#do-i-have-to-implement-all-these-functions" class="sidebar-link">Do I have to implement all these functions?</a></li><li class="sidebar-sub-header"><a href="/deepnn/#example-of-sgd-for-linear-function" class="sidebar-link">Example of SGD for linear function</a></li></ul></li><li><a href="/deepnn/#data-source" class="sidebar-link">Data / Source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#resources" class="sidebar-link">Resources</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-google-drive" class="sidebar-link">Data Download / Google Drive</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-google-images" class="sidebar-link">Data Download / Google Images</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-wget" class="sidebar-link">Data Download / wget</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-kaggle" class="sidebar-link">Data Download / kaggle</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-linux-commands" class="sidebar-link">Data Download / linux commands</a></li></ul></li><li><a href="/deepnn/#architecture" class="sidebar-link">Architecture</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#glossary" class="sidebar-link">Glossary</a></li><li class="sidebar-sub-header"><a href="/deepnn/#activation-functions" class="sidebar-link">Activation Functions</a></li><li class="sidebar-sub-header"><a href="/deepnn/#loss-functions" class="sidebar-link">Loss functions</a></li><li class="sidebar-sub-header"><a href="/deepnn/#weight-decay-sgd-l2-regularization" class="sidebar-link">weight decay - SGD - L2 Regularization</a></li><li class="sidebar-sub-header"><a href="/deepnn/#momentum" class="sidebar-link">Momentum</a></li><li class="sidebar-sub-header"><a href="/deepnn/#rmsprop" class="sidebar-link">RMSProp</a></li><li class="sidebar-sub-header"><a href="/deepnn/#adam-optimizer" class="sidebar-link">Adam Optimizer</a></li><li class="sidebar-sub-header"><a href="/deepnn/#convolution-network" class="sidebar-link">Convolution Network</a></li><li class="sidebar-sub-header"><a href="/deepnn/#batch-normalization" class="sidebar-link">Batch Normalization</a></li><li class="sidebar-sub-header"><a href="/deepnn/#dropout" class="sidebar-link">Dropout</a></li></ul></li><li><a href="/deepnn/#pytorch" class="sidebar-link">PyTorch</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#functions" class="sidebar-link">Functions</a></li><li class="sidebar-sub-header"><a href="/deepnn/#how-to-train-a-model" class="sidebar-link">How to train a model?</a></li><li class="sidebar-sub-header"><a href="/deepnn/#dataset-dataloader" class="sidebar-link">DataSet / DataLoader</a></li><li class="sidebar-sub-header"><a href="/deepnn/#model" class="sidebar-link">Model</a></li><li class="sidebar-sub-header"><a href="/deepnn/#backward-propagation" class="sidebar-link">Backward propagation</a></li><li class="sidebar-sub-header"><a href="/deepnn/#learn" class="sidebar-link">Learn</a></li><li class="sidebar-sub-header"><a href="/deepnn/#adam-optimizer-2" class="sidebar-link">Adam optimizer</a></li><li class="sidebar-sub-header"><a href="/deepnn/#using-model-with-fastai" class="sidebar-link">Using model with fastai</a></li></ul></li><li><a href="/deepnn/#fast-ai" class="sidebar-link">fast.ai</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#installation-google-colab" class="sidebar-link">Installation / Google Colab</a></li><li class="sidebar-sub-header"><a href="/deepnn/#installion-aws" class="sidebar-link">installion / AWS</a></li><li class="sidebar-sub-header"><a href="/deepnn/#installation-google-cloud" class="sidebar-link">installation / Google Cloud</a></li></ul></li><li><a href="/deepnn/#fast-ai-help-functions" class="sidebar-link">fast.ai / Help functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#open-image" class="sidebar-link">open_image()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#open-mask-fn" class="sidebar-link">open_mask(fn)</a></li><li class="sidebar-sub-header"><a href="/deepnn/#show" class="sidebar-link">.show()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#apply-tfms" class="sidebar-link">.apply_tfms()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#imagecleaner" class="sidebar-link">ImageCleaner</a></li><li class="sidebar-sub-header"><a href="/deepnn/#show-heatmap" class="sidebar-link">.show_heatmap()</a></li></ul></li><li><a href="/deepnn/#fast-ai-data" class="sidebar-link">fast.ai / Data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#basic-functions" class="sidebar-link">Basic functions</a></li><li class="sidebar-sub-header"><a href="/deepnn/#imagedatabunch" class="sidebar-link">ImageDataBunch</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-own-item-list" class="sidebar-link">DataBunch / Own Item List</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-1-datatype" class="sidebar-link">DataBunch / 1. DataType</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-2-from" class="sidebar-link">DataBunch / 2. from_</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-3-split" class="sidebar-link">DataBunch / 3. split</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-4-label" class="sidebar-link">DataBunch / 4.label</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-5-transforms" class="sidebar-link">DataBunch / 5. Transforms</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-6-dataunch" class="sidebar-link">DataBunch / 6. Dataunch</a></li><li class="sidebar-sub-header"><a href="/deepnn/#normalize" class="sidebar-link">.normalize()</a></li></ul></li><li><a href="/deepnn/#fast-ai-data-augmentation" class="sidebar-link">fast.ai   / Data augmentation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#get-transforms" class="sidebar-link">get_transforms()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#zoom-crop" class="sidebar-link">zoom crop()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#rand-resize-crop" class="sidebar-link">rand_resize_crop()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#list-of-transforms" class="sidebar-link">List of transforms</a></li></ul></li><li><a href="/deepnn/#fast-ai-learner" class="sidebar-link">fast.ai / Learner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#basic-functions-2" class="sidebar-link">Basic Functions</a></li><li class="sidebar-sub-header"><a href="/deepnn/#learner-cnn-learner" class="sidebar-link">Learner / cnn_learner()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#learner-unet-learner" class="sidebar-link">Learner / unet_learner()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#learner-language-model-learner" class="sidebar-link">Learner / languagemodellearner</a></li><li class="sidebar-sub-header"><a href="/deepnn/#learner-text-classifier-learner" class="sidebar-link">Learner / textclassifierlearner</a></li><li class="sidebar-sub-header"><a href="/deepnn/#learner-tabular-learner" class="sidebar-link">Learner / tabular_learner</a></li><li class="sidebar-sub-header"><a href="/deepnn/#tabular-learner-add-datepart" class="sidebar-link">Tabular Learner / add_datepart</a></li><li class="sidebar-sub-header"><a href="/deepnn/#train-fit" class="sidebar-link">Train / fit</a></li><li class="sidebar-sub-header"><a href="/deepnn/#improve" class="sidebar-link">Improve</a></li><li class="sidebar-sub-header"><a href="/deepnn/#how-to-choose-learning-rate" class="sidebar-link">How to choose learning rate?</a></li></ul></li><li><a href="/deepnn/#fast-ai-own-models" class="sidebar-link">fast.ai / Own Models</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#learner" class="sidebar-link">Learner</a></li><li class="sidebar-sub-header"><a href="/deepnn/#reasidual-learning" class="sidebar-link">Reasidual Learning</a></li></ul></li><li><a href="/deepnn/#fast-ai-examples" class="sidebar-link">fast.ai  / Examples</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#dog-cat-example" class="sidebar-link">dog-cat example</a></li><li class="sidebar-sub-header"><a href="/deepnn/#dogs-cats-breeds-example" class="sidebar-link">dogs/cats breeds example</a></li><li class="sidebar-sub-header"><a href="/deepnn/#isic-archive-skin-melanoma-recognition" class="sidebar-link">ISIC - Archive (Skin melanoma recognition)</a></li><li class="sidebar-sub-header"><a href="/deepnn/#planet-amazon-dataset" class="sidebar-link">Planet Amazon dataset</a></li><li class="sidebar-sub-header"><a href="/deepnn/#camvid-mask-images" class="sidebar-link">CamVid / mask Images</a></li><li class="sidebar-sub-header"><a href="/deepnn/#imdb-nlp-text-classification" class="sidebar-link">IMDB / NLP Text Classification</a></li><li class="sidebar-sub-header"><a href="/deepnn/#twitter-text-recognition" class="sidebar-link">Twitter / Text recognition</a></li><li class="sidebar-sub-header"><a href="/deepnn/#tabular-data-2" class="sidebar-link">Tabular Data</a></li><li class="sidebar-sub-header"><a href="/deepnn/#collaborative-matrix-predict-movie-score-for-the-user" class="sidebar-link">Collaborative Matrix / Predict movie score for the user</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"><div class="warning custom-block"><p class="custom-block-title">Source</p><p>The material based mostly on the free deep learning course and library <strong>fast.ai</strong> (from 2017)</p><p><a href="https://course.fast.ai/index.html" target="_blank" rel="noopener noreferrer">https://course.fast.ai/index.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div><h2 id="gpu-servers"><a href="#gpu-servers" aria-hidden="true" class="header-anchor">#</a> GPU Servers</h2><p>This is a short list of GPU Servers that can be used for fast.ai.</p><table><thead><tr><th>Server</th><th>Free</th><th>Description</th><th>Limitation</th></tr></thead><tbody><tr><td><a href="https://colab.research.google.com/" target="_blank" rel="noopener noreferrer">Google Colab<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>Yes</td><td>Free notebook for use (required setup a GPU)</td><td>12 continuus hours per session</td></tr><tr><td><a href="https://www.kaggle.com/" target="_blank" rel="noopener noreferrer">Kaggle Notebook<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>Yes</td><td>Free kaggle notebook <a href="https://www.kaggle.com/dansbecker/running-kaggle-kernels-with-a-gpu" target="_blank" title="https://www.kaggle.com/dansbecker/running-kaggle-kernels-with-a-gpu" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>60 continuus minutes per session.</td></tr><tr><td><a href="https://www.paperspace.com/" target="_blank" rel="noopener noreferrer">Paperspace<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No</td><td>Pay as you go consoles to run machines</td><td></td></tr><tr><td><a href="https://azure.microsoft.com/" target="_blank" rel="noopener noreferrer">Microsoft Azure ML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No/200$ for start</td><td>Free 200$ for machines that can have GPU inside</td><td></td></tr><tr><td><a href="https://cloud.google.com/" target="_blank" rel="noopener noreferrer">Google Cloud<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No/300$ for start</td><td>Free Tier to use $300 dolars <a href="https://cloud.google.com/free/docs/gcp-free-tier" target="_blank" title="https://cloud.google.com/free/docs/gcp-free-tier" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td></td></tr><tr><td><a href="https://aws.amazon.com/free/" target="_blank" rel="noopener noreferrer">Amazon AWS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No</td><td>Free Tier doesn’t have GPU machines.</td><td></td></tr></tbody></table><h2 id="artificial-neural-network"><a href="#artificial-neural-network" aria-hidden="true" class="header-anchor">#</a> Artificial Neural Network <a href="https://towardsdatascience.com/multi-layer-neural-networks-with-sigmoid-function-deep-learning-for-rookies-2-bf464f09eb7f" target="_blank" title="https://towardsdatascience.com/multi-layer-neural-networks-with-sigmoid-function-deep-learning-for-rookies-2-bf464f09eb7f" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Artificial Neural Network (ANN) is an paradigm for the deep learning method based on how the natural nervous system works.  They can be used in the ImageRecognition, SpeechRecognition,  natural language processing, desease recognition etc…</p><p>The simplest architecture of the Artifical Neural Network is a Single-layer Perceptron that was introduced in the 1957 by Frank Rosenblatt. <a href="https://en.wikipedia.org/wiki/Perceptron" target="_blank" title="https://en.wikipedia.org/wiki/Perceptron" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><h3 id="single-layer-perceptron"><a href="#single-layer-perceptron" aria-hidden="true" class="header-anchor">#</a> Single Layer Perceptron</h3><p>This architecture contains:</p><ul><li>Input <code>x</code> as a vector</li><li>Weights for each <code>x</code> input (<code>w</code>)</li><li>bias (<code>b</code>)</li><li>and Activation function that on output has been activated or not (<code>0</code> or <code>1</code>)</li></ul><div class="perceptron"><input placeholder="x1" size="mini" value="0.2" class="x1 red"><input placeholder="x2" size="mini" value="0.3" class="x2 green"><input placeholder="x3" size="mini" value="0.8" class="x3 blue"><input placeholder="w1" size="mini" value="0.2" class="w1 red"><input placeholder="w2" size="mini" value="0.3" class="w2 green"><input placeholder="w3" size="mini" value="0.5" class="w3 blue"><input placeholder="b" size="mini" value="0.1" class="b"><input placeholder="w1" size="mini" value="0.2" class="w1a red"><input placeholder="w2" size="mini" value="0.3" class="w2a green"><input placeholder="w3" size="mini" value="0.5" class="w3a blue"><input placeholder="x1" size="mini" value="0.2" class="x1a red"><input placeholder="x2" size="mini" value="0.3" class="x2a green"><input placeholder="x3" size="mini" value="0.8" class="x3a blue"><input readonly="readonly" size="mini" value="0.04" class="m1 red"><input readonly="readonly" size="mini" value="0.09" class="m2 green"><input readonly="readonly" size="mini" value="0.4" class="m3 blue"><input placeholder="b" size="mini" value="0.1" class="mb"><input readonly="readonly" size="mini" value="0.63" class="msum" style="color:green;"><img src="/deepnn/perceptron.png" alt="Card image cap" width="740" height="578" class="image"><span class="answer" style="background-color:green;">σ = 1 </span></div><h4 id="when-use"><a href="#when-use" aria-hidden="true" class="header-anchor">#</a> When Use?</h4><ul><li>Can only classify linearly separable cases with the binary output (0 or 1)</li><li>Single Layer perceptron cannot  solve non-linear problem.</li><li><strong>Not used in modern Deep Learning architecture</strong></li></ul><h3 id="modern-neural-network"><a href="#modern-neural-network" aria-hidden="true" class="header-anchor">#</a> Modern Neural Network</h3><p>Modern Neural Networks has something more than only one layer. In previous architecture, you wouldn’t find any better calculation than some simple linear functions.  To create more complicated functions we need hidden layers.  With this first input goes to the activation function in the first layer, and the following output if the hidden layer can go to the next layer with the activation function or to the final output. More dense Neural Network gives us the opportunity to define more parameters on weights and biases in the network and next recognise more complicated tasks. Each layer can have some special functions. For example in the image recognition first layer is used to extract features (like edges) on the image.</p><p>For example, we define a neural network with one hidden layer with three neurons, two input values, and one output. For the moment we don’t set our activation function yet.</p><p><img src="/assets/img/1547391156214.3d92b6e8.png" alt="1547391156214"></p><p>Let’s explain all parameters defined in the network:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAUCAYAAADskT9PAAABtUlEQVRIie2VIY/qQBSFz2xCSRgFCbYJCkQDAhSOkBoSkkp0+Qd1KGw9GlMDAoEEhcARDAIDCQIECQZBCgSanFU02+V1u2+f2JfsXnnmztxvzr2TESSJb4yX7yz+/wOMx2OUSiUIIVAsFnE+n309lUpBCIF8Po/ZbAYA2O12qFQqEEIgHo+j3+9HEzAkHMehaZp0XZfdbpcA6DgOW60WHcchSV83DIOj0cjP32w2TCaTlFLycDiElSBJhgK8DcuyqCgKy+Uye72er0+nUwIgAJqm6euXy4Wqqn4KIHIGPM/Der3G7XaDrutoNBpPOVJK2LYdbffftOAzt7EsiwDYbrcD+sMZwzAi3Y10YL/f43Q6Qdd1pNPpJ2cURUGtVgvsWa1WAIBCoRBpQCTAZDLB8Xh8OszzPCwWC2iaBk3TAvpwOPwj2JcAlsslACCXywX0+XyO7XYLVVWRSCSewGKxGDKZzL8BXK9XDAYDSClRrVYDa2E2P8Det+xLAI/+Z7NZSCkDa2HOvA3P89DpdNBsNsOLfDShYdP80cu43++s1+sEQEVRaNs2XdcNrSHI39/wF+CHA7wCzQYaadGCWGIAAAAASUVORK5CYII=" alt="1547390335050"></td><td>Number of the examples.</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAnCAIAAAAU41arAAAABnRSTlMA/wD/AP83WBt9AAABIklEQVRYhe2Yu5ECMQxA5avlSG6uAlEC+ZVgp1eKaYP85A6ogAi7F12A96MBFsvsDAR6ode23lifYB0zwxvw8WqBinlIzENiHhLzkJiHxDwk5iHReJR92DrnnNvu07SYLoshLZxsgBvJETFm5hwRADBmZmYmX6/x1HrRbZo95kI1bo44GT2J3mMIHyPelSCvfaIOjyEZeDcQedA+VI/HlJn16K2PtUWU86OksPn9JvIAcDqX6w0puNraNz4+3bfkwRPnqfwWKqAva00eYyrG0LMpMgwWsVndzU0elwZBP7+cqptcrZv1Q6WnXxbRjw5mVtfpQ8r5BIBfG+25lT3K3+EI+LP7fLHHSElB17orl0dtravqfYRj+/8xxzwk5iF5F49/cIBei6jEs00AAAAASUVORK5CYII=" alt="1547389815746"></td><td>Input on the <strong>i</strong> position. Sometimes it shows as a zero activation layer. <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAAAtCAIAAADEABlTAAAABnRSTlMA/wD/AP83WBt9AAAEZ0lEQVRoge2bP0jrXhTHTx+1gtVBUHBpoIJSKKUQ0EEKVmlxqrSgOFVQZysUF/+ADg6CuHRQl+ok0inFQZy00C6KSyAOVkggoYsOTmnVBPobLi/kpTGJmvS9n8ln8+R6e/jmnHvPOVVXs9kEh+/x62878BNwRDQBR0QTcEQ0AXuJKIri0dFRPB5/fn7WWHZ8fDw/P39/f29036ZtEAQhkUhsbGzwPK+7mKbpsbGxs7MzIzvbRUSk4NbWlsK4traGgikQCBAEIX9K0/TAwMDNzY3u5nYRsVwue73ep6cnuTGbzXq9XoqiBEHIZrMAoAi9fD6P47hu5NpCRBSGyWRSbqRpure3V1Kt0WhgGKaQzGAw2uJi4TiuUqnMzc3JjdfX1zzPDw4Ooh/dbnc4HH54eOB5Xlrj8/lGRkYuLi6097eFiLVaTa4XQnH5ut3uoaEhQRAYhlEYSZLU3t8WIn5ER0eH3+/XXcaybL1e11hgCxGr1aqqXoq4+zK2EHF4eFhXL1EUHx8fDcamAluIqEoqlXp/f5cuDVEUSZKMx+P9/f2KlRiGdXV1ae1lej3xD6KoZhCo7pHqxFwu5/F4FNUMqnsUJXorthBRtU5E9uXlZRRMoVCotR40WCfaQsTmBx2LLk7H8geqvbM2JvTONE1Ho1EAwHFceoEsyyKjwfFGe2BZdmpqCmWlx+PZ3d3N5XKxWEwRQe2e4tA0jZzI5/MAgF4gOmUB4At5IVEulw3enq3HvCqXl5foTVMU1fx9h0g+KxAE4fDwMBaLafufz+fT6TTa0Ag66Yx8SiaT6DUaOSDaCXJP7hXys8254tYOB5/PF4lEWJbd29ur1WrlclmnYmojoiiurKy8vLwcHBwovPJ4PIpO2Vp0ZUaDtlAo9OUUtgh0MiiSQ3WiZTX6HUswGASA9fX11lIewXHcxMTE9va2me/WANVqFQASiYQ8DO/u7liW1e8xTEVHRIZhVldXAaBQKLQ+5Tguk8lgGFYqlQx+XqVScRmjs7Pz9vZWYys0ywoEAnIjQRAAoBgdWo2WiBzHRaPR/f19DMNax0EMw6TT6cnJSeMXLgBEIhGDOfL29jY6OvrRPmheoDAyDHNyctLuA1FVxEqlkkqlOI6LRCI4ji8sLMzMzFAURVGUfJnf7y+VSslksl2u/gEal8otr6+vmUwmHA6rTmIsPXNURKxWq8ViEcOwvr6+09NTAAgGg2jgIYri7Oysdpa1jVQqBQCFQqFer3Mct7m5ubOz09PTg55eXV3F43H06LNnzqdpzSN0HafTaemCazQaqPhS7dJROn+qozIL6QtPydtcLocsi4uLPM/TND0+Pk4QhKVOmtA7/0URjWOpk/YdypqII6IJmCAiKnpJktT+SuwH83URRVGcnp52uVxLS0sAUCwWvV5vd3e39h9c/Uh0BhBav+l2n5+fm+jK/xe7nInWnjlWXPn/DtJ4Uc53hsqquJrOv2B8G7uks6U4IpqAI6IJOCKagCOiCfwHCnjQetP2MvkAAAAASUVORK5CYII=" alt="1547389977628"></td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAcCAYAAACZOmSXAAABUUlEQVRIie2WMY6CQBiFH1uMxdDAAbgBDV6AC5hYcwxLGk5CY2PrHWjEmhoTSqElFpC8LTbDLioug25MNryE6g/vm3+G9w8GSeJN+ngXeIaPUtu2CMMQhmF0j2maKMsSAHA6nWDbdldbLBY4Ho+PTampzWZDAJRSMsuyXi1JEgKgEILb7fZXL224Aniex7que7U4jgmAu91ulJc2/HK50HEcSil5Pp9vFhVF0WgvbTh522Ge57Qsi+v1WstnElzBPM9jVVV0HEcbPBneNA1XqxWFEFwul3fP/8/g5PfWX5+9jiYNmbZtsd/vp7z6XM7Jr6xLKRkEgVa0rqUNj+OYQgimadrFa8rHpg1XMNXpUOZfDh/Kshq3U7Z+FFx1eC9Sj8bt03CV6aHufl4maZq+Dl4UBX3fJwACoOu6vZvscDjQsqyurrsAg5z/4Wb4DP/n8E+2KzNgiEfCMwAAAABJRU5ErkJggg==" alt="1547390011533"></td><td>Input vector. The size of the input vector is <em>(input_layer x m)</em> . <br>Where <em>m</em> is a number of examples  (In this example 1).</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA0CAIAAAC2D6d2AAAABnRSTlMA/wD/AP83WBt9AAAD+klEQVRoge1ZMUjzThR//VNvMFNBJSBGKlSFVoSCDq7aRVB0EJVSwdlBEC2WDDpbJxcdjItDHYRuUhcd0qGKS6EBtRChEgQFHSQ2NIF+w/HlH9Omre0l8kF/2z3ucr+7e/d7711c5XIZ/kH899sEmkSbt7No866ApmlHR0ehUOjt7a1u55OTk5WVFUEQGv162R6oqjozM8OyrCzLDQ4RRXFiYiKRSDTS2RbemPTOzs5PB4qiSNP0zc1N3Z628OZ5nqKo19fXJsZyHBcMBuueEnneeLPn5uaMxlQq5fF4EEKJREJV1VgsBgC4aRre4JaTv5fPz8/pdHpxcVG3nJ6e8jyfz+dpms7lctvb2+FwuFgs0jQdj8e/vr6Mw/v6+sbGxi4uLmrP4ibOW5IkWZYHBgZ0SyQSAQBFUQAgHo/zPO/3+3GTYZjOzs5vhNxun8+XzWZrz+Kcft/d3RUKhVgsNj4+DgAvLy+fn5+jo6NVOxcKBdM5mECe9+PjY0dHh9frrbQjhKanp3FTkqSPj4/h4eHmZiHPe3BwUFXVp6cnk10QBON6kskkQsjoTj+CQ36iKMr5+XkoFOru7gYATdPy+XwgEAgEAlX7V/q9CeR59/b2UhQliqLRaPJmTdOy2SzDMAihhYWF29tbvSdeoZXf/w/C6m2h3zzPA4BRrTmOA4CRkRGTVDeo3+14acDv5Cf4TAHAtG58sjqbYrHIMAzuWRmufycfTKVSAGA6642NDSNvPBPDMFYuoarq4eHh1NRUIw7DcVwkEsnlco2QtuSN99JISN9d44UTRdHj8TThD62jlg4awweO0qYOkiSVSqW1tbU6mmUDqvN2u91GBdU0bW9vLxqNMgyjZw7YuLm5iUOJw7Dk7fP5SqUSDh+ZTObq6mp9fd24mEwmI0lSNBp1iOl31I+XiqKEw+Hj4+Oenh4AeHh4kGUZG7e2tozROJ1Ou1yus7Ozyi/09/fPz887wdvv9wPA/f09y7JdXV2zs7P4ELDTsywbDAaXlpaMQ6xSJXw36ofuH8HqwmIVX15eNgYCjuMQQqurq42ENFtRhzd8F2wcehBCjYQ0W2HJG2uzaV/xYioFu+oiywbVJ34+xPITfBRV63OGYUzpYesgmX9b1S816simQYy3IAhV65cW60grkOGNi5SqxVUymaQoanJykshEOsjwtnpUwHXk0NAQRVFEJtJBhvf19bUsy/obgw69jqxd5DYBwnXx5eXl7u6u3qz9uNMSiKgSFnuE0P7+vtFuJY6tg8z7oNfrfX9/r7QLgmDHpQSw7X9D+W+wJB5xMGz8T3JwcGBfJmMLb1xBV77pEISr3P7P7STavJ1Fm7ezaPN2Fv8q7z+lOQlPqm9RLQAAAABJRU5ErkJggg==" alt="1547389753231"></td><td>the weight on the layer <em>n</em>, from the input from the previous layer position (<em>i</em>) to the activation layer position (<em>j</em>)</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAjCAYAAAAg/NwXAAADx0lEQVRoge2ZPUjzXBTH/32IFYxLBEEsLUSwiwVBUUQEP7AghUo3p7o4SpcgBe2grq4WKmJ1swoOfoCjFaLix1SsS4cEWlSwOFaLLdx3eJpiniT1to/Pa4b8oEN7zr3n3H9Obs5NbYQQAgv8+ukEzIIlRAVLiAqWEBVMKUS5XMbGxga8Xi/y+TzVmO3tbczOzuLh4aGxoMRklEol4vf7SSQSIYVCoa6xkiSR4eFhkkgk6o5rKiEUEZaXlw19stksGRsbM/SRJIl0dHSQm5ubumKbSghRFAnLsuTl5UVjy2azJBQKEQAEQE2x4vE46evrq6uiTLNHlMtlrK2twev1or29XWWTZRnBYBATExMQRfHLucbHx/H09IR0Ok0d3zRC5HI5XFxcYGZmRmPjeR7n5+cIBAJUczmdTgwMDOD09JQ6PpUQ6+vrsNls1U9zczNub29VPuVyGdPT07DZbNjb21PZZFlGW1ubao6VlRWVz+PjIwqFArq6uqiTN4JhGHR3dyOVSlGPoRIiFApBEAQAgN1uhyiKGBwcVPlcX1/j5OREdzzP80gkEtXvkUgE4XCYOslGyWazeHt7o/JlaCft6ekBAHg8Hng8HpVNub9r4Xa7wXEceJ7H0tISWlpaVPZMJoOmpibwPE+b0rdCvUe43W5DWy6Xw93dHfr7+w19kskkCoUCYrGYRgRl/lKpBFmWaVP6Vr5ls4xGoxgaGsLo6KiuvVgsYnV1FT6fT3NL/UtcLpeu6Hr8tRCyLGN3dxeLi4uGPpFIBK+vr9jc3DT0cTgcYFkWkiTVjJfJZAAAqVTK8P4vFos4ODhAb28vxQp+Qy2Ew+EAx3Ga35VqMLrSsixjZ2cHCwsLmv7gM06nEyMjI9jf39fYPj+R5ubmAACHh4dgWRatra2a88jz8zM+Pj7g8/lol0e/WeqhVMPR0ZGhTzQaBc/zXz4lGIZBOBzG1NQU8vm8SjSGYXB8fEydVzKZRGdnp2ZTrwltCypJEuE4TtW6CoJAAoFA1UcQBGK326t9vjKG9hBEc9agyfOfnjX+FEIv4GchlEXV2/Ob/vT5/v5OXC5XdWF/VgMhaiFEUVRVRz2USiUSi8XI5OSk7gFMj3g8ToLBIEmn03XHI6RBIe7v73XLTxHi8vKS+P1+jVBmpqHN8qsnxdXVFc7Ozn6sOWoIWsWUigBgWPKCIFC9LzAj1H0EwzDVBuWrDpFlWczPz//lJfp/aaiz1Htn8Jmtra2azZMZsRFi/eUHmOgN1U9jCVHBEqKCJUQFS4gKlhAVLCEq/AdXuokfEVKMaAAAAABJRU5ErkJggg==" alt="1547390155358"></td><td>The matrix on the layer <em>n</em>. The size of the matrix is (<em>current_layer</em> x <em>previous_layer</em>). In the example <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAjCAYAAAAg/NwXAAADx0lEQVRoge2ZPUjzXBTH/32IFYxLBEEsLUSwiwVBUUQEP7AghUo3p7o4SpcgBe2grq4WKmJ1swoOfoCjFaLix1SsS4cEWlSwOFaLLdx3eJpiniT1to/Pa4b8oEN7zr3n3H9Obs5NbYQQAgv8+ukEzIIlRAVLiAqWEBVMKUS5XMbGxga8Xi/y+TzVmO3tbczOzuLh4aGxoMRklEol4vf7SSQSIYVCoa6xkiSR4eFhkkgk6o5rKiEUEZaXlw19stksGRsbM/SRJIl0dHSQm5ubumKbSghRFAnLsuTl5UVjy2azJBQKEQAEQE2x4vE46evrq6uiTLNHlMtlrK2twev1or29XWWTZRnBYBATExMQRfHLucbHx/H09IR0Ok0d3zRC5HI5XFxcYGZmRmPjeR7n5+cIBAJUczmdTgwMDOD09JQ6PpUQ6+vrsNls1U9zczNub29VPuVyGdPT07DZbNjb21PZZFlGW1ubao6VlRWVz+PjIwqFArq6uqiTN4JhGHR3dyOVSlGPoRIiFApBEAQAgN1uhyiKGBwcVPlcX1/j5OREdzzP80gkEtXvkUgE4XCYOslGyWazeHt7o/JlaCft6ekBAHg8Hng8HpVNub9r4Xa7wXEceJ7H0tISWlpaVPZMJoOmpibwPE+b0rdCvUe43W5DWy6Xw93dHfr7+w19kskkCoUCYrGYRgRl/lKpBFmWaVP6Vr5ls4xGoxgaGsLo6KiuvVgsYnV1FT6fT3NL/UtcLpeu6Hr8tRCyLGN3dxeLi4uGPpFIBK+vr9jc3DT0cTgcYFkWkiTVjJfJZAAAqVTK8P4vFos4ODhAb28vxQp+Qy2Ew+EAx3Ga35VqMLrSsixjZ2cHCwsLmv7gM06nEyMjI9jf39fYPj+R5ubmAACHh4dgWRatra2a88jz8zM+Pj7g8/lol0e/WeqhVMPR0ZGhTzQaBc/zXz4lGIZBOBzG1NQU8vm8SjSGYXB8fEydVzKZRGdnp2ZTrwltCypJEuE4TtW6CoJAAoFA1UcQBGK326t9vjKG9hBEc9agyfOfnjX+FEIv4GchlEXV2/Ob/vT5/v5OXC5XdWF/VgMhaiFEUVRVRz2USiUSi8XI5OSk7gFMj3g8ToLBIEmn03XHI6RBIe7v73XLTxHi8vKS+P1+jVBmpqHN8qsnxdXVFc7Ozn6sOWoIWsWUigBgWPKCIFC9LzAj1H0EwzDVBuWrDpFlWczPz//lJfp/aaiz1Htn8Jmtra2azZMZsRFi/eUHmOgN1U9jCVHBEqKCJUQFS4gKlhAVLCEq/AdXuokfEVKMaAAAAABJRU5ErkJggg==" alt="1547390155358"> (<em>3 x 2</em>)</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAAjCAYAAAAqoHJFAAADJUlEQVRoge2ZP0vrUBjGHy/Xg5ipgxAQAzqIQ0UI6ODkYBdBcBEF0Q9RRKwZ+gEE14p4ujh0EbpJ97goLkILkkIKERF06CC1hQTeO1xSbJsmObm297a3P8hyTt435znvn3NKx4iI8J/w428voJ+MxA4rI7G9wnEcnJ+fI5FI4P39Xdg+m83i4OAApVIp2gKoT9i2TZubm6RpGtVqtch+TNOk1dVVyuVywrZ9EesKTafT3+LPNE2SZZnu7u6E7PoiVtd1kiSJ3t7evs0n55xUVRXKkp6LdaO6tbXlOV8oFCgWixFjjHK5HNm2TalUigA0x7yIEt2eN6jn52fc3t5iZ2enY+7q6gq6rqNcLkOWZRSLRRwfH2Nvbw/1eh2yLOP09BSfn58dtjMzM1heXsbNzU34xYhESdd1AhD4fI2iruvEGPONQL1eJ0VRWt5zx7plBBFRMpn0nW9HKLL5fB4AoGkaarUa6HcZgIjAOQcASJKEi4sLEbd4eHiAZVlIpVJYWVkBALy+vuLj4wNLS0u+tpZleUbei9BiHcdBuVyGqqo4OTnB5ORkc65SqeDw8BAAcHl5iampqeacYRgYHx/H7OxsV9+GYYAxho2NjebYy8sLqtUqFhYWwi4xECGxT09PyGQyLUIbjQbW1tZQrVaRTqexu7vbYjc/Pw/btlGpVLr6LpVKHRuSz+fBGMPc3JyIHl9+hn1xYmIChmF0jGuaBsuyoKoqjo6OhBfQaDRwfX2NRCLRzAg3i+LxOOLxuK+9oigtm+/HH3XjbDaLs7MzMMY6Iu4yPT0NSZJgmqanD6/adBwHj4+PUBQFjDFsb2/j/v6+xc7dpKCabiF0K2vDNE2KxWIEwPfqFnTOuh2+3QfnnADQ4uKiZyePcs5GEuseC2g7Zrox0DeoZDJJAEJ/bGDvxm7aBV0U2hm4Xz1h67Qbtm1TJpOh9fX1SCnNOaf9/X0qFovCtkQCYt3IhK3Tf5HQYt069Wo0bsOKEu1+EkpsUJ1yzr+92/aCQLFf69SrmxYKBaHO/DfxFfu1ToOeQajjMaLR3x9DyUjssDISO6yMxA4rvwCixYf6hR0JhgAAAABJRU5ErkJggg==" alt="1547587884160"></td><td>The Z value on the layer (n). The product on output from the previous layer (or input) and weights on the current layer. The size of the matrix is (<em>current_layer</em> x <em>m</em>)</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEMAAAA3CAIAAADYG2DzAAAABnRSTlMA/wD/AP83WBt9AAACcklEQVRoge2aP7KbMBDGP+csfi48PsFyAk8aV2lfJ8qXJl3KHECUoXttKppIJ3icwENhcRelEPgPyG+EQDLx8HUIGO+PXe2udrzSWuMp9OXRBkymhWR+Wkjmp4VkfopGUsssTZJMujyaJUmayXrgL+gYUpxAXKhBbxAxMeA3IpAYjAEUfu+FJxEMGPRxLxrEEppEceqCKMEIAEzwtFewxdIQlMAkPRDFGXGhtGAAccEZE0obx9lsHoASmMQYbLFEMFzbLhjsMegemw+qJ7LIAeLvb2sAQH06ArR9sT98PLkk5LAk9ekI7DZr6zp9+9reUFVpfW6IwpKsNzvrJ+1Ybjx0zyWOekh0ySIH2GHfXHY91JWbswKTvGwJZaVuF7u74uyhOkuS7MaBssidnTUmMznIUk/6iUrxpsB0s9yM6ol+nhqv/5O+SwlG1MYpMS4EJ7pbqufaC6u2TDcGNsF+7zMqwRkRd7FNcSI2iFtrfxJj943VDYrnnhgtvyxcZ6/fS4D9fOtl+rEFzl8++J3273rVZ2tPIx+f1Kcj+kVZFjlGN08j5EOiqhI9mw3IpQW5upOuVqvUZRQxSh4kxiWdtexXDvsmmaQ9dJAHyXqz66zI9LXaEeyxtf+ttf7op4ap5RNd+wMDkBeyhpljFYf3H9v2bi17fWAc+SWKdoxw6foEP6+ca5rJcZESWvCJxL0D+uQKftL67IA+qQKTTHFAd1RYks4xN6iCknw+/JlYQUkixlZYkqguCUlS//0T0SUhSVRVRtvuCEkSM28BCDXvUoJT5GPX9CRNs9UfwwXWSi//JZqbFpL5aSGZnxaS+el5SP4BTR7r3k81pagAAAAASUVORK5CYII=" alt="1547390538540"></td><td>The value on the activation function on the layer <em>n</em> and position <em>j</em>. Activation on the last layer is the output on the neural network:  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAwCAIAAABVDSmEAAAABnRSTlMA/wD/AP83WBt9AAADQElEQVR4nO2bMbbiIBRAH3NmKYmFxxU8VqDT/Gra6Uipzd8HKX+6aaeyGViBrMBjIewlU2A0JkQjPxL/hFtiPMEbeDwekZRlCZHn823sDkyFKDoQUXQgouhARNGBiKIDEUUHIooGACPzjNJc3r4opzTLpfG9STl1NEdALnTPaxGZ8LnNxEVby3XJWgvOEKtxiIzrO9/ox7RFCwZwNUA1R4DzANecATSu8FU9ZdGaY9NiU6IVP4TpCYt2eG4hGEBbqo/pCWcd+qAA5+mtS+S2AMCfP5Lr5mS2AHXQD91twqLvYXK6KpCJ3Tpxfbw/PpTpfUK0zCghhNDcO7UcFXPcAyxmTokAJqfpRjGx+1gOcztf0TKjq0IBAKhN+iVdJ7NF17CsLJdDWQZP0Sanq0Ih41prwRDUJs1ub6u+EH0td06GDh5dq+1ijay2ldKCOZKgl8eZddhfV88oNMdmhiGYIxW5w6OiNccryed20e7Pq9M2bdPmFjGP/iytnWEf4s7Qg8elhah1nGIxNAOUYB1zbFS0uK4NCcHRFd1ernonmA3OVmuj5GVjm7fny6O6S6/RpKtOnvxVsbfjy7Zgx2/3XnNE1vOBOPAIHaJd0nLWXkajKsHpZtOYPfSJ0W3TPvnOs3A6dbgPjI/oZq/7lMGC4YpsXVW4kPjsDJPZAuBSvjJ//yjk7419lJEZHaEOYo57aBfc5LaAx/dyw+LzdOpD2nEYJLg7O+lmuMXQsYB0NAbGL4++LH7NlP+8No8zWV0B+tQ28hriV72zwWO/zeiqYKJefUnWu93HejnWHLUdqyOzX4cFgjtwBIxvnmXSdI4AqijUtebxWb4xACi20oB9X2P79vt9Xn1qZE6tVyPzjJL0VOoNgedMuBv2xlvnL/vX6lUBwc8t4rSuBI9vn4jRtzs4fkLVg4Cd/O4xCWSWbhRy7T5LizjpG6PNKbiZnJJVgVx3HFlGOug7ovVBqSIlGwDoPhiuYTcO6qANJPGJQO8Rbb3Z1eT2wbDJKSGEpBsFAFCsUkII+X9OFL3pOaKT9a5cD3zltJj0CzS1+PZ8AmQ2r4fzEPa5tRBSxn/OBmHSoSMkUXQgouhARNGBiKID8Q+YYksmp31qhAAAAABJRU5ErkJggg==" alt="1547390776342"></td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAAjCAYAAAAqoHJFAAADI0lEQVRoge1ZsUvzUBD/+aFvaHHIIATEgA7iUBEERZztIggu4iA6+A8ImQwZxNk/QB3ioGAXwUEQOz+HKiIILWgLKaSIoIOD1BYSuG96xbZpmqS2fvbrDzLk3bvL/XL37i6kj4gI/wn+/LQDnUSPbLeiR7ZdcBwHBwcHiMfjeHt7C6x/dHSEjY0NZDKZcA5Qh2DbNi0tLZGu61QsFkPbMU2T5ufnKZFIBNbtCFlBdGdn51vsmaZJsizTzc1NIL2OkOWcUzQapdfX12+zaRgGTU9PB8qStpMVUV1eXnaVX11dkSRJxBijRCJBtm2TpmkEoLLmhjDRbXuBKhQKuL6+xurqap3s5OQEnHPkcjnIsox0Oo3t7W2sra2hVCpBlmXs7e3h8/OzTndkZAQzMzO4vLz070yocNXAMAwC4Bo9zjkxxjwjUCqVSFGUqn1irVFGEBGpquopr0XLkS2Xy9jd3QUAWJblGoVmuLu7g2VZ0DQNs7OzAICXlxd8fHxgamrKUzfIM1smq+s6IpEIJElylWezWQwMDGB0dLShjWw2C8YYFhcXK2vPz894f3/HxMREqy5W0BLZfD6P09NTHB4eYnBw0HXP+Pg4bNtGPp9vaCeTydS9kPPzczDGMDY21oqLVQhN1nEcbG1tYW5urpJ6T09PKBaLgeyUy2WcnZ0hHo9jaGioYjuXyyEWiyEWi3nqK4qCSCTi61mhyaZSKSSTSWia5rlveHgY0WgUpmm6yt3OpuM4eHh4gKIoYIxhZWUFt7e3VXriJTU701XwXcpcqqeYiMS92+DQrM9yzglAXT8VFX5yctK1kofps6HIGoZRRUwQatRifu0EZZomSZJUNec2I/trZ2NVVeuiJMi4pWPtnl/z1SPOl9fl5YRt27S/v08LCwuhUtowDFpfX6d0Oh1YlygAWRGZRudEVdWmZH8a/X6r9vHxMZLJJDjnnn3t8fHRfyvoMHz1WTH/+mny/zJ8kdV1HZZlNZxWCoUC7u/vAQAXFxehPgY6Aq8c/1plxVXbPsRA8XXP5uZmSxW3Xegj6v3+6Er0yHYremS7FT2y3Yq/4zbnNyZuKqgAAAAASUVORK5CYII=" alt="1547587796103"></td><td>Activation matrix on the layer (n). The size is the same as</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAcCAYAAAB2+A+pAAABkklEQVRIie2WMYvCQBSEJ8exhVsp2FoLFoKFrQE7IZD/YGkhBBsr/4aNCDY2QgR/hWCpjUUCNoKNhWiEXZgrjhwcMbI5BDnIwDb7kvdlJrxNLJLEG/TxDmgONpbWGuPxGKVSCZZlwbIsdLtd3G438ybMqCiKaNs2hRD0fZ8kGQQBi8UiXdc17pMJrJSi4zgUQnC9Xif2pZQ8nU5GvTJFPZvNsFqtMBwO0Ww2E3WlFMIwfG3UURSxUqk8dJWWxDMZgyeTCQFwNBpleqg0GUWttcZyuYQQAp1OJ1E/Ho+4XC5mEWeJOnYE4OlqNBq8Xq+vc7zZbHA4HOC6Lvj9en4tz/MAAI7joFAoGBk2Au/3ewBAvV5P1O73OxaLBQCgWq0aQY3BsR41jtOQUqLdbr8WvNvtUmu+7wMABoMByuXya8FpCsMQ0+kUUkr0er1M936aXFSr1RJ7Wmv0+32cz2fM5/NMbgGYjVP8EYjHRSlFz/NSDxQTGZ9cQRDQtu2fmW21Wtxut3+CkqRF5v9cOTgH/3PwF+DfR2VLzcqfAAAAAElFTkSuQmCC" alt="1547390298914"></td><td>Set of parameters of the model. In the example two matricies: <img src="data:image/png;base64,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" alt="1547390430000"></td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFUAAAAuCAIAAADWcsIPAAAABnRSTlMA/wD/AP83WBt9AAADwklEQVRoge1aPUvzUBS+ealXsS4RnMRABT+gDUIHcXBIBxdRUQi49yd0cXCov0FEUQiFInSs4uISHBIHxaWQgB9QIUVERRwkVppA3uFCCElzc5NaHZJn6/14znnuOTn3g1KWZYEY499fO/DHSPTHG4n+eCPRH28k+uONRH+88Rv6ZVkeHR0dHBy8vr7+BXPhYAWh3W4zDIMGr6+v+w0TRZHjuHK57GqXJImmaTQdQnh1dRVoMRQEQWBZtl6vR5serN+yLMMwVldXAQC1Ws2vF0LodaLZbNI0zbLs5eXl+fk5TdPpdPr19TWar35AS5/P53VdDzuXSL9lWaVSqWv0UHZ0tY3EF4tFu0vTNI7j+rEEKAYRmIn0I5FedoxVwzB4nq9Wq9723d1d72fSOzCRwIBIP4qkl1qSJABAP8REgyAIfh+pH4j0d9UZOeX6hwgpQLT/1et1AMDs7KyzsdVqybK8tLQ0NjbmGt9qtQqFAkVRrj1PlmWKoiiKGhkZeXt7wxuNQDI0NMTzvKIoiqKQ6AKAYP+zy7ur+KFk8yZ/u91eWVlRFAVljSsaaBZmH+2RxM8rP6QCF8g0zUajkcvlcrmcs11VVeBJChSEs7MzAMD39zfDMHd3d7quDw8PO8dsbm7ijUYmmZ6eBgA0Go1AXQjB+X9zc6NpGsMwTvOmaT48PEAIJycnMRp4ntd1XRRFu1FV1Xw+v7a2RuhfWJLx8XGapjVN+/r6IuEPjv/9/T0AYG5ujtBjJ7LZLADg9vYW/Xx8fKxUKvv7+65I/gKJHwLib5rmyckJhHB5eTkCuysbLy4uMpkMefB/kMQPAfFHH//AwEAmk4nA7szGl5eX7e3t09PTsHH7ERI/BMT/+fn58/NzZmYmnU4721Op1NTUVKfTaTabmOkTExOLi4uoeu3t7S0sLMzPz4d1MRTJ09PTx8eHq1phEKAfQ+f6LLsCLZNhGFtbW4eHh0dHR64BaDPf2NjohcSJsNUquP4hmKZ5cHDw/v6+s7ODWgqFAk3TgTtNNpvtdDqVSqVWq3lPSoQgJ1FVNVy1wh8P7JsvhLBarToPIYTnX3SA8Tvw4HvDDotw/iW9/2Lcwhy20BphHCK5sQSShGJzoSf9gSng92qAgMJVLBbxVvAkLra+3H9DWRUEoVwu+90anEAjMV0kJAj9ff8gsW2/f5VKJVRZIIShUtGJUCSiKKJXtgg38R/QbzvBcdzx8TGqlyzLKooSjcouuiQkkiT18v5JWcn/X+KMRH+8keiPNxL98UaiP96Iu/7/szOcW2SqxwgAAAAASUVORK5CYII=" alt="1547391042187"></td><td>Loss function on the one example.</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAAjCAYAAAA0aUL2AAAD50lEQVRYhe1YMUgzWRD+/uNcgttsCnGrkFgFDChpLA3YCcHtTCm2FsZgkS6WdgGbVJJoYSyE2KWMYhEEIS4oMQoa0mSx2YCEDSbwXfHfhkR312y88/Dwg23emzcz38yb9+btL5LE/wx//NcO/Bv4IfVZdDod5HI5HB8ff0rP9fU1dnd30Wq1LOe/jNTOzg4CgQAODg4QDAY/pUuSJKiqikAggK2tLXQ6nWEBjoGLiwsCGPpSqZStfDKZpMfjYT6fd9Tb7XaZyWTo9Xr7etfX19luty3lK5UKZVlmLBYbGh+LFDlMzIlQJpMhAKbTaUd9hmEwEolQEAQWCgWS5OPjI71eLxVFsV1XKpUIgPF4vD82NinToCiKfH5+tpRpNpsE4OgU+TtD0WiUgiDw8vLy3biTDZJMpVIEwGKxSPIfyJSTw6axUqnkqGt/f98y43Zk3+Jt8MYmlUgkHLeeYRiUZZmyLDvqMQyDPp/PMhujkiLJSCRCAGw2mxzr9Ov1enh4eAAA25Ps7OwMmqZBURRHXUdHR2g0Gtje3sbU1NQ7O6qqYmJiAoFAwFHPysoKACCXy413pJvGRFHE0tKSpczd3R0AYHp62lHP6ekpBEHA8vLyu/lms4mXl5eRfDKDW6vV8OdIK97g6uoKjUYD4XAYoihaytRqNQCA3++31WMG5/X1FQsLC7ZyTnZMSJIEAKjX6+Nl6v7+HgAQjUYxOTlpKVOv14eMWcEMjqIo4O/6HvoSicSHdkzIsgwA0DTNPSlzywD29QSgf8s7kTKDMzc3Z7n+5OTkQztW68YipaoqBEHAzMyMrdzgdvgIVk6bWXSq20EMBtE1KbN4Q6EQQqGQrZxZS3ZNJwDc3t7azhUKBQCwPBWtoGla365rUqVSCbquw+fzOe5z89RzImWHp6cnZLNZiKKIjY2NkdaYpGRZdn/6mdFdXV11lJufnwcAnJ+f28rMzs6+G+v1etjc3ISu68jn8yNlCQBUVQXwd32O3EK4vOFJMhgM9m95K5j9YzgcZrvdZrfb/bBTsYPf76ckSTQMw12bNEoTO4h0Ok0AzGQyjjrNFgcAFxcXeXNz48YtlsvloU7dFalRmthB6LpOSZLo9/up67orR90gEonQ4/GwWq2SdEHK3HoAPnzsDaJSqdDj8YwcCLdIJpNDzw5yRFLdbpd7e3uusjSIYrFIj8fDWCxmW19uoes64/E4ATCbzQ7NOZIynwUAGAwGeXh4OLYT1WqVa2trlCSp/7IdF+VymbIsU1EUy7faL/Jrf2ZqmoZWq/Wpny+apqHT6dg2y19O6ivw8zPzu+CH1HfBD6nvgh9S3wV/Acpe75TyoElqAAAAAElFTkSuQmCC" alt="1547391083924"></td><td>Cost function on all examples in the one batch. (Very often show as C or E)</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F

<span class="token keyword">class</span> <span class="token class-name">Neural_Network</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputSize <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> outputSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> hiddenSize <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>Neural_Network<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># parameters</span>
        self<span class="token punctuation">.</span>inputSize <span class="token operator">=</span> inputSize
        self<span class="token punctuation">.</span>outputSize <span class="token operator">=</span> outputSize
        self<span class="token punctuation">.</span>hiddenSize <span class="token operator">=</span> hiddenSize
        
        <span class="token comment"># weights</span>
        <span class="token comment">#self.W1 = torch.randn(self.hiddenSize, self.inputSize) # 3 X 2 tensor</span>
        <span class="token comment">#self.W2 = torch.randn(self.outputSize, self.hiddenSize) # 1 X 3 tensor</span>
        self<span class="token punctuation">.</span>W1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>W2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="forward-function"><a href="#forward-function" aria-hidden="true" class="header-anchor">#</a> Forward Function</h3><p>To calculate the output we need to go from the input to the output with all calculations. For example, we define all activation as sigmoid functions, and our loss function as binary cross entropy (the loss function if we have binary output).</p><p>For example you have a function to predict that is:</p><p><img src="data:image/png;base64,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" alt="1547485837571"></p><p>This is a simple function with the binary output (like when you predict if on the image is dog or cat)</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">fun_to_predict</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token number">1.0</span> <span class="token keyword">if</span> <span class="token number">3</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0.0</span> <span class="token comment">#must be float</span>
</code></pre></div><p>To calculate the output you need to go through your defined neural network and calculate all the layers.</p><ol><li>calculate the first layer by multiply the input with the first layer weights.</li></ol><p><img src="data:image/png;base64,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" alt="1547586657031"></p><ol start="2"><li>Caclulate activation function on the weights.</li></ol><p><img src="data:image/png;base64,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" alt="1547586732170"></p><ol start="3"><li>Calulate the second layer by multiplying the output on the first layer with weights on the second layer.</li></ol><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANAAAAAoCAYAAACPZXQAAAAFZElEQVR4nO2cvVLrOhSFV+6cRyEUDE8gPwHcnpZOKUlzO8rTpZFL0tGe6jTIT4CfgKFAfpd9C9mJcSTbsoyxw/5mUmTiv720l362DCsiIjAMM4h/vvsBGGbJsIEYJgI2EMNEwAZimAjYQAwTwTcZqECWbpAkKbKQs9IEySZFVnzZgy2McB3PQ8MZ5Q9NjiElQEJpMoNOVySEIKnHfq6lEaHjojWcV/5MbKAqeFfohoxWJIUgAOVHkHQdaxQJCHJe5kfg0/HcNWzLn/phmmTbcSPGPq2BtCRAksv8RtlGP/YshpS0SeDqLYwSBKGG9UJLx6Pj2WvYkj9ERGQ0KXnsPNqMNlbsExrI9h7wjJ3OgIwiAc85i+xBx8Cv43lr2J4/dmomSWlTGq1jpBop9ukMVDZk0NyzVYiew/m5EarjuWgYEncfA40U+7AqXLbBarXq/mxqNRLzjhwCV+uA2/zdAxC4+/fC8esFLq+B/N0MCuEryNKkoUGC9KTiUyBN7O+bZgmpSJE0NEyaFwjUcUkaFpV+J8JgUP60M07sgwxkGwUQSsPYUezwMUqUR0nop5vBD1akCW73AlK/4sHV9hVvH5hLRfbm4RVaVt8ElHE8e7bDNvdc4OIBz8cLQCiN59bg21mWhhl2lTBTPk/kvQYYqMDHGwCh8Pxwg0/tUqS4L0WQ+gl1+xQfbwCucdkjH4o0wXqbQ+pXRHjwW1hflR2IuMNpp18g/b1vPf9ifQUBuPVFfx2XpmG2ucVeCAjP7yH5MyUDDGTwnguo54dG42bYrLfIAQhlThrt4vIawBs+Oux+bHhaRMM3sXF6KF7wJxcQviwBULz8QQ6XvvXrt+u4OA2LFL/3Aur5ET71+ubP1Aww0A2e6HRKkG1usQfKnnNYNzGo4a8vnYk2R7LdFrl8xKPXY+U0Rj62T7lamE7DDBvXGi2YAum91eUQc/6OyVZlkfkzyqs8dq4NoKXnxPoKAjm8a7Zy+ncyehUpkiR1zFMz/N0DYrxV5ddS9bL/+bPadkIda8c2HSfVcI2rlpG0N9kO27xdF3u7jvypYad7tkDgt/dI+RNVwyM67jN0lhjb6vjlb/B8xtrDKMub4Z+A+1R6NPZjtDzGoV2bm+V53WVVn44TaFjttZjj/exlDWkpSMjQ12s0yU8x2+/uzdKOfaDW+B3Xm8c+UBVwW2D1wzt2kgOY7S66y0CNxnIZSMtT03kZScdBGpa7/UJqUhIkpLTGl4p0YGPYNyfqcVQm8CT2DPMnykBVIvR/kJE27ua8g+4wUH30OXyvP3/wJvMIOkZqWL02BAi7+z/o/s0YOgw0w/wZbqDDdCj0Qeb1Nu3oNA3kaKzPBiqTJrg3/J63sU31oqZUpCRIKvvyqtQm6DmsBs3R5DgN8z/bvPJnmIF6r3u8FyCtJAmhgoZjo8SgqcK0lNPa0hDN0YeoYSAtB3RCFeE6RmlYf9+MbByHNZCS/ddAPdaiXevpueTPAAPVFmuzHQY8TFFEqBvIM1U4GqhrYTxnhk6n2kdcZ4FlxvwKrdplm3X5Koqr3Jphs7oF5rqBd/MEoqfJbvey2yKXGq++jYaXHba5hH6do1hdGLznAO7CzirSe1u2Np7tjpK3jwK4WcAOX5DdOtY9p1WVn0itMunR6VB86VW2Pic+T2+dR8hl6dLfQLV1jys4U5lrjqXlSeme4h4N9LM6m0Pc3r/psQWKJeVRTwN1bNJ1bdj9KLorSUub58dzmj+nnXB95C6PCd6YnZ4VEf9vbIYZCv9fOIaJgA3EMBGwgRgmAjYQw0TABmKYCNhADBMBG4hhImADMUwEbCCGiYANxDARsIEYJoL/AcboBoss8ru2AAAAAElFTkSuQmCC" alt="1547586904341"></p><ol start="3"><li>Calculate the output by activation function in the previous output.</li></ol><p><img src="data:image/png;base64,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" alt="1547586933870"></p><ol start="4"><li>Calculate the cost and lost function.</li></ol><p><img src="data:image/png;base64,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" alt="1547587606618"></p><p><img src="data:image/png;base64,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" alt="1547587697072"></p><div class="warning custom-block"><p class="custom-block-title">What’s the difference between cost and loss function?</p><p>Usually, they are used interchangeably. But in this case, I thought a cost function as an error on the whole data set as a scalar, but loss function as a single function on one example.</p><p><a href="https://www.coursera.org/learn/neural-networks-deep-learning/lecture/yWaRd/logistic-regression-cost-function" target="_blank" title="https://www.coursera.org/learn/neural-networks-deep-learning/lecture/yWaRd/logistic-regression-cost-function" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><a href="https://stats.stackexchange.com/questions/179026/objective-function-cost-function-loss-function-are-they-the-same-thing" target="_blank" title="https://stats.stackexchange.com/questions/179026/objective-function-cost-function-loss-function-are-they-the-same-thing" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>stackoverflow</span></a></p></div><p>Below you can find the example of calculating the output of the 2 layers neural network defined before. You can change values and play with weights on the network.</p><div class="deepnn"><div class="mw"><div class="mx-row"><input title="0.5" size="mini" value="0.5" class="mb"><input title="0.5" size="mini" value="0.5" class="mb"></div><div class="mx-row"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"></div><div class="mx-row"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"></div></div><div class="mx"><div class="mx-row"><input title="0.1" size="mini" value="0.1" class="mb"><input title="0.2" size="mini" value="0.2" class="mb"><input title="0.3" size="mini" value="0.3" class="mb"><input title="0.4" size="mini" value="0.4" class="mb"></div><div class="mx-row"><input title="0.5" size="mini" value="0.5" class="mb"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"><input title="0.8" size="mini" value="0.8" class="mb"></div></div><div class="mz1"><div class="mx-row"><input readonly="readonly" title="0.3" size="mini" value="0.3" class="mb"><input readonly="readonly" title="0.4" size="mini" value="0.4" class="mb"><input readonly="readonly" title="0.5" size="mini" value="0.5" class="mb"><input readonly="readonly" title="0.6000000000000001" size="mini" value="0.6000000000000001" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.41" size="mini" value="0.41" class="mb"><input readonly="readonly" title="0.54" size="mini" value="0.54" class="mb"><input readonly="readonly" title="0.6699999999999999" size="mini" value="0.6699999999999999" class="mb"><input readonly="readonly" title="0.7999999999999999" size="mini" value="0.7999999999999999" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.41" size="mini" value="0.41" class="mb"><input readonly="readonly" title="0.54" size="mini" value="0.54" class="mb"><input readonly="readonly" title="0.6699999999999999" size="mini" value="0.6699999999999999" class="mb"><input readonly="readonly" title="0.7999999999999999" size="mini" value="0.7999999999999999" class="mb"></div></div><div class="mw2"><div class="mx-row"><input size="mini" title="0.1" value="0.1" class="mb"><input size="mini" title="0.2" value="0.2" class="mb"><input size="mini" title="0.3" value="0.3" class="mb"></div></div><div class="ma1"><div class="mx-row"><input readonly="readonly" size="mini" title="0.574442516811659" value="0.574442516811659" class="mb"><input readonly="readonly" size="mini" title="0.598687660112452" value="0.598687660112452" class="mb"><input readonly="readonly" size="mini" title="0.6224593312018546" value="0.6224593312018546" class="mb"><input readonly="readonly" size="mini" title="0.6456563062257954" value="0.6456563062257954" class="mb"></div><div class="mx-row"><input readonly="readonly" size="mini" title="0.6010878788483698" value="0.6010878788483698" class="mb"><input readonly="readonly" size="mini" title="0.6318124177361016" value="0.6318124177361016" class="mb"><input readonly="readonly" size="mini" title="0.6615031592029523" value="0.6615031592029523" class="mb"><input readonly="readonly" size="mini" title="0.6899744811276125" value="0.6899744811276125" class="mb"></div><div class="mx-row"><input readonly="readonly" size="mini" title="0.6010878788483698" value="0.6010878788483698" class="mb"><input readonly="readonly" size="mini" title="0.6318124177361016" value="0.6318124177361016" class="mb"><input readonly="readonly" size="mini" title="0.6615031592029523" value="0.6615031592029523" class="mb"><input readonly="readonly" size="mini" title="0.6899744811276125" value="0.6899744811276125" class="mb"></div></div><div class="mz2"><div class="mx-row"><input readonly="readonly" size="mini" title="0.3579881911053508" value="0.3579881911053508" class="mb"><input readonly="readonly" size="mini" title="0.375774974879296" value="0.375774974879296" class="mb"><input readonly="readonly" size="mini" title="0.3929975127216616" value="0.3929975127216616" class="mb"><input readonly="readonly" size="mini" title="0.40955287118638584" value="0.40955287118638584" class="mb"></div></div><div class="ma2"><div class="mx-row"><input readonly="readonly" size="mini" title="0.5885533447669059" value="0.5885533447669059" class="mb"><input readonly="readonly" size="mini" title="0.592853675444023" value="0.592853675444023" class="mb"><input readonly="readonly" size="mini" title="0.5970040807235782" value="0.5970040807235782" class="mb"><input readonly="readonly" size="mini" title="0.6009806609022761" value="0.6009806609022761" class="mb"></div></div><div class="my"><div class="mx-row"><input readonly="readonly" size="mini" title="0" value="0" class="mb"><input readonly="readonly" size="mini" title="0" value="0" class="mb"><input readonly="readonly" size="mini" title="1" value="1" class="mb"><input readonly="readonly" size="mini" title="1" value="1" class="mb"></div></div><div class="ml"><div class="mx-row"><input readonly="readonly" size="mini" title="0.8880759021818458" value="0.8880759021818458" class="mb"><input readonly="readonly" size="mini" title="0.8985826383577421" value="0.8985826383577421" class="mb"><input readonly="readonly" size="mini" title="0.5158313302300179" value="0.5158313302300179" class="mb"><input readonly="readonly" size="mini" title="0.5091925231638667" value="0.5091925231638667" class="mb"></div></div><input readonly="readonly" size="mini" title="0.7029205984833681" value="0.7029205984833681" class="mj mb"><img src="/deepnn/deepn.png" alt="Deepn Network" width="780" height="475" class="image"></div><div class="language-python extra-class"><pre class="language-python"><code>    <span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> torch<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>        
      
    <span class="token keyword">def</span> <span class="token function">loss_function</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>yhat<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token operator">-</span>y <span class="token operator">*</span> torch<span class="token punctuation">.</span>log<span class="token punctuation">(</span>yhat<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token operator">*</span> torch<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>yhat<span class="token punctuation">)</span><span class="token punctuation">;</span>
   
    <span class="token keyword">def</span> <span class="token function">loss</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> yhat<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Binary classification logistic loss </span>
        <span class="token keyword">return</span> torch<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>self<span class="token punctuation">.</span>loss_function<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># m - number of examples</span>
        <span class="token comment"># (3 X 2) * (2 x m) = (3 x m)  </span>
        self<span class="token punctuation">.</span>z1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>self<span class="token punctuation">.</span>W1 <span class="token punctuation">,</span> X<span class="token punctuation">)</span> 
        <span class="token comment"># (3 X m) activation function</span>
        self<span class="token punctuation">.</span>a1 <span class="token operator">=</span> self<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>z1<span class="token punctuation">)</span> 
        <span class="token comment"># (1 x 3) * (3 x m) = (1 x m)</span>
        self<span class="token punctuation">.</span>z2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>self<span class="token punctuation">.</span>W2<span class="token punctuation">,</span> self<span class="token punctuation">.</span>a1<span class="token punctuation">)</span> 
        <span class="token comment"># (1 x m) final activation function</span>
        yhat <span class="token operator">=</span> self<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>z2<span class="token punctuation">)</span> 
        <span class="token keyword">return</span> yhat    
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Neural_Network</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>Neural_Network<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># parameters</span>
        self<span class="token punctuation" data-v-54601d22>.</span>inputSize <span class="token operator" data-v-54601d22>=</span> inputSize
        self<span class="token punctuation" data-v-54601d22>.</span>outputSize <span class="token operator" data-v-54601d22>=</span> outputSize
        self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize <span class="token operator" data-v-54601d22>=</span> hiddenSize
        
        <span class="token comment" data-v-54601d22># weights</span>
        <span class="token comment" data-v-54601d22>#self.W1 = torch.randn(self.hiddenSize, self.inputSize) # 3 X 2 tensor</span>
        <span class="token comment" data-v-54601d22>#self.W2 = torch.randn(self.outputSize, self.hiddenSize) # 1 X 3 tensor</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.3</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>/</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>+</span> torch<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>        
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_function</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>-</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
   
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># Binary classification logistic loss </span>
        <span class="token comment" data-v-54601d22># Special case of cross entropy </span>
        <span class="token comment" data-v-54601d22># (http://wiki.fast.ai/index.php/Log_Loss)</span>
        <span class="token comment" data-v-54601d22># nn.BCELoss()</span>
        <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># m - number of examples</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X 2) * (2 x m) = (3 x m)  &quot;.dot&quot; does not broadcast in PyTorch</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>a1 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X m) activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>z2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x 3) * (3 x m) = (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z2'</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span>
        
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m) final activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A2'</span><span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>return</span> yhat    
    
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

NN <span class="token operator" data-v-54601d22>=</span> Neural_Network<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.4</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.7</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.8</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'X:'</span><span class="token punctuation" data-v-54601d22>,</span>X<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Y:'</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span>

Yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#or NN(X)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'L:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'J:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h3 id="gradient-descent"><a href="#gradient-descent" aria-hidden="true" class="header-anchor">#</a> Gradient Descent <a href="https://towardsdatascience.com/gradient-descent-algorithm-and-its-variants-10f652806a3" target="_blank" title="https://towardsdatascience.com/gradient-descent-algorithm-and-its-variants-10f652806a3" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>When you know how to calculate your result is time to update weights to get the best result in your neural network. For this you need to use Gradient Descent. This algorithm is use the fact that if you want find the minimimum of the cost function you can use derivative of the cost function to recognize the direction how to update weights and the value shows how much to update.</p><p>Let’s assume that you have only one weight (w), so the cost function J(θ) you can present in a 2D plot. (on the x axis weight, and on the y axis J(θ)).</p><p><img src="data:image/png;base64,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" alt="1548179188819"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAAtCAYAAAByBT9fAAADjElEQVR4nO2bsbKiMBSG/+zso6DFHZ8gPAF3m1tte7tYarPdlnY2oYRu261us+EJLk/AWBjeJVtAEBVUSMRrJt+MMw4hITk/OZxzRKKUUvA8Pd8ePQGPHbyQjuCFdAQvpCN4IR3BC+kIXkhH8EI6ghfSEbyQjuCFPKNEFi8RhgSEEJBlZnf4bFmNS0KEyxhZWdoZV1lDKsGZooBC/aFMKGnvAvdH8nr+VDFx55lLoTit7cTNr2VJSKEYrQzAtQG0UZiwc4m7IxvDTjdlfU2qTLW0IGTfZPRxpp5CymY3TjtfyamVXWn8jCzjd6xzgPI/WAVdZxTYW3oMTAJ9wezRcxiBoZAZtuscAMPvbhWfj3wH+eg5jMBIyDLeIAVA+S9EZ60SuxwAFpg/g8bBHAsAnR6kiTQJSBjjtLmMQxBCEMbtlgxL3YcQ9AW/sjISFoZGMhCyxL+/OQCKnz86JlHuUYwf/EDbiIM+IeJBLj3CGwOAHLvTLRklkIJV3zt2rBbjdLxEclS9GN7O73QAJfYFAFC8GPrz7+O76h2XYz0jWPedZvrMiRIolZiMYIUgegNDivSsJcNHfTDfSQDHN3WBPo/VxoLXGh0mCVbliz2xumD2cqQpkOJauiQUQ0d0ru3Q1Vew61Fw3Z9ys5x7tJCXw2a96ClzsrHIGxPzrjSrOkY5r9ZLeUsM3XaDPE3qM95exkJ2Xri5S58kh1SHHUkvWFJ7meaUZsfVIreFFOxE2N5BG0/wkB15tqiONitute26Bn2GV0uqeff3O15z5XWq76fFj3bbJewVTQyCnR7KGJsUsJZbTh7s1FFrx9RnLxRAjmJfIvt4RUo5ZAQAAeYLAHmdumxfkTIBdTnCwSFgNGd0+lEt6pQS8fsaOQAmkiuR2lfjeioQzKtME7stNikF/7Nq9Nb22G1DvBYcMrll9TNU3VJ8mP7IMnov6wd08xyQTxepHqMDtAturuXmT9eoY4ahLt2WzcyK5pLXv3rUk6FM3fvXn7txdmMOPKdJI4YZwFbR3OwZGayQfK7w+HR9IoIVPtWqu+3BhQv/hoBG11onLpp/gVqra+haq4XA42Z0ea+vFjsAI8fsHIcy3BSvejCLbyT4HXlEhERJCL5AsZnd9+Wr2QbFgkNIhZsylSsQpfwfXV3A70hH8EI6ghfSEbyQjuCFdAQvpCN4IR3BC+kIXkhH8EI6ghfSEf4Dd1cE1syEVzsAAAAASUVORK5CYII=" alt="1548137149402"></p><p><img src="data:image/png;base64,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" alt="1548137409720"></p><p>Where your whole function to calculate the final cost <strong>J(θ)</strong> is:</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWsAAABFCAYAAACMl8eKAAAOa0lEQVR4nO2dP0wbyRfHv/x0xZYut/RJgHwRBSVaGpeQNFyDuAqqIVfFKSJRREInRfJJFFkqhBsuFXdpoImdjjSY62gifGItQUc66KB7v2J37LW9f2bWa3YX3keyhMx6/GY8852ZNzNvpoiIwDAMw+Sa/2VtAMMwDBMPizXDMEwBYLFmGIYpACzWDMMwBYDFmmEYpgCwWDMMwxQAFmuGYZgCwGLNMAxTAFisGYZhCgCLNcMwTAFgsWYYhikALNYMwzAFgMWaYRimALBYMwzDFAAWa4ZhmALAYs0wDFMAWKwZhmEKAIs1wzBMAWCxZhiGKQAs1jp0W9hcnMLibjdrSxiGeWawWKvQbWF3cxFTMy/RaGdtDMMwzxEW6zi6u1hcPwZWPoGaImtrGIZ5pvyUtQG5Z/oNTk+9v1uZWsJo8PDwAMMwsjaDyQl3d3colUpZmzEWPLJmngwPDw/4888/8fPPP+Ovv/7K2hwmR/zxxx/45Zdf8Pfff2dtSmJ4ZM08Ca6vr7G8vIzr62tsb2/j9evXWZvE5Ih6vQ7DMPDbb7/hn3/+weHhYeFmXjyyLhDd1iYWp6YwNbUId0NKF63NRUx57216bprurnzueexcubu7w/LyMn78+IHz83NsbW1lbRKTMwzDQL1ex8nJCb5+/Ypff/0VDw8PWZulxaOI9b///ou3b9+Onc7bt2/x7du3FCx6ZLq7PfHUffkFeP1yBZ+oCYE2Pn9pYXdzB3h3CvLea3zYxe7mJr7MvsMpObAtoF3befKu9t9//x3//fcf6vU6KpVK1uZkTlrtrQjoakK1WsXr16/x9etX2LY9QcsmAE2Qs7MzqlarVCqV6OPHj2Ont7e3R6ZpUrVapfPz8xQs1KQpCABZtpPgoyAACp93Bp4VzZGUSAAEWNRPRr7nf94h2wLBsknf2jj63weAMGpkIE7TJmFF5d8hW1j9dGGRJZqR9p+fnxMAWlhY0M5FPtEvA0na7a0IJNGE+/t7Mk2TDMOgm5ubCVvYx7EtgiXIbiZrkepi7QmV/xUlOp1Oh0qlEq2trdHt7W1Ewg41bUGWP92Iynl7e0sbGxtUKpWo0+kom58Gjm31xCmBXPsETlC0vAWJr/xXQIfh2G75DTzspaEopPp4nUFghxL2rBVRUeUzguQjTtPLF6zQ79jY2CAAdHZ2ljAfeSJZGRDptLc84lBzoIMaaiOyfvs6MH/1T6IJHz9+JAC0vb2dem6ikAOWJIMovZG1T7CjhPrm5obK5TJVKhW6v7+PStA13N+IA4VnkPv7e1pYWKByuUxXV1daWdCnL0qjrzjRHcLf4cUonBxdDz/mdhiDlVWmO/CsV45JZgGquDYO2TL6lNtpxFXOsN9dlllAed3f31OpVKJSqZTA+hySoAyIdNpbvunPKPudle+fPaEWAR2+riZcXV0RAKpUKilZr4OvU9b4lJ5Y93q46C9ZW1sjwzBiejnfaMsJej/6O66ursgwDFpZWdHKQrYMCn+kXgcJMMkKPVg2QQIeKOqpIkf/Ub+TTqUMS89NI6jTOTw8JAAFqwNR6JcBkWp7KwBSkAM6djmrjWozuppQLpcJQEblpjiI8ZFsZB1RYjc3N2QYBi0tLUUmJQt/tAKGifgocgo8+dF1ivindNpToSDXRrBvOkjUU0XmIyoPuj5+hfrlZ21tjQA8Lf+sZhmotrdiENJZadQjHU2o1WqZuEIkKh2QHy2xltOUqEKr1+sEgA4ODqJSihiVqYt1q9UiAFSr1RRzkA96vm9dN0WgayNOwF1/YOqu69gGlGyqp1LHJKZpEoBsFptHcH+HNNxOOmWg1t4eg3TyPyJgCm5RPzqacHR0RAAy7Oj0RtcaYq22oFSpVAhA5CJH+KiaSG167SJ9lqZpKuUgP/gXGzVcFRq+aUcu2lpRi3rJCfOpD9ulvsApF5ksshQXLmWHFzqK8q8RREytAzs/FVfVkP1RrgrVNHTLILK9FS7/NDRj018k19GEk5MTAkDz8/MJ7JTrbSFteGBDRriWqa37uGiItZqIAogpqJiRs6JfXCL9TrKyNm1BQsS87Ik5B9SJaUj5Jn72E90hjzzcE3b36fi6JheI4nafOr1yHk0rdATr2GoDBscmyxJeGbhl4uqKK7qqW+56aWmWAVF8eytM/vuJ9uqWlXDXxLAmhCHrkP5gr0nC8hZBFfzsUZ2NTjvR37oXUXidTkdhhXVoj27YS/FHqlarvkWCqJ0b+mlPmuj91HkmfvoWO/KWhPi+4yrx2dkZASDDMNRsHREeXz0c3XKjvpPGaZLtCZMtQJZwZzSWsEd3NISmkawM9NpbjvM/nGTPTZhszWVQE8K5ublR6vCjCe9UlXzSGmsUylaq9ADSX1StVhMbp+OvIyJaWVkhANRqtZSezxe+BpOTDkSJ2Aqmuu4Q8VzMAqb0N5bL5ThjAw4R0eDMJnCrnJ5Q9AVG1+2UvAyU2lvu8z+Skm/AlUysdTQh1pWmQNjApCkU2rXKQr2H4nHzLr58dqPuz81Ohz51d3cXn9LldwCA9WIm4L8tHDcQ+z1+ZNhDle9WIcmR8OGXOstY8UJkW6uvoJZjAK3NgaPoj030b6hBawe1NgDxHm/CMt++gBPwtvrvPYMX1vB7Xex+aMCybQgA+H6J7sj/3mFZIfWud3vQ+sUqbAEIexUXH9ax2epCKSrLxMsg5/kforU5g1pbQAgAaOA4QR1PWxPimPEK+PulL8fdXXxoAOL9G/V2HYOiWDu4aAOAhaj2WS6XAUApQEqgGLeO4Wq1wIpKTYEbbQ0ATNNU+0AM5M42xnop4/2gsGx8Cm2po7SOG4j7LSaH7LgtrL4arxq2vJ45UPSnZzEHAPiOy4BWL+taPNOYnQOANi6k4rV2UGsLvH/zalTIWjuoQfH36O5iff0YL947ON1/g1kAmH2D/dNPWLncwfpmK1aw0iiD6PaW7/wPJreIlw0LtrOPfW8U00ig1kk0YZxY19NuAaN90e9Su18+o23ZeKeoY0oojfMVh+rSBxQ1NY3yZeq6QIiI5ufnfdOYIvmsk21tmxje6nZ82escholyg8TsLopZaJb+WpUqPFjnXPvlQtjgb+D/ny5JdkOMVwYq7Y0oz/kfMHKoHNR3hQ0zqAnhyAXG+HWPGIb10bHJUt3lpeEGUYpn3f3yGW0AmJuNHNKbpgnDMPDjxw/NLgP9USYE3muMMuVUR44yZlcFxFzMh15E5+MxcKd7gGjuK003J0a3hd2dD6h5l0taq3HPX+I7AFgvED6w90ZzbW80F1nYwTOEXp0TK4Hl4x81xd0C4k5T2/h+2UXr+CUalg1n2W+nN3LdeYmGaIIS/SDe7DOu/AJJXgYq7S33+e/uYvFlAxBN7Pe+23URNhoNHLf2saxh07AmxD039qx8+hVWrRranrvK2amhLZo4VREZ50JJWwGojayVV/aJaGFhIXIlNniFVCcoUB/ZMybaJ5klmqfURj6nOfsIRW69ajrqp8QUbVdZkA6vVyGLYkMYhqG2OCTzJsTIiEceyxfCymTGNW4ZxLU370tym//InUUKO9CG0dEEuc96JGJjgvYp90sLYWnNBlLeuqd+opCoH68h9AjnyLDfSeT+IOqf3irWcWPV6V3wiTDdI6rqZiURa4eathX8GZVDMf5pvkzCafbqW1we5XT35OREzeaI8pxsHJUIxiyD2PZGlOP8xwzSfMGbVG3T0YSDgwMCQGtra8Hfq9HI/KeSddpmuodiNA+pyFixkXs/Hdt3+gdkWSLRnsyFhQUyDKNAkcY0Or7Qk4nBAZr8lSXyFVaTlOMv+NcF3AhowZ9Q9Mk7TRLWoO2qe3S3t7cJAG1tbcWYHOEXHCNGeWqMUQaq7S13+R84AQjCsAb0QsP265qKiTqaILf4HR4eDv4jycw30Ww57ePmCYyQjWhvb0/5M7rIXjG2oeYInSlP2Ahaae9mEibRaCcsBHKRsXBusJR5jPZWBHQ0QR5LDxJ2/dlrsos+Ug7klMyXTDTZsI2dTqd44VE1Vn37x32Hy32CFwpMRFgnv+NFJRbNc+DJhElNiK4mSH/1iAtEuh8T+Kv1mk6qIVJdf2SihTBye66lpSUyTZOOjo60Px/G0dERmaZJS0tLBXR/6L9ULxR4PDeILvqVUgc5qizWukX6TKq9FYEkmiBDqQ67QJywNZjAZ/TW83wppHX5gP8IdPCtDDocHBxQuVyOORKrRrVapXK5PPFwkE5TXjNm9YLU9K8d6i/6OL7ryFR2Pei/HvFCgYm6LFSu9UrG7e1tJvfp5ZU021sRSKIJMq5MUvfZYHvWCz/cu6bN0p9tTvTCXD9p3JEXu+qfAo4tyLKbvfCMlt0kW8jFj/4o0Rby4svHO9ziF2unKVIV1vHul1T8Du/+ubS9OHt7ewQ8pRtjxudp3EkZTxJNmJ+fJ8MwEsZB982SdTdGNMUjXZj77MjDLeJD9HbmWCRSEeoU75fMGP/OkOK4x5jH5Pb2tne70MgOkALAYh1Gbm4RZ1Q5ODigUqlElUolJ7fHMHnh5OSETNMk0zQLGqFTOere88ONLDcUrMg7Gir8Uaa849djR6BjxmZjYwOdTgfr6+vJQh4wT5br62vU63VcXV1haWkpa3MSoRQb5DniXLQBCPiDA0oB9+uyG7/Bgj1mBDomHUzTxNbWVtZmMDljY2MjaxPGhkfWgXhxtQcC6HihQa1VDA622wDmoBh+m2EYJhEs1kEEuja8qGID0bG6cAfbLzCDLlqbi5ldCMAwzNOGxToIzzc9N+gDCRDwabxaFbDaNcwsruNy5ZMvxCPDMEx6TBHpXG3CMAzDZAGPrBmGYQoAizXDMEwBYLFmGIYpACzWDMMwBYDFmmEYpgCwWDMMwxQAFmuGYZgCwGLNMAxTAFisGYZhCgCLNcMwTAFgsWYYhikA/weuvlLKvGLsRgAAAABJRU5ErkJggg==" alt="1548137505581"></p><p>Your gradient will be a derivative cost function on your weight.</p><p><img src="data:image/png;base64,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" alt="1548137519406"></p><p><img src="/assets/img/1548138648303.18d18150.png" alt="1548138648303"></p><p>If your gradient is positive, this means that the plot is increasing, so we have to subtract the value of the gradient (go to the left). If your gradient is negative, this means that you need to add the value to your weight (go to the right).</p><p>In your final neural network, you have more dimensions, and it is impossible to show it on the single plot.</p><h3 id="backpropagation"><a href="#backpropagation" aria-hidden="true" class="header-anchor">#</a> Backpropagation</h3><p>When you know how to update weights, it is time to calculate the gradient for your neural network. You need to find the gradient on your weight, but the problem might be your equation that is little more complicated.</p><p>Let’s look how you calculate your final cost.</p><p><img src="data:image/png;base64,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ynxjfLMV+3qQ3GZ5SicrAEaariKbNlc4BopTWaj1Abe62dEDaMin0rC5oCSR55599lkAwIULFwJOiXtmZmYAAM8991zAKSEiok6dPHkSGxsbOHbsWNBJccXZs2exvLyMiYkJxOPxoJMTeoODgzhx4gSWl5ehKErQyfGAjtvGau+QZJQqZTh9ucfi4iLOnTuHoaEh5PN511NYr09chcCTwtOdEHW1N/sQtmvo818u49t/mg46GT1tY2MDjz32GO7fv49bt25teeVZFC0vL2P//v3o7+/H9evXbfcS+3YuhvA6JIocH64j1k/hcODAASwuLuLKlSs4ePBg0Mnp2OrqKp544gnEYjHcvXvX0QhmmM7FY68O4/QXX/N1n88//zwuXLiAEydO4OTJk76/rjSszp07h2PHjqG/vx9Xrlxx3MHjtCz9f884EVEPiMViOH36dNeMPhw7dgwbGxs4ffo0K2wioohTVRX9/f04evQoFhcXg05OR1ZXV/H8888DqB4P6yZnzp8/j1OnTkFRFBw4cKD9++d7wPPPP4+jR49idHS0o0C8EwzGiYg8cvjwYZw8eRILCwu1YDZqzM6E1157DadPn8bw8HDQSSIioh2Kx+O4du0aEokEDhw4gJdeeilSddS5c+fwxBNPYHV1FVeuXMHg4GDQSYqkEydO4O7duxgfH2dnBoAnn3wSt27dwuzsrG+PPDAYJyLy0Msvv4zZ2VksLCxg//79kRqBWFxcxP79+7GwsIBLly55/twUERH5J5FI4Nq1a5idncXVq1cjNTJ68eJFnDp1CtevX2cgvkOJRAL5fJ7BOICJiQkMDAz4us9dvu6NiKgHHTlyBIcPH8bZs2exsrKCoaGhoJNky40bN5DL5TAxMRF0UoiIyCNHjhzBkSNHgk6GI6qqBp0EIlcwGCci8kEsFovcyDKDcCIiIiLvcJo6ERERERERkc8YjBMRERERERH5jME4ERERERERkc/4zDgRERER+eKhB3fh818uB50MIjz0IMMgCh7PQiIiir5dceDNvqBTQRRtu7x/r+6lqX/o+T6IoubBDz+EY68OB50McsGDH37I0fcZjBN1IY48UFj4NvKQXvNnP0RERC779//svwSdBApIn/huXOCD+0Gngyi6dsUZCBARERERkSP/HxgTuqUH4LmFAAAAAElFTkSuQmCC" alt="1548183708290"></p><p>In backpropagation, you need to go back from right to left and on each step calculate derivative to update the previous layer.   For this you use the <strong>chain rule</strong>: <a href="https://en.wikipedia.org/wiki/Chain_rule" target="_blank" title="https://en.wikipedia.org/wiki/Chain_rule" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><p>In the <strong>chain rule</strong>, you can calculate the partial derivative of the composition of two or more functions.</p><p><img src="data:image/png;base64,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" alt="1548140736187"></p><p>For example in your neural network you if you want to calculate new weights on your first layer and the second layer according to the <strong>gradient descent</strong> you have to calculate partial derivative on your cost function.</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAABFCAYAAADqzTvdAAAKPElEQVR4nO2dP3KrPBfGH755l2JukckKxAqc26Rym04u7eZ2Lt2lgTLu0rpKE7ECs4KMi4i96CsAmxjx12Bs5/nNMHNvLBCRw8PR0TlHjjHGgBBCRuB/Y98AIeT3QgEihIwGBYgQMhoUIELIaFCACCGjQQEihIwGBYgQMhoUIEIuRRxi7nlwHCc5vDmCuO8uAsw9B94ZF44DL7m3sOebs0ABIuQCxIEH5+UDz+87GGNgtIKMNli6nl2EwvlRqNKjWlRiBJ4D92mLh5XGbjEpbRcGc3j5685D5K88WeygVw/Yr104XoBBZcgQQoZF+0ZAGnX6cyUNAANZ+OTn54ARvq7oQBkJGAjfVLUyRhkpYABhfKVz91Z2D9r4Aga2e+8JChAho1EjHJk4VApAU5HI2gnzU8vqzm8qbt3gFIyQsYn20Laf6z0iAJDPmJadG75iGQHC/1feBkAcvKTt3mGfnX3h2zrXmuKfL4BoidewooOOUIAIuVLCjw0AQDy4JS1iBOsNAIlVqc8HAEK8LqMG7exMFitIAJt1//4gChAhl8C2AhZ+V52A76/kX49/SkQj/sQ2QrWFBCAO1tigzErS2EcA8IiyboApniWAaIvPnhWIAkTIwMSBB8d9wgYzKG2SVbD3B+yfltgAgHhA0cbJhEHiuURd4s8tIlRZSAAQ43MbARCY/bUoTPyNrwa/g/sgAETY9qxAFCBChiScw02cL9C7BaaZBkwWiVUBAI9/UJCG8KNCnBJ0olDlFlLSKhWyCEvXKSztO+4y8TNV9AMAkz+PAIBob/VWdYYCRMhgZD4aQK4WBZFJrAq7BROn8y8x+1sUp/TaSROBSgMoEzKpEsvr5FCpCJb3c7hZCAD4+u7VD0QBImQo0hUqCB//LNOocgsmmzbVWTf1HITMqlIhUj/32f10hQJEyEBUWzHZw2/z8WTTphrrpgVWgcmsowo/09BQgAgZiEofzWFqZFnByhzDYgab37jLPdg4LPPXxBANyQ0JUJrD4gVoGg8VBx68eYAL5NTdEBzHayB5+AV8y9wsW92yOqcPTJD4hSN08gvHAdapBdYoNigLiqy8pw4MEF09AEm4uPBV+3Bw7RshhClLt/ldcBwvifaFPY+rJgdMyST/q26sS69vafPzWln6RX0fbfrqwg0IUPbQVPziOkmyK22jfSMKOTC/DY7j5SnmUWmV5neV5laV5WzZmlYlkp60OfSnDwLXRkySc/r/7q9fgJQsT5TTyvhSNMoY1r4YLKHuJuA4joPOMtDTQwgjqyzQRgmoh8bNElG1/+MehJBGtfoCh0tIvXIBSgfYpvDaN0LIpKxAatJWv91/89ub43gz1JXoKGnf99Qoj30a1w/XLUDp26D2F2/0JTSYgtwrHMcbob1vZviaPVdajiMMvJOwbltlt6RKm+M4mJ8uucTBj6ps1opveo+ot1iIZNWg71Dyc+E4koQYYVoyA1LhrfG6+ASLnYLEBk+9Vy+MEXhP2EBC7YqR3H3QWYCmi90hjBsQ8PWuWGckiwS1MVng/XgBCF/hvUOpgNb0HEp+LhzH306IuePAcVw8bQGpNExz9UmZ4s1o+FjCdbxeajnHYQDPcbGEhDJvg8UJnRUHlOWy2AOmjnkwZUyy/BLh430xLShsEklaVSbgPuA4/mameMtys3Y7vE27fkkTLHYGWs2wX7tFS7kN4Rzueo+Z0jC74cQHOFOAsgxZK/EntpGAEFVNtogg4L/bzbvk+mWV2u4HjiPpi8l0gbedaTGFszB9g9m9YdFZDJszWCR0+LpEJFdYlT5baZU2uSopETkQfUdyDgzHcSySqdE529uQeoYRoDjAemMPM88I56lzq0qq3QeIBqHmWdJftNcVfokk+a+6eNOVwXFsRhwimJfst5Vtb9PaQeviocLqJD1x1hpaIcoyQcljHIM1rDw9r34ptyJ+JbdkWTwsS5Jd4ldy26K0O1r2c+/jOCRKHsbuuNOMSO+9RVRxcmISE6WNycYlGTJtlBRGyA4pLKSS/gXo5A/U9uAo2SKuoCqCt9WtXnEEL8exGyXCfYh7krJ9AF0aFS6kMr6EETIROCH9ltHDpAm9C1D+rX34f/4N1DQo7tjJ+YFv1/bWPoXj2IGqoL00eO6MCOEs+vfHJn6kd/oVIMsf6M8HJ/2jaf0GvfMs7nsdxyGnsGXWT9Jx5+hdnSXkSt/4Ekb6vpFCGKl07bW6/a73cXTlzFSMn1/06VvbmJMHR8n2/pED2ihfGiH8xtMI7YsbMZ05jm2pLA/R2jrMnZflxZlkzA8+IF/SBzQA/QlQiXl+fHCqHKFXyqWc0Pc+jgNQVTOnaT2dapjzdgn+Q098vi4RSYVdWXDI5yuWkYTajVX8sQPTNxjzdtEu73Ice+e4aV/xo6zS37m5b2ld5tk51yC1nKdfR2df2Vs/exvhDIfg/cNxbIvdytHGl75RvjhjivobuJ5p+JkClIshqSkvOVy5gHuA49iaXN2cxC+vjBTJ2PyoX5P9nGKUcl0LOr0JUNlN9TMfv3c4jl1Q+SqOeQex9o/L8BSfHNdXlve6C5IRcutoZaQ4CiUOkdYjcIVleW9oWx5Cbos48OC8fOD5fZeU29AKMtpg6f4sOneRonRZWRfrPmQBvJcP4PkdJldbqozJ3xlEtMVnH3m6PYgYIeQU7RthszZKaj4ffXwl05tcSIi1tHfuc6t/50rL8tICImQIJgvsbJUEp8+QQKGi5NBF6a61LC8FiJAxiPbIP75DF6UbhB7K8lKACLly+ihKd61leSlAhAxFHGLunRRKC79bXqOfonTXWpaXAkTIAMSBB8d9wgYzKJ0WnX9/wP5piSRT5AE/3DGZD+eEzPopLbebpp4I/9+gxeOt9FCWlwJESN+Ec7jLCBA+9G6BQ233yQLP2Sp3k4e3ifXzukQk/PqtmK60LC8FiJBeOa5YyVXRIZytdjV5eO3WT24lK7V+bP0UmPzFTACbD9t+PccYIzfbgG7zBNdx4DhzFM6Iv/EFgVlxua41FCBC+iTbRFL4sBkuep884I913uBa6ydG8JJYPxUGUo4JFisJbD6KgpLuKWaM7SiGEsSfW0TWcIH2UIAI6ZFsCiNmfy1WSTJ1ASSeT5/qyR/kF7lqfT/hK5ZRy2X36T/4YoP1OVsNxQFeluhtub+3ekCEkBoLJ/xIHNC2dIg8mfWjK6yf9QaQquVecBMsdhrwXHhQ9oDFmvvyXrZ4VJbtwztCC4iQCxF+bABUO5WBrChdhfWTFaXrtP1pIkIrfODFCyzTMTtx4MF7BVbvu/N2XT3l7GQOQsiB0lrVJTlguQa/sigdLSBCemSyWEECiLafh2XsOAzgPW2SZflS8yG3E2vtNtsSq4vuwz0cFCBCemWKN60gsUyXsR246y0efQW9a+a4lQUP9cnnypLkeqM4xhgz9k0QQn4ntIAIIaNBASKEjAYFiBAyGhQgQshoUIAIIaNBASKEjAYFiBAyGhQgQsho/B8TEP9NlViCBQAAAABJRU5ErkJggg==" alt="1548193684435"></p><p><img src="data:image/png;base64,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" alt="1548193713633"></p><p>By using <strong>chain rule</strong>, you can calculate partial derivative based on the partial derivative on each function.</p><p><img src="/assets/img/1548194181907.8e75351c.png" alt="1548194181907"></p><p>You can go from the right to the left and calculate the error on each step, and next propagate this to the previous layer and update your weights.</p><div class="warning custom-block"><p class="custom-block-title">Hadamard product <a href="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)" target="_blank" title="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><p>Sometimes you will see ∘ instead of ∗ in the multiplication between matrices. This sign is a Hadamard product, and by this, you multiply two matrices with the same dimension by multiply each part of matrix themselves. For example if your f(x)=x*(x-1). The matrix calculation wouldn’t be multiple two matrices but Hamarad product of this.</p><p><img src="data:image/png;base64,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" alt="1548182006468"></p></div><p>Below you can find an algorithm for a matrix with <strong>m</strong> examples .</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA1MAAABlCAYAAACoc7mxAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABqxSURBVHhe7d0/bPPG+cDxx7+l2fpuzfgO1ovUeId0K6glY+x3qCc3m9tFymYvL5ACBroY6OAh0tTKS+upgJe4g8Ux6CClWzoYTvCKQNqp7dR2Sjf97jnyJEoiJYr6R1LfT8DoNSVRJO94vIe8Ox4MDQEAAAAALOX/olcAAAAAwBIIpgAAAAAgB4IpAAAAAMiBYAoAAAAAciCYAgAAAIAcCKYAAAAAIAeCKQAAAADIgWAKwAYE4rebUj9oih/NAQAAqBqCKQBrFfhtadZrcnJ5K/1oHgAAQBURTAFYj8CXdrMutet7kddeNBMAAKC6CKYArIV/cy3Pp3cy7PWk07mSRjQfAACgqgimAKzFcccEUceH0V8AAADVRzAFAAAAADkQTAEAAABADgRTAAAAAJADwRQAAAAA5EAwBQAAAAA5EEwBAAAAQA4EUwAAAACQA8EUAAAAAORAMAUAAAAAORBMAVi7oH0tt/Zft/LgB/ZfKIe//e1v0b+KpajrhWJYJX+UOW/tw3HBsY+iI5gCsB5+Uw4ODuxUu+xHM004dVIL59eb0iauKiytsPzyl7+Un/zkJ/MrLyad6zad61tNz1/96lfy4x//WP7whz9Ec4D15Nsy5q3M210BHPt7YkfnlrUYAhX0/fffD3/7298OX758OfzHP/4Rzc3uk08+Gf7iF78YfvPNN9EcoGy6w4Yp4rWYt1OjG82fpceKfubTTz+df7x0G0Mvvkzxhq1B9N4WfPHFF/aY/vDDD4f//ve/o7nYnsk85W0z8ROsM9+WKW9l3u4K2X36FCvvxw26rWHDK9Y6LS3DMTpoeUPxGsNWt3jbSTBVEd1GmAHn1JdKajBsNcwBFDvAPLOR8w4l3/eH77//vi10v/zyy2jucrSwvry8HL733ns2sALKyRw/5iQ7r2zQSoq+//nnn0dzUgxa4clOT2aDgTmBu5Nfw1QztkePTa1Uffzxx/aiCbbPnW92WXnbRL4tQ97KvN3WYNht6fZu9xjdlCKkTxHy/pgr303gMTfAKHg+WOIYdYGjeK259cBtI5iqApPx9ODWqVrBlCsozAEVHTV6IIUHmZe4rV9//fXwxYsXawuAdHkaUOkVQKCMwpN/8h2kr776yubv09PTaE6K6GQ3cyFj0A1PbFs+Sbv15rjcDXuFWPPDjiqUm8y3Rc5bmbfbGFU67fmyoJXoHHadPrvO+2PRnbIFQUXh80Guc0usbhjN2TWCqdKbvPVcqWDKXa2Y3igXPE7N/+677+wdqQ8++GCtV61+//vf29/7zW9+E80BysKVD8knHa2UacVkfrMZPXHpxYu0U7Ze9fS2XrnQZrh6XOpxj+3adYVy0/m2qHkr03abSqhtzaHbPmrVUZ1gSu0yfYoRTGUIJkqRD1Y5t2QLJreFYKrk7FVnk5lalWzml1YRDAuS6QNMr1TpPthEPydtVqAnsX1pn46KGDWfmD3haF7WPK15u4y0Oa8e79ocF9u1ywrlNvJtEfNW1u3umorzuHI6/2JKWe0yfQoRTEUXlOetwz7kA5cWRaj3MppfmflNObn1pHV3Ia+iWdVyLB0TLerw2idNP5xlHcpFbyi9i8Pob5H//Oc/dqSfn/70p/LBBx9Ec9fn5z//ufzvf/9jNCGUy+BZdFxF7+yNOWom/e53v7N5WvN2GX300Ufy4sWL0XZgWb40Dw6kXrJhs7aRb4uYt7Ju93GnJ53j6aO9WlZPn3Lm/VAg7Wt98EhDrmJ1oGn7kA8OL67MXjA1xOu22Su7VflgKtChFuvhcM0H9fEOt/PtEIw6PzZkc2AOMvf5g7pM1OELxaznya14rTuZczyV33FHwnjqZG7Bp0GOFqo/+9nPojnrdXp6Ku+995602+3CnFyBRfyH8Glfr1/NFhJ//vOf7atWTFJNlYczh6ApR8P3dGqaUmkJKy5bj0e9eKLH41/+8pdobsVscv9LTY686J/rZta73azH1s1UXPU8m/rMucBsSn18Tk6aovP3NvJtEfNWpu0ui52nTznzvhU8yr1eIWucynE4p5zWUrYdy6nWD/v38pi2e7clukNVSQMdvaQRdmob3w4cTNz+dPO1/40dQST6vHkjbB6zzG3R2EAQy03LDy8cdiofr1v4d/UGoNC00v3jRR0o07bPnGDs+wub+C1Mo/S0MIW3/Yx2gAWKz7WrT87TOiqW5uf0/hfdYcMzZYx+1x03Cc0F42VodutZtus7of0al7LFsjq/Dex/Pa/ZEbPsHzZ/hF8Ly9qZTuAp3G8mNjMy6+qalkanWfMF3ZZwH85+J5ZPx1+wfSWStnlb+TZ33tqQxdudxOwL3cZCNe/aUfpUIO+rub+fqmj5YD15QOXbH+u3N32mwmBDK+UaSEUzlUtITYzJN4rbxjRa5/jqVi6Yig0+ER4i89NDB53Q7V/Up8nlg+lhRN3+m3dAusL7j3/8YzQng1j+Wm7aZqUN1RQdMwknKaX9LzSvZZN+/LmTWf6yJ/+yP/vsM/t+9QeHWeP+jzqm6/lO+9p6jbAC6DViFcAF0iswc8rp0QXKqbLNlZEzG5B8MWBb+bZoeWu57XbmpEchbDl9Sp73Vb66XpHzQf48YKXuw+3akz5Tgbx70te+yNmddBLvjTbkKvmNgvFt8z6TcVK2owKCttRrl9L3WjIwGxk2UDqWt6Z00f5T1zP3g8Onwav333/fviYL80Gj25OLWFtiv3kguktNATvRD2uattFW//znP+1rJscdPfvlmMw6Vrn5JjbPfzBHi/H61Ux/Kc3D2kTm5cuX0ZxFouYUZokPU+0tBs+mXDXH6tvc5VH+Zf/gBz+wr3//+9/ta3Wtcf8fHstFpyd3R9dyaTJI//ZJzroD6XUuZNUuFkH7OsxzSU2QDi/kym5DX+5jbXKC8OQs3lHNvo4dyqvX+tqX54GdsdV8W6S8tfx2l8WW06fEeT/k6rKezHyltFYs22pHZm8YT+/GTSF3YE+CqYFomtiAaaqG6voUeK23kweAq4gUrF1qeMB60pqbuwJp1xPaoJaCWfdzE0jpNt5dTFQCD9+c2YOmf/84cdDo4BN6opkfSKlw4Ip4EBq06zaQ0uC0tyA6/eEPf2hfq19xQxWkn6jDPgdKj52salEng6d3saMvaIv2hW5cTR6ry1p12e5CR2FMtPdfZkovt9e1/4Oor8L585m0TCWm0TqT5+tzafrBypURW/kxkvKcctvQn6whWrPzZiuOu8i3mfPWBtLcybPdK9vg9sRt89gvc97fiZLkgSLYj2AqeCc2X84ERuMMe/ZmMrnmVUR2x5ebSz1g+3JZm8y8NiAwbk/075rYj5WRfxOue+Mq/c5M/9mEx2MaSOWhgVRNf8wL74CVUTwPMC03VVsgj7aX8mzZprQCotMylbPD8FLpxIk/eLy3d5Az3xVJkXfZ//rXv+zrj370I/taGBu4I72W/W8qKOfnD3J0FV6Nt6PAvrqQTu9OTt/dyHnTX7lSuSw3IpcOMqSV2lAgfvvcngu82Llgm/l26by1wVYIebZ7ZVtqVbG19Cl53t+JgueBItmLYMominmdDYyiO1bemUzWN+ZXRFJtPIo/lk5ixh2GI94Zja6bV85mYqM7hUlB7OErCQ+5J4lfwNA7UnrlbqnmdyatRoFUL9uVj//+97/2tUgVt+l8wJR9qjZ3N/61JAzkZ7k7ua6J7ELTzSm0cnIpM3eQc8m5bFe5XLr505auuK7VOvb/4YX0ep2omXN4MTG8Gnwoxxcde3d+5bRcmjmvDVp2225PatF+rsnJvZ7PtOI7WZvaVr7Nnbc2ZOntLottpU8F8n5lbfLcsiV7EUy5268zwwOn9ilYXBFJRP+YFbk7hQlppdwdxoR0cSeaTAGVOVDrYds+6WYMpFSuk2sZK20oP3eseEeSdm/d5ePMFyEO38iZnvGiO8P+zaX013XlNOeyv/32W/vqjv/MylhWr33/u/Pc+sxryqSSm0L50jy/l7PB1L7uJT8nZ1v5Nnfe2pClt7ssdpI+5cz7Zmel9KUquVXKtuhZikl9g7dpD4IpX8KbHQ05nQryU5vyFbS/1P5Ibifs7jAmpYs70SxsBqGBlA5uYX6jNegslb65Cm8CbOxChhOMe/jnn/70J/u6mDuRP8lDU/saNqSbduXUXUTI/KC+JZYd0Sv0f/3rX+1DuvWZM9W3/D6aL2zpMG/QnWW5fq1ye51wMWh8Lo73Xbb9gDWzZqwcbjTfRoqYt5bf7rLYRfqUM++rxP5FpZe/bCtMlxxTcas2NyRlwvDAqUNMTgy1GI75PzlsetG4YTSThussl/RhP93wmclDhuvwqPq9+cOkpi/D/u6cNNZne+jQtCaQGn7//ffRXKCgksqwqUyv+Vjz88uXL6M5i7mhapOP0Zgcw9VmXnbEHfOff/55NKf6lt1Hm+LK6aT0Ha2je46MndkdnaOmvxLfpsRp9Gyg0EbzbaSIeWv17U44cRZEmdJnl3nfij02Jqsy5INl84ATpkdyvXCbqh9MpZ7U5427Pw5ONJEarWwPc9sNtx2xaZmcWDSj5zEkFUZTzwiL0edLabCjD9ZNNn5uw/Qy9GHNut/m7TZ9MKB+5vLyMpoDFNlUGWYOpqQyTPOzfsb3/WjOAlmDpBzB1DLf0Yrlhx9+aI/5vbq4kWe/rlU8X0VT0sM2u61hw5usKOoDU5PrcQnLnJkmK0sby7dGkfNWpu1225o2JVXQd60U6VOMvD/+TlLdNaZs+SBX2RbVf1OepbhN1Q+mUD4meJopjDI8VM89VPebb76J5owtvAI0U2BN+vjjj23hveihwECZ6B1XfeC1XvFenLejk3iGE5c73rKfF7MvW/3617+2y9eLHPtjuX1UFmFeSSl/9VwQldHxvLSpfKuKnLeW2+6y2N9jP0/et6LAo+wtkcbylW3Ln2c2h2AKlaFB1IsXL+zdqXVesXJ3pbQQLwdt1qVPdl9w5arSosI5OhlNTvMD533z3Xff2aZDH330ka2spcnenCKsBCzTNHqZphpffPGFTcf5TXqrpyjNWdYqQ5OltArT+vNtOfJW1u0ui7099lfI++PzWzXO8fnKtuLclVIEU6iUr776yt5BWldzPA3QdHmffPJJNKfYwiYGWjBVp6DNJyxoG7HS2Z2YqnM1b320gqaVM73i7foh6P4K95U7cWc72Y2/ly7PsvVYPD09tRdM9qGfVN79XyoZKpTzKlrryrdly1tJ210WHPuRFfN+0YKJZaxetrnvFaeOQzCFytH25Fro6snm66+/juYuR+9s6dUvXY4W4kVrOz9D+5U1TLDgecOGvmohu7aCJiq4ylRoazOI2Pq6fnFhAY40X375pT1utAlReCJ3U3p/xTzyLPuzzz6zx2QVrsZnscn9XxyuUqTH5nTf5IHZB9kugKyab8uat+LbXRYc+8468n4sGFnUD6JAVinb9IKxDUK1H1o0rwgIplBJWuhq4Zu3bbn2v9K7UXqnqwy04B2P0uPaWlcjmNKrWOOCd86UViLn6ti678Yn+omRqdZik8uuin3aR1Gz5Kl+slrJytJXdhJ5q9hIn0nryfuuRUo5TnEr5AF7kbRRyMDxQP9nNgpAZfjSPDiRW30o8XC5Z2klC6Rdr8mltGSwxEOOC8E9V6zRlUFnF0+4BwAAVbYHD+0FUDyB+O2m1OsH4cNddao3xV/ncwhdIOWZIJBACgAAbADBFIDt0iDnoCYn9yJXd7apsQy6DZH+rZzc+NGHVhT40nSBlLubZn/XBGz2AwAAAKsjmAKwPfG7Rb2OHEe3iw5rR+LpP57eyeo3pzSQipo5jpolBuLf6O8eSc3+DQAAsDqCKQBbEkj73AQ0Jmxq3U32vQoe7818Ee/szcrN8fymBlLqVk5cE0K9E2ZmrmP5AAAADsEUgJDfHPdfmphqcqmRTv9Saonv16Wd5XZS8Cj3upzGlVzYiCaQIPCl3axLzfyA12jJXfjGSo47YdPBpKm3huUDAAA4BFMAQsedxABkOBxIS9vgadO8xPd7UXA0n7v7JLcnURBWk/Pza3mWM+kOTKDTKdlIgQAAYO8RTAHYisGzDaX0cU+jQKzX60nHBFGu7xQAAECZEEwB2IJA3j3pqydHjAABAAAqgmAKwBYcyqvX+tqX54GdMSFoN6WZqeMVAABAcRBMARUTtK9Ho9k9rPUpuKs5ftuyw5/fXrfHw5+7ASjuRU7f0NYPAACUC8EUUAWxkfh0ZDzn9qQWzq83s424t0mHF3LXbUlDYqMC6gAUp3cTz5wCAAAoi4Oh9gIHgFSBtOs1EwLpg3YZcQ8AAMAhmAIAAACAHGjmBwAAAAA5EEwBAAAAQA4EUwAAAACQA8EUAAAAAORAMAUAAAAAORBMAQAAAEAOBFMAAAAAkAPBFAAAAADkQDAFAAAAADkQTAEAAABADgRTAAAAAJADwRQAAAAA5EAwBQAAAAA5EEwBAAAAQA4EUwAAAACQA8EUAAAAAORQsWDKl+bBgRyYqelHs5AikHZ9xf3kN82+bpq9nmLR+yvymyatSehSIu0AAEAVZAymwiCl+HWfY+kMWuKZ/45q0azKCsRvN6UeBY8HB3Wpt9eZQGGwRYV3Q4J2LO3MVG+bPY4ysQHhBi8WAACA4ssWTAXv5GmXAYqteGastAyepe+dyZvD6O+K8ps1uX4+lbvhUIZmMjGk9C9PuCNXCiZQPb+Xs0GYdsNhVxr9Szlvby+c2sSdof252xReXDq5jf4EAAB7K1swdXghvWFPLnYSoATi39ybAOlIssRywbsnkdevpOKxlBx3htLrHI+28/DiShrm9enduirkh3LRMxV98xtYN9238ePpWE5N4vWfB9HfKDK/eSK3XksGXT3iAADAPlsYTIVNWQ6kPrpqHki7Wbfz7EXowJemNgdb4TPjecZEPxu9AlyTk9u+3naRmvns/GY1gTze98WbvoUW+31tDtf029JsjptV+W49YlfV3XZPXmkfr7OdRk2z0ra3Lsk3G8znR+szZ9pK0y/dx+43J9d35k7DRNM089l30Xxn0fsz2x1Py/C9pp++PoulL99uy9T+DNomzeJpmLpuuk5mXUy+CbcvYb1svo1/fzxNZKEkZr9d34o0TpcJXLPsy+hPNTquwvfsXZXbk/C7YaY183W70vZ/nmUuI1xG0vZsNO1ypJteyBj2Lip/wQYAAGQwXKg7bJiPNbrRX63GsDswrw0Zeq3WsNXqDs2fw0HLG4rXsv+e+xkx7818Rt8NxZcTGgxb3vj359N19YaxxekCh55Zf88sIJwdbs/oN7stu+z4uoWml+W+Fy3HLjd8f2JbGo1hw35GPx9f3mbN7rdFwv0qsW3U9Y8vw/492vHR50d/h/tjvM+WfX96nRevz7Sk9YstfvL9bmNi2e7zYT5YtG7T27IGUb7UQ1Cn+HovNru+dlun9vXEMu32j9d/ct+paJmxfTR5TORZZrpSp50ztf0AAGD/LA6mbKVvusIwW4FJq5xpEDOSUikafyReSYrEgpaFEtbVrtdEhXz6NyPTv6N/p23fwIRKjXhFU83uk23RyqM3J+hIlrAf5lWOk9Ih/vk875t3xgHr4vWZNpvnJiUFa6O8FV+fhesWVsg3l7RRhT/rDyTul/g6Lpm2VsJ3Vl5mukqk3YL8CQAAqm9xnyk7oMNUf6XgUe77nrTeumZJgWhXpYlmStFnzkafMbP0Q/JaXrn2MfYzDRl/bSDPfe3yFGtAs8SAEsHjdN8qXx60+dRVrEnOzG9GDl+ZNeuL67bi3zzH1j1czqgJ0/m5PBxdyWDYkdFiZvbJPNPNklKmDM38Ar8p5/dncrfpZkeaDvG0m7bofasvl7X4Np7IbWyfr2xqhLzapclMI4fy5syT/v2j3adhXonnqxXXbZVmfjoKpYku5PYh1jxtz+wq7VZKNwAAsO8W95kyUYR39mayoj5dcU4KUGaCoLA/k4m4RgHIdPATtK9NJWhyOfr7WQeUGJhIbGJdE0Yh9G8upwIuJxwE4PbB1KBMxe7h6O14gIBoOS03+lqvJ52L8eAPVqZgwokGd4hG4kudFgVIGkhdH8UCKV+am6oB1o7MHniS1PEtFr1vxfZhbFrLGBdaGa9dyuvueLmDlhe9GbKDdPQv5cYP8+JEkL3quh13Zr7rptKO4bGtUTx3mXZVTDcAALA1C4Kp8I6TiWXsHRBXT7cBTiwoCgMnDVACaUcDO9jPyLOEF4cDU+8/l0sTcHVjNRQNfpyg3ZZHE4zIxHLC3w8HlAifq5T+KCW3rocT66pXrcMr1Pp9EyTpPzU4MxW45tQoArUjU4F7epDmjcjb+NCFo7tW7vO6PTqQRfSnMbNPNk0roNciV7GAK/AfTDA6ltRxP7doH9w/RkvT34+PDb3w/Tdy5vXl8mZDwd4MX24m7m6oKGA+qdm8OArat71uum8m0sXk93AEilH+mZt2x6fSMCl9EsuAboS58Mboobwyh5K9MGCZIDtpHO+ndzPLvz0ZD9BgL3aMLhDkX+byCpx2AAAAccMFbN8G8YaNsAOCMdV/QXUbQ9uZ3nP9B6L+FY1ovpm8RssO0jDBfW+i/0N8OTpL+yZNr0Oy2XU189z3dZlm9sD2c9D1cQNSxNj3pvtfhAat8bbMrkvCPtmo8PfCdZmaYp1D7P5I7UsVpVG8w8dUH5CZfi0ufeyk+1P/Hn9+4fuJ6+3eX7w+06bXb5xXdDLpaNJsZvuj9J/trzNv3dbf7ybMq7FpauHz006F6zT6/sxn4+8npEU8rexvu/0f/15SXyT3XpZlpqtU2tkpudwAAADVdqD/M5WB9dIr7zV9KOmunk2VT9Buys2rTkWa9+iQ0NdyVLI02LhS5M1dpJ3246vJ81WBm7eVtFwBAADVle2hvcua6S9VdNoEsC7n8rYy/SS0/9lT645K55TZwQuKh7RLVoa0AwAA+2UjwZTtP9S/t53Fi82NqncuD6/upFeh2uvhRa9S27Me0UOdpwdUKRjSLkk50g4AAOyXzTTzAwAAAICK20wzPwAAAACoOIIpAAAAAMiBYAoAAAAAciCYAgAAAIAcCKYAAAAAIAeCKQAAAADIgWAKAAAAAHIgmAIAAACAHAimAAAAACAHgikAAAAAWJrI/wOka6w0DtB3TAAAAABJRU5ErkJggg==" alt="1548182396033"></p><ol><li>Calculate the error on the cost function</li></ol><div class="deepnn-01"><div class="ma2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="0.5970040807235782" size="mini" value="0.5970040807235782" class="mb"><input readonly="readonly" title="0.6009806609022761" size="mini" value="0.6009806609022761" class="mb"></div></div><div class="my"><div class="mx-row"><input readonly="readonly" title="0" size="mini" value="0" class="mb"><input readonly="readonly" title="0" size="mini" value="0" class="mb"><input readonly="readonly" title="1" size="mini" value="1" class="mb"><input readonly="readonly" title="1" size="mini" value="1" class="mb"></div></div><div class="mdL"><div class="mx-row"><input readonly="readonly" title="2.4304487283618257" size="mini" value="2.4304487283618257" class="mb"><input readonly="readonly" title="2.456119433450796" size="mini" value="2.456119433450796" class="mb"><input readonly="readonly" title="-1.675030426572603" size="mini" value="-1.675030426572603" class="mb"><input readonly="readonly" title="-1.663947053635071" size="mini" value="-1.663947053635071" class="mb"></div></div><img src="/deepnn/deepn01.png" alt="Deepn Network" width="740" height="225" class="image"></div><ol start="2"><li>Backpropagate this to calculate the loss on the <strong>dJ/Z[2]</strong> layer.</li></ol><div class="deepnn-02"><div class="ma2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="0.5970040807235782" size="mini" value="0.5970040807235782" class="mb"><input readonly="readonly" title="0.6009806609022761" size="mini" value="0.6009806609022761" class="mb"></div></div><div class="mdL"><div class="mx-row"><input readonly="readonly" title="2.4304487283618257" size="mini" value="2.4304487283618257" class="mb"><input readonly="readonly" title="2.456119433450796" size="mini" value="2.456119433450796" class="mb"><input readonly="readonly" title="-1.675030426572603" size="mini" value="-1.675030426572603" class="mb"><input readonly="readonly" title="-1.663947053635071" size="mini" value="-1.663947053635071" class="mb"></div></div><div class="mda2"><div class="mx-row"><input readonly="readonly" title="0.2421583051305935" size="mini" value="0.2421583051305935" class="mb"><input readonly="readonly" title="0.24137819495653604" size="mini" value="0.24137819495653604" class="mb"><input readonly="readonly" title="0.2405902083229735" size="mini" value="0.2405902083229735" class="mb"><input readonly="readonly" title="0.23980290612373953" size="mini" value="0.23980290612373953" class="mb"></div></div><div class="mdz2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="-0.40299591927642175" size="mini" value="-0.40299591927642175" class="mb"><input readonly="readonly" title="-0.3990193390977239" size="mini" value="-0.3990193390977239" class="mb"></div></div><img src="/deepnn/deepn02.png" alt="Deepn Network" width="740" height="434" class="image"></div><ol start="3"><li>Backpropagate to get update for the second Layer <strong>W[2]</strong></li></ol><div class="deepnn-03"><div class="ma1"><div class="mx-row"><input readonly="readonly" title="0.574442516811659" size="mini" value="0.574442516811659" class="mb"><input readonly="readonly" title="0.598687660112452" size="mini" value="0.598687660112452" class="mb"><input readonly="readonly" title="0.6224593312018546" size="mini" value="0.6224593312018546" class="mb"><input readonly="readonly" title="0.6456563062257954" size="mini" value="0.6456563062257954" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div></div><div class="mdz2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="-0.40299591927642175" size="mini" value="-0.40299591927642175" class="mb"><input readonly="readonly" title="-0.3990193390977239" size="mini" value="-0.3990193390977239" class="mb"></div></div><div class="ma1t"><div class="mx-row"><input readonly="readonly" title="0.574442516811659" size="mini" value="0.574442516811659" class="mb"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.598687660112452" size="mini" value="0.598687660112452" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6224593312018546" size="mini" value="0.6224593312018546" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6456563062257954" size="mini" value="0.6456563062257954" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div></div><div class="mdw2"><div class="mx-row"><input readonly="readonly" title="0.1845463214020981" size="mini" value="0.1845463214020981" class="mb"><input readonly="readonly" title="0.18644836043998914" size="mini" value="0.18644836043998914" class="mb"><input readonly="readonly" title="0.18644836043998914" size="mini" value="0.18644836043998914" class="mb"></div></div><img src="/deepnn/deepn03.png" alt="Deepn Network" width="692" height="595" class="image"></div><ol start="4"><li>We go further to update <strong>W[1]</strong>. First calculate <strong>dJ/dA[1]</strong></li></ol><div class="deepnn-04"><div class="mw2"><div class="mx-row"><input title="0.1" size="mini" value="0.1" class="mb"><input title="0.2" size="mini" value="0.2" class="mb"><input title="0.3" size="mini" value="0.3" class="mb"></div></div><div class="mw2t"><div class="mx-row"><input readonly="readonly" title="0.1" size="mini" value="0.1" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2" size="mini" value="0.2" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.3" size="mini" value="0.3" class="mb"></div></div><div class="mdz2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="-0.40299591927642175" size="mini" value="-0.40299591927642175" class="mb"><input readonly="readonly" title="-0.3990193390977239" size="mini" value="-0.3990193390977239" class="mb"></div></div><div class="mda1"><div class="mx-row"><input readonly="readonly" title="0.05885533447669059" size="mini" value="0.05885533447669059" class="mb"><input readonly="readonly" title="0.059285367544402306" size="mini" value="0.059285367544402306" class="mb"><input readonly="readonly" title="-0.04029959192764218" size="mini" value="-0.04029959192764218" class="mb"><input readonly="readonly" title="-0.0399019339097724" size="mini" value="-0.0399019339097724" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.11771066895338118" size="mini" value="0.11771066895338118" class="mb"><input readonly="readonly" title="0.11857073508880461" size="mini" value="0.11857073508880461" class="mb"><input readonly="readonly" title="-0.08059918385528436" size="mini" value="-0.08059918385528436" class="mb"><input readonly="readonly" title="-0.0798038678195448" size="mini" value="-0.0798038678195448" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.17656600343007176" size="mini" value="0.17656600343007176" class="mb"><input readonly="readonly" title="0.1778561026332069" size="mini" value="0.1778561026332069" class="mb"><input readonly="readonly" title="-0.12089877578292652" size="mini" value="-0.12089877578292652" class="mb"><input readonly="readonly" title="-0.11970580172931716" size="mini" value="-0.11970580172931716" class="mb"></div></div><img src="/deepnn/deepn04.png" alt="Deepn Network" width="736" height="501" class="image"></div><ol start="5"><li>Next we calculate <strong>dJ/dZ[1]</strong></li></ol><div class="deepnn-05"><div class="ma1"><div class="mx-row"><input title="0.574442516811659" size="mini" value="0.574442516811659" class="mb"><input title="0.598687660112452" size="mini" value="0.598687660112452" class="mb"><input title="0.6224593312018546" size="mini" value="0.6224593312018546" class="mb"><input title="0.6456563062257954" size="mini" value="0.6456563062257954" class="mb"></div><div class="mx-row"><input title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div><div class="mx-row"><input title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div></div><div class="mda1"><div class="mx-row"><input readonly="readonly" title="0.05885533447669059" size="mini" value="0.05885533447669059" class="mb"><input readonly="readonly" title="0.059285367544402306" size="mini" value="0.059285367544402306" class="mb"><input readonly="readonly" title="-0.04029959192764218" size="mini" value="-0.04029959192764218" class="mb"><input readonly="readonly" title="-0.0399019339097724" size="mini" value="-0.0399019339097724" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.11771066895338118" size="mini" value="0.11771066895338118" class="mb"><input readonly="readonly" title="0.11857073508880461" size="mini" value="0.11857073508880461" class="mb"><input readonly="readonly" title="-0.08059918385528436" size="mini" value="-0.08059918385528436" class="mb"><input readonly="readonly" title="-0.0798038678195448" size="mini" value="-0.0798038678195448" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.17656600343007176" size="mini" value="0.17656600343007176" class="mb"><input readonly="readonly" title="0.1778561026332069" size="mini" value="0.1778561026332069" class="mb"><input readonly="readonly" title="-0.12089877578292652" size="mini" value="-0.12089877578292652" class="mb"><input readonly="readonly" title="-0.11970580172931716" size="mini" value="-0.11970580172931716" class="mb"></div></div><div class="mdz1s"><div class="mx-row"><input readonly="readonly" title="0.24445831169074586" size="mini" value="0.24445831169074586" class="mb"><input readonly="readonly" title="0.24026074574152914" size="mini" value="0.24026074574152914" class="mb"><input readonly="readonly" title="0.2350037122015945" size="mini" value="0.2350037122015945" class="mb"><input readonly="readonly" title="0.22878424045665732" size="mini" value="0.22878424045665732" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2397812407499373" size="mini" value="0.2397812407499373" class="mb"><input readonly="readonly" title="0.23262548653056345" size="mini" value="0.23262548653056345" class="mb"><input readonly="readonly" title="0.22391672956746583" size="mini" value="0.22391672956746583" class="mb"><input readonly="readonly" title="0.2139096965202944" size="mini" value="0.2139096965202944" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2397812407499373" size="mini" value="0.2397812407499373" class="mb"><input readonly="readonly" title="0.23262548653056345" size="mini" value="0.23262548653056345" class="mb"><input readonly="readonly" title="0.22391672956746583" size="mini" value="0.22391672956746583" class="mb"><input readonly="readonly" title="0.2139096965202944" size="mini" value="0.2139096965202944" class="mb"></div></div><div class="mdz1"><div class="mx-row"><input readonly="readonly" title="0.01438767570016593" size="mini" value="0.01438767570016593" class="mb"><input readonly="readonly" title="0.014243946617778747" size="mini" value="0.014243946617778747" class="mb"><input readonly="readonly" title="-0.009470553703205323" size="mini" value="-0.009470553703205323" class="mb"><input readonly="readonly" title="-0.009128933642299017" size="mini" value="-0.009128933642299017" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.028224810251146867" size="mini" value="0.028224810251146867" class="mb"><input readonly="readonly" title="0.027582574938319723" size="mini" value="0.027582574938319723" class="mb"><input readonly="readonly" title="-0.018047505654682168" size="mini" value="-0.018047505654682168" class="mb"><input readonly="readonly" title="-0.017070821146424515" size="mini" value="-0.017070821146424515" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.04233721537672029" size="mini" value="0.04233721537672029" class="mb"><input readonly="readonly" title="0.04137386240747958" size="mini" value="0.04137386240747958" class="mb"><input readonly="readonly" title="-0.027071258482023245" size="mini" value="-0.027071258482023245" class="mb"><input readonly="readonly" title="-0.025606231719636767" size="mini" value="-0.025606231719636767" class="mb"></div></div><img src="/deepnn/deepn05.png" alt="Deepn Network" width="641" height="660" class="image"></div><ol start="6"><li>The last step before update is to find the <strong>dJ/dW[1]</strong></li></ol><div class="deepnn-06"><div class="mx"><div class="mx-row"><input title="0.1" size="mini" value="0.1" class="mb"><input title="0.2" size="mini" value="0.2" class="mb"><input title="0.3" size="mini" value="0.3" class="mb"><input title="0.4" size="mini" value="0.4" class="mb"></div><div class="mx-row"><input title="0.5" size="mini" value="0.5" class="mb"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"><input title="0.8" size="mini" value="0.8" class="mb"></div></div><div class="mdz1"><div class="mx-row"><input readonly="readonly" title="0.01438767570016593" size="mini" value="0.01438767570016593" class="mb"><input readonly="readonly" title="0.014243946617778747" size="mini" value="0.014243946617778747" class="mb"><input readonly="readonly" title="-0.009470553703205323" size="mini" value="-0.009470553703205323" class="mb"><input readonly="readonly" title="-0.009128933642299017" size="mini" value="-0.009128933642299017" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.028224810251146867" size="mini" value="0.028224810251146867" class="mb"><input readonly="readonly" title="0.027582574938319723" size="mini" value="0.027582574938319723" class="mb"><input readonly="readonly" title="-0.018047505654682168" size="mini" value="-0.018047505654682168" class="mb"><input readonly="readonly" title="-0.017070821146424515" size="mini" value="-0.017070821146424515" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.04233721537672029" size="mini" value="0.04233721537672029" class="mb"><input readonly="readonly" title="0.04137386240747958" size="mini" value="0.04137386240747958" class="mb"><input readonly="readonly" title="-0.027071258482023245" size="mini" value="-0.027071258482023245" class="mb"><input readonly="readonly" title="-0.025606231719636767" size="mini" value="-0.025606231719636767" class="mb"></div></div><div class="mdxt"><div class="mx-row"><input readonly="readonly" title="0.1" size="mini" value="0.1" class="mb"><input readonly="readonly" title="0.5" size="mini" value="0.5" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2" size="mini" value="0.2" class="mb"><input readonly="readonly" title="0.6" size="mini" value="0.6" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.3" size="mini" value="0.3" class="mb"><input readonly="readonly" title="0.7" size="mini" value="0.7" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.4" size="mini" value="0.4" class="mb"><input readonly="readonly" title="0.8" size="mini" value="0.8" class="mb"></div></div><div class="mdw"><div class="mx-row"><input readonly="readonly" title="-0.0022051826743088613" size="mini" value="-0.0022051826743088613" class="mb"><input readonly="readonly" title="0.0018076713146672708" size="mini" value="0.0018076713146672708" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.0039035841421958244" size="mini" value="-0.0039035841421958244" class="mb"><input readonly="readonly" title="0.0043720392131481375" size="mini" value="0.0043720392131481375" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.005855376213293734" size="mini" value="-0.005855376213293734" class="mb"><input readonly="readonly" title="0.006558058819722202" size="mini" value="0.006558058819722202" class="mb"></div></div><img src="/deepnn/deepn06.png" alt="Deepn Network" width="651" height="607" class="image"></div><ol start="7"><li>The final step is to update your weights with new values, and calculate new loss and cost.</li></ol><div class="deepnn-07"><input title="0.1" size="mini" value="0.1" class="malpha"><div class="madw1"><div class="mx-row"><input readonly="readonly" title="-0.00022051826743088614" size="mini" value="-0.00022051826743088614" class="mb"><input readonly="readonly" title="0.0001807671314667271" size="mini" value="0.0001807671314667271" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.00039035841421958245" size="mini" value="-0.00039035841421958245" class="mb"><input readonly="readonly" title="0.00043720392131481377" size="mini" value="0.00043720392131481377" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.0005855376213293734" size="mini" value="-0.0005855376213293734" class="mb"><input readonly="readonly" title="0.0006558058819722203" size="mini" value="0.0006558058819722203" class="mb"></div></div><div class="mw1p"><div class="mx-row"><input readonly="readonly" title="0.5002205182674309" size="mini" value="0.5002205182674309" class="mb"><input readonly="readonly" title="0.49981923286853325" size="mini" value="0.49981923286853325" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6003903584142195" size="mini" value="0.6003903584142195" class="mb"><input readonly="readonly" title="0.6995627960786851" size="mini" value="0.6995627960786851" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6005855376213294" size="mini" value="0.6005855376213294" class="mb"><input readonly="readonly" title="0.6993441941180277" size="mini" value="0.6993441941180277" class="mb"></div></div><div class="madw2"><div class="mx-row"><input readonly="readonly" title="0.01845463214020981" size="mini" value="0.01845463214020981" class="mb"><input readonly="readonly" title="0.018644836043998914" size="mini" value="0.018644836043998914" class="mb"><input readonly="readonly" title="0.018644836043998914" size="mini" value="0.018644836043998914" class="mb"></div></div><div class="mw2p"><div class="mx-row"><input readonly="readonly" title="0.08154536785979019" size="mini" value="0.08154536785979019" class="mb"><input readonly="readonly" title="0.1813551639560011" size="mini" value="0.1813551639560011" class="mb"><input readonly="readonly" title="0.2813551639560011" size="mini" value="0.2813551639560011" class="mb"></div></div><div class="ml"><div class="mx-row"><input readonly="readonly" title="0.8880759021818458" size="mini" value="0.8880759021818458" class="mb"><input readonly="readonly" title="0.8985826383577421" size="mini" value="0.8985826383577421" class="mb"><input readonly="readonly" title="0.5158313302300179" size="mini" value="0.5158313302300179" class="mb"><input readonly="readonly" title="0.5091925231638667" size="mini" value="0.5091925231638667" class="mb"></div></div><input readonly="readonly" title="0.7029205984833681" size="mini" value="0.7029205984833681" class="mb mj"><div class="mlp"><div class="mx-row"><input readonly="readonly" title="0.8687608795922419" size="mini" value="0.8687608795922419" class="mb"><input readonly="readonly" title="0.8781937863190606" size="mini" value="0.8781937863190606" class="mb"><input readonly="readonly" title="0.5305700340917647" size="mini" value="0.5305700340917647" class="mb"><input readonly="readonly" title="0.5243942768254239" size="mini" value="0.5243942768254239" class="mb"></div></div><input readonly="readonly" title="0.7004797442071229" size="mini" value="0.7004797442071229" class="mb mjp"><button class="btn">Update W1 and W2 weights </button><img src="/deepnn/deepn07.png" alt="Deepn Network" width="661" height="671" class="image"><input size="mini" value="1" class=" mtimes"></div><hr><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Neural_Network</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>Neural_Network<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># parameters</span>
        self<span class="token punctuation" data-v-54601d22>.</span>inputSize <span class="token operator" data-v-54601d22>=</span> inputSize
        self<span class="token punctuation" data-v-54601d22>.</span>outputSize <span class="token operator" data-v-54601d22>=</span> outputSize
        self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize <span class="token operator" data-v-54601d22>=</span> hiddenSize
        
        <span class="token comment" data-v-54601d22># weights</span>
        <span class="token comment" data-v-54601d22>#self.W1 = torch.randn(self.hiddenSize, self.inputSize) # 3 X 2 tensor</span>
        <span class="token comment" data-v-54601d22>#self.W2 = torch.randn(self.outputSize, self.hiddenSize) # 1 X 3 tensor</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.3</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>/</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>+</span> torch<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>        
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_function</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>-</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
   
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># Binary classification logistic loss </span>
        <span class="token comment" data-v-54601d22># Special case of cross entropy (http://wiki.fast.ai/index.php/Log_Loss)</span>
        <span class="token comment" data-v-54601d22># nn.BCELoss()</span>
        <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># m - number of examples</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X 2) * (2 x m) = (3 x m)  &quot;.dot&quot; does not broadcast in PyTorch</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>a1 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X m) activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>z2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x 3) * (3 x m) = (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z2'</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span>
        
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m) final activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A2'</span><span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>return</span> yhat   
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># derivative of sigmoid</span>
        <span class="token keyword" data-v-54601d22>return</span> s <span class="token operator" data-v-54601d22>*</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>-</span> s<span class="token punctuation" data-v-54601d22>)</span>
      
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token operator" data-v-54601d22>/</span>yhat<span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>      
          
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>backward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22>#lr learning rate</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 1:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># yhat = a2</span>
        dL <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>loss_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># cost function dI/da2  (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dL:'</span><span class="token punctuation" data-v-54601d22>,</span> dL<span class="token punctuation" data-v-54601d22>)</span>

        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 2:'</span><span class="token punctuation" data-v-54601d22>)</span>
        da2 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#  da2/dz2 (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dA2:'</span><span class="token punctuation" data-v-54601d22>,</span> da2<span class="token punctuation" data-v-54601d22>)</span>
        
        dz2 <span class="token operator" data-v-54601d22>=</span> dL<span class="token operator" data-v-54601d22>*</span>da2 <span class="token comment" data-v-54601d22># dl/dz2 from the chain rule (1 x m) - the same as a2</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dz2:'</span><span class="token punctuation" data-v-54601d22>,</span> dz2<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 3:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># dL/da2 * da2/dz2 (*) dz2/dW2(T)  [a1]  | (1 x m) * (3 x M)^T = (1 x 3)</span>
        dW2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz2<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> 
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dW2:'</span><span class="token punctuation" data-v-54601d22>,</span> dW2<span class="token punctuation" data-v-54601d22>)</span>
        
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 4:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># dl/da1 = dz2/dW2(T) * dL/dz2 | (1x3)^T * (1 x m) = (3 x 1) * (1 x m) = (3 * m)</span>
        da1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>,</span> dz2 <span class="token punctuation" data-v-54601d22>)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'da1:'</span><span class="token punctuation" data-v-54601d22>,</span> da1<span class="token punctuation" data-v-54601d22>)</span>
        
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 5:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22>#  dz1 = dL/da1 * da1/dz1  | (3 x m) * (3 x m) = (3 x m)</span>
        dz1 <span class="token operator" data-v-54601d22>=</span> da1 <span class="token operator" data-v-54601d22>*</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'sZ1: '</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dZ1: '</span><span class="token punctuation" data-v-54601d22>,</span> dz1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 6:'</span><span class="token punctuation" data-v-54601d22>)</span>
        dW1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz1<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>  <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (3 * m) * (m x 2) = (3 x 2)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dW1: '</span><span class="token punctuation" data-v-54601d22>,</span> dW1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>

        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 7:'</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW1
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'alpha*dW1: '</span><span class="token punctuation" data-v-54601d22>,</span> lr<span class="token operator" data-v-54601d22>*</span>dW1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'W1: '</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW2
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'alpha*dW2: '</span><span class="token punctuation" data-v-54601d22>,</span> lr<span class="token operator" data-v-54601d22>*</span>dW2 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'W2: '</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
        <span class="token keyword" data-v-54601d22>return</span>      
    
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

NN <span class="token operator" data-v-54601d22>=</span> Neural_Network<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.4</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.7</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.8</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'X:'</span><span class="token punctuation" data-v-54601d22>,</span>X<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Y:'</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Forward:'</span><span class="token punctuation" data-v-54601d22>)</span>
Yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#or NN(X)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'L:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'J:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Backward:'</span><span class="token punctuation" data-v-54601d22>)</span>
NN<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>,</span>Yhat<span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span>


Yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#or NN(X)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'L: '</span><span class="token punctuation" data-v-54601d22>,</span> NN<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'J: '</span><span class="token punctuation" data-v-54601d22>,</span> NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h4 id="pytorch-implementation"><a href="#pytorch-implementation" aria-hidden="true" class="header-anchor">#</a> Pytorch Implementation</h4><div class="language-python extra-class"><pre class="language-python"><code>NN <span class="token operator">=</span> Neural_Network<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># random values from [0,1] (2 x m)</span>

<span class="token keyword">def</span> <span class="token function">fun_to_predict</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token number">1.0</span> <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0.0</span> <span class="token comment">#must be float</span>

Y <span class="token operator">=</span> torch<span class="token punctuation">.</span>t<span class="token punctuation">(</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>fun_to_predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> torch<span class="token punctuation">.</span>t<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">]</span>   <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment"># (1 x m)</span>
yhat <span class="token operator">=</span> NN<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot; Loss: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>NN<span class="token punctuation">.</span>loss<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># trains the NN 100 times</span>
  NN<span class="token punctuation">.</span>train<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span>

yhat <span class="token operator">=</span> NN<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; Loss: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>NN<span class="token punctuation">.</span>loss<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ypred <span class="token operator">=</span> NN<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
     
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Predicted data based on trained weights: &quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Input: \n&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Output: \n&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ypred<span class="token punctuation">)</span><span class="token punctuation">)</span>   
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Real: \n&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Neural_Network</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>Neural_Network<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># parameters</span>
        self<span class="token punctuation" data-v-54601d22>.</span>inputSize <span class="token operator" data-v-54601d22>=</span> inputSize
        self<span class="token punctuation" data-v-54601d22>.</span>outputSize <span class="token operator" data-v-54601d22>=</span> outputSize
        self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize <span class="token operator" data-v-54601d22>=</span> hiddenSize
        
        <span class="token comment" data-v-54601d22># weights</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>inputSize<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># 3 X 2 tensor</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>outputSize<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># 1 X 3 tensor</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># m - number of examples</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X 2) * (2 x m) = (3 x m)  &quot;.dot&quot; does not broadcast in PyTorch</span>
        self<span class="token punctuation" data-v-54601d22>.</span>a1 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X m) activation function</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x 3) * (3 x m) = (1 x m)</span>
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m) final activation function</span>
        <span class="token keyword" data-v-54601d22>return</span> yhat
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>/</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>+</span> torch<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># derivative of sigmoid</span>
        <span class="token keyword" data-v-54601d22>return</span> s <span class="token operator" data-v-54601d22>*</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>-</span> s<span class="token punctuation" data-v-54601d22>)</span>
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># Binary classification logistic loss </span>
        <span class="token comment" data-v-54601d22># Special case of cross entropy (http://wiki.fast.ai/index.php/Log_Loss)</span>
        <span class="token comment" data-v-54601d22># nn.BCELoss()</span>
        <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>-</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>

      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token operator" data-v-54601d22>/</span>yhat<span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>      
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>backward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22>#lr learning rate</span>
        <span class="token comment" data-v-54601d22># yhat = a2</span>
        dL <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>loss_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># cost function dI/da2  (1 x m)</span>
        
        da2 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#  da2/dz2 (1 x m)</span>
        dz2 <span class="token operator" data-v-54601d22>=</span> dL<span class="token operator" data-v-54601d22>*</span>da2 <span class="token comment" data-v-54601d22># dl/dz2 from the chain rule (1 x m) - the same as a2</span>
        
        <span class="token comment" data-v-54601d22># dL/da2 * da2/dz2 (*) dz2/dW2(T)  [a1]  | (1 x m) * (3 x M)^T = (1 x 3)</span>
        dW2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz2<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> 
        

        <span class="token comment" data-v-54601d22># dl/da1 = dz2/dW2(T) * dL/dz2 | (1x3)^T * (1 x m) = (3 x 1) * (1 x m) = (3 * m)</span>
        da1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>,</span> dz2 <span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22>#  dz1 = dL/da1 * da1/dz1  | (3 x m) * (3 x m) = (3 x m)</span>
        dz1 <span class="token operator" data-v-54601d22>=</span> da1 <span class="token operator" data-v-54601d22>*</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>  
        dW1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz1<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>  <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (3 * m) * (m x 2) = (3 x 2)</span>

        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW2
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW1
        <span class="token keyword" data-v-54601d22>return</span>
     

    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>train</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> lr <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># forward + backward pass for training</span>
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>saveWeights</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> model<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># we will use the PyTorch internal storage functions</span>
        torch<span class="token punctuation" data-v-54601d22>.</span>save<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>&quot;NN&quot;</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># you can reload model with all the weights and so forth with:</span>
        <span class="token comment" data-v-54601d22># torch.load(&quot;NN&quot;)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>predict</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>xPredicted<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>xPredicted<span class="token punctuation" data-v-54601d22>)</span>
        y <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span> <span class="token keyword" data-v-54601d22>if</span> y <span class="token operator" data-v-54601d22>&gt;=</span> <span class="token number" data-v-54601d22>0.5</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>for</span> y <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
        <span class="token keyword" data-v-54601d22>return</span> y
              

<span class="token comment" data-v-54601d22># torch.manual_seed(123) # set the constant seed for the random (JUST FOR TESTING)</span>

NN <span class="token operator" data-v-54601d22>=</span> Neural_Network<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># random values from [0,1] (2 x m)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>+</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

Y <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m)</span>
yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot; Loss: &quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>detach<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>  

<span class="token keyword" data-v-54601d22>for</span> i <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>  <span class="token comment" data-v-54601d22># trains the NN 1,000 times</span>
  NN<span class="token punctuation" data-v-54601d22>.</span>train<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>1.0</span><span class="token punctuation" data-v-54601d22>)</span>

yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;#&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>i<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>+</span> <span class="token string" data-v-54601d22>&quot; Loss: &quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>detach<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>  

ypred <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>predict<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
     
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Predicted data based on trained weights: &quot;</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Input: \n&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Output: \n&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>ypred<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>   
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Real: \n&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><div class="language-python extra-class"><pre class="language-python"><code>Loss<span class="token punctuation">:</span> <span class="token number">0.7505306005477905</span>
<span class="token comment">#99 Loss: 0.00372719275765121</span>
Predicted data based on trained weights<span class="token punctuation">:</span> 
Input <span class="token punctuation">(</span>scaled<span class="token punctuation">)</span><span class="token punctuation">:</span> 
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.5810</span><span class="token punctuation">,</span>  <span class="token number">1.3010</span><span class="token punctuation">,</span>  <span class="token number">1.2753</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2010</span><span class="token punctuation">,</span>  <span class="token number">0.9624</span><span class="token punctuation">,</span>  <span class="token number">0.2492</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4845</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0929</span><span class="token punctuation">,</span>
         <span class="token operator">-</span><span class="token number">0.8199</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4210</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.9620</span><span class="token punctuation">,</span>  <span class="token number">1.2825</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3430</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6821</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9887</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.7018</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7498</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.1285</span><span class="token punctuation">,</span>
          <span class="token number">0.4135</span><span class="token punctuation">,</span>  <span class="token number">0.2892</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Output<span class="token punctuation">:</span> 
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
Real<span class="token punctuation">:</span> 
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="do-i-have-to-implement-all-these-functions"><a href="#do-i-have-to-implement-all-these-functions" aria-hidden="true" class="header-anchor">#</a> Do I have to implement all these functions?</h3><p>Fortunately no. All gradient and backpropagation the only think what you have to set up in the Neural Network is:</p><ul><li>architecture of the network - How many hidden layer?, What are the activation functions on each layer?</li><li>Loss Function - How to calculate loss function in the Neural Network</li></ul><ul><li>Optimilization Function  - How to update weights. If you choose wrong you can finish in the local minimum instead of the better result</li><li>Learning Rate - Find learning rate to use in the neural network</li></ul><a href="https://github.com/jcjohnson/pytorch-examples" target="_blank" title="https://github.com/jcjohnson/pytorch-examples" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more examples</span></a><p>Let’s bring again the same neural network that we define in previous chapter. For all activation we want to use sigmoid function and for loss</p><p><img src="/assets/img/1547391156214.3d92b6e8.png" alt="1547391156214"></p><p><img src="data:image/png;base64,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" alt="1548182396033"></p><table><thead><tr><th>Name</th><th>Comment</th></tr></thead><tbody><tr><td><code>torch.nn.Linear</code></td><td>Simple Linear Layer in the neural network <a href="https://pytorch.org/docs/stable/nn.html#linear" target="_blank" title="https://pytorch.org/docs/stable/nn.html#linear" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>torch.nn.Sigmoid</code></td><td>Sigmoid activation function  <a href="https://pytorch.org/docs/stable/nn.html#sigmoid" target="_blank" title="https://pytorch.org/docs/stable/nn.html#sigmoid" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>torch.nn.BCELoss</code></td><td>Binary classification logistic loss <a href="https://pytorch.org/docs/stable/nn.html#bceloss" target="_blank" title="https://pytorch.org/docs/stable/nn.html#bceloss" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>torch.optim.SGD</code></td><td>stochastic gradient descent <a href="https://pytorch.org/docs/stable/optim.html#torch.optim.SGD" target="_blank" title="https://pytorch.org/docs/stable/optim.html#torch.optim.SGD" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr></tbody></table><div class="warning custom-block"><p class="custom-block-title">What’s the difference between stochastic gradient descent adn gradient descent?</p><p>Stochastic gradient descent (often shortened to <strong>SGD</strong>) means that you update set parameters in an iterative for each sample one by one. In Gradient Descent you get your whole data to calculate the loss and update your weights. <a href="https://www.quora.com/Whats-the-difference-between-gradient-descent-and-stochastic-gradient-descent" target="_blank" title="https://www.quora.com/Whats-the-difference-between-gradient-descent-and-stochastic-gradient-descent" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>Quora Question</span></a><a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent" target="_blank" title="https://en.wikipedia.org/wiki/Stochastic_gradient_descent" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p></div><h4 id="using-sequential"><a href="#using-sequential" aria-hidden="true" class="header-anchor">#</a> Using Sequential</h4><div class="language-python extra-class"><pre class="language-python"><code>inputSize <span class="token operator">=</span> <span class="token number">2</span>
outputSize <span class="token operator">=</span> <span class="token number">1</span>
hiddenSize <span class="token operator">=</span> <span class="token number">3</span>

model <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
          torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>inputSize<span class="token punctuation">,</span> hiddenSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
          torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Sigmoid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hiddenSize<span class="token punctuation">,</span> outputSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
    	  torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Sigmoid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

<span class="token comment"># define loss function, sinble Binary </span>
loss_fn <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>BCELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

inputSize  <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span>
outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span>
hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span>

<span class="token comment" data-v-54601d22>#define model</span>
model <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Sequential<span class="token punctuation" data-v-54601d22>(</span>
          torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>inputSize<span class="token punctuation" data-v-54601d22>,</span> hiddenSize<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
          torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Sigmoid<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
          torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>hiddenSize<span class="token punctuation" data-v-54601d22>,</span> outputSize<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    	  torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Sigmoid<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
        <span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># function for predict</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

<span class="token comment" data-v-54601d22># X, and Y</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span>  torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> X<span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (1 x m)</span>


<span class="token comment" data-v-54601d22># define loss function, sinble Binary </span>
loss_fn <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>BCELoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># define optimizer</span>
<span class="token comment" data-v-54601d22># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>optim<span class="token punctuation" data-v-54601d22>.</span>SGD<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>.</span>parameters<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss:'</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># print(loss_fn(YHat,Y))</span>
<span class="token keyword" data-v-54601d22>for</span> epoch <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  y_pred <span class="token operator" data-v-54601d22>=</span> model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
  
  L <span class="token operator" data-v-54601d22>=</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>y_pred<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>)</span>
  <span class="token comment" data-v-54601d22># Before the backward pass, use the optimizer object to zero all of the</span>
  <span class="token comment" data-v-54601d22># gradients for the Tensors it will update (which are the learnable weights</span>
  <span class="token comment" data-v-54601d22># of the model)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>zero_grad<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  L<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>step<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss #'</span><span class="token punctuation" data-v-54601d22>,</span>epoch<span class="token punctuation" data-v-54601d22>,</span><span class="token string" data-v-54601d22>': '</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h4 id="using-nn-model"><a href="#using-nn-model" aria-hidden="true" class="header-anchor">#</a> Using nn.Model</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">TwoLayerNet</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>inputSize <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> outputSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> hiddenSize <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">super</span><span class="token punctuation">(</span>TwoLayerNet<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment"># define first layer and second layer</span>
    self<span class="token punctuation">.</span>linear1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>inputSize<span class="token punctuation">,</span> hiddenSize<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>linear2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hiddenSize<span class="token punctuation">,</span> outputSize<span class="token punctuation">)</span>

  <span class="token comment"># calculate the output  </span>
  <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    h <span class="token operator">=</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>linear1<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>linear2<span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#define model</span>
model <span class="token operator">=</span> TwoLayerNet<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># define loss function, sinble Binary </span>
loss_fn <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>BCELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>TwoLayerNet</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>TwoLayerNet<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    <span class="token comment" data-v-54601d22># define first layer and second layer</span>
    self<span class="token punctuation" data-v-54601d22>.</span>linear1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>inputSize<span class="token punctuation" data-v-54601d22>,</span> hiddenSize<span class="token punctuation" data-v-54601d22>)</span>
    self<span class="token punctuation" data-v-54601d22>.</span>linear2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>hiddenSize<span class="token punctuation" data-v-54601d22>,</span> outputSize<span class="token punctuation" data-v-54601d22>)</span>

  <span class="token comment" data-v-54601d22># calculate the output  </span>
  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    h <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>linear1<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>linear2<span class="token punctuation" data-v-54601d22>(</span>h<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>

<span class="token comment" data-v-54601d22># function for predict</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

<span class="token comment" data-v-54601d22># X, and Y</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span>  torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> X<span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (1 x m)</span>

<span class="token comment" data-v-54601d22>#define model</span>
model <span class="token operator" data-v-54601d22>=</span> TwoLayerNet<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># define loss function, sinble Binary </span>
loss_fn <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>BCELoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># define optimizer</span>
<span class="token comment" data-v-54601d22># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>optim<span class="token punctuation" data-v-54601d22>.</span>SGD<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>.</span>parameters<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss:'</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>


<span class="token comment" data-v-54601d22># print(loss_fn(YHat,Y))</span>
<span class="token keyword" data-v-54601d22>for</span> epoch <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  y_pred <span class="token operator" data-v-54601d22>=</span> model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
  
  L <span class="token operator" data-v-54601d22>=</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>y_pred<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>)</span>
  <span class="token comment" data-v-54601d22># Before the backward pass, use the optimizer object to zero all of the</span>
  <span class="token comment" data-v-54601d22># gradients for the Tensors it will update (which are the learnable weights</span>
  <span class="token comment" data-v-54601d22># of the model)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>zero_grad<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  L<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>step<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss after #'</span><span class="token punctuation" data-v-54601d22>,</span>epoch<span class="token punctuation" data-v-54601d22>,</span><span class="token string" data-v-54601d22>' epochs: '</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h3 id="example-of-sgd-for-linear-function"><a href="#example-of-sgd-for-linear-function" aria-hidden="true" class="header-anchor">#</a> Example of SGD for linear function</h3><p>example of updating weights for linear function from the fast.ai course.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">%</span>matplotlib inline
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>basics <span class="token keyword">import</span> <span class="token operator">*</span>

n <span class="token operator">=</span> <span class="token number">100</span>
x <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 
x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>uniform_<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># (m x 2) (2 is a number of input parameters)</span>

a <span class="token operator">=</span> tensor<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># The parameters that we should find</span>
y <span class="token operator">=</span> x@a <span class="token operator">+</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># (m x 1)</span>

<span class="token keyword">def</span> <span class="token function">mse</span><span class="token punctuation">(</span>y_hat<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y_hat<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># mean square error</span>
a <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>tensor<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># unknown parameter for function y=x@a, (n x 1) = (n x 2) x (2 x 1)</span>

<span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y_hat <span class="token operator">=</span> x@a <span class="token comment"># uour testing, forward function</span>
    loss <span class="token operator">=</span> mse<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_hat<span class="token punctuation">)</span> <span class="token comment">#loss</span>
    <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>loss<span class="token punctuation">)</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># backward functions</span>
    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># with gradient we g</span>
        a<span class="token punctuation">.</span>sub_<span class="token punctuation">(</span>lr <span class="token operator">*</span> a<span class="token punctuation">.</span>grad<span class="token punctuation">)</span> <span class="token comment"># a.grad - gives information about gration, it will update a, i need to go oposite.</span>
        a<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>zero_<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># zero gradient</span>

lr <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span>
        
<span class="token comment"># ANIMATE</span>
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> animation<span class="token punctuation">,</span> rc
rc<span class="token punctuation">(</span><span class="token string">'animation'</span><span class="token punctuation">,</span> html<span class="token operator">=</span><span class="token string">'html5'</span><span class="token punctuation">)</span>

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">)</span>
line<span class="token punctuation">,</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x@a<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">animate</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
    update<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    line<span class="token punctuation">.</span>set_ydata<span class="token punctuation">(</span>x@a<span class="token punctuation">)</span>
    <span class="token keyword">return</span> line<span class="token punctuation">,</span>

animation<span class="token punctuation">.</span>FuncAnimation<span class="token punctuation">(</span>fig<span class="token punctuation">,</span> animate<span class="token punctuation">,</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> interval<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550262060215.5fbf0d44.png" alt="1550262060215"></p><h2 id="data-source"><a href="#data-source" aria-hidden="true" class="header-anchor">#</a> Data / Source</h2><p>In this chapter I want to brink some information how to get any data to learn, and how to convert them to be helpfull in the learning process.</p><h3 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h3><p>List of free resources for your own use.</p><p>How to get data and other sources of data for Data-Science and Machine Learning</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Medical Data <a href="https://github.com/beamandrew/medical-data" target="_blank" title="https://github.com/beamandrew/medical-data" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>link</span></a></td><td>List of a lot of medical data that can be used for Machine Learning</td></tr><tr><td>Kaggle Datasets <a href="https://www.kaggle.com/datasets" target="_blank" title="https://www.kaggle.com/datasets" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>link</span></a></td><td>List a lot of datasets for Kaggle competitions.</td></tr><tr><td>Archive DataSet from Wisconsin<a href="https://archive.ics.uci.edu/ml/datasets.html" target="_blank" title="https://archive.ics.uci.edu/ml/datasets.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>link</span></a></td><td>Archive Data-Set that help you to get data from Wisconsin Library.</td></tr><tr><td>fast.ai Datasets <a href="https://course.fast.ai/datasets" target="_blank" title="https://course.fast.ai/datasets" t-link="" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>List of datatsets for image classification/NLP processing</td></tr><tr><td>BelgiumTS DataSet <a href="https://btsd.ethz.ch/shareddata/" target="_blank" title="https://btsd.ethz.ch/shareddata/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>link</span></a></td><td>BelgiumTS DataSet with road signs classification.</td></tr><tr><td>Flower Datasets <a href="http://www.robots.ox.ac.uk/~vgg/data/flowers/" target="_blank" title="http://www.robots.ox.ac.uk/~vgg/data/flowers/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>flower datasets</td></tr><tr><td>Human 3.6ML<a href="http://vision.imar.ro/human3.6m/description.php" target="_blank" title="http://vision.imar.ro/human3.6m/description.php" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>3.6 million 3D human poses and corresponding images.</td></tr></tbody></table><h4 id="text-resources"><a href="#text-resources" aria-hidden="true" class="header-anchor">#</a> Text Resources:</h4><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Sentiment Analysis in Text <a href="https://data.world/crowdflower/sentiment-analysis-in-text" target="_blank" title="https://data.world/crowdflower/sentiment-analysis-in-text" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td><code>.csv</code> file with 40,000 text and defined emetions. (<code>sadness</code>, <code>enthusiasm</code>, <code>worry</code>, <code>love</code>)</td></tr><tr><td>EmoBank <a href="https://github.com/JULIELab/EmoBank" target="_blank" title="https://github.com/JULIELab/EmoBank" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>Large DataBase text with a score for each emotion (<code>Valence</code>-<code>Arousal</code>-<code>Dominance</code>scheme)</td></tr><tr><td>EmoInt <a href="http://saifmohammad.com/WebPages/EmotionIntensity-SharedTask.html" target="_blank" title="http://saifmohammad.com/WebPages/EmotionIntensity-SharedTask.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>Shared Task on Emotion Intensity, 4 emotions (<code>anger</code>, <code>fear</code>, <code>joy</code>, <code>sadness</code>). <a href="http://saifmohammad.com/WebPages/TweetEmotionIntensity-dataviz.html" target="_blank" title="http://saifmohammad.com/WebPages/TweetEmotionIntensity-dataviz.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>visualisation</span></a></td></tr></tbody></table><h4 id="tabular-data"><a href="#tabular-data" aria-hidden="true" class="header-anchor">#</a> Tabular Data</h4><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Movielens <a href="https://movielens.org/" target="_blank" title="https://movielens.org/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>Non-commercial, personalized movie recommendations.</td></tr></tbody></table><h3 id="data-download-google-drive"><a href="#data-download-google-drive" aria-hidden="true" class="header-anchor">#</a> Data Download / Google Drive</h3><p>If you use <strong>Google Colab</strong> you can easly mount your Gdrive in the filesystem. I also create a link for “My Drive”(<code>ln</code>), because it is easier to go to a folder without a space in the name.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Load the Drive helper and mount</span>
<span class="token keyword">from</span> google<span class="token punctuation">.</span>colab <span class="token keyword">import</span> drive
drive<span class="token punctuation">.</span>mount<span class="token punctuation">(</span><span class="token string">'/content/drive'</span><span class="token punctuation">)</span>
!ln <span class="token operator">-</span>s <span class="token string">&quot;/content/drive/My Drive/&quot;</span> <span class="token operator">/</span>content<span class="token operator">/</span>gdrive
</code></pre></div><p><img src="/assets/img/1550258836263.015bf78a.png" alt="1550258836263"></p><h3 id="data-download-google-images"><a href="#data-download-google-images" aria-hidden="true" class="header-anchor">#</a> Data Download / Google Images</h3><p>You can also download using google images search engine.  For this,</p><ol><li>Prepare folder structure for your classes.</li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

folder <span class="token operator">=</span> <span class="token string">'teddys'</span>

path <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">'data/bears'</span><span class="token punctuation">)</span>
dest <span class="token operator">=</span> path<span class="token operator">/</span>folder
dest<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1550259522813"></p><ol start="2"><li>Go to google images, find interesting search images, go to the developer console<code>ctrl+shift+j</code> and type:</li></ol><div class="language-python extra-class"><pre class="language-python"><code>urls <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>querySelectorAll<span class="token punctuation">(</span><span class="token string">'.rg_di .rg_meta'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>el<span class="token operator">=</span><span class="token operator">&gt;</span>JSON<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>el<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span><span class="token punctuation">.</span>ou<span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'data:text/csv;charset=utf-8,'</span> <span class="token operator">+</span> escape<span class="token punctuation">(</span>urls<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/1550259689567.acfd6857.png" alt="1550259689567"></p><p>This wll download you the file <code>download</code>, rename the file to <code>urls_teddys.txt</code> and upload to your path in the <code>jupyter</code> or <code>colab</code></p><p><img src="/assets/img/1550259797554.8541a8f9.png" alt="1550259797554"></p><ol start="3"><li>Download your files using <code>download_images</code></li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">'url_teddys.txt'</span>
folder <span class="token operator">=</span> <span class="token string">'teddys'</span>
dest <span class="token operator">=</span> path<span class="token operator">/</span>folder

download_images<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token builtin">file</span><span class="token punctuation">,</span> dest<span class="token punctuation">,</span> max_pics<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550259892436.c5ff2319.png" alt="1550259892436"></p><ol start="4"><li>The last step is to verify images. This will remove images that are corrupted or doesn’t have 3 channels.</li></ol><div class="language-python extra-class"><pre class="language-python"><code>verify_images<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'teddys'</span><span class="token punctuation">,</span> delete<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> max_size<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550260036514.03a398f5.png" alt="1550260036514"></p><h3 id="data-download-wget"><a href="#data-download-wget" aria-hidden="true" class="header-anchor">#</a> Data Download / wget</h3><a href="https://chrome.google.com/webstore/detail/curlwget/jmocjfidanebdlinpbcdkcmgdifblncg" target="_blank" title="https://chrome.google.com/webstore/detail/curlwget/jmocjfidanebdlinpbcdkcmgdifblncg" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>CurlWget</span></a><p>There is an extension for the chrome that you can get to generate wget command for your Linux command line. Just add the extension and after start downloading cancel this and copy the command to your console.  (or in the Jupyter Notebook with exclamation character “!”).</p><p><img src="/assets/img/1549318371426.cc27e832.png" alt="1549318371426"></p><div class="language-python extra-class"><pre class="language-python"><code>!wget <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span><span class="token string">&quot;Host: archive.ics.uci.edu&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span><span class="token string">&quot;User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.81 Safari/537.36&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span><span class="token string">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&quot;</span> <span class="token string">&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/00436/Container_Crane_Controller_Data_Set.csv&quot;</span> <span class="token operator">-</span>O <span class="token string">&quot;Container_Crane_Controller_Data_Set.csv&quot;</span> <span class="token operator">-</span>c
</code></pre></div><p><img src="/assets/img/1549482301055.62028812.png" alt="1549482301055"></p><h3 id="data-download-kaggle"><a href="#data-download-kaggle" aria-hidden="true" class="header-anchor">#</a> Data Download / kaggle</h3><div class="language-python extra-class"><pre class="language-python"><code>!pip install kaggle
</code></pre></div><p>Sign  to the profile on the Kaggle page:</p><p><img src="data:image/png;base64,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" alt="1549317920891"></p><p>Next, download new API key. Upload</p><p><img src="/assets/img/1549317857572.976a2ee0.png" alt="1549317857572"></p><p>And upload to your page: (On Colab you can upload your page)</p><p><img src="/assets/img/1549317981152.9d945f45.png" alt="1549317981152"></p><p>Copy the <strong>kaggle</strong> configuration to the home folder.</p><div class="language-python extra-class"><pre class="language-python"><code>!mkdir <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>kaggle
!cp <span class="token operator">/</span>content<span class="token operator">/</span>kaggle<span class="token punctuation">.</span>json <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>kaggle<span class="token operator">/</span>kaggle<span class="token punctuation">.</span>json
!chmod <span class="token number">600</span> <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>kaggle<span class="token operator">/</span>kaggle<span class="token punctuation">.</span>json
</code></pre></div><p>Now you can download any competion that you are in: (kaggle will create folders by themself)</p><div class="language-python extra-class"><pre class="language-python"><code>!kaggle competitions download <span class="token operator">-</span>c home<span class="token operator">-</span>credit<span class="token operator">-</span>default<span class="token operator">-</span>risk <span class="token operator">-</span>p <span class="token operator">/</span>content<span class="token operator">/</span>titanic
</code></pre></div><p><strong>Errors</strong>:</p><ul><li><code>Error 401</code> - means that you have wrong <code>.json</code> file. Generate again and check if exists.</li><li><code>Error 403</code> - You don’t accept terms and condition for the competition. Go to the webpage and join to the competition.</li></ul><h3 id="data-download-linux-commands"><a href="#data-download-linux-commands" aria-hidden="true" class="header-anchor">#</a> Data Download / linux commands</h3><p>Useful commands to operate on files.</p><table><thead><tr><th>Command</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td><code>Create Directory</code></td><td><code>mkdir folder</code></td><td>Create directory named <code>folder</code></td></tr><tr><td><code>Remove files</code></td><td><code>rm content/*.zip</code></td><td>Remove all files with extension ``.zip`</td></tr><tr><td><code>Unizip files</code></td><td><code>unzip -o -q isic-images.zip -d isd/bening</code></td><td>Unzip the files <code>isic-images.zip</code>, <br>the <code>-o</code> option is used to suppress the query, <br>the <code>-q</code> is used to not show list of extracted files,<br><code>-d</code> is a destination folder</td></tr><tr><td><code>Move files</code></td><td><code>mv isd/benign/ISIC-images/**/*.jpg isd/benign</code></td><td>Move all files with the extension <code>.jpg</code> from the folder <code>isd/benign/ISIC-images</code> , the double start <code>**</code> means to tro find files in the folder and subfolder recseively., Destination folder is <code>isd/benign</code></td></tr><tr><td><code>Copy files</code></td><td><code>cp isd/benign/ISIC-images/**/*.jpg isd/benign</code></td><td>The same as above without remove original files.</td></tr></tbody></table><h2 id="architecture"><a href="#architecture" aria-hidden="true" class="header-anchor">#</a> Architecture</h2><h3 id="glossary"><a href="#glossary" aria-hidden="true" class="header-anchor">#</a> Glossary</h3><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>parameters</code></td><td>Configuration of the Neural network (Contains <code>weights</code> and <code>biases</code>)</td></tr><tr><td><code>activation function</code></td><td>Function to activate</td></tr><tr><td><code>activation</code></td><td>Result of the <code>activation functions</code></td></tr><tr><td><code>input layer</code></td><td>Input for the Nueral network (called <code>layer 0</code>, <code>x</code>)</td></tr><tr><td><code>output layer</code></td><td>Output of the Neural network (<code>y</code>). Activation of the last layer.</td></tr><tr><td><code>loss function</code></td><td>Function thant compares <code>output</code> with <code>ground truth</code></td></tr><tr><td><code>embedding</code><a href="https://pytorch.org/docs/stable/nn.html#embedding" target="_blank" title="https://pytorch.org/docs/stable/nn.html#embedding" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>Type of the layer that output is a product of two matrices. <code>X@W</code>, (e.g.<code>(5x1)@(5x8)=(8x1)</code>)</td></tr></tbody></table><p><img src="/assets/img/1551271030999.dd2f74f6.png" alt="1551271030999"></p><h3 id="activation-functions"><a href="#activation-functions" aria-hidden="true" class="header-anchor">#</a> Activation Functions <a href="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" target="_blank" title="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Instead of using perceptron with output <code>0 or 1</code>, better is use activation function that return values <code>between 0 and 1</code>. In Deep learning there are couple functions to use as an activation.</p><h4 id="sigmoid-function"><a href="#sigmoid-function" aria-hidden="true" class="header-anchor">#</a> Sigmoid function</h4><p>In sigmoid function the difference is in the activation function.</p><p>Logistic function is:</p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6f42e36c949c94189976ae00853af9a1b618e099" alt="{\displaystyle f(./assets/6f42e36c949c94189976ae00853af9a1b618e099.svg)={\frac {L}{1+e^{-k(x-x_{0})}}}}"></p><p>Sigmoid is a special case when <code>L=1, k=1, and x0 = 0</code>.</p><p><img src="/assets/img/1_Xu7B5y9gp0iL5ooBj7LtWw.07066668.png" alt="img"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARkAAABWCAYAAAD7aeIaAAAZJUlEQVR4nO2de3BU1R3Hv+feu5sXJFnEQI0koYSxMJSUJJApINIS0joDKmmhTEHqVMfSKgUtpbHYKloVpzJMO0FlqsWoiDqdKoJgGXxCMQaY8GyRRzMQHUwIz5Bsdvfe8+sfcI53N699ZHez7PnM7BB2795z7t1zfuf3Or/LiIgQgHiLMRb4kUKhUHSiJ5nB7EKGiJRgUSgUEREoR7TuPlAoFIpwYIzBbiBpgBIwCoWib7ELGtaVT0ahUCj6Ck3JGIVCES2I6GufjEKhUEQDZS4pFIqoojQZhUIRVZSQUSgUUUUJGYVCEVWUkFEoFFFFCRmFQhFVlJBRKBRRRQkZhSKKqAwRwIh3BxSKRMe+94+I/AQLYwytra0AgIyMDGha8q3ryXfFCkWUsNdU4ZyDiPDZZ58hPz8ft956a1IKGEBpMgpFxDDG4PF4YJomAMDj8WD79u1YsmQJTp8+DQAwTTNpqx0kvGgV6qn4gePRvli1FMkJ5xy6rqOiogIulwuFhYX4y1/+goceeggpKSkAAMuyklLAANfA3iUhZDjn0DQtpiqpuHVihUrWQZTscM4BAK2trWCMIT09HZqmwbIsDBw4EB6PB6Wlpdi9e3ecexofrglzSdO0TtW4oo29LdM04XQ6Y9a2on8hFrisrCypsQQuOAm+lkdEwppL4kfzeDz40Y9+hJtvvjnmmkRzczPS0tJQX18vVzNF8qHrOjRNk2YTYyxu5nt/JOGEjJjMjDG0tbVh0qRJ2LdvHz744IOYC5mcnBy8++67mDRpEl544QVwzmFZlhI4SYYYd8JUZ4zBMAw/0z2ZTemENJd8Ph8AYNKkSfjiiy/Q2NgIwzBi6r0X5tktt9yCt956C3fccQdcLhduv/12OJ3OpI0kKBSBJJwmA1wRMhUVFTh8+DA+/fRTOJ1O6ZeJJZxzGIaBmTNnYunSpZg7dy6amprAOVcCRqG4SkIIGc651F4A4KWXXsLHH3+MFStWYOTIkdB1PS790nVd+oYef/xx5ObmoqCgAF6vV0a9RORLoUhWEkLIMMbgcDgAAKdOncJvfvMbZGdno6qqKq79EiYR5xxOpxObNm0CAFRUVPjlzyitRpHMJISQse8HmT9/PrxeLw4ePBj3sGCgw2/MmDEoLCxEbW0t/vnPf8q8HSVkFMlMQggZxhh8Ph9qa2uxa9cu5OfnIzc3N+5Cxg4RQdM07N27Fz6fD7/61a9gmiY458pcUiQ1CSFkAMAwDNx2220AgPXr18uchP6CiDalpaVh9OjRaGlpweuvv64ygRVJT0IIGc45jh07hrNnz8LlcqGkpASapvUrTcZOdXU1GGNYuHBhzDORFYr+RkIIGV3XMWXKFHDOsWDBAmiaBtM0++XWeV3XMXHiRBiGAbfbjUOHDikho0hq+t8svYp982FbWxvOnTsHxhjuvPNOGIYBw4gsj9Ae/bGHmrsSCOK93nwrRATLsuB0OlFeXg4AmDVrVr8UhorYksx+uX47+u1+jOrqapimifT0dHznO9/p0zbs5kxXvhMxOIIJRQthQkSYNWsWiAgnT570y/FRXPuIZEz7S2SkJyP9VsgIGGPYvHkzdF1HQUFBn2kF9hwXsbmtKyEifD/BZPESkdwsN3PmTLlR7qOPPuqTPisSg0B/oYg8JmsAIGybI7CuKeccly5dgtvthmVZfjVWepLguq5jyJAh3UaKOjo6sHv3bliWhenTp4fb3U60t7fjmWeewbPPPouUlBRs2LABkyZN6vb43NxcHD9+HAMGDOj2GBFqdzgcyMnJwcCBA9Ha2oqamhpUVFT0Wd8V/Rd7TldzczN8Ph8YY7hw4QI8Ho9fSZCkEToUBj6fj0zTJM45NTU10aOPPkrZ2dnEGCPGGAEgTdNI0zQCQIwx+bf9xRgjwzDo17/+dZftcM5p//798pw7duwIp7sS0zTJsiyqra2lzMxM0jRN9o0xRsuXLyfOOVmWJV+cc1q8eDHdeOONZJpmSO2NHj2aGGM0ZswYsiwror4TXbkfXf3d1f+jgbgf4l/F13DOacuWLVRaWkpFRUU0fPhwcjgccuzquk4ZGRlUWFhIpaWlVFpaSs3NzUREIY+rRCMsTUZksq5YsQIrV66Ue3WE+SEktP1vCvBpkM2Zmp+f35XwAwAcPHgQwBWpX1JSEnaavjCLmpubcfPNN8sVxt7Wk08+iSFDhuD++++XGtjbb7+NZ599FqdPnw45N6egoAD//e9/cezYMXg8HqSlpUW0zUD0SfxLV9VwipGtr3J+uodzjlGjRmH58uVgjEHXdaSmpkLXdViWBV3X4fF45D68jo4OpKenyzEVybjo74RtLuXn5+PUqVMArgy+YcOG4b777sPIkSOxb98+rFq1St5UzjlWrFiB8ePHy++Lm1tSUoLrrruu0/nFDd+7d6/8AVJSUsL+IcRkzM3NBeccxcXF+NOf/oThw4ejrq4ODz/8MBobG7F48WK5+XL16tX4+9//jvfeew+DBg0Kue2ioiJs2bIFHo8HTU1NKCgoCKvvgfh8PmiahnPnzqGtrS1mQsayLAwYMABDhgyJSXuJAl31xQ0dOhQzZsyAYRjweDxISUmRY9c0TVnQCoCcF2JcXqsCBkBw5pJQjTnn1N7eLs0ATdNo6tSp1NraSpxz+SK6olr/7ne/I13XSdM0GjFihDRBgm2PiKikpIQYY6TrekQqOuecXnnlFXI4HFRXV+fXX6H+e71eWrt2LU2bNo2KioqIMUZVVVVhmwebNm2SpuMHH3zQ5fWFiujLtm3bpMkpVPJov4QJXFVVpcwlRdAEVUhcHEJEmDlzJt577z0AwLJly/DEE090KqRtD+ENHz4cJ0+ehKZpqKurQ0lJSSgCEEOGDMGZM2fk/ylMqU9EKC8vx5QpU/CHP/yhU5RKnNeyLFiWheLiYhQVFeHll18GgJBVWiLCF198gby8PADAG2+8gTlz5vi1FQ5i9Wtvb8df//pXnDt3zm9FjCaapiEtLQ2LFi0KS7NTJCnBSCLTNMnr9dKLL74oV85p06b5OUfFcT6fj4iurLimadKyZcvkSlhdXS3f72kltGsYwnmWkZERlhS14/V6ZftdtSmuZ+LEiVReXi61Lp/PF5bjtqmpSWoZa9aske2Ei/iux+Px0xo559KpHe1XpNegSD6C8snoug7OOe6++27oug5d17Fp0ya/ELVYTW3CC5qmYcaMGVi1ahU459i7dy8A9JozYD+ncNCmpqbKxLhwc2UMw4DP5+vSeSvaKy4uRn5+Pt555x2/74UKESErK0tqFy0tLdIuDxdxrsAnIzDGYpKHYVmWbC/w9+4LkjkrNhEJNhDQ7eyhAJV+/vz58lkyTz/9tCwi1V1jwrzo6OiQg9Ptdgc9MAMjKU6nM+LoBmNMTlCybSfQNA1tbW0YM2YMJk+ejJqamk6RsnBwOByy/263O+Jd4z3du1iYLvb+93VS5KFDhzBhwoSkzYpNJETZ2fLycmzcuLHX47sVMvYkOrfbjS1btoCIYBgG7rrrLgDB+RZ27dolhYPL5QrZHyH6EI2VWgiRL7/8EiUlJfjZz36GJ598UgrTSCaSXcsTvh4huMTnCv/kNa/XG+feKHpDzAmfzxf0Y196tAPEJNmwYYMMlY4bNw4ul0um4vckNBhj+Pjjj+UgGj16dFgChl191nCoAqonTNOEYRg4fvw4xo4di7Vr1+LOO++Umo0wqyJpU0waIpLmXn8uUREPhAAeOXIkPB5PvLuj6AW6+kjoUFwI3R5pjxBt27ZNvv/DH/5QCp+uVnr7BGKM4X//+588vqioSB7T28QVKpkQZm63O+iL6grhcxH+JcMwsHv3bkyePBkbNmxAZWWln3kmzEG7/yFUgSN8MESE7OzsHvdIBYvQsESCV6yLd9nb7QuTSWwejHRXvSJ2hPpbBaXJ7Ny5U/4twrA9IQRNc3MzGhsbQUQYMGAAysrKgu6YmNQulwvnzp1DR0dH0N/tCZEE9eabb+Kuu+7Czp07pS/APmnEZBLXEo6Zc/78eWkmXX/99X2iiYn7omkaDh48iJaWFj/hGG0yMjIwfvz4flWVUNG/6dEnY5omiAjnz5+Xq/vIkSN7jQyJz1999VU5OWfOnAmHwyFX4mAnXE5ODs6ePSsna7iIiUlEWLduHZYsWYKGhgZ84xvf6LTZE/g6otbR0YGWlhbk5eWFNIk55zh16pQ8b05Ojp+PJtxrAK4Imu3bt+MHP/hBzE0vxhiWLl2KlStXxs2v1JdmsyL69KjJGIbhlw4tVNuesEdtVq1aJcOrzz//vEy/DmaQiGMmT56MI0eOyIJQkayglmXhueeew8MPP4wvv/zSb0e1Xf23myD3338/Tp06he3bt4c0uDVNw549e+R3hg0b5qcdhTNJxHdM08SUKVOwaNEinDhxws95Gm3S09Px2GOPxVXAKBKLXqNLmqYhLy8PR44c8dt7IQicMGKyvvvuu2hubgYALFq0CAMHDpTHBTNAxTHjxo3rlIsT7AAP9KWsXr0aK1euxNGjR5GVldXl9do1nsbGRtTU1GDXrl1hRZs+/fRTuVkuLy9P+mQi9WUIQb969Wq//kebWE1w+5gS950xBq/Xi3vuuQcjRozAI4880udtipdYGK91utLg7fNAKBaidEtX8z/YhrpFZHb+9re/JU3TyOFw9LqPR+wBSk9PJ03TqKioqNss297gnNPOnTtllnF9fX1I2ab2/Ulr164lwzDo3//+Nx07dow6OjrkZ6Jv9qzfs2fP0uDBg+mmm24ir9cbcv855/Ttb3+bAFBBQYHfni5F99izwcVY83g8VF1dTbm5ucQYo9tvv73P2hNt+Xw++uijjzrtwbvWsWeNE1GnzO7A0ifh0K2QsW8c/Oqrr2Q9mB07dnT7I4j38/PziTFGN9xwA12+fJmIwq+ZceHCBbkZ849//GNI3xU35sCBA7JmjK7rpOs6ORwOGjZsGL3//vuyb2L7xPLly8kwDGKM0Z49e0IWEOI+DB06lADQHXfc0elzRWfsY27WrFk0dOhQysrKIqfTSYMHDyaHw0EA+kzI2CfY1q1bCQBduHAh6RYC0zRp//79lJubS0OHDqUXXnjBb6vQa6+9RlOmTOl1O1B3BLV3iYjol7/8Jem6TkVFRXJlF/tlxOC4ePEiFRcXEwAaPXo0eb3ekDsUCOecvvWtbxFjjIqLi+V7wX738uXLpGkalZWVUVtbm/xsyZIlcl+RfSezEGhOp5OWLVsWsuYkuHjxIum6TowxqqmpCfocyY4YS88//zytXr2a6uvr5WKRkpLSp0LGjtgx39LS0m8WgUiLg9mFaOB57O+tXbvWr5AcY4zGjRtHJ06coK1bt9LAgQPp8uXLfa/JdNWhefPmEWOMbrvtNjp79qwcEG1tbfTyyy/ToEGDKCUlhR555JE+q/bFOad7772XdF0nl8sVkiprWRYVFhbS9773Pb9yDuLvu+++W2o2ooyBuMmLFy8mr9cbtpD5xz/+IQVWa2tryNedrIgxJVZNuxaZTELGvoD31cuOfe6mpaXRmjVraN++fbRnzx6qqamhhx56iKZOnUrZ2dl0+PDhiEymkIQM55zef/99Gjp0KBmGQYWFhTRq1CjKyMig1NRUeuyxx+j06dN9qm5yzqmhoUFO/uPHjwf93VdeeYV0XaeOjg4i8jd3xE1/8MEHpTDQNI1yc3Nl7ZdQVxLh37Esi37xi18QY4yuv/76oL+vID9/gEBMiGQTMoJIhY04hx27MD98+LC0TMSxW7dupaysLDpx4oRf++EQtLlk75zA7XZTe3u77LD9Yvpa0LhcLtI0jR5//HG/9nrC5/N1eZNFjWKiK+UfOjo6yO12d1o9Q72xog3TNCk7O5t0Xac333yzXwzaRKMrh2QyCRnOOaWkpHRZGzuU14wZM4hzLkuwBLYRONZN06RFixbRiBEj/I6LpMxHyLnc9szSlJQU+b4I+QX+2xcQEZ566iksXLgQL730EqqqqoJKbbYfY++P/X2Hw+EXvrMTarhOPNny888/x6VLl0BEmD17dkjnUFwhlHSHaLUdLmQLAfOr5Uqamppw6NAhHDlyBIZhYNSoUZg4cSLS09NleDjwHHv27EFLS0vYiah0da9hV+cXcNv2ocbGRlRUVGDu3LkyN80e0g47Ty1ksRQHhC0ofCdHjx6V7/cnRNGuyspKYozR73//+4hCf4qviaUmEylCg7Ysi9566y0qKioih8NBP/3pT2ndunX03HPP0S233EJZWVm0b9++bs1ye+pHJOaSXaMXCK1FaO/r168nl8tFdXV1flEk4a4QQZOoRpfiiYhS/e1vfyPGGM2YMSNkp2ws4PxKTgdjjBwOB126dEm+r4iMRBEyYkFxu900YcIEYozR+PHj6cKFC37jwDRN+slPfkJOp7PL89gnebg+mcCco+76u3TpUpo4cSJdvny503fb29vpxhtvlIGecMZyQqQ1ih3RCxYsQHZ2NjZv3iwf/UpxTjOnq5nIojDXvHnzwBjDo48+ioyMDPm+Irbwbp5rHoj9GPGon1Cgq6aEz+eT5oXH48HgwYNRV1eHW2+9FbW1tRgwYIAcK/xq1nd5eTl8Pl+XjzG2m4si4znUlz1Dt7vrWrhwIaqrq5GSkoIHH3wQb7/9Ng4fPoxjx47hxRdfRE5ODr75zW+GVQvKfpP6PUJ6mqZJ27ZtI03TaPz48WEnB0Wjb0REp0+fptTUVCooKIjYI6/wJxRNJpR7b1kWeb1e2rhxIzHGglqx7dpFoEOUc05jx44lTdMoOztbajD2aA7RlbE8depUysrKips5vWzZMiooKKAdO3ZQQ0MD/fjHP5ZRXMMwCABNmDBBPo3Efp2hkBBFPOy7l7///e+jsrISGzdulDuReZj1XvoCsu13mjNnDnw+Hz788EO/yniK2GLfc9NTISwxVjjnsuJAW1sbHA5Hjw5OzjkcDocMfAjnKecc77zzDv7zn/+AiHDPPfcgLS3Nb3+Qrus4f/485syZg507d+LkyZNxcW57vV588sknOHr0KAzDABHhtddek88cS0tLwwMPPCAfrxzRWO4bmRhdunoKQnp6OmVmZsptC/HUGizLoldffZV0Xaf169fL/giUNhM54fhk1qxZ02N4V+RH2bO97Z/19t3a2loi8tdsysrK5Hfvu+8+qqqqogceeIAqKyspNzdXtjd79mzyeDzy2uKJmDuiP0T+qSiBOTehkhCajH1VEavUmTNnkJubi4qKCuzYsSMuqwFdleyNjY1YsGAB5s+fj7lz53YqcKVqn8QWodnOmzcPFy9e7LZ2ML9aIREAjhw5gg0bNqCqqgpOp9OvYFlXiOJd9lIoHR0dqK+vBwCkpqZi7Nix8rNp06bhiSeeQEFBgdSAevOXxArRD/tTMPo0FaUPBGHMEVL1xIkT5HK5qLKyMi6aDOeczp49S6mpqTR79my5pyveK9O1SCiaTHdh266OE+fevHkzMcbo3LlzvY4ly7L8NGtxrqamJpk8l5eX10kDCDaJ9FojIaJLduiqJ5+xK0+nPHr0KLZu3Yp777035hqD2+3GTTfdhJ///Od4/fXXYRgGdF2P+8qU7JAt+Yx60EaEn0H4Y8RLaKLdIaJQ9hpDdv8OYwzf/e53OyV5Ci28t35daySEuWSHsa+fncQYw6BBg9De3o6GhoaY9oOuPoHg0KFDuO6662R/FJHRVVYp76H4un0ii++GIuTt40mcL5is1sAHGXq9XgwcOBAOhwM+nw/p6el+QsXe18C/vV4vHA7HNbs4JfxViR9x+PDhcal3m5OToyrt9xFkq0oo/h/4m9onol34BCscooXT6YTT6cSUKVOg6zrq6+s7aUT2CI34e8mSJZg+ffo1K2CABNRkArH/aLHUJOzqsf3/ivCxpyrYf1d7ApvYC2QXRIHaQjx+C5H898wzz6C0tBSff/55p7QKuxD1eDyYPXs2PvzwQ5w8efKaLo6e8OJTrADxsnFFNqbK7I0c+0T76quvcODAAdTV1eGNN95AcXGxfPbWv/71L8ybNw+ffPIJ9u/fjwMHDvhl3MYakV2raRrGjh2Lp59+Gm63G9OnT+90rGmaWL58OTIzM2FZFs6cOYPMzMxrVsAAAKNk8kAp+jVCSHDOsW7dOvz5z3+GruvymeLiYX9CoJimCdM0YVkWPvvsM2RnZwMIT6vcvHkzZs6ciZaWFuljC/caiAgHDhzAggUL0NDQgLS0NPmAwhtuuAFlZWWorq5GZmZm3JJIY4kSMop+g4js6Louyxt0ZwYHOlHtx8RbyAg45/B6vXC73dA0Denp6XIfHg/xyRuJTML7ZBTXDvatGIHRm678LoHro9CC4jlx7b46TdOQmpoKXdfhdDrh9Xo79Y33wSNy+jtKyCj6FcFMuMBMavvEDXXCBmoUwtyJVFDZ+yFC5PZQuYiEJYMmc22LUIWiF4RGVFZWhjlz5iArK0ttbO1jlE9GoVBEFaXJKBSKqKKEjEKhiCqaspYUCkW0ICKlySgUiuiiJUMITaFQxA8NSK7aFgqFIjaIfCMVwlYoFFHFzyej5I1CoYiUQDnit60gsI6HQqFQBEt3suP/DWlWlNdxcuYAAAAASUVORK5CYII=" alt="1543948420834"></p><div class="sigmoid"><input placeholder="x1" size="mini" value="0.2" class="x1 red"><input placeholder="x2" size="mini" value="0.3" class="x2 green"><input placeholder="x3" size="mini" value="0.8" class="x3 blue"><input placeholder="w1" size="mini" value="0.2" class="w1 red"><input placeholder="w2" size="mini" value="0.3" class="w2 green"><input placeholder="w3" size="mini" value="0.5" class="w3 blue"><input placeholder="b" size="mini" value="0.1" class="b"><input placeholder="w1" size="mini" value="0.2" class="w1a red"><input placeholder="w2" size="mini" value="0.3" class="w2a green"><input placeholder="w3" size="mini" value="0.5" class="w3a blue"><input placeholder="x1" size="mini" value="0.2" class="x1a red"><input placeholder="x2" size="mini" value="0.3" class="x2a green"><input placeholder="x3" size="mini" value="0.8" class="x3a blue"><input readonly="readonly" size="mini" value="0.04" class="m1 red"><input readonly="readonly" size="mini" value="0.09" class="m2 green"><input readonly="readonly" size="mini" value="0.4" class="m3 blue"><input placeholder="b" size="mini" value="0.1" class="mb"><input readonly="readonly" size="mini" value="0.63" class="msum" style="color:green;"><img src="/deepnn/sigmoid.png" alt="Card image cap" width="740" height="578" class="image"><span class="answer">σ = 0.652 </span></div><h4 id="when-use-2"><a href="#when-use-2" aria-hidden="true" class="header-anchor">#</a> When Use?</h4><ul><li>predict the probability of the output. (simple classification for example: ‘dog/cat’).</li></ul><h4 id="list-of-activation-functions"><a href="#list-of-activation-functions" aria-hidden="true" class="header-anchor">#</a> List of Activation functions <a href="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" target="_blank" title="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>source</span></a></h4><h4 id="when-use-3"><a href="#when-use-3" aria-hidden="true" class="header-anchor">#</a> When Use?</h4><ul><li>Currently in the architecture except the last layer, <code>ReLU</code> is the most popular.</li><li>For last layer (output) <code>ReLU</code> is not used because we want to have output in the range (e.g. <code>[0,1]</code>), most popular is <code>Sigmoid (Logistic)</code>.</li><li><code>Identiny</code> is linear, it can be used for linear regression.</li></ul><p><img src="/assets/img/1_p_hyqAtyI8pbt2kEl6siOQ.614e078a.png" alt="img"></p><p><img src="/assets/img/1_n1HFBpwv21FCAzGjmWt1sg.ae245b14.png" alt="img"></p><h3 id="loss-functions"><a href="#loss-functions" aria-hidden="true" class="header-anchor">#</a> Loss functions <a href="&lt;https://medium.com/udacity-pytorch-challengers/a-brief-overview-of-loss-functions-in-pytorch-c0ddb78068f7&gt;" target="_blank" title="&lt;https://medium.com/udacity-pytorch-challengers/a-brief-overview-of-loss-functions-in-pytorch-c0ddb78068f7&gt;" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><a href="&lt;https://pytorch.org/docs/stable/nn.html#l1loss&gt;" target="_blank" title="&lt;https://pytorch.org/docs/stable/nn.html#l1loss&gt;" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>PyTorch</span></a></h3><table><thead><tr><th>Name</th><th>Pytorch</th><th>Calculation</th><th>Where Use?</th></tr></thead><tbody><tr><td>Mean Absolute Error</td><td><code>nn.L1Loss</code></td><td><img src="data:image/png;base64,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" alt="1554546156699"></td><td>Regression Problems (very rare)</td></tr><tr><td>Mean Square Error Loss</td><td><code>nn.MSELoss</code></td><td><img src="data:image/png;base64,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" alt="1554546384434"></td><td>Regression Problems</td></tr><tr><td>Smooth L1 Loss</td><td><code>nn.SmoothL1Loss</code></td><td><img src="/assets/img/1554546413250.b08856fe.png" alt="1554546413250"></td><td>Regression Problems</td></tr><tr><td>Negative Log-Likelihood Loss</td><td><code>nn.NLLLoss</code></td><td><img src="data:image/png;base64,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" alt="1554546459528"></td><td>Classification</td></tr><tr><td>Cross-Entropy Loss</td><td><code>nn.CrossEntropyLoss</code></td><td><img src="data:image/png;base64,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" alt="1554546499670"></td><td>Classification</td></tr><tr><td>Kullback-Leibler divergence</td><td><code>nn.KLDivLoss</code></td><td><img src="data:image/png;base64,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" alt="1554546582184"></td><td>Classification</td></tr><tr><td>Margin Ranking Loss</td><td><code>nn.MarginRankingLoss</code></td><td><img src="/assets/img/1554546627954.8190dd84.png" alt="1554546627954"></td><td>GANs, Ranking tasks</td></tr><tr><td>Hinge Embedding Loss</td><td><code>nn.HingeEmbeddingLoss</code></td><td><img src="/assets/img/1554546662939.81c91dfe.png" alt="1554546662939"></td><td>Learning nonlinear embeddings</td></tr><tr><td>Cosine Embedding Loss</td><td><code>nn.CosineEmbeddingLoss</code></td><td><img src="/assets/img/1554546723665.c2c277fd.png" alt="1554546723665"></td><td>Learning nonlinear embeddings</td></tr></tbody></table><h3 id="weight-decay-sgd-l2-regularization"><a href="#weight-decay-sgd-l2-regularization" aria-hidden="true" class="header-anchor">#</a> weight decay - SGD - L2 Regularization</h3><p>SGD is a simple <code>loss.backward()</code> that goes backpropage through the model and update weights. If we define a loss as mean squared error:</p><p><img src="/assets/img/1551806539435.a97cb1f8.png" alt="1551806539435"></p><p>Weight decay is a regularization term that penalizes big weights. When the weight decay coefficient is big, the penalty for big weights is also big, when it is small weights can freely grow.</p><p>There is no difference between L2 regularization and weight decay,  in L1 regularization there is absolute value  <code>|w|</code> instead of <code>w^2</code>.</p><p><img src="data:image/png;base64,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" alt="1551806603749"></p><h3 id="momentum"><a href="#momentum" aria-hidden="true" class="header-anchor">#</a> Momentum <a href="https://towardsdatascience.com/stochastic-gradient-descent-with-momentum-a84097641a5d" target="_blank" title="https://towardsdatascience.com/stochastic-gradient-descent-with-momentum-a84097641a5d" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Momentum is intended to help speed the optimisation process through cases, to avoid getting stuck in the &quot;shallow valleys&quot; when gradient is close to 0. Momentum accumulates the gradient of the past steps to determine the direction to go.</p><p>You update your weights based on the 90% of your previous result (default) and in 10% of your current gradient descent result. In the first time when you don’t have previous result you update in 100% by your gradient descent.</p><p><img src="/assets/img/1551965981091.20b04112.png" alt="1551965981091"></p><div class="language-python extra-class"><pre class="language-python"><code>opt <span class="token operator">=</span> optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="rmsprop"><a href="#rmsprop" aria-hidden="true" class="header-anchor">#</a> RMSProp</h3><p>Here instead of multiply by momentum we multiply by gradient divident by the root square of the previous result of the batch. In this case we multiply by the square of gradient.  This mean that if you are going in the right direction make the number bigger.</p><ul><li>If the gradient is really small and <code>St</code>  is a small number than the update will be small</li><li>If the gradient the gradient is constenely very small and not volatile let’s get bigger jumps.</li></ul><p><img src="data:image/png;base64,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" alt="1551975097200"></p><div class="language-python extra-class"><pre class="language-python"><code>optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>RMSprop<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                          lr <span class="token operator">=</span> <span class="token number">0.0001</span><span class="token punctuation">,</span> 
                          alpha<span class="token operator">=</span><span class="token number">0.99</span><span class="token punctuation">,</span> 
                          eps<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">08</span><span class="token punctuation">,</span> 
                          weight_decay<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> 
                          momentum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="adam-optimizer"><a href="#adam-optimizer" aria-hidden="true" class="header-anchor">#</a> Adam Optimizer</h3><p>Adam this combination of RMSProp and Momentum, it’s in less epochs than both separetely.</p><p><img src="data:image/png;base64,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" alt="1551967342004"></p><p>The final calculation you can find with epsilon value (default 1e-10):</p><ul><li><code>betas</code> coefficients used for computing running averages of gradient and its square (default: (0.9, 0.999)), in the above calculation <code>bheta1</code>, and <code>bheta2</code>.</li></ul><p><img src="data:image/png;base64,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" alt="1551966978062"></p><div class="language-python extra-class"><pre class="language-python"><code>optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr <span class="token operator">=</span> <span class="token number">0.0001</span><span class="token punctuation">,</span> betas<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.999</span><span class="token punctuation">)</span><span class="token punctuation">,</span> eps<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">08</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="convolution-network"><a href="#convolution-network" aria-hidden="true" class="header-anchor">#</a> Convolution Network <a href="https://medium.com/impactai/cnns-from-different-viewpoints-fab7f52d159c" target="_blank" title="https://medium.com/impactai/cnns-from-different-viewpoints-fab7f52d159c" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Convolution Network is type of layer in the neural network that can help you to read information about image by putting a mask (like in the most popular image software ) called kernel <a href="https://en.wikipedia.org/wiki/Kernel_(image_processing)" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Kernel_(image_processing)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> . It doesn’t have to bet a 3x3 matrix, but this is most popular. In the webpage <a href="http://setosa.io/ev/image-kernels/" target="_blank" rel="noopener noreferrer">http://setosa.io/ev/image-kernels/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> you can play with the own matrix. The calculation is don for each pixel in the image. For each of them we get the matrix around the pixel with the size of the kernel (3x3) and multiply each of them.  The sum is the new pixel of the image.</p><p><img src="/assets/img/31.7bb3400e.png" alt="img"></p><p>For example below matrix creates from your image of cat edges around your cat.</p><p><img src="data:image/png;base64,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" alt="1552500642360"></p><p><img src="/assets/img/1552500673214.3e40c8a1.png" alt="1552500673214"></p><p><img src="/assets/img/1552500687431.54297e53.png" alt="1552500687431"></p><p>Define different matrix you can find different factors that appear on your image.  In the popular models first layer can detect simple artifacts like edges <a href="http://cs231n.github.io/convolutional-networks/" target="_blank" title="http://cs231n.github.io/convolutional-networks/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a>,  but next layers can go into some deeper knowledge like if this is a cat or dog, based on this artifacts.  In below example there are 96 kernels with image 11x11x3 that shows different aspects.</p><p><img src="/assets/img/weights.dd62e1d7.jpeg" alt="img"></p><h4 id="f-conv2d"><a href="#f-conv2d" aria-hidden="true" class="header-anchor">#</a> F.conv2d</h4><p>In pytorch function for calculation convolution is <code>F.conv2d</code>,</p><table><thead><tr><th>parameter</th><th>definition</th></tr></thead><tbody><tr><td><code>input</code></td><td>input data</td></tr><tr><td><code>weight</code></td><td>kernel to use on the shape</td></tr><tr><td><code>bias</code></td><td>optional bial</td></tr><tr><td><code>stride</code></td><td>The stride of the convolving kerenl.</td></tr><tr><td><code>padding</code></td><td>implicit zero padding on both sides of the input.</td></tr><tr><td><code>dilation</code></td><td>the space between kernel elements</td></tr><tr><td><code>groups</code></td><td>split input into groups</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>k <span class="token operator">=</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span>  <span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span>  <span class="token punctuation">,</span><span class="token number">1</span>   <span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>expand<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6</span>
F<span class="token punctuation">.</span>conv2d<span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">,</span>stride<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'japanese_chin_125.jpg'</span>

data <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>img<span class="token punctuation" data-v-54601d22>)</span>
t <span class="token operator" data-v-54601d22>=</span> data<span class="token punctuation" data-v-54601d22>.</span>px <span class="token comment" data-v-54601d22># get item set shape: ([3, 500, 377])</span>

k <span class="token operator" data-v-54601d22>=</span> tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>
    <span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>.</span>  <span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>5</span><span class="token operator" data-v-54601d22>/</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span>
    <span class="token punctuation" data-v-54601d22>[</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>5</span><span class="token operator" data-v-54601d22>/</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>5</span><span class="token operator" data-v-54601d22>/</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span>
    <span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>.</span>  <span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span>   <span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>21</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span>
<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>expand<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token number" data-v-54601d22>6</span>
<span class="token comment" data-v-54601d22># shape (1,3,3,3), </span>

<span class="token comment" data-v-54601d22>#t[None] - used to extend the shape of the tensor to [1,3,500,377]</span>
output <span class="token operator" data-v-54601d22>=</span> F<span class="token punctuation" data-v-54601d22>.</span>conv2d<span class="token punctuation" data-v-54601d22>(</span>t<span class="token punctuation" data-v-54601d22>[</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span>k<span class="token punctuation" data-v-54601d22>,</span> 
                  stride<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
                  padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#shape: ([1, 1, 500, 377])</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>output<span class="token punctuation" data-v-54601d22>.</span>shape<span class="token punctuation" data-v-54601d22>)</span>
show_image<span class="token punctuation" data-v-54601d22>(</span>output<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
</code></pre></div></div></div><p><img src="/assets/img/1552559867051.0846252e.png" alt="1552559867051"></p><h4 id="stride"><a href="#stride" aria-hidden="true" class="header-anchor">#</a> stride</h4><p>Usual your kernel is shifted by 1 pixel (<code>stride=1</code>). Your kernel is start from the position <code>(0,0)</code> and move to the position <code>(1,0)</code> but you can shift the pixel by any value you want.</p><a href="https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks-Part-2/" target="_blank" title="https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks-Part-2/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><p><img src="data:image/png;base64,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" alt="1552564165730"></p><p>If you set a stride to 2 your kernell will be moved by 2 pixels, and the size of the input image will be 2 times smaller (for example for above image is  <code>[250,189]</code>).</p><p><img src="data:image/png;base64,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" alt="1552564234896"></p><div class="language-python extra-class"><pre class="language-python"><code>output <span class="token operator">=</span> F<span class="token punctuation">.</span>conv2d<span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span>k<span class="token punctuation">,</span> 
                  stride<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#shape: ([1, 1, 500, 377])</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'japanese_chin_125.jpg'</span>

data <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>img<span class="token punctuation" data-v-54601d22>)</span>
t <span class="token operator" data-v-54601d22>=</span> data<span class="token punctuation" data-v-54601d22>.</span>px <span class="token comment" data-v-54601d22># get item set shape: ([3, 500, 377])</span>

k <span class="token operator" data-v-54601d22>=</span> tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>
    <span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>.</span>  <span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>5</span><span class="token operator" data-v-54601d22>/</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span>
    <span class="token punctuation" data-v-54601d22>[</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>5</span><span class="token operator" data-v-54601d22>/</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>5</span><span class="token operator" data-v-54601d22>/</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span>
    <span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>.</span>  <span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span>   <span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>21</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span>
<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>expand<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token number" data-v-54601d22>6</span>
<span class="token comment" data-v-54601d22># shape (1,3,3,3), </span>

<span class="token comment" data-v-54601d22>#t[None] - used to extend the shape of the tensor to [1,3,500,377]</span>
output <span class="token operator" data-v-54601d22>=</span> F<span class="token punctuation" data-v-54601d22>.</span>conv2d<span class="token punctuation" data-v-54601d22>(</span>t<span class="token punctuation" data-v-54601d22>[</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span>k<span class="token punctuation" data-v-54601d22>,</span> 
                  stride<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
                  padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#shape: ([1, 1, 500, 377])</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>output<span class="token punctuation" data-v-54601d22>.</span>shape<span class="token punctuation" data-v-54601d22>)</span>
<span class="token comment" data-v-54601d22>#show_image(output[0], figsize=(5,5));</span>
</code></pre></div></div></div><h4 id="padding"><a href="#padding" aria-hidden="true" class="header-anchor">#</a> padding</h4><p>The default padding for function is 0. The problem is that your image will decrease in the size by 1 pixel for each corner  (if you have kernel=(3,3))</p><p><em>[from (10,10) to (9,9)]</em></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWwAAACXCAYAAAAxvWHXAAADrUlEQVR4nO3cMW5bRxhG0XkBF+AFeAGBySpd9l+4SzUvK8gyAjAV4ycgRhBkaPHqndOo+0AB1BUwxb/NOe8DgJd3GWOMnz/9tGbs85fx5x+/v+TW/b7m/9K2bbZsvbHv+7her7ZsPWXruLmm1AA8nWADRAg2QIRgA0QINkCEYANECDZAhGADRAg2QIRgA0QINkCEYANEXJYNff7y5ufKzRW2bbP1AbbgzC5jrA0jPNPK+O/7vmTndrst2YF/s8057yvOqz6if//62//eGmOM7ddfnFe19WZnjPFyn+vvrYXf+5f9HW29y9Zx0xs2QIRgA0QINkCEYANECDZAhGADRAg2QIRgA0QINkCEYANECDZAhGADRAg2QMQ257w7D8kZzTmX7Pj74UdZfl515UlU51VtHXfGeOHzqrZsPWnruOlJBCBCsAEiBBsgQrABIgQbIEKwASIEGyBCsAEiBBsgQrABIgQbIEKwASIEGyDiMsa3S3tLBl9063HtzZath33fl2296u9o62NsPVzGWHOy0vlLW8/cesb363q9Ltkaw/fe1vO2jpueRAAiBBsgQrABIgQbIEKwASIEGyBCsAEiBBsgQrABIgQbIEKwASIEGyBCsAEiLmO87klBW7aeueW8qq3K1oPzqrYSW86r2jrr1nHTkwhAhGADRAg2QIRgA0QINkCEYANECDZAhGADRAg2QIRgA0QINkCEYANECDZAhPOqtk675byqrcrWg/OqthJbzqvaOuvWcdOTCECEYANECDZAhGADRAg2QIRgA0QINkCEYANECDZAhGADRAg2QIRgA0QINkCE86q2TrvlvKqtytaD86q2ElvOq9o669Zx05MIQIRgA0QINkCEYANECDZAhGADRAg2QIRgA0QINkCEYANECDZAhGADRAg2QITzqrZOu+W8qq3K1oPzqrYSW86r2jrr1nHTkwhAhGADRAg2QIRgA0QINkCEYANECDZAhGADRAg2QIRgA0QINkCEYANECDZAhPOqtk675byqrcrWg/OqthJbzqvaOuvWcdOTCECEYANECDZAhGADRAg2QIRgA0QINkCEYANECDZAhGADRAg2QIRgA0RcVg++6rUrWx9jC85s+XlVeCbnVW2dceth2XnVMV73PKEtW/+0teq86pxz2da+77ZsfXfTGzZAhGADRAg2QIRgA0QINkCEYANECDZAhGADRAg2QIRgA0QINkCEYANECDZAxDbnvN9ut/f+HPDDzTnf+yPAf/IXD6NXajNe8EQAAAAASUVORK5CYII=" alt="1552565495070"></p><p>To avoid this we can add padding,  increase the previous size with 0 values.</p><p><img src="data:image/png;base64,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" alt="1552565871005"></p><p>The output size is the same as the input size. For 5x5 kernel, the padding must be (2,2) to get the same size of the image.</p><p><img src="data:image/png;base64,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" alt="1552566061084"></p><h4 id="nn-conv2d"><a href="#nn-conv2d" aria-hidden="true" class="header-anchor">#</a> nn.Conv2d</h4><p>To create a layer for your model you have a function <code>nn.Conv2d</code>,</p><div class="language-python extra-class"><pre class="language-python"><code>n <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
              out_channels<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
              kernel_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> stride <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>

show_image<span class="token punctuation">(</span>n<span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22>n <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>Conv2d<span class="token punctuation" data-v-54601d22>(</span>in_channels <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span>
              out_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span>
              kernel_size <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
              padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> 
              stride <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22>#print(t.shape)</span>
o <span class="token operator" data-v-54601d22>=</span> n<span class="token punctuation" data-v-54601d22>(</span>t<span class="token punctuation" data-v-54601d22>[</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

show_image<span class="token punctuation" data-v-54601d22>(</span>o<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>o<span class="token punctuation" data-v-54601d22>.</span>shape<span class="token punctuation" data-v-54601d22>)</span> 
</code></pre></div></div></div><p><img src="/assets/img/1552560544169.5c2c9425.png" alt="1552560544169"></p><p><code>show_image</code> can only accept 1 channel and 3 channels, but you can create more and if you look into <code>resnet34</code> you will find that first convolution layer has 64 channels as output, and 3 as an input.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

model <span class="token operator">=</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1552567407873.d551501e.png" alt="1552567407873"></p><h4 id="the-size-of-the-output"><a href="#the-size-of-the-output" aria-hidden="true" class="header-anchor">#</a> The size of the output  <a href="https://docs.fast.ai/callbacks.hooks.html#model_summary" target="_blank" title="https://docs.fast.ai/callbacks.hooks.html#model_summary" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>When you look into summary for your model <code>summary()</code> in the fast.ai you will find the layers that represents convolutional network 2d and size of each layer.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>
path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>

data <span class="token operator" data-v-54601d22>=</span> ImageList<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>split_by_rand_pct<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span> seed<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>label_from_re<span class="token punctuation" data-v-54601d22>(</span>r<span class="token string" data-v-54601d22>'([^/]+)_\d+.jpg$'</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>transform<span class="token punctuation" data-v-54601d22>(</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>databunch<span class="token punctuation" data-v-54601d22>(</span>bs<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>
learn <span class="token operator" data-v-54601d22>=</span> cnn_learner<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> 
                   models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> 
                   metrics<span class="token operator" data-v-54601d22>=</span>error_rate<span class="token punctuation" data-v-54601d22>,</span> 
                   bn_final<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>

learn<span class="token punctuation" data-v-54601d22>.</span>summary<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1552647460580.554f0b03.png" alt="1552647460580"></p><p>To calculate the output size of the image (width and height), you can use below formula.</p><p><img src="/assets/img/1552571969347.0325e14a.png" alt="1552571969347"></p><p>Calculation of <code>Param#</code> for layers: <a href="https://docs.fast.ai/callbacks.hooks.html#model_summary" target="_blank" title="https://docs.fast.ai/callbacks.hooks.html#model_summary" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></p><ul><li>Conv: <code>kernel_size*kernel_size*ch_in*ch_out</code></li><li>Linear: <code>(n_in+bias) * n_out</code></li><li>Batchnorm: <code>2 * n_out</code></li><li>Embeddings: <code>n_embed * emb_sz</code></li></ul><h4 id="examples"><a href="#examples" aria-hidden="true" class="header-anchor">#</a> Examples:</h4><div class="language-python extra-class"><pre class="language-python"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token comment">#items, channels, width, height</span>
layer <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>
          in_channels <span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
          out_channels<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
          kernel_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          padding<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    	  stride <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

layer<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">.</span>shape
</code></pre></div><p><code>W = 100, H = 100, K=(3,3), P=(1,1), S=(1,1)</code></p><p><code>ow = (W-K+2P)/S + 1 = (100-3+2)/1+1=100</code><code>oh = (W-K+2P)/S + 1 = (100-3+2)/1+1=100</code></p><ul><li><strong>(items, channels,width,height)</strong>: <code>[1,3,100,100]</code></li><li><strong>out_channels</strong>: <code>64</code></li></ul><table><thead><tr><th>kernel</th><th>stride</th><th>padding</th><th>Output size</th><th><strong>calc</strong></th></tr></thead><tbody><tr><td><code>[3,3]</code></td><td><code>(1,1)</code></td><td><code>(1,1)</code></td><td><code>[1, 64, 100, 100]</code></td><td><code>((100-3+2*1)/1+1)</code></td></tr><tr><td><code>[7,7]</code></td><td><code>(1,1)</code></td><td><code>(1,1)</code></td><td><code>[1,64,96,96]</code></td><td><code>((100-7+2*1)/1+1)</code></td></tr><tr><td><code>[3,3]</code></td><td><code>(2,2)</code></td><td><code>(1,1)</code></td><td><code>[1,64,50,50]</code></td><td><code>((100-3+2*1)/2+1)</code></td></tr><tr><td><code>[3,3]</code></td><td><code>(1,1)</code></td><td><code>(0,0)</code></td><td><code>[1,64,49,49]</code></td><td><code>((100-3+2*0)/1+1)</code></td></tr></tbody></table><h4 id="netron"><a href="#netron" aria-hidden="true" class="header-anchor">#</a> NETRON</h4><p>You can also show your model in the <strong>NETRON APPLICATION</strong><a href="https://github.com/lutzroeder/netron" target="_blank" rel="noopener noreferrer">https://github.com/lutzroeder/netron<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as a graph. For the pytorch <code>learn.save()</code> the application show error for me, but you can export your model to the <code>ONNX</code> format, and open in the application.</p><div class="language-python extra-class"><pre class="language-python"><code>dummy_input <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># the size of your input</span>

torch<span class="token punctuation">.</span>onnx<span class="token punctuation">.</span>export<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                  dummy_input<span class="token punctuation">,</span> 
                  <span class="token string">&quot;./models/resnet34-entire-model.onnx&quot;</span><span class="token punctuation">,</span> 
                  verbose<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1552575612810.f403a48e.png" alt="1552575612810"></p><h3 id="batch-normalization"><a href="#batch-normalization" aria-hidden="true" class="header-anchor">#</a> Batch Normalization <a href="https://towardsdatascience.com/batch-normalization-in-neural-networks-1ac91516821c" target="_blank" title="https://towardsdatascience.com/batch-normalization-in-neural-networks-1ac91516821c" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><a href="https://arxiv.org/abs/1502.03167" target="_blank" title="https://arxiv.org/abs/1502.03167" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>paper</span></a><a href="https://www.youtube.com/watch?v=nUUqwaxLnWs" target="_blank" title="https://www.youtube.com/watch?v=nUUqwaxLnWs" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>video</span></a></h3><p>Batch normalization is a type of layer for the neural network that make loss surface smootherby normalizing parameters inside hidden layers, like you do with the input layer.</p><p><img src="/assets/img/1552580302141.426c7a61.png" alt="1552580302141"></p><p>Bath Normalization reduce problem when input changes, so the loss function is more stable and less bumpy.</p><div class="warning custom-block"><p class="custom-block-title">Batch normalization doesn’t  reducing internal covariate shift</p><p><strong>Internal Covariate shift</strong> refers to change in the distribution of layer inputs caused by updates to the preceding layers. (where for example you put different style of images next time)</p><p>Last papers shows that Batch Normalization doesn’t reduce ICS like in the original paper.  https://arxiv.org/pdf/1805.11604.pdf](https://arxiv.org/pdf/1805.11604.pdf)</p></div><p>Benefits:</p><ul><li>We can use higher learning rates because batch normalization makes sure that there’s no activation that’s gone really high or really low. And by that, things that previously couldn’t get to train, it will start to train.</li><li>It reduces overfitting because it has a slight regularization effects.</li></ul><p>How it is calculated:</p><ol><li>We get mini-batch</li><li>Calculate mean (<code>e</code>) anv variance (<code>var</code>) of the mini-batch</li><li>normalize the output <code>y=(x-e)/sqrt(var)</code></li><li>Scale and shift the output using own parameters  <strong>γ</strong> and <strong>β</strong> . This are wieghts that are also larned during a backward optimalization. We also need to scale and shift the normalized values otherwise just normalizing a layer would limit the layer in terms of what it can represent.</li></ol><p><img src="/assets/img/14.cca90e29.png" alt="img"></p><h3 id="dropout"><a href="#dropout" aria-hidden="true" class="header-anchor">#</a> Dropout <a href="https://www.cs.toronto.edu/~hinton/absps/JMLRdropout.pdf" target="_blank" title="https://www.cs.toronto.edu/~hinton/absps/JMLRdropout.pdf" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>paper</span></a><a href="https://www.youtube.com/watch?v=ARq74QuavAo" target="_blank" title="https://www.youtube.com/watch?v=ARq74QuavAo" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>video</span></a></h3><p><img src="/assets/img/1552583126804.433c674a.png" alt="1552583126804"></p><p>Dropout is a tregulariation method that for reducing overfitting in neural network, by preventing complex co-adaptaions on training data.  At random, we throw away some <strong>percentage of the activations</strong>,  <span class="red" data-v-9e33b382> After we finish traiing we remove dropout on the activation, because we wanted to be accurate.</span> Dropout use Bernoulli distribution to remove some activations.</p><ul><li>It helps working with overfitting. If we over fit some parts are recognizing particular image. If we turn off them during training the network the network will avoid this behaviour.</li></ul><div class="language-python extra-class"><pre class="language-python"><code>torch<span class="token punctuation">.</span>manual_seed<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
m <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">.5</span><span class="token punctuation">)</span> <span class="token comment"># in 50% probability return 0.</span>
<span class="token builtin">input</span> <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
m<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1552588690527"></p><h2 id="pytorch"><a href="#pytorch" aria-hidden="true" class="header-anchor">#</a> PyTorch <a href="https://pytorch.org/" target="_blank" title="https://pytorch.org/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>WebPage</span></a></h2><h3 id="functions"><a href="#functions" aria-hidden="true" class="header-anchor">#</a> Functions</h3><p>PyTorch is an optimized tensor library for deep learning using GPUs and CPUs.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
</code></pre></div><table><thead><tr><th>Command</th><th>Info</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.cuda.is_available()</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543956014633" data-v-336f4fea></code></span></td><td>Is CUDA Available (<code>On CPU returns False</code>)</td></tr><tr><td><code>torch.backends.cudnn.enabled</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543956000527" data-v-336f4fea></code></span></td><td>Is CUDA® Deep Neural Network library Available (used by fast.ai, <code>On CPU returns False</code>)</td></tr><tr><td><code>torch.cuda.device_count()</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955982482" data-v-336f4fea></code></span></td><td>Number of GPUs</td></tr><tr><td><code>torch.cuda.get_device_name(device)</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955759448" data-v-336f4fea></code></span></td><td>Gets the name of a device number</td></tr><tr><td><code>torch.cuda.set_device(device)</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955961561" data-v-336f4fea></code></span></td><td>Set the current GPU device</td></tr><tr><td><code>defaults.device = torch.device('cpu')</code></td><td></td><td>Set default device to CPU</td></tr><tr><td><code>torch.manual_seed(n)</code></td><td></td><td>Set manual seed for random initialization for weights, and oher random calculations.</td></tr></tbody></table><h3 id="how-to-train-a-model"><a href="#how-to-train-a-model" aria-hidden="true" class="header-anchor">#</a> How to train a model?</h3><p>In this example there will be creation of model for PyTorch without using <code>fastai</code> library from basics. 1st you need download your data <a href="http://deeplearning.net/data/mnist/mnist.pkl.gz" target="_blank" rel="noopener noreferrer">http://deeplearning.net/data/mnist/mnist.pkl.gz<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. and unpack in your folder.</p><p>We can load our data using <code>gzip</code> library, and <code>pickle</code>, <code>mnist.pkl</code> is a pickle file that have been divided into train and validation. We can load them separetely.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> gzip
<span class="token keyword">import</span> pickle
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

path <span class="token operator">=</span><span class="token string">'./mnist.pkl.gz'</span>

<span class="token keyword">with</span> gzip<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_valid<span class="token punctuation">,</span> y_valid<span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'latin-1'</span><span class="token punctuation">)</span>
    
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>x_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&quot;gray&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551976476263"></p><h3 id="dataset-dataloader"><a href="#dataset-dataloader" aria-hidden="true" class="header-anchor">#</a> DataSet / DataLoader</h3><p>For PyTorch we need to convert the data into Tensor and prepare <code>DataSet</code>, and <code>DataLoader</code> for our model.</p><ul><li><code>DataSet</code> -is used for get original values,</li><li><code>DataLoader</code> - is a class that returns values during training, we don’t want to load the whole dataset into graphics memory, and second we can do some transformation (like data augmentation) before return to the model.</li></ul><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils <span class="token keyword">import</span> data

<span class="token comment"># CUDA for PyTorch</span>
use_cuda <span class="token operator">=</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span>
device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">&quot;cuda:0&quot;</span> <span class="token keyword">if</span> use_cuda <span class="token keyword">else</span> <span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span>

x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>x_valid<span class="token punctuation">,</span>y_valid <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>tensor<span class="token punctuation">,</span> <span class="token punctuation">(</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>x_valid<span class="token punctuation">,</span>y_valid<span class="token punctuation">)</span><span class="token punctuation">)</span>


bs<span class="token operator">=</span><span class="token number">64</span>

<span class="token comment"># # We can use simple TensorDataset, instead of creating own</span>
<span class="token keyword">class</span> <span class="token class-name">DatasetXY</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token string">'Characterizes a dataset for PyTorch'</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token string">'Initialization'</span>
        self<span class="token punctuation">.</span>X <span class="token operator">=</span> X
        self<span class="token punctuation">.</span>Y <span class="token operator">=</span> Y

  <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token string">'Denotes the total number of samples'</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>X<span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token string">'Generates one sample of data'</span>
        <span class="token comment"># Select sample</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>X<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
        y <span class="token operator">=</span> self<span class="token punctuation">.</span>Y<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
        <span class="token keyword">return</span> x<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>

train_ds <span class="token operator">=</span> DatasetXY<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>
valid_ds <span class="token operator">=</span> DatasetXY<span class="token punctuation">(</span>x_valid<span class="token punctuation">,</span>y_valid<span class="token punctuation">)</span>

<span class="token comment"># we ccan use this isntead of DatasetXY</span>
<span class="token comment">#train_ds = data.TensorDataset(x_train, y_train)</span>
<span class="token comment">#valid_ds = data.TensorDataset(x_valid, y_valid)</span>
    
train_dl <span class="token operator">=</span> data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>train_ds<span class="token punctuation">,</span>batch_size<span class="token operator">=</span>bs<span class="token punctuation">)</span>
valid_dl <span class="token operator">=</span> data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>valid_ds<span class="token punctuation">,</span>batch_size<span class="token operator">=</span>bs<span class="token punctuation">)</span>
</code></pre></div><h3 id="model"><a href="#model" aria-hidden="true" class="header-anchor">#</a> Model</h3><p>Next, we define our model, with one linear layout, <code>cuda()</code> is required to work model in graphics card.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Our model</span>
<span class="token keyword">class</span> <span class="token class-name">Mnist_Logistic</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lin <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">784</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xb<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> self<span class="token punctuation">.</span>lin<span class="token punctuation">(</span>xb<span class="token punctuation">)</span>

    model <span class="token operator">=</span> Mnist_Logistic<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="backward-propagation"><a href="#backward-propagation" aria-hidden="true" class="header-anchor">#</a> Backward propagation</h3><p>The last option is to update our weights, learn algorithm, and prepare loss function. <code>nn.CrossEntropyLoss()</code></p><div class="language-python extra-class"><pre class="language-python"><code>
lr<span class="token operator">=</span><span class="token number">2e</span><span class="token operator">-</span><span class="token number">2</span>
loss_func <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>lr<span class="token punctuation">)</span><span class="token punctuation">:</span>
    wd <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span>
    y_hat <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token comment"># weight decay</span>
    w2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">.</span>
    <span class="token keyword">for</span> p <span class="token keyword">in</span> model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> w2 <span class="token operator">+=</span> <span class="token punctuation">(</span>p<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#weight decay</span>
    <span class="token comment"># add to regular loss</span>
    loss <span class="token operator">=</span> loss_func<span class="token punctuation">(</span>y_hat<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> w2<span class="token operator">*</span>wd
    <span class="token comment">#print(loss.item())</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> p <span class="token keyword">in</span> model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            p<span class="token punctuation">.</span>sub_<span class="token punctuation">(</span>lr <span class="token operator">*</span> p<span class="token punctuation">.</span>grad<span class="token punctuation">)</span>
            p<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>zero_<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Now we can learn our model, based on the training data loader.</p><h3 id="learn"><a href="#learn" aria-hidden="true" class="header-anchor">#</a> Learn</h3><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_batch</span><span class="token punctuation">(</span>dl<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> dl<span class="token punctuation">:</span> <span class="token keyword">yield</span> x<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span>y<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>

losses <span class="token operator">=</span> <span class="token punctuation">[</span>update<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>lr<span class="token punctuation">)</span> <span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> get_batch<span class="token punctuation">(</span>train_dl<span class="token punctuation">)</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>losses<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> gzip
<span class="token keyword" data-v-54601d22>import</span> pickle
<span class="token keyword" data-v-54601d22>import</span> matplotlib<span class="token punctuation" data-v-54601d22>.</span>pyplot <span class="token keyword" data-v-54601d22>as</span> plt
<span class="token comment" data-v-54601d22># from fastai.basics import *</span>

path <span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'./mnist.pkl.gz'</span>

<span class="token keyword" data-v-54601d22>with</span> gzip<span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>open</span><span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'rb'</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>as</span> f<span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>,</span> y_train<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token punctuation" data-v-54601d22>(</span>x_valid<span class="token punctuation" data-v-54601d22>,</span> y_valid<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> _<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>=</span> pickle<span class="token punctuation" data-v-54601d22>.</span>load<span class="token punctuation" data-v-54601d22>(</span>f<span class="token punctuation" data-v-54601d22>,</span> encoding<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'latin-1'</span><span class="token punctuation" data-v-54601d22>)</span>
    
plt<span class="token punctuation" data-v-54601d22>.</span>imshow<span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>reshape<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>28</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>28</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> cmap<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>&quot;gray&quot;</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>from</span> torch<span class="token punctuation" data-v-54601d22>.</span>utils <span class="token keyword" data-v-54601d22>import</span> data

<span class="token comment" data-v-54601d22># CUDA for PyTorch</span>
use_cuda <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>cuda<span class="token punctuation" data-v-54601d22>.</span>is_available<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
device <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>device<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;cuda:0&quot;</span> <span class="token keyword" data-v-54601d22>if</span> use_cuda <span class="token keyword" data-v-54601d22>else</span> <span class="token string" data-v-54601d22>&quot;cpu&quot;</span><span class="token punctuation" data-v-54601d22>)</span>

x_train<span class="token punctuation" data-v-54601d22>,</span>y_train<span class="token punctuation" data-v-54601d22>,</span>x_valid<span class="token punctuation" data-v-54601d22>,</span>y_valid <span class="token operator" data-v-54601d22>=</span> <span class="token builtin" data-v-54601d22>map</span><span class="token punctuation" data-v-54601d22>(</span>torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>,</span> <span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>,</span>y_train<span class="token punctuation" data-v-54601d22>,</span>x_valid<span class="token punctuation" data-v-54601d22>,</span>y_valid<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>


bs<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>64</span>

<span class="token comment" data-v-54601d22># # We can use simple TensorDataset, instead of creating own</span>
<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>DatasetXY</span><span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>.</span>Dataset<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token string" data-v-54601d22>'Characterizes a dataset for PyTorch'</span>
  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token string" data-v-54601d22>'Initialization'</span>
        self<span class="token punctuation" data-v-54601d22>.</span>X <span class="token operator" data-v-54601d22>=</span> X
        self<span class="token punctuation" data-v-54601d22>.</span>Y <span class="token operator" data-v-54601d22>=</span> Y

  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__len__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token string" data-v-54601d22>'Denotes the total number of samples'</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>X<span class="token punctuation" data-v-54601d22>)</span>

  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__getitem__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> index<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token string" data-v-54601d22>'Generates one sample of data'</span>
        <span class="token comment" data-v-54601d22># Select sample</span>
        x <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>X<span class="token punctuation" data-v-54601d22>[</span>index<span class="token punctuation" data-v-54601d22>]</span>
        y <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>Y<span class="token punctuation" data-v-54601d22>[</span>index<span class="token punctuation" data-v-54601d22>]</span>
        <span class="token keyword" data-v-54601d22>return</span> x<span class="token punctuation" data-v-54601d22>.</span>to<span class="token punctuation" data-v-54601d22>(</span>device<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>.</span>to<span class="token punctuation" data-v-54601d22>(</span>device<span class="token punctuation" data-v-54601d22>)</span>

train_ds <span class="token operator" data-v-54601d22>=</span> DatasetXY<span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>,</span>y_train<span class="token punctuation" data-v-54601d22>)</span>
valid_ds <span class="token operator" data-v-54601d22>=</span> DatasetXY<span class="token punctuation" data-v-54601d22>(</span>x_valid<span class="token punctuation" data-v-54601d22>,</span>y_valid<span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># we ccan use this isntead of DatasetXY</span>
<span class="token comment" data-v-54601d22>#train_ds = data.TensorDataset(x_train, y_train)</span>
<span class="token comment" data-v-54601d22>#valid_ds = data.TensorDataset(x_valid, y_valid)</span>
    
train_dl <span class="token operator" data-v-54601d22>=</span> data<span class="token punctuation" data-v-54601d22>.</span>DataLoader<span class="token punctuation" data-v-54601d22>(</span>train_ds<span class="token punctuation" data-v-54601d22>,</span>batch_size<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span>
valid_dl <span class="token operator" data-v-54601d22>=</span> data<span class="token punctuation" data-v-54601d22>.</span>DataLoader<span class="token punctuation" data-v-54601d22>(</span>valid_ds<span class="token punctuation" data-v-54601d22>,</span>batch_size<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># Our model</span>
<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Mnist_Logistic</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>lin <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>784</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>,</span> bias<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>

    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> xb<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> self<span class="token punctuation" data-v-54601d22>.</span>lin<span class="token punctuation" data-v-54601d22>(</span>xb<span class="token punctuation" data-v-54601d22>)</span>

model <span class="token operator" data-v-54601d22>=</span> Mnist_Logistic<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>cuda<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>


lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span>
loss_func <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>CrossEntropyLoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>update</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>,</span>lr<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    wd <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>5</span>
    y_hat <span class="token operator" data-v-54601d22>=</span> model<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token comment" data-v-54601d22># weight decay</span>
    w2 <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>.</span>
    <span class="token keyword" data-v-54601d22>for</span> p <span class="token keyword" data-v-54601d22>in</span> model<span class="token punctuation" data-v-54601d22>.</span>parameters<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> w2 <span class="token operator" data-v-54601d22>+=</span> <span class="token punctuation" data-v-54601d22>(</span>p<span class="token operator" data-v-54601d22>**</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>sum</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#weight decay</span>
    <span class="token comment" data-v-54601d22># add to regular loss</span>
    loss <span class="token operator" data-v-54601d22>=</span> loss_func<span class="token punctuation" data-v-54601d22>(</span>y_hat<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>+</span> w2<span class="token operator" data-v-54601d22>*</span>wd
    <span class="token comment" data-v-54601d22>#print(loss.item())</span>
    loss<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>with</span> torch<span class="token punctuation" data-v-54601d22>.</span>no_grad<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>for</span> p <span class="token keyword" data-v-54601d22>in</span> model<span class="token punctuation" data-v-54601d22>.</span>parameters<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
            p<span class="token punctuation" data-v-54601d22>.</span>sub_<span class="token punctuation" data-v-54601d22>(</span>lr <span class="token operator" data-v-54601d22>*</span> p<span class="token punctuation" data-v-54601d22>.</span>grad<span class="token punctuation" data-v-54601d22>)</span>
            p<span class="token punctuation" data-v-54601d22>.</span>grad<span class="token punctuation" data-v-54601d22>.</span>zero_<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>return</span> loss<span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_batch</span><span class="token punctuation" data-v-54601d22>(</span>dl<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>for</span> x<span class="token punctuation" data-v-54601d22>,</span>y <span class="token keyword" data-v-54601d22>in</span> dl<span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>yield</span> x<span class="token punctuation" data-v-54601d22>.</span>to<span class="token punctuation" data-v-54601d22>(</span>device<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>.</span>to<span class="token punctuation" data-v-54601d22>(</span>device<span class="token punctuation" data-v-54601d22>)</span>

losses <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>update<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>,</span>lr<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> x<span class="token punctuation" data-v-54601d22>,</span>y <span class="token keyword" data-v-54601d22>in</span> get_batch<span class="token punctuation" data-v-54601d22>(</span>train_dl<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plt<span class="token punctuation" data-v-54601d22>.</span>plot<span class="token punctuation" data-v-54601d22>(</span>losses<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
</code></pre></div></div></div><p><img src="/assets/img/1551982934877.2c3e45bd.png" alt="1551982934877"></p><h4 id="using-2-layer-model"><a href="#using-2-layer-model" aria-hidden="true" class="header-anchor">#</a> Using 2 layer model</h4><p>We can define different model and work on it.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F


<span class="token keyword">class</span> <span class="token class-name">Mnist_NN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lin1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">784</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lin2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>lin1<span class="token punctuation">(</span>xb<span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>lin2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    
model <span class="token operator">=</span> Mnist_NN<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>

losses <span class="token operator">=</span> <span class="token punctuation">[</span>update<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>lr<span class="token punctuation">)</span> <span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> get_batch<span class="token punctuation">(</span>train_dl<span class="token punctuation">)</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>losses<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/1551983216377.323da919.png" alt="1551983216377"></p><h3 id="adam-optimizer-2"><a href="#adam-optimizer-2" aria-hidden="true" class="header-anchor">#</a> Adam optimizer</h3><p>We can also use Adam optimizer instead of our own function to update.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> torch <span class="token keyword">import</span> optim

<span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>lr<span class="token punctuation">)</span><span class="token punctuation">:</span>
    opt <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token punctuation">)</span>
    y_hat <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    loss <span class="token operator">=</span> loss_func<span class="token punctuation">(</span>y_hat<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
    opt<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
    opt<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>

losses <span class="token operator">=</span> <span class="token punctuation">[</span>update<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> get_batch<span class="token punctuation">(</span>train_dl<span class="token punctuation">)</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>losses<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> gzip
<span class="token keyword" data-v-54601d22>import</span> pickle
<span class="token keyword" data-v-54601d22>import</span> matplotlib<span class="token punctuation" data-v-54601d22>.</span>pyplot <span class="token keyword" data-v-54601d22>as</span> plt
<span class="token comment" data-v-54601d22># from fastai.basics import *</span>

path <span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'./mnist.pkl.gz'</span>

<span class="token keyword" data-v-54601d22>with</span> gzip<span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>open</span><span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'rb'</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>as</span> f<span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>,</span> y_train<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token punctuation" data-v-54601d22>(</span>x_valid<span class="token punctuation" data-v-54601d22>,</span> y_valid<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> _<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>=</span> pickle<span class="token punctuation" data-v-54601d22>.</span>load<span class="token punctuation" data-v-54601d22>(</span>f<span class="token punctuation" data-v-54601d22>,</span> encoding<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'latin-1'</span><span class="token punctuation" data-v-54601d22>)</span>
    
<span class="token comment" data-v-54601d22>#plt.imshow(x_train[0].reshape((28,28)), cmap=&quot;gray&quot;)</span>

<span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>from</span> torch<span class="token punctuation" data-v-54601d22>.</span>utils <span class="token keyword" data-v-54601d22>import</span> data

<span class="token comment" data-v-54601d22># CUDA for PyTorch</span>
use_cuda <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>cuda<span class="token punctuation" data-v-54601d22>.</span>is_available<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
device <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>device<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;cuda:0&quot;</span> <span class="token keyword" data-v-54601d22>if</span> use_cuda <span class="token keyword" data-v-54601d22>else</span> <span class="token string" data-v-54601d22>&quot;cpu&quot;</span><span class="token punctuation" data-v-54601d22>)</span>

x_train<span class="token punctuation" data-v-54601d22>,</span>y_train<span class="token punctuation" data-v-54601d22>,</span>x_valid<span class="token punctuation" data-v-54601d22>,</span>y_valid <span class="token operator" data-v-54601d22>=</span> <span class="token builtin" data-v-54601d22>map</span><span class="token punctuation" data-v-54601d22>(</span>torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>,</span> <span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>,</span>y_train<span class="token punctuation" data-v-54601d22>,</span>x_valid<span class="token punctuation" data-v-54601d22>,</span>y_valid<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>


bs<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>64</span>

<span class="token comment" data-v-54601d22># # We can use simple TensorDataset, instead of creating own</span>
<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>DatasetXY</span><span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>.</span>Dataset<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token string" data-v-54601d22>'Characterizes a dataset for PyTorch'</span>
  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token string" data-v-54601d22>'Initialization'</span>
        self<span class="token punctuation" data-v-54601d22>.</span>X <span class="token operator" data-v-54601d22>=</span> X
        self<span class="token punctuation" data-v-54601d22>.</span>Y <span class="token operator" data-v-54601d22>=</span> Y

  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__len__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token string" data-v-54601d22>'Denotes the total number of samples'</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>X<span class="token punctuation" data-v-54601d22>)</span>

  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__getitem__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> index<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token string" data-v-54601d22>'Generates one sample of data'</span>
        <span class="token comment" data-v-54601d22># Select sample</span>
        x <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>X<span class="token punctuation" data-v-54601d22>[</span>index<span class="token punctuation" data-v-54601d22>]</span>
        y <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>Y<span class="token punctuation" data-v-54601d22>[</span>index<span class="token punctuation" data-v-54601d22>]</span>
        <span class="token keyword" data-v-54601d22>return</span> x<span class="token punctuation" data-v-54601d22>.</span>to<span class="token punctuation" data-v-54601d22>(</span>device<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>.</span>to<span class="token punctuation" data-v-54601d22>(</span>device<span class="token punctuation" data-v-54601d22>)</span>

train_ds <span class="token operator" data-v-54601d22>=</span> DatasetXY<span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>,</span>y_train<span class="token punctuation" data-v-54601d22>)</span>
valid_ds <span class="token operator" data-v-54601d22>=</span> DatasetXY<span class="token punctuation" data-v-54601d22>(</span>x_valid<span class="token punctuation" data-v-54601d22>,</span>y_valid<span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># we ccan use this isntead of DatasetXY</span>
<span class="token comment" data-v-54601d22>#train_ds = data.TensorDataset(x_train, y_train)</span>
<span class="token comment" data-v-54601d22>#valid_ds = data.TensorDataset(x_valid, y_valid)</span>
    
train_dl <span class="token operator" data-v-54601d22>=</span> data<span class="token punctuation" data-v-54601d22>.</span>DataLoader<span class="token punctuation" data-v-54601d22>(</span>train_ds<span class="token punctuation" data-v-54601d22>,</span>batch_size<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span>
valid_dl <span class="token operator" data-v-54601d22>=</span> data<span class="token punctuation" data-v-54601d22>.</span>DataLoader<span class="token punctuation" data-v-54601d22>(</span>valid_ds<span class="token punctuation" data-v-54601d22>,</span>batch_size<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># Our model</span>
<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Mnist_Logistic</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>lin <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>784</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>,</span> bias<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>

    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> xb<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> self<span class="token punctuation" data-v-54601d22>.</span>lin<span class="token punctuation" data-v-54601d22>(</span>xb<span class="token punctuation" data-v-54601d22>)</span>

model <span class="token operator" data-v-54601d22>=</span> Mnist_Logistic<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>cuda<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>


lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span>
loss_func <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>CrossEntropyLoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>from</span> torch <span class="token keyword" data-v-54601d22>import</span> optim

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>update</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>,</span>lr<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    opt <span class="token operator" data-v-54601d22>=</span> optim<span class="token punctuation" data-v-54601d22>.</span>Adam<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>.</span>parameters<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span>
    y_hat <span class="token operator" data-v-54601d22>=</span> model<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span>
    loss <span class="token operator" data-v-54601d22>=</span> loss_func<span class="token punctuation" data-v-54601d22>(</span>y_hat<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>)</span>
    loss<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
    opt<span class="token punctuation" data-v-54601d22>.</span>step<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
    opt<span class="token punctuation" data-v-54601d22>.</span>zero_grad<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>return</span> loss<span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_batch</span><span class="token punctuation" data-v-54601d22>(</span>dl<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>for</span> x<span class="token punctuation" data-v-54601d22>,</span>y <span class="token keyword" data-v-54601d22>in</span> dl<span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>yield</span> x<span class="token punctuation" data-v-54601d22>.</span>to<span class="token punctuation" data-v-54601d22>(</span>device<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>.</span>to<span class="token punctuation" data-v-54601d22>(</span>device<span class="token punctuation" data-v-54601d22>)</span>

losses <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>update<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> x<span class="token punctuation" data-v-54601d22>,</span>y <span class="token keyword" data-v-54601d22>in</span> get_batch<span class="token punctuation" data-v-54601d22>(</span>train_dl<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plt<span class="token punctuation" data-v-54601d22>.</span>plot<span class="token punctuation" data-v-54601d22>(</span>losses<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
</code></pre></div></div></div><p><img src="/assets/img/1551983650860.18423599.png" alt="1551983650860"></p><h3 id="using-model-with-fastai"><a href="#using-model-with-fastai" aria-hidden="true" class="header-anchor">#</a> Using model with fastai</h3><p>We can also use our model with <code>fastai</code> library, instead of creating our.</p><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> DataBunch<span class="token punctuation">.</span>create<span class="token punctuation">(</span>train_ds<span class="token punctuation">,</span> valid_ds<span class="token punctuation">,</span> bs<span class="token operator">=</span>bs<span class="token punctuation">)</span> <span class="token comment"># We don't need create our own loader</span>

loss_func <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Mnist_NN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lin1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">784</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lin2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>lin1<span class="token punctuation">(</span>xb<span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>lin2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

learn <span class="token operator">=</span> Learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> Mnist_NN<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> loss_func<span class="token operator">=</span>loss_func<span class="token punctuation">,</span> metrics<span class="token operator">=</span>accuracy<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> gzip
<span class="token keyword" data-v-54601d22>import</span> pickle
<span class="token keyword" data-v-54601d22>import</span> matplotlib<span class="token punctuation" data-v-54601d22>.</span>pyplot <span class="token keyword" data-v-54601d22>as</span> plt
<span class="token comment" data-v-54601d22># from fastai.basics import *</span>

path <span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'./mnist.pkl.gz'</span>

<span class="token keyword" data-v-54601d22>with</span> gzip<span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>open</span><span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'rb'</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>as</span> f<span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>,</span> y_train<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token punctuation" data-v-54601d22>(</span>x_valid<span class="token punctuation" data-v-54601d22>,</span> y_valid<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> _<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>=</span> pickle<span class="token punctuation" data-v-54601d22>.</span>load<span class="token punctuation" data-v-54601d22>(</span>f<span class="token punctuation" data-v-54601d22>,</span> encoding<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'latin-1'</span><span class="token punctuation" data-v-54601d22>)</span>
    
<span class="token comment" data-v-54601d22>#plt.imshow(x_train[0].reshape((28,28)), cmap=&quot;gray&quot;)</span>

<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>basics <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span> <span class="token comment" data-v-54601d22>#it replace all imports from torch</span>
<span class="token comment" data-v-54601d22>#import torch</span>
<span class="token comment" data-v-54601d22>#import torch.nn as nn</span>
<span class="token comment" data-v-54601d22>#from torch.utils import data</span>



x_train<span class="token punctuation" data-v-54601d22>,</span>y_train<span class="token punctuation" data-v-54601d22>,</span>x_valid<span class="token punctuation" data-v-54601d22>,</span>y_valid <span class="token operator" data-v-54601d22>=</span> <span class="token builtin" data-v-54601d22>map</span><span class="token punctuation" data-v-54601d22>(</span>torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>,</span> <span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>,</span>y_train<span class="token punctuation" data-v-54601d22>,</span>x_valid<span class="token punctuation" data-v-54601d22>,</span>y_valid<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>


bs<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>64</span>
train_ds <span class="token operator" data-v-54601d22>=</span> TensorDataset<span class="token punctuation" data-v-54601d22>(</span>x_train<span class="token punctuation" data-v-54601d22>,</span>y_train<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># we don't need DataSetXY</span>
valid_ds <span class="token operator" data-v-54601d22>=</span> TensorDataset<span class="token punctuation" data-v-54601d22>(</span>x_valid<span class="token punctuation" data-v-54601d22>,</span>y_valid<span class="token punctuation" data-v-54601d22>)</span>

data <span class="token operator" data-v-54601d22>=</span> DataBunch<span class="token punctuation" data-v-54601d22>.</span>create<span class="token punctuation" data-v-54601d22>(</span>train_ds<span class="token punctuation" data-v-54601d22>,</span> valid_ds<span class="token punctuation" data-v-54601d22>,</span> bs<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># We don't need create our own loader</span>


lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span>
loss_func <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>CrossEntropyLoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Mnist_NN</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>lin1 <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>784</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>50</span><span class="token punctuation" data-v-54601d22>,</span> bias<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>lin2 <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>50</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>,</span> bias<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>

    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> xb<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        x <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>lin1<span class="token punctuation" data-v-54601d22>(</span>xb<span class="token punctuation" data-v-54601d22>)</span>
        x <span class="token operator" data-v-54601d22>=</span> F<span class="token punctuation" data-v-54601d22>.</span>relu<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span>
        <span class="token keyword" data-v-54601d22>return</span> self<span class="token punctuation" data-v-54601d22>.</span>lin2<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span>

learn <span class="token operator" data-v-54601d22>=</span> Learner<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> Mnist_NN<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> loss_func<span class="token operator" data-v-54601d22>=</span>loss_func<span class="token punctuation" data-v-54601d22>,</span> metrics<span class="token operator" data-v-54601d22>=</span>accuracy<span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>lr_find<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>recorder<span class="token punctuation" data-v-54601d22>.</span>plot<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1551984419055.a41751f5.png" alt="1551984419055"></p><p><img src="data:image/png;base64,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" alt="1551984427879"></p><h2 id="fast-ai"><a href="#fast-ai" aria-hidden="true" class="header-anchor">#</a> fast.ai <a href="https://github.com/fastai/fastai" target="_blank" title="https://github.com/fastai/fastai" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>github</span></a></h2><p>Fast.ai is a very popular library for deep learning based on the PyTorch. The library simplifies training fast and accurate neural nets using modern best practices. fast.ai doesn’t replace any base functionality from the PyTorch. It adds a lot of functions that can help you build a model faster.</p><p><span class="red" data-v-9e33b382>Requires Python &gt;=3.6</span> (<code>python --version</code>)</p><h3 id="installation-google-colab"><a href="#installation-google-colab" aria-hidden="true" class="header-anchor">#</a> Installation / Google Colab  <a href="https://course.fast.ai/start_colab.html" target="_blank" title="https://course.fast.ai/start_colab.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>source</span></a></h3><p>On Google Colab you don’t have to install fast.ai. It is installed already. Google Colab gives you Tesla K80 machine with 12GB of GPU RAM.</p><ol><li>Go to a page: <a href="https://colab.research.google.com" target="_blank" rel="noopener noreferrer">https://colab.research.google.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>Create new Python 3 notebook</li></ol><p><img src="/assets/img/1548781198400.677f18c7.png" alt="1548781198400"></p><ol start="3"><li>Make sure that you have setup GPU mode</li></ol><p><img src="/assets/img/1548781236103.599ac401.png" alt="1548781236103"></p><p><img src="/assets/img/1548781252590.79972f93.png" alt="1548781252590"></p><ol start="4"><li>Check version</li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> fastai
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'fastai: version: '</span><span class="token punctuation">,</span> fastai<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2MAAABlCAYAAADAgDuJAAAetklEQVR4nO3dfVRU5d438O8wvLjV8cAMpA0qQryolJh4RCTTu8xTmi9peoPmc3zpOScf84HKND1lK5fd3JDnLMhc5knT55DgiUKF7O5QGmqKaBBQ1gERg2BScwZzzK3AzDx/4N7ODG8DDA7i97MWK5lr9jXXHsYWX3+/fW2FxWKxwI70kEKhsB8iIiIiIiIiB7WVrRTWYcxisTCAERERERERdQP7vOXW2gARERERERE5j0KhgHVjojvQchBroXuRiIiIiIiIOkmhUMiBTKFQ2LYpAi2HMAYzIiIiIiKijmvxWrGbjynMZrPFvlzW2p+JiIiIiIioY6wDmfWf5TZFicVikb+3/y8RERERERE5zrot0f4xd+uqmBTEWvqSxomIiIiIiKhtcivizevEpC/rcXf7IGY2m+X/mkwm+XsGMiIiIiIiovbZBzE3NzcolUq4ubnJ3wNWbYrWAayxsREXL1503eodoNVqXb0EIiIiIiIih9XX18Pd3R0A4Obm1hTGJFIYq6+vd8niiIiIiIiIeqv6+nqbapkcxqR2xIaGBoii6Mo1EhERERER9TqiKMoti2azGW7ArTZFqSp27do1V6+TiIiIiIioV7l27Rrq6+thMplgsVjgZr0xh3S9GCtjREREREREziWKIhobG2+FMcB2S/vGxkZeM0ZERERERORk9fX1aGxslLOXm/Wg2WyWv4iIiIiIiMh57POWW0tP4r3EiIiIiIiInMs+ZzGMERERERER3QbthjEGMSIiIiIiou5hnbfc23hepzU2NqK4uBilpaWoqanBxYsX4ebmBo1GgyFDhmDUqFEYPXq0fPdpIiIiIiKiu43T09Dp06eRlpYGvV7fbKympgY1NTXIz8+HRqPBokWLEB4e7uwlEBERERER9XhODWMHDhzAvn37HHquXq9HamoqZs2ahenTp3f5ta82etp876dS4hejqcvzEhERERHRna2/e+dv3WU0GqHX6zFs2DAnrqiJ08JYR4KYxGKxyMc4I5ARERERERE5y6FDh5CVlQWz2YzZs2dj6tSpTp2/xd0UO+r777/H/v37O338/v378f333ztjKc3oy/R4L3wbvkv7tlvmv53+mrQRfiol/FRK/DVpo0vXcvLEMfiplDh54phL10FERERE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kYiIiIiIqCdhmyIREREREVEPwDBGRERERETkAgxjRERERERELsAwRkRERERE5AIMY0RERERERC7AMEZEREREROQCDGNEREREREQuwDBGRERERETkAgxjRERERERELsAwRkRERERE5AIMY0RERERERC7AMEZEREREROQC7q0NBAUF3c51EBERERER3VVYGSMiIiIiInIBhjEiIiIiIiIXYBgjIiIiIiJyAYYxIiIiIiIiF2AYIyIiIiIicgGGMSIiIiIiIhdgGCMiIiIiInIBhjEiIiIiIiIXYBgjIiIiIiJygV4bxgoKChAUFISgoCBMnDgRFRUVrl4SACAzMxNBQUEoKChw9VKcKjk5uUe9z0REREREPZ27syc8ceJEu0EjKioK48ePd/ZLy+rq6pCUlISMjAxERUU5de7k5GQEBgZi3rx5Tp2XXCMzMxNr1qzp8GdFFEWsXbsW2dnZAIDnnnsOq1ev7tBrS3MUFhZi586dCA4Olsfq6uqwbNkyDB06FImJiRAEoUNzExEREVHP5/QwVlBQgNTU1DafEx8f361hTK/Xw9vbG6Ghod32Gp01b968XhnkVq9e3eEw4kpSEAoNDcXo0aM7fPzmzZuh1WpRWVkpB6fMzMwO/Ww/+eQTAEBISIjN4wUFBUhKSsKUKVNQXl7e4bURERER0Z2h29oUKysrW/y6HfR6PS5fvtziWF1dHebMmSO3MCYnJ9uMW7c3BgUFITMzE8Ct9sJ3330Xa9asafH4tua2HmurnS85ORlz5sxBXV2dQ+cqiiISEhLkdbb2mLT+oKCgZvMnJycjMzPT5jnW1U3780pISIAoigCAiooKTJw4scV52zu2rq4OCQkJKCgokOewHrdeu7NbID/55BPExcUhLi6uw8dWVFQgPz8fc+bMAQD4+PggLi4Ox44da7b2tuZIT09v9vp1dXU4fPgwdu/eDT8/vw6vjYiIiIjuHLf9mrH4+Hintw5KpDARFxeH4uJiREZGNgtF2dnZ2LFjByorK1FYWGjTVllXV4dt27YhNzdXDo9SpWPevHmorKzEc889h6SkJHncuhrU1tw+Pj7IyspCYWFhs0pIVwiCgJiYGJsgcP36dVy5cgUPPvgggKaAmZGRgcLCQlRWViIuLg5vvPGGTXBYs2YNzp07h8rKSrnFUxp/7733EBcXJ59zSkqK3DYXHByMo0eP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" alt="1548787769768"></p><ol start="5"><li>Test some code from the fast.ai course:</li></ol><div class="language-python extra-class"><pre class="language-python"><code>
<span class="token operator">%</span>reload_ext autoreload
<span class="token operator">%</span>autoreload <span class="token number">2</span>
<span class="token operator">%</span>matplotlib inline

<span class="token keyword">from</span> fastai <span class="token keyword">import</span><span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

bs <span class="token operator">=</span> <span class="token number">64</span>
<span class="token comment"># bs = 16   # uncomment this line if you run out of memory even after clicking Kernel-&gt;Restart</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>PETS<span class="token punctuation">)</span><span class="token punctuation">;</span> path
path_anno <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'annotations'</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span>


fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pat <span class="token operator">=</span> r<span class="token string">'/([^/]+)_\d+.jpg$'</span>


data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>path_img<span class="token punctuation">,</span> 
                                   fnames<span class="token punctuation">,</span> pat<span class="token punctuation">,</span> 
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> 
                                   bs<span class="token operator">=</span>bs
                                  <span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1548781400369"></p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">)</span>
<span class="token comment">#len(data.classes),data.c</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1548781504899.ca2ae27a.png" alt="1548781504899"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
interp <span class="token operator">=</span> ClassificationInterpretation<span class="token punctuation">.</span>from_learner<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
losses<span class="token punctuation">,</span>idxs <span class="token operator">=</span> interp<span class="token punctuation">.</span>top_losses<span class="token punctuation">(</span><span class="token punctuation">)</span>


interp<span class="token punctuation">.</span>plot_top_losses<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiUAAABpCAYAAADlaFPVAAAbAElEQVR4nO3dQWgb6f038K9K4bX4EzdaNYdKoMVCmIJbYeODHLSu92AM29erlwi8oOxhyZoSH5KsoancFLLGPTSRyMEkSzEEk+5hd6hVBCsHAsaHFcZEOhgLg2lxhEwEUmGDopDw3/Gpeg/meTojjTSSLduy/f2AaVeamef3PDPR85vneUayVCqVCqqIlywWS/VbLUun01AUBffu3YPVaj308YiIiOj0apRj/KTehu1ISAAgmUzC7/czISEiIiJdjlE9LiKTkkql0rZERMhms/jXv/6F0dHRth6XiIiITj+LxaJLTH4CHE1CUi6XEQ6Hcf36ddhstrYem4iIiM4GbWJiMVpT0g6xWAwAMDExcRSHJyIiojPG8p///KfS7lESIiIiolZUKhX9QlciIiKik3Jk0zdEREREreBICREREXWEuklJuVzG9PQ0yuXyccZDRERE51TdpMRms8Hv92Nubg6qqh5nTERERHQONZy+mZiYgMPhwNOnT48rHiIiIjqnTNeUBINBPHv2jNM4REREdKRMkxKn04nu7m7s7OwcRzxERER0TpkmJVarFQ6HA/l8/jjiISIionOqqUeCe3p6sLu7e9SxEBER0TnWVFKyu7uLnp6eo46FiIiIzjHTpERVVRSLRbhcruOIh4iIiM4p06SkUCjg7du36O3tPY54iIiI6JwyTUri8Tg++ugj2Gy244iHiIiIzqmGSUksFkOxWMT4+PhxxUNERETnVMPfvllfX8fs7CysVutxxkRERETnkKVSqVROOggiIiKinxq9uLS0dNxxEBEdyCeffHLSIRBRmxgmJcDB/6G/fv0a77333oEDOs37n+bYT3r/0xz7Se9/mmM/7P68gSI6W5r68jQiIiKio8akhIiIiDoCkxIiOnNUVcX09DTcbjfcbjei0WjD7dPptNx2eHgY2WxW934sFpPvB4NBlMtlw/disZguhrt379Ycq1o0Gq05bqPy6h1b1DmdTjcsr1wuIxgMGsbcTFtUaxRrq+ehmtn+ZnVpJdZG7xudIzoaTEqI6Mx59OgRHA4Hcrkctre3USwW63ZY2WwW9+/fx8rKCnK5HB48eIBwOCw7n3Q6DUVRsLGxgVwuh1AohLm5OaiqinK5jGfPnmFlZQUrKyv49ttvZSe+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" alt="1548781518290"></p><p><img src="/assets/img/1548791676403.1dd96b0f.png" alt="1548791676403"></p><ol start="6"><li>You can open the github repo directly from the course <code>https://github.com/fastai/course-v3.git</code></li></ol><p><img src="/assets/img/1548782192774.57159cf9.png" alt="1548782192774"></p><p><img src="/assets/img/1548782244713.bcf9e5ea.png" alt="1548782244713"></p><ol start="7"><li>Or Upload from your computer</li></ol><p><img src="/assets/img/1548782293026.e5de64dc.png" alt="1548782293026"></p><p><img src="/assets/img/1548788564305.daffe66e.png" alt="1548788564305"></p><h3 id="installion-aws"><a href="#installion-aws" aria-hidden="true" class="header-anchor">#</a> installion / AWS</h3><div class="warning custom-block"><p class="custom-block-title">AWS Free Tier doesn’t include GPU computer</p><p>The instance called <code>p2.xlarge</code> that is dedicated for the deep learning cost about <code>0.9$ per hour.</code> . First you need request to increase the service limit.</p></div><ci i="https://aws.amazon.com/blogs/aws/new-p2-instance-type-for-amazon-ec2-up-to-16-gpus/" t="source"></ci><p><code>p2.xlarge</code> has the NVIDIA GK210 Tesla K80 GPU Machine</p><p><img src="/assets/img/1548792962650.3a2a88ad.png" alt="1548792962650"></p><ol><li>When you login for your AWS as a Free Tier you don’t have acces to create instance called <code>p2.xlarge</code>. First go to the dashboard and request for new limit for this instance.</li></ol><p><img src="/assets/img/1548782638507.1df5737c.png" alt="1548782638507"></p><p><img src="data:image/png;base64,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" alt="1548782656757"></p><p><img src="data:image/png;base64,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" alt="1548782674826"></p><p>In your request form choose the best <strong>Region</strong>, <strong>Instance Type</strong>, and <strong>New Limit Value</strong>.</p><p><img src="/assets/img/1548782883630.a6df1336.png" alt="1548782883630"></p><p>In the description you can type: <code>‘[FastAI] Limit Increase Request’</code></p><p><img src="/assets/img/1548782954025.7d8d29f8.png" alt="1548782954025"></p><p>After couple of days (usually one) you will get new limit for your Free Tier (<code>This will still charge you for this computer</code>)</p><ol start="2"><li>After you have ability to create new <code>p2.xlarge instance</code>, you can create new one.</li></ol><p>In the services click <strong>EC2</strong>, and next <strong>instances</strong></p><p><img src="/assets/img/1548783181553.ead28183.png" alt="1548783181553"></p><p><img src="/assets/img/1548783218231.f384270d.png" alt="1548783218231"></p><p>and click <strong>Launch instance</strong></p><p><img src="data:image/png;base64,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" alt="1548783245159"></p><ol start="2"><li>In a list find <strong>deep learning</strong> instances</li></ol><p><img src="/assets/img/1548783307267.28268b3d.png" alt="1548783307267"></p><p>And select newest one:</p><p><img src="/assets/img/1548783324760.016db6ce.png" alt="1548783324760"></p><ol start="3"><li>In the <strong>Instance type</strong> choose <code>p2.xlarge</code> and click <strong>Next: Configure Instance details</strong></li></ol><p><img src="/assets/img/1548783390814.2ea01f74.png" alt="1548783390814"></p><ol start="4"><li>We don’t change anything in <strong>Instance Details</strong>, just click <strong>next</strong></li></ol><p><img src="/assets/img/1548783484833.a707c2dc.png" alt="1548783484833"></p><ol start="5"><li>In the storage we stay as it is ( 75 GB).</li></ol><p><img src="/assets/img/1548783505382.ab3d9ed1.png" alt="1548783505382"></p><ol start="6"><li>We don’t add any tags.</li><li>In <strong>Configure securiity Group</strong>, add your IP to allow from your IP allow to connect (it can be only <strong>SSH</strong> or <strong>All traffic</strong> if you want), and click <strong>next</strong></li></ol><p><img src="/assets/img/1548792681361.03345f30.png" alt="1548792681361"></p><ol start="8"><li>You will see that your network is not eligible for the free usage tier, click <strong>Launch</strong>.</li></ol><p><img src="/assets/img/1548792728048.4262a83e.png" alt="1548792728048"></p><ol start="9"><li>Now you need to create your key pair to login into your instance. If you create one you can use the same, but first:</li></ol><p>Choose name, and click <strong>Download Key Pair</strong>, and store the key in the safe place.</p><p><img src="/assets/img/1548783776548.173ff113.png" alt="1548783776548"></p><p>If you are using <code>putty.exe</code>, you need to divide your key into private and public key.</p><ul><li>Download the <code>puttygen.exe</code> from the <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank" rel="noopener noreferrer">https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>Click load to load your private/public key: (choose All Files *.*)</li></ul><p><img src="/assets/img/1548783977245.654d4de7.png" alt="1548783977245"></p><p><img src="/assets/img/1548783995980.ed1ebf4a.png" alt="1548783995980"></p><ul><li>Click <strong>Save private key</strong></li></ul><p><img src="data:image/png;base64,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" alt="1548784064758"></p><ul><li>This will generate your private key  (<code>.ppk</code>) to use in the <code>putty.exe</code></li></ul><div class="warning custom-block"><p class="custom-block-title">If you loose your key</p><p>You will loose your access to the server</p></div><ol start="10"><li>Click view Instances</li></ol><p><img src="/assets/img/1548792807620.58003b0d.png" alt="1548792807620"></p><ol start="11"><li>On the instance you can now login with the <code>putty.exe</code></li></ol><ul><li>In a connection\SSH\Auth browse your private key (<code>.ppk</code>)</li></ul><p><img src="/assets/img/1548784332519.9ab91b5c.png" alt="1548784332519"></p><ul><li>In the session write your IP</li></ul><p><img src="/assets/img/1548792569401.c549fb29.png" alt="1548792569401"></p><ol start="12"><li><p>Login as <strong>ubuntu</strong></p></li><li><p>update your libralies</p></li></ol><div class="language-python extra-class"><pre class="language-python"><code>conda install <span class="token operator">-</span>c fastai fastai
</code></pre></div><ol start="14"><li>Setup password for your notebook</li></ol><div class="language-python extra-class"><pre class="language-python"><code> jupyter notebook password
</code></pre></div><p><img src="/assets/img/1548784862543.149fa9ee.png" alt="1548784862543"></p><ol start="15"><li>Run jupyter notebook</li></ol><div class="language-python extra-class"><pre class="language-python"><code>ipython notebook <span class="token operator">-</span><span class="token operator">-</span>no<span class="token operator">-</span>browser <span class="token operator">-</span><span class="token operator">-</span>port<span class="token operator">=</span><span class="token number">8002</span>
</code></pre></div><ol start="16"><li>Start tunneling to get to your notebook from the local webbrowser (<code>-i</code> is your downloaded .pem file from the Amazon AWS instance)</li></ol><div class="language-python extra-class"><pre class="language-python"><code>ssh <span class="token operator">-</span>N <span class="token operator">-</span>f <span class="token operator">-</span>L localhost<span class="token punctuation">:</span><span class="token number">8002</span><span class="token punctuation">:</span>localhost<span class="token punctuation">:</span><span class="token number">8002</span> ubuntu@__IP__ADRESS__ <span class="token operator">-</span>i fastai<span class="token operator">-</span><span class="token number">01.</span>pem
</code></pre></div><ol start="17"><li>got to the webpage: http://localhost:8002</li></ol><p><img src="/assets/img/1548785475325.3cdb779a.png" alt="1548785475325"></p><ol start="18"><li>Verify you choose kernel: <code>pytorch36</code></li></ol><p><img src="/assets/img/1548786200488.a209af56.png" alt="1548786200488"></p><ol start="18"><li>Verify library for <code>fastai</code></li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai <span class="token keyword">import</span><span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
</code></pre></div><ul><li>You will get the error about <code>dataclasses</code>. You need to install them</li></ul><p><img src="/assets/img/1548785884823.01fde125.png" alt="1548785884823"></p><div class="language-python extra-class"><pre class="language-python"><code>!pip install dataclasses
</code></pre></div><ol start="19"><li>Verify download data:</li></ol><div class="language-python extra-class"><pre class="language-python"><code>bs <span class="token operator">=</span> <span class="token number">64</span>
<span class="token comment"># bs = 16   # uncomment this line if you run out of memory even after clicking Kernel-&gt;Restart</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>PETS<span class="token punctuation">)</span><span class="token punctuation">;</span> path
path_anno <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'annotations'</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span>


fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pat <span class="token operator">=</span> r<span class="token string">'/([^/]+)_\d+.jpg$'</span>


data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>path_img<span class="token punctuation">,</span> 
                                   fnames<span class="token punctuation">,</span> pat<span class="token punctuation">,</span> 
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> 
                                   bs<span class="token operator">=</span>bs
                                  <span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1548786238799.7d3f1fe2.png" alt="1548786238799"></p><div class="warning custom-block"><p class="custom-block-title">Error while loading data</p><p>Sometimes you will get the error:</p><p><code>RecursionError: maximum recursion depth exceeded while calling a Python object</code></p><p>You need  to increase limit of the recursion:</p><p><code>import sys; sys.setrecursionlimit(10000) lub więcej, 100k</code></p></div><ol start="20"><li>Verify creating model</li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">)</span>
<span class="token comment">#len(data.classes),data.c</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">)</span>
</code></pre></div><ol start="21"><li>Verify calculating epochs.</li></ol><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
interp <span class="token operator">=</span> ClassificationInterpretation<span class="token punctuation">.</span>from_learner<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
losses<span class="token punctuation">,</span>idxs <span class="token operator">=</span> interp<span class="token punctuation">.</span>top_losses<span class="token punctuation">(</span><span class="token punctuation">)</span>


interp<span class="token punctuation">.</span>plot_top_losses<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1548786340529"></p><p><img src="/assets/img/1548786462857.2b0c772e.png" alt="1548786462857"></p><ol start="22"><li>Stop your instance after you finish working (or <strong>Terminate</strong> to remove the whole instance)</li></ol><p><img src="/assets/img/1548792872371.d68602cd.png" alt="1548792872371"></p><div class="warning custom-block"><p class="custom-block-title">Remember to stop your instance</p><p>If you don’t do this Amazon will charge you for every hour of using your instance. If You only <strong>Stop</strong> your instance, Amazon will charge you for <code>ELASTIC BLOCK STORE</code> (Free Tier allow you to have maximum 30GB and <code>p2.xlarge</code> has 75GB) but the cost is much less than running machine (about 5 dollars per month).</p></div><h3 id="installation-google-cloud"><a href="#installation-google-cloud" aria-hidden="true" class="header-anchor">#</a> installation / Google Cloud</h3><p>Google cloud also is not a free option, but at the beginining you’ve got 300$ to use in your computer. It is enough to run a machine and go through all courses in the fast.ai library. First think you need to do is to create an account at <a href="https://cloud.google.com/" target="_blank" rel="noopener noreferrer">https://cloud.google.com/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p><p>Free credits are not eligible to run GPU machine, that’s why you need post a ticket to give you permission for GPU machine.</p><ol><li>On your console <a href="https://console.cloud.google.com" target="_blank" rel="noopener noreferrer">https://console.cloud.google.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, in the IAM &amp; Admin go to <code>Quotas</code>.</li></ol><p><img src="/assets/img/1551261621298.7db9b4a7.png" alt="1551261621298"></p><ol start="2"><li>Filter metrics to GPUs (all regions)</li></ol><p><img src="/assets/img/1551261729127.bef4f820.png" alt="1551261729127"></p><ol start="3"><li>Click on the <code>Compute Enginge API</code>, and create new Quota.</li></ol><p><img src="/assets/img/1551261828322.d64e5dfe.png" alt="1551261828322"></p><ol start="4"><li>Set up new limit to <code>1</code>.</li></ol><p><img src="/assets/img/1551261869250.94c174d4.png" alt="1551261869250"></p><ol start="5"><li>Wait for acceptance of your ticket. It could take couple hours, or even couple days.</li></ol><p><img src="/assets/img/1551261929324.5fa66498.png" alt="1551261929324"></p><ol start="6"><li>When you have new limit, time to create a new instance. The best option is to create your instance by console. Install <code>gcloud</code> going trhough the instructions: <a href="https://cloud.google.com/sdk/docs/quickstarts" target="_blank" rel="noopener noreferrer">https://cloud.google.com/sdk/docs/quickstarts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol><div class="warning custom-block"><p class="custom-block-title">A lot of errors</p><p>I’ve got a lot of errors during installation on Windows 10. Most of them I resolved by restarting a system.</p></div><ol start="7"><li>Now create your machine:</li></ol><p><code>Windows command GPU</code></p><div class="language-python extra-class"><pre class="language-python"><code>gcloud compute instances create <span class="token string">&quot;my-instance-01&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>zone<span class="token operator">=</span><span class="token string">&quot;us-west2-b&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>image<span class="token operator">-</span>family<span class="token operator">=</span><span class="token string">&quot;pytorch-latest-gpu&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>image<span class="token operator">-</span>project<span class="token operator">=</span>deeplearning<span class="token operator">-</span>platform<span class="token operator">-</span>release <span class="token operator">-</span><span class="token operator">-</span>maintenance<span class="token operator">-</span>policy<span class="token operator">=</span>TERMINATE <span class="token operator">-</span><span class="token operator">-</span>accelerator<span class="token operator">=</span><span class="token string">&quot;type=nvidia-tesla-p4,count=1&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>machine<span class="token operator">-</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;n1-highmem-8&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>boot<span class="token operator">-</span>disk<span class="token operator">-</span>size<span class="token operator">=</span>200GB <span class="token operator">-</span><span class="token operator">-</span>metadata<span class="token operator">=</span><span class="token string">&quot;install-nvidia-driver=True&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>preemptible
</code></pre></div><p><code>WIndows command CPU</code></p><div class="language-python extra-class"><pre class="language-python"><code>gcloud compute instances create <span class="token string">&quot;my-instance-01&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>zone<span class="token operator">=</span><span class="token string">&quot;us-west2-b&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>image<span class="token operator">-</span>family<span class="token operator">=</span><span class="token string">&quot;pytorch-latest-cpu&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>image<span class="token operator">-</span>project<span class="token operator">=</span>deeplearning<span class="token operator">-</span>platform<span class="token operator">-</span>release <span class="token operator">-</span><span class="token operator">-</span>maintenance<span class="token operator">-</span>policy<span class="token operator">=</span>TERMINATE  <span class="token operator">-</span><span class="token operator">-</span>machine<span class="token operator">-</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&quot;n1-highmem-8&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>boot<span class="token operator">-</span>disk<span class="token operator">-</span>size<span class="token operator">=</span>200GB <span class="token operator">-</span><span class="token operator">-</span>metadata<span class="token operator">=</span><span class="token string">&quot;install-nvidia-driver=True&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>preemptible
</code></pre></div><p><code>Bash/Linux</code>:</p><div class="language-python extra-class"><pre class="language-python"><code>export IMAGE_FAMILY<span class="token operator">=</span><span class="token string">&quot;pytorch-latest-gpu&quot;</span> <span class="token comment"># or &quot;pytorch-latest-cpu&quot; for non-GPU instances</span>
export ZONE<span class="token operator">=</span><span class="token string">&quot;us-west2-b&quot;</span> <span class="token comment"># budget: &quot;us-west1-b&quot;</span>
export INSTANCE_NAME<span class="token operator">=</span><span class="token string">&quot;my-fastai-instance&quot;</span>
export INSTANCE_TYPE<span class="token operator">=</span><span class="token string">&quot;n1-highmem-8&quot;</span> <span class="token comment"># budget: &quot;n1-highmem-4&quot;</span>

<span class="token comment"># budget: 'type=nvidia-tesla-k80,count=1'</span>
gcloud compute instances create $INSTANCE_NAME \
        <span class="token operator">-</span><span class="token operator">-</span>zone<span class="token operator">=</span>$ZONE \
        <span class="token operator">-</span><span class="token operator">-</span>image<span class="token operator">-</span>family<span class="token operator">=</span>$IMAGE_FAMILY \
        <span class="token operator">-</span><span class="token operator">-</span>image<span class="token operator">-</span>project<span class="token operator">=</span>deeplearning<span class="token operator">-</span>platform<span class="token operator">-</span>release \
        <span class="token operator">-</span><span class="token operator">-</span>maintenance<span class="token operator">-</span>policy<span class="token operator">=</span>TERMINATE \
        <span class="token operator">-</span><span class="token operator">-</span>accelerator<span class="token operator">=</span><span class="token string">&quot;type=nvidia-tesla-p4,count=1&quot;</span> \
        <span class="token operator">-</span><span class="token operator">-</span>machine<span class="token operator">-</span><span class="token builtin">type</span><span class="token operator">=</span>$INSTANCE_TYPE \
        <span class="token operator">-</span><span class="token operator">-</span>boot<span class="token operator">-</span>disk<span class="token operator">-</span>size<span class="token operator">=</span>200GB \
        <span class="token operator">-</span><span class="token operator">-</span>metadata<span class="token operator">=</span><span class="token string">&quot;install-nvidia-driver=True&quot;</span> \
        <span class="token operator">-</span><span class="token operator">-</span>preemptible
</code></pre></div><p><img src="data:image/png;base64,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wkMB60NuXqUkKge4TrthP0NdsC4/yzSI8oWIiOgcqSwN+E8lfPSv/h4++O4PmhaZsXRGfa2On3lsUgb56D7f32h+7cxFcpHTTkREVEfqkPTv/CF+OHENG9950OToeKNfGcbbkC0RERERuXUZAH7nH/0WTv7kD/HDQ+Dd/uZFZjk54enO0HLyOQbXtKdsvQzZEhEREZFrbwHvvXnwve/g15/9PlJ/Brzb/36z40RERERELaT8lPS1r/h6KQwRERERnXOXgP+N/E/+Cu2/dxu/3ezYEBEREVHLuQQA/+ejf4tv/ck1jH/0UbPjQ0REREQtpvJaHQ3nMBIRERGRXgus9EJERERErYwdRiIiIiISuvTVr3612XEgIiIiohb1xbffxqX33+ecRSIiIiKyFn3vPVz6xje+0ex4EBEREVGL6v36dVx68OAB3nnnnWbHhYiIiIhazBfffhv3vzmGy1/60pfw3//XX+DPN3+E169f44Pv/qDZcSMiIiKiFvDtmT/AV758DZcB4De/8mt4q7sN/+Sfj+Nvf5kPwRARERFdZF98+218e+YPkLg5AgB4682bN+UXd//85z/H9zNPsPvxHnb29poWSSIiIiJqvOh7PYi++y7+zYN7+I2vdpY///+klTK4KA+toAAAAABJRU5ErkJggg==" alt="1551262933905"></p><ol start="8"><li>You should also see your instance in the google console. <a href="https://console.cloud.google.com" target="_blank" rel="noopener noreferrer">https://console.cloud.google.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol><p><img src="/assets/img/1551263023358.d4fce13d.png" alt="1551263023358"></p><p><img src="/assets/img/1551263120582.3fc07aee.png" alt="1551263120582"></p><ol start="9"><li>Now you can login to your <code>jupyter notebook</code>. This will forward a jupyter port <code>8080</code> to your localhost port.</li></ol><div class="language-python extra-class"><pre class="language-python"><code>gcloud compute ssh jupyter@my<span class="token operator">-</span>instance<span class="token operator">-</span><span class="token number">01</span> <span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span>L <span class="token number">8080</span><span class="token punctuation">:</span>localhost<span class="token punctuation">:</span><span class="token number">8080</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">gcloud compute ssh refuses connection (return code 255)</p><p>When I first try to login to the ssh I’ve got error 255. For this  recreate your internal routing. <a href="https://stackoverflow.com/questions/45155619/gcloud-compute-ssh-refuses-connection-return-code-255" target="_blank" title="https://stackoverflow.com/questions/45155619/gcloud-compute-ssh-refuses-connection-return-code-255" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></p><div class="language- extra-class"><pre class="language-text"><code>gcloud compute routes list
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>gcloud compute routes create default-internet \
--destination-range 0.0.0.0/0 \
--next-hop-gateway default-internet-gateway
</code></pre></div></div><ol><li>Login to your machine <a href="http://localhost:8080/lab?" target="_blank" rel="noopener noreferrer">http://localhost:8080/lab?<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ol><p><img src="/assets/img/1551263348669.ec6b3a29.png" alt="1551263348669"></p><ol start="11"><li>Update to the latest version</li></ol><div class="language-python extra-class"><pre class="language-python"><code>pip install fastai <span class="token operator">-</span><span class="token operator">-</span>upgrade
</code></pre></div><ol start="12"><li>Create new notebook and run. (this version has already installed <code>fastai</code>)</li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai <span class="token keyword">import</span><span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>__version__<span class="token punctuation">)</span>

bs <span class="token operator">=</span> <span class="token number">64</span>
<span class="token comment"># bs = 16   # uncomment this line if you run out of memory even after clicking Kernel-&gt;Restart</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>PETS<span class="token punctuation">)</span><span class="token punctuation">;</span> path
path_anno <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'annotations'</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span>


fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pat <span class="token operator">=</span> r<span class="token string">'/([^/]+)_\d+.jpg$'</span>


data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>path_img<span class="token punctuation">,</span> 
                                   fnames<span class="token punctuation">,</span> pat<span class="token punctuation">,</span> 
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> 
                                   bs<span class="token operator">=</span>bs
                                  <span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551263919741.83d1a64c.png" alt="1551263919741"></p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">)</span>
<span class="token comment">#len(data.classes),data.c</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
interp <span class="token operator">=</span> ClassificationInterpretation<span class="token punctuation">.</span>from_learner<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
losses<span class="token punctuation">,</span>idxs <span class="token operator">=</span> interp<span class="token punctuation">.</span>top_losses<span class="token punctuation">(</span><span class="token punctuation">)</span>


interp<span class="token punctuation">.</span>plot_top_losses<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551264505006.776a2a59.png" alt="1551264505006"></p><div class="warning custom-block"><p class="custom-block-title">Stop your instance</p><p>Remember to stop your instance on the console when you finish your work.</p></div><h2 id="fast-ai-help-functions"><a href="#fast-ai-help-functions" aria-hidden="true" class="header-anchor">#</a> fast.ai / Help functions</h2><h3 id="open-image"><a href="#open-image" aria-hidden="true" class="header-anchor">#</a> open_image()</h3><p>Open single image,</p><div class="language-python extra-class"><pre class="language-python"><code>im <span class="token operator">=</span> open_image<span class="token punctuation">(</span><span class="token string">'images/Maine_Coon_97.jpg'</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
im<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549698053830.8ad8dea0.png" alt="1549698053830"></p><h3 id="open-mask-fn"><a href="#open-mask-fn" aria-hidden="true" class="header-anchor">#</a> open_mask(fn)</h3><p>Open mask by the function <code>fn</code>., that returns mask image file.</p><div class="language-python extra-class"><pre class="language-python"><code>mask <span class="token operator">=</span> open_mask<span class="token punctuation">(</span>get_y_fn<span class="token punctuation">(</span>img_f<span class="token punctuation">)</span><span class="token punctuation">)</span>
mask<span class="token punctuation">.</span>show<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22>!git clone https<span class="token punctuation" data-v-54601d22>:</span><span class="token operator" data-v-54601d22>//</span>github<span class="token punctuation" data-v-54601d22>.</span>com<span class="token operator" data-v-54601d22>/</span>alexgkendall<span class="token operator" data-v-54601d22>/</span>SegNet<span class="token operator" data-v-54601d22>-</span>Tutorial<span class="token punctuation" data-v-54601d22>.</span>git

    
<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>callbacks<span class="token punctuation" data-v-54601d22>.</span>hooks <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
    
path <span class="token operator" data-v-54601d22>=</span> Path<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'./SegNet-Tutorial/CamVid'</span><span class="token punctuation" data-v-54601d22>)</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'val'</span><span class="token punctuation" data-v-54601d22>)</span>
lbl_names <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'valannot'</span><span class="token punctuation" data-v-54601d22>)</span>

img_f <span class="token operator" data-v-54601d22>=</span> fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span>
img <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>img_f<span class="token punctuation" data-v-54601d22>)</span>
img<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_y_fn</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> Path<span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>.</span>parent<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>+</span><span class="token string" data-v-54601d22>'annot'</span><span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span>x<span class="token punctuation" data-v-54601d22>.</span>name

mask <span class="token operator" data-v-54601d22>=</span> open_mask<span class="token punctuation" data-v-54601d22>(</span>get_y_fn<span class="token punctuation" data-v-54601d22>(</span>img_f<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
mask<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> alpha<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1550779832997.2a0a5632.png" alt="1550779832997"></p><h3 id="show"><a href="#show" aria-hidden="true" class="header-anchor">#</a> .show()</h3><p>Show image in the output.</p><div class="language-python extra-class"><pre class="language-python"><code>im <span class="token operator">=</span> open_image<span class="token punctuation">(</span><span class="token string">'images/Maine_Coon_97.jpg'</span><span class="token punctuation">)</span>
im<span class="token punctuation">.</span>show<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'Title of the image'</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
im<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

fig<span class="token punctuation" data-v-54601d22>,</span> axs <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
i <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>180</span>
<span class="token keyword" data-v-54601d22>for</span> ax <span class="token keyword" data-v-54601d22>in</span> axs<span class="token punctuation" data-v-54601d22>:</span>
    im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
    im<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>,</span> title<span class="token operator" data-v-54601d22>=</span>f<span class="token string" data-v-54601d22>'{i}'</span><span class="token punctuation" data-v-54601d22>)</span>
    i<span class="token operator" data-v-54601d22>+=</span><span class="token number" data-v-54601d22>1</span>
</code></pre></div></div></div><p><img src="/assets/img/1549698531867.7757609f.png" alt="1549698531867"></p><h3 id="apply-tfms"><a href="#apply-tfms" aria-hidden="true" class="header-anchor">#</a> .apply_tfms()</h3><p>Apply transformation for the image and return new image.</p><div class="language-python extra-class"><pre class="language-python"><code>im<span class="token punctuation">.</span>apply_tfms<span class="token punctuation">(</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
im<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
im<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549736278158.7c5496d9.png" alt="1549736278158"></p><h3 id="imagecleaner"><a href="#imagecleaner" aria-hidden="true" class="header-anchor">#</a> ImageCleaner</h3><p>Displays images for relabeling or deletion and saves changes in path.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>widgets <span class="token keyword">import</span> <span class="token operator">*</span>

ds<span class="token punctuation">,</span> idxs <span class="token operator">=</span> DatasetFormatter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>from_toplosses<span class="token punctuation">(</span>learn<span class="token punctuation">,</span> ds_type<span class="token operator">=</span>DatasetType<span class="token punctuation">.</span>Valid<span class="token punctuation">)</span>
ImageCleaner<span class="token punctuation">(</span>ds<span class="token punctuation">,</span> idxs<span class="token punctuation">,</span> path<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>DOGS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>


bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                   ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   bs<span class="token operator" data-v-54601d22>=</span>bs
                                  <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>
learn <span class="token operator" data-v-54601d22>=</span> create_cnn<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> metrics<span class="token operator" data-v-54601d22>=</span>error_rate<span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit_one_cycle<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> max_lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>widgets <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>


ds<span class="token punctuation" data-v-54601d22>,</span> idxs <span class="token operator" data-v-54601d22>=</span> DatasetFormatter<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>from_toplosses<span class="token punctuation" data-v-54601d22>(</span>learn<span class="token punctuation" data-v-54601d22>,</span> ds_type<span class="token operator" data-v-54601d22>=</span>DatasetType<span class="token punctuation" data-v-54601d22>.</span>Valid<span class="token punctuation" data-v-54601d22>)</span>
ImageCleaner<span class="token punctuation" data-v-54601d22>(</span>ds<span class="token punctuation" data-v-54601d22>,</span> idxs<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1550257534536.5d57aa21.png" alt="1550257534536"></p><div class="warning custom-block"><p class="custom-block-title">ImageCleaner doesn’t work on Google Colab</p><p>For this situation you need to delete files by yourself, or use Jupyter Notebook.</p></div><h3 id="show-heatmap"><a href="#show-heatmap" aria-hidden="true" class="header-anchor">#</a> .show_heatmap()</h3><p>Pytorch alows you to <code>hook</code> the layer and store some information before. In the <code>resnet34</code> if you look at the last layer you will find that last linea <code>[1,37]</code> is your layer for classification (cat/dogs breeds),  previous layers are also flat layers with classification <code>[512]</code>, this is the end of <code>resnet34</code> model.</p><p>We have two groups of layers <code>learn.model[0]</code>, and <code>learn.model[1]</code>. We can get first layer with the last <code>Conv2d</code>layer, and <code>BatchNorm2d</code> that size is  <code>[1,512,11,11]</code> , and usign <code>hook_output</code> to get what is stored in the output for that category (<code>preds[0,int(cat)].backward()</code>), next we get this information from the <code>hook_a.stored[0].cpu()</code> variable, and show the heatmap.</p><p><img src="/assets/img/1552590896874.a1a31008.png" alt="1552590896874"></p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">show_heatmap</span><span class="token punctuation">(</span>learn<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m <span class="token operator">=</span> learn<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># set mode to evaluation mode</span>
    xb<span class="token punctuation">,</span>_ <span class="token operator">=</span> learn<span class="token punctuation">.</span>data<span class="token punctuation">.</span>one_item<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    
    
    xb_im <span class="token operator">=</span> Image<span class="token punctuation">(</span>data<span class="token punctuation">.</span>denorm<span class="token punctuation">(</span>xb<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    
    xb <span class="token operator">=</span> xb<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span>xb<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    
    <span class="token keyword">from</span> fastai<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>hooks <span class="token keyword">import</span> hook_output
    <span class="token keyword">def</span> <span class="token function">hooked_backward</span><span class="token punctuation">(</span>cat<span class="token operator">=</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> hook_output<span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">as</span> hook_a<span class="token punctuation">:</span> 
            <span class="token keyword">with</span> hook_output<span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> hook_g<span class="token punctuation">:</span>
                <span class="token comment"># print(m[0])</span>
                preds <span class="token operator">=</span> m<span class="token punctuation">(</span>xb<span class="token punctuation">)</span>
                <span class="token comment"># print(preds.shape)</span>
                preds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>hook_a<span class="token punctuation">.</span>stored<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
        <span class="token keyword">return</span> hook_a<span class="token punctuation">,</span>hook_g
    
    hook_a<span class="token punctuation">,</span>hook_g <span class="token operator">=</span> hooked_backward<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    acts  <span class="token operator">=</span> hook_a<span class="token punctuation">.</span>stored<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span>
    avg_acts <span class="token operator">=</span> acts<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span>acts<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>avg_acts<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">show_heatmap</span><span class="token punctuation">(</span>hm<span class="token punctuation">)</span><span class="token punctuation">:</span>
        _<span class="token punctuation">,</span>ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
        xb_im<span class="token punctuation">.</span>show<span class="token punctuation">(</span>ax<span class="token punctuation">)</span>
        _<span class="token punctuation">,</span>width<span class="token punctuation">,</span>height <span class="token operator">=</span> xb_im<span class="token punctuation">.</span>shape
        ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>hm<span class="token punctuation">,</span> 
                  alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> extent<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>width<span class="token punctuation">,</span>height<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  interpolation<span class="token operator">=</span><span class="token string">'bilinear'</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'magma'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    show_heatmap<span class="token punctuation">(</span>avg_acts<span class="token punctuation">)</span>

x<span class="token punctuation">,</span>y <span class="token operator">=</span> data<span class="token punctuation">.</span>train_ds<span class="token punctuation">[</span><span class="token number">5004</span><span class="token punctuation">]</span>
show_heatmap<span class="token punctuation">(</span>learn<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>     
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>
path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
size <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>324</span>

data <span class="token operator" data-v-54601d22>=</span> ImageList<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>split_by_rand_pct<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span> seed<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>label_from_re<span class="token punctuation" data-v-54601d22>(</span>r<span class="token string" data-v-54601d22>'([^/]+)_\d+.jpg$'</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>transform<span class="token punctuation" data-v-54601d22>(</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>352</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>databunch<span class="token punctuation" data-v-54601d22>(</span>bs<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>
learn <span class="token operator" data-v-54601d22>=</span> cnn_learner<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> 
                   models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> 
                   metrics<span class="token operator" data-v-54601d22>=</span>error_rate<span class="token punctuation" data-v-54601d22>,</span> 
                   bn_final<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>

learn<span class="token punctuation" data-v-54601d22>.</span>fit_one_cycle<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> 
                    <span class="token builtin" data-v-54601d22>slice</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                    pct_start<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.8</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>unfreeze<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit_one_cycle<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> max_lr<span class="token operator" data-v-54601d22>=</span><span class="token builtin" data-v-54601d22>slice</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> pct_start<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.8</span><span class="token punctuation" data-v-54601d22>)</span>

                    
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>show_heatmap</span><span class="token punctuation" data-v-54601d22>(</span>learn<span class="token punctuation" data-v-54601d22>,</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    m <span class="token operator" data-v-54601d22>=</span> learn<span class="token punctuation" data-v-54601d22>.</span>model<span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>eval</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span> <span class="token comment" data-v-54601d22># set mode to evaluation mode</span>
    xb<span class="token punctuation" data-v-54601d22>,</span>_ <span class="token operator" data-v-54601d22>=</span> learn<span class="token punctuation" data-v-54601d22>.</span>data<span class="token punctuation" data-v-54601d22>.</span>one_item<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span>
    
    
    xb_im <span class="token operator" data-v-54601d22>=</span> Image<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>.</span>denorm<span class="token punctuation" data-v-54601d22>(</span>xb<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    
    xb <span class="token operator" data-v-54601d22>=</span> xb<span class="token punctuation" data-v-54601d22>.</span>cuda<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
    
    <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>xb<span class="token punctuation" data-v-54601d22>.</span>shape<span class="token punctuation" data-v-54601d22>)</span>
    
    <span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>callbacks<span class="token punctuation" data-v-54601d22>.</span>hooks <span class="token keyword" data-v-54601d22>import</span> hook_output
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>hooked_backward</span><span class="token punctuation" data-v-54601d22>(</span>cat<span class="token operator" data-v-54601d22>=</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>with</span> hook_output<span class="token punctuation" data-v-54601d22>(</span>m<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>as</span> hook_a<span class="token punctuation" data-v-54601d22>:</span> 
            <span class="token keyword" data-v-54601d22>with</span> hook_output<span class="token punctuation" data-v-54601d22>(</span>m<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span> grad<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>as</span> hook_g<span class="token punctuation" data-v-54601d22>:</span>
                <span class="token comment" data-v-54601d22># print(m[0])</span>
                preds <span class="token operator" data-v-54601d22>=</span> m<span class="token punctuation" data-v-54601d22>(</span>xb<span class="token punctuation" data-v-54601d22>)</span>
                <span class="token comment" data-v-54601d22># print(preds.shape)</span>
                preds<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span><span class="token builtin" data-v-54601d22>int</span><span class="token punctuation" data-v-54601d22>(</span>cat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>hook_a<span class="token punctuation" data-v-54601d22>.</span>stored<span class="token punctuation" data-v-54601d22>.</span>shape<span class="token punctuation" data-v-54601d22>)</span>
        <span class="token keyword" data-v-54601d22>return</span> hook_a<span class="token punctuation" data-v-54601d22>,</span>hook_g
    
    hook_a<span class="token punctuation" data-v-54601d22>,</span>hook_g <span class="token operator" data-v-54601d22>=</span> hooked_backward<span class="token punctuation" data-v-54601d22>(</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    acts  <span class="token operator" data-v-54601d22>=</span> hook_a<span class="token punctuation" data-v-54601d22>.</span>stored<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>cpu<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
    avg_acts <span class="token operator" data-v-54601d22>=</span> acts<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>)</span>
    
    <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>acts<span class="token punctuation" data-v-54601d22>.</span>shape<span class="token punctuation" data-v-54601d22>,</span>avg_acts<span class="token punctuation" data-v-54601d22>.</span>shape<span class="token punctuation" data-v-54601d22>)</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>show_heatmap</span><span class="token punctuation" data-v-54601d22>(</span>hm<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        _<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        xb_im<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token punctuation" data-v-54601d22>)</span>
        _<span class="token punctuation" data-v-54601d22>,</span>width<span class="token punctuation" data-v-54601d22>,</span>height <span class="token operator" data-v-54601d22>=</span> xb_im<span class="token punctuation" data-v-54601d22>.</span>shape
        ax<span class="token punctuation" data-v-54601d22>.</span>imshow<span class="token punctuation" data-v-54601d22>(</span>hm<span class="token punctuation" data-v-54601d22>,</span> 
                  alpha<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span> extent<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
                  interpolation<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'bilinear'</span><span class="token punctuation" data-v-54601d22>,</span> cmap<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'magma'</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
    show_heatmap<span class="token punctuation" data-v-54601d22>(</span>avg_acts<span class="token punctuation" data-v-54601d22>)</span>

x<span class="token punctuation" data-v-54601d22>,</span>y <span class="token operator" data-v-54601d22>=</span> data<span class="token punctuation" data-v-54601d22>.</span>train_ds<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>5004</span><span class="token punctuation" data-v-54601d22>]</span>
show_heatmap<span class="token punctuation" data-v-54601d22>(</span>learn<span class="token punctuation" data-v-54601d22>,</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,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" alt="1552593708692"></p><p><img src="/assets/img/1552593695073.9952bd95.png" alt="1552593695073"></p><h4 id="another-layer"><a href="#another-layer" aria-hidden="true" class="header-anchor">#</a> Another layer</h4><p>Let’s now change <code>m[0]</code> to <code>m[0][1]</code>. This is a first layer of your network (after <code>BatchNorm2d</code>).  What you can see that first layer regnozie edges of the pet.</p><p><img src="/assets/img/1552594605148.b98ec24a.png" alt="1552594605148"></p><h2 id="fast-ai-data"><a href="#fast-ai-data" aria-hidden="true" class="header-anchor">#</a> fast.ai / Data</h2><p>Before we put our data into learner we need to load them, and <code>fast.ai</code> gat a whole class that will divide your data into <code>train</code>, <code>test</code> , and <code>validation</code>, prepare some data augmentation so you don’t have to do it by yoursef</p><h3 id="basic-functions"><a href="#basic-functions" aria-hidden="true" class="header-anchor">#</a> Basic functions</h3><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>data.c</code></td><td>number of classes</td></tr><tr><td><code>data.classes</code></td><td>list of classes</td></tr><tr><td><code>data.train_ds</code></td><td>Train Dataset</td></tr><tr><td><code>data.valid_ds</code></td><td>Validation dataset</td></tr><tr><td><code>data.test_ds</code></td><td>Test dataset</td></tr><tr><td><code>data.batch_size</code></td><td>batch size</td></tr><tr><td><code>data.dl(ds_type=DatasetType.Valid)</code></td><td>Return data loader, (example: <code>ds.dl(DatasetType.Valid)</code>)</td></tr><tr><td><code>data.one_item(item)</code></td><td>Get <code>item</code> into a batch</td></tr><tr><td><code>data.one_batch()</code></td><td>Get one batch of from the DataBunch. Returns <code>x,y</code> with size of the <code>batch_size</code> (if <code>bs=128</code> then there is a list of 128 elements).</td></tr></tbody></table><h3 id="imagedatabunch"><a href="#imagedatabunch" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch</h3><p>Class that as an input have images.</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><code>path</code></td><td>folder path to the directory of images</td></tr><tr><td><code>ds_tfms</code></td><td>List of transformation for images</td></tr><tr><td><code>size</code></td><td>The size of the image as input for data (<code>width</code>and <code>height</code>for the image are the same). If the image is greater than will be cropped.</td></tr></tbody></table><h4 id="imagedatabunch-from-folder"><a href="#imagedatabunch-from-folder" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_folder</h4><p>Load data that are prepared in the folder structure. <strong>train</strong>, <strong>test</strong> , <strong>valid</strong></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP0AAACVCAYAAACTkvzLAAAbgklEQVR4nO2dT0gcWR7Hvw57sNlRbJzsoRs6tHREENxIHzRocA4iJCRu0owMPTlknRAmh50xB7cbIUGGhThVeBDjDg4hmD2EYuwhsEl2A+IhkhG6DyI4yIrdW800xMMGbXHAyq32IO+lqrq6q6r/aLf9+4Ak3VXvf/3ee/Xr976vQVVVFQbYVw0NDcZLBEHUAIVsuEFr9KqqkqETxCnDaNcf5btAEMTpoKGhAdoJ/UcAGTxBnHa0ht9g9k5PEMTp5aNibF4URcRisQpkpzRSqRS+/PJLZLNZR+ESiQTa2trQ1taGixcvIpVKVSiHzhBF0VZ+CrWHoii4e/cuEolEJbJYkGLbwyrOixcvQhTFssVZzbDytrW1IRQKlVyXqqp+eKd3komtrS0MDg6WlLhdnDy0z549w6VLl+B2u23Hn81mIQgCJEmCLMt48+YNAoFAKVnmHEfnWIn2SCQSuHv3LhRFKSmeYtqjklTrYFWIQCCAN2/eYGlpCS0tLWWJ83dO3+XX19erqiEZ2WwWOzs7uH37tqNwu7u7aGlpQXt7e4VyVjyRSASRSKTgPaetPaxgRkAUR0NDg7ORPpvN4tWrV+ju7ubfaUdiURRNp8ixWIxPn9va2nSjdjabRSgU4te0I4woiujs7MTz588RDof5PWa99fLyMjwej+OHf3d3F/v7+6bXtNN+Y74LlYt9Pz8/j2g0yq9rp6TGcmuv2Z3SmbWHMW5Wf3bKxdINh8N4/vw5Ojs7c/JQKN9ajO2RzWZx9+5dfP/992hra8OTJ09w9+5d/qwoioL79+8jkUjw+I1lZ89XvmeglPawwlhnxvS1aWuf/1gshu+//x6hUAihUAj//ve/dWkzu9GGdzIbYfbnqEyqAxYXF1VBEHTfHR4eqmNjY6rf71cXFxdVVVVVQRD4ffF4XL1+/bq6t7fHP/f396vJZJKHZeHYZ20a7Lt4PJ43X3t7e+ro6KiaTCYdlcXv9+f8sbT39vbUJ0+e8PuN5Ugmk+ro6Cj/bIYgCLxsRp48ecLD7u3tqdevX88po1UahdrDWKcsbqtyse/GxsbUw8PDovJt1h7sXkEQ1Hg8rvr9fjUej/M6YvnM92xoMavXUtujEFbPVzKZVP/1r3/xz4uLi7z+FhcX1f7+fnVjY0MdGxtTx8bG1I2NDZ5XVhesHZPJpHrt2rWctPKVT2trhepMi+2RXlEUrK6uYmBgwPT6nTt3MDIyAgAYGBjAzs4OstksJElCOBzmPX5PTw+uXr2K9fV1bGxsIJPJ8PdRl8uFv/zlL9ja2nLksNje3kZzczO8Xq/tMCMjI5BlGZIk4fz581hbW4Msy3w67Xa7cfPmTX5/e3s7WlpasLu7y79LJpPY3t62naaWmzdv8jpxu93o7e1FJpOxHT5fe2xsbAAArly5YhrOTrlKzXe+9mhpaUEoFAIADA8Po6urKyf+6elpBAIBuFwu9PX1IZ1O28oXUFp7WLG/v4/19XXTa4FAAJcvX+afu7u7cXBwgPfv3wMArl69yv1E4XAYLpdLF354eBhff/01AMDr9eLs2bO22sP4CuVyuRAOh7G6ulrQH2Pb6NnDZNZQAHQPX09PD2ZmZtDY2AgA8Pl8eeP1+Xz8vmJQFIV3LMbKLBXtdDIYDCKZTPJrgUAA09PT/LXDqePLOF2cn593lDer9ihEoXJZYZXvSrZHIUptj0K43W6IoojZ2VnT1w7jFHtoaCjvK6Nd7AwAu7u7WFtbQzAY5GmHw2HLcLaNfmVlBX19fUU1pLYAiqJgZ2dHd431iEDhd2wz3r59i4ODg7I74mKxGOLxOJ8BrK2t4dy5c7p7enp6IMsyZFmGx+PBxMSErQctlUphfHyc/2IgyzLu3LnjKH/FtoedcpWS70q1hx2KbQ87MAeiLMsIh8O4desWN/yHDx8CADY3NyHLclk87YUGSi3nzp3jbcn+ZmZmCj4Xtoy+2J+F2BRNkiReQdopPXswlpeXAehHCTaFdLlc8Hg8WFlZMU3D6mch1gsX8/u7dhby6NGjgiOi3+83/S7fVOuTTz5Ba2srgKPR08lIX6g9Wltb8euvv+Lt27cAjh5IoyPPqlzGOJzku1p+pnPaHk4wM0iPxwOXywVFUTA3N1f0SP/y5UtkMhlbnabX60VzczMePXrkKA1bRr++vo6Ojo6iGnJkZAThcJhPQcbHxyGKItxuN9xuNx4/fgxJkrin2ePxcN8A4/bt24jH4znezWw2i62trRzvdTkYHBxEJpPhHuyPP/5YNyIaPcWSJGFyclLXw7L3ahYH86wGAgFcuHABQ0NDPOyNGzdy4h4aGsLr168RDAZ1U8pC7REIBPDFF1/wuP1+v240tiqXWRwsbat8V7I9tL8aaL3w7FkopT2sML7SaJ9hAAiFQnjx4gV/hs+fP+9opNf+UiJJEh4/fszjLvQsuFwuTE1NYWdnp+AvCzmU6rk8Scy816cdao/TRaFfSioFrb0niBMkkUhAkiRMTU0dm+Pzd8eSCkFUKalUCqOjo6b+CwAQBCHndbPWoZGeIOoMR8twRVE8kd1aBEGUD8e77AiCqG3I6Amizqh6o7faWVWIWCxWtNiC9nfhahLWIIhSqXqjj0QiRS1TLRW3241nz545WqZKELVA1Rs9QRDlpeaN3kroAtC/ImivFyVAoKGQOEip4fNdYyIT2l1eZt8RRD5q2ujZWm+2u0iSJAiCoHv45+fn4ff7Ta8/fPgQHo8Hsixjc3MTOzs7tv0GqVQKr1690u1w6unpsZ33WCwGSZJMwxeKm23E0O4bz2Qy6O3tPfFNLkRt4HhFnna/7ueff46ff/4572qmzz77DD/99JPpNa/Xi4WFhZJEKAsJQjAD0Ip7aA2mvb0dOzs7mJycBPBBgECSJFy5csXWkkgm2uDE2AFwcZFoNJrXUPPF7Xa7EQ6HsbKygp6eHiiKgo2NDV09EEQhHBu9JEmOHvJKSxWLoqjb3llIPaexsZFvi9QKEGgZHh62la5WtIGFs7t+end3F6qq8i2qTuPu7u7Gq1evkM1mucKKE9Ugor6p6em9U0GI9+/f4+DggBtbMQIEWooVbWhtbbWciheKm+2j3t7exvr6Orq6uo5VpYaobWra6AFnQhfLy8tcu61YAYJ8mIk2MHVZo3ST2+1GR0cH5ubmbHUSxriZOMl//vMfpNPpYzuDgDgdVLXRWwkn2BGEmJ+f5x7w1dVVPk22EiBgvwoEg0G8fv0aQ0NDOdLGVqINhYhEIvB4PDzvZpLNheIeHBzkijjkwCOc4GiXnSiKGBgYcOy4IgiieqjqkZ4giPJDRk8QdQYZPUHUGWT0BFFnkNETRJ1BRk8QdUbdGz1bC1DOs88IopqpeqNn219JkJMgykPd694zhRyCqBeqeqQXRRGdnZ14/vw5P4JYu1Q2lUrhyy+/xH//+1++XNc4TdcuaTVq3WmvGXcDJhIJiKKou8epRh9BVCNVbfSRSASbm5sYHh7WHY+sPXEkmUziz3/+M0RRxNraGjKZDD+7PZVK4fe//z0P98033+g2uYyMjECWZQiCYJr+/Pw80uk0F+DQnr5LELVKTYtoMKanp3k8vb29yGQy6OnpQSAQ0MXP9qG/f//e1saY4eFhfP311wDMBToIohapeRGNc+fO6c7yjkQi/P+KomBiYkJ3Pvv58+crmh+CqHaqenpfKg8fPgQAbG5uQpZlLC0tOTo3nCBOI1Vv9C6XCx6PBysrK0WF93g8cLlcUBQFc3Nz2N/fL3MOCaK2qHqjB4Dbt28jHo879qKHQiG8ePECbW1t6OzsxPnz5/lIr5W/jkajXGyj0q8jBHHSkIgGQdQZNTHSEwRRPsjoCaLOIKMniDqjJoxeURTcv3+fjosmiDJQE0ZPEET5IKMniDqDjL6CaI/IJpEOe5CoSWESiUTJdUNGnwd2JFWpRisIQt4z8rRpGLf9AkedRr7v851rb4z7uBcbse3OtBuxeiGjz0MgEMCbN290h0iytfzlIJFIYHR0FAsLC5BlGW/evOE7Atlo94c//AGffPJJTthIJMLztbS0hO+++y5HJ2Bubg6ffvpp2fJ7XDBREycHiRLOIKO3idkBlcWiKApevnyZd2uxJEkQRRH9/f2WcRlPwE2lUnj37h1mZmbQ1NRUVP60wiGhUIiP2tlslkuXsRkKmwGxjmpoaAivX79GMBjMmcGwqekvv/zCw2tnIoVETVj6TCzFbDm28QxAJxJrheIWRVFXD2wWpb3HGF47M7TKNzs3Md+MT1su7dZ2QL+c3NheeVEdIAiCGo/HnQQpC4eHh+q9e/fUZDJ57Gmz9MfGxhyXXRAEdXFxMef7ZDKpjo6Oqn//+99Vv9+v+v1+dWxsTD08PMy579q1awXLHY/HTcOy9AVBcJTneDyuXr9+Xd3b21NVVVUXFxd5/Ht7e+r169f5dfZZWy+sbCy8MW6/38/D5yvf4uJiTr5ZG7D6NKZdKF0rrOJm1wVByLlXe79ZW9vJt7YOjPVv9lnb3mZ1ZUXNjPS//fYbhoaGeI8WiUR0vbr27+LFi5iYmMh73VZviA89cGdnJwCgq6urLGXZ3d3F69evcebMGciyjM3NTQCw/fqg7d3D4TDC4XDZpsIrKyuIRqN89jA4OIiDgwMulNLS0gJRFOF2u+F2u7loiV28Xi8P7/V6cfbsWezu7lqGe/v2LZqamnDlyhUAR68B4XBYt/symUxie3vbSXFtxe1yuTA5OYmtrS38+OOPAMDvBY6OQPf5fLrv7Ma9vr6OL774gs/4urq64PP5sL29DUVRIEmSrj3MiMfjjnwoNSOM2dTUhKWlJd102MpJNTU1VVKaPT09kGUZwFEHcOPGDTx+/LgsyjnDw8P8QXC5XAiHw5AkCYqiWBqwy+XCzMwMZmZmuFBIJpPRyYgVg6Io2NnZyZlCer3ekuLVEgwGeXysHHbY3d3F06dP8fTpU933d+7cAXDkg5menuZ5Hx4e5seSlxo3cGSsX331FcbHx7GwsKCLN51O8y3cTuNOp9P8GHYtxjbIx8jICNLpNILBIIAjx7HVc1AzRn/SlFMuq7W1FQcHB7ZluwrhcrnQ19eHdDpdUjxa8qkjnbRH3sqQtZ20KIqYmJiwbfhWcadSKfzwww+YmJhAJBLRdf5+v79g/VvFnc9Q7f5aFIlEEIlEkM1mcevWLQAoaPg1M70/aZaXl9Hc3FyWUc/r9aK5uRnLy8sAwKdxfX19jjuBbDYLSZIwMDBQcr5YByIIQtEG3traiv39/aKm2YVob29HJpPBy5cvbd3vxPFqFTcTYLl06RIuX76M3t5ePHr0iF/v7u7GixcvTB2HVnEPDAxgdnbWdIm5UUAmlUphfHw8bzkaGxvh8/kKlhUAOfLywZxOhRxtVuRz5KnqB4cOi1973+Lioi5tv9+v9vf3q8lkkjuGtNe0bWKMl/05cfYY09c68kZHR3XtYFZGbd2xfLPv89WjWbmM+TYrGyu7Mc9a55cd8sXN8qXNdzKZVPv7+3V5Y9+ZPS+F8m2sL2PetWGZA/DevXvq4eGhaZ3ZaeeaENFQFAUPHjzAzZs3y6Kee1yIogi/31/yuzZBlBOa3hNEnUFGX2Gi0SitvSeqCvLeVxDmVSWIaoJGeoKoM8joCaLOIKMniDqDjL6CkIiGc0hEozAkolFBjEIVxWzXBIoT0TBul7SzzVSbL2PezbZrVgoS0ah+yHufB6PnPZVK4a9//StaW1vLEn8ikeCbN4wLjl6+fIm+vj7MzMzw9dSxWIwv8kmlUhgdHcX09HTehVJOTxeuFpiIBlE5aKS3yfr6Oi5cuFCWFYFWIhojIyPcwNn2Ve2GjmfPnhU0+FIhEQ0S0eDU09p7LWZrzu1QqoiGNh62pprlZWFhIe8681LaiUQ0SESjajgJEQ3G8vIyOjo6yrbu34mIRiKRwIsXLxAKhXjYZDKJ//3vf1wnr7e3F99++63OuRMOhx2f8guQiIZZ3CSicQJoRSO0VFpEA/iwddUoclAqdkQ02FbK6elpXYdz7tw53L59m38OhUJ48OAB35+v9UfY3WMNkIgGiWgQAD704uWSygLsiWgwZ90333yje3dnjkS7Yh5sNHYCiWjkQiIadQIb5cupQQdYi2hoDd7YeG63Gx0dHToP97Nnz9DR0WHaCbDXg+7ubst8kYgGiWjkcFKOvJNCEISixDO04YsR0RAEIa+IhqrmCk4UEppwKiahqiSiQSIaGk5KRKNWIRENohqh6T1B1Blk9BWGRDSIaoO89xWERDSIaoRGeoKoM8joCaLOIKMniDrjVBu9dr96vvX2dkUbaJ84cVo41UYfCATw5s0bLC0toaWl5aSzQxBVQd1770m0gag3qnqkj8ViOdNu43daAQKnwglWog3auIeGhrC/v196oQjihKlqo+/u7savv/7K93IDR1sR2caUbDaLra0tvq9ckiRHm0VGRkYgyzIEQci5lkql8N1332FpaQmyLNMrAnFqcDy91+7z/fzzz/Hzzz/rjFLLZ599hp9++sn0mtfrzSsXxQgEArhw4QLW19cRCASQzWaxs7PD95K73W7cvHmT31/OM+SfPXumEzcgiNOCI6MvZoWZldCFFQMDA5AkCVeuXMH29jY8Ho/OoEVRxPz8PP9cTsEHgjiNVPX0HjgavZlc08rKCgYGBvi1WCyGeDyOtbU1yLKMtbU1nDt37gRzSxDVT9UbPRONYKIMRgUbn8+HxsZGAMCjR4+QTCbLkq7f78fq6ipXeo1EIuTII04FVW/0wJEG3NTUFPx+v07BZnBwEJlMBp2dnWhra8PHH3+sG+mZd14ry8wW6Wilg6PRKObn53VefKZf19nZieHhYUSjUXuqJARR5TgS0SAIovapiZGeIIjyQUZPEHUGGT1B1Bk1YfSKouD+/fvHdvIqQZxmasLoCYIoH2T0BFFnkNFXEFEUTY8uJvJjV9SkXmHHfZdSN2T0edCq7pRitIIgQJZlzMzM5ByNxdIw25+Q74x4RiHjsDoPvZKQwlD1Q0afB6a6w7btejwe06OkiyUWi2Fubg6ffvppzrVEIgFJkvieAuNR1IlEArdu3cLg4GBOWEVR8O233yIcDvMtwbOzs450Bk4SJmpi1kkS5YGM3iZODkS0IpVK4d27d5iZmUFTU5PuGjvMMhwO892EoVCI6wpks1msrKzg6dOnOHPmTE7cGxsbyGQyvEMIBAK4evWq7hx3K/LNMrLZLO7evYtEIsFnQWymwWYX2iXPbW1tuHjxIv/VhU1Nf/nlFx5eO8uxEjWxmsFowzsVVCkUtyiKunpgMzTtPcbw2hmYVb61Yi3a+jIrl/EIa+1y8kJakDpsn/B3ghweHqr37t3THZx43OmPjY05Pryz0AGW2nuMhzRqD4nUHmBoTH9xcTHnQMjFxUVdfOxgR7sHccbjcd0Bito0WF7YdfZZm69kMqmOjo6aHh7JDmpk4ZPJpHrt2rWcdjWWQVU/tAGrT2PahdK1wipudl0QhJx7tfebtbWdfGvrwFj/Zp+1bWlWV1bUzEj/22+/YWhoiPdokUhE16tr/y5evIiJiYm81231hvjQA3d2dgLI3eFXSVgPHgwGEY1GcefOHWQyGdvhWd5XV1fxz3/+EwcHB3j//r1luJWVFUSjUT7LGBwc5FubAaClpQWiKMLtdsPtdqO3t9dRvrxeLw/v9Xpx9uxZ7O7uWoZ7+/Ytmpqa+EYot9uNcDism8Ekk8mijsi2itvlcmFychJbW1v48ccfAXzYkAUAy8vL8Pl8uu/sxr2+vq4Ta+nq6oLP58P29jaf9Wnbw4x4PO7Ih1IzwphNTU1YWlrSKdlYCXRMTU2VlGZPTw9kWQZwZEQ3btzA48ePS1blsWJ/fx9/+tOfIEkSZmZmeONrtQQKMT8/j52dHWxubsLlciGRSKC5uZlvQc6HoijY2dnJmUKWU5gkGAzy+FwuF2ZmZmyF293dxdOnT/H06VPd93fu3AFw9BozPT3N8z48PIypqSlbfgGruIEjY/3qq68wPj6OhYUFXbzpdBoej8c0Lau40+k05ufnEY1GddeNbZCPkZERpNNpBINBAEeOY6tTkmvG6E+ackpxFaKxsRE+nw/hcJgfCf7+/XscHBygtbXVMrzP58P58+cxOTnJH8JMJpP3oTRDkiTT48hP2iNvZcjaTloURUxMTNg2fKu4U6kUfvjhB0xMTCASieg6f7/fj3Q6XXTc+QzV7q9FTNEqm83i1q1bAFDQ8Gtmen/SLC8vo7m5ueJyXC6XC319fZidneUOHSdpt7e3AzgSFAGODNXuLIGl7URc1Ehrayv29/eLmmYXor29HZlMBi9fvrR1vxPHq1XciqJgbm4Oly5dwuXLl9Hb28vrFzgScH3x4oWp49Aq7oGBAV1ba3G5XPB4PPxVIJVKYXx8PG852IBhiSMPwAlxEo485nRif3YdYVryOfK0zjntn5kDzpg2cwwZw2rvMcbv1AGpTVsbt9HJmK+M2rrr7+/XOany1WO+chmdnMZ6Y2Uz5lnr/LJDvrhZvrT5TiaTan9/vy5v7Ds77WFsE+Ozps27NixzAN67d089PDw0rTM7Tr2aENFQFAUPHjzAzZs3a0qdVhRF+P1+y3csgjhOaHpPEHUGGX2FiUajtPaeqCrIe19BijkngCAqDY30BFFnkNETRJ1BRk8QdQYZfQUhEQ3nkIhGYUhEo4JoDbbY7ZpAZUQ0jAIfxjyVSwCkGEhEo/oho89DJBLhAhpMjOKPf/yjrfXvdihWRENRFPzjH//AwsICZFmGJEkYHx/nyziz2SwePHjAr29ubgKA7eWrJw2JaFQeMnqbrK+v48KFC2VZEViKiIbL5cLf/vY3no/29nacOXOGb09l/7LOia3fdgKJaJCIxolz0iIaZmvO7VBpEQ3tdaPgA1v7HY/HdevfrSARDRLRqBpOQkSDsby8jI6OjmNd929XROPRo0fw+Xxc4IPtUe/r60NnZycEQcDz589t551ENEhEoypgD7JRcKHSIhrAh62pRpGDSmJXRCMWiyEej+Px48f8/VdRFExMTMDj8UCWZcRiMQSDwbx75LWQiAaJaBD40Isfl1SWXRGNWCyG2dlZLCws6EYBJow5OTkJ4IOYgiRJ6OrqsmUEJKKRC4lo1AlslA+Hw8fmSbYjoqE1eLNp+7t37/iUWVEUrK6u2lLOIRENEtGoewRBKEo8Qxu+3CIa+cIanTtOhRW0kIgGiWgQRUIiGkQ1QtN7gqgzyOgrDIloENUGTe8Jos6gkZ4g6gwyeoKoM8joCaLOIKMniDrjI/LjEUT9oKoqjfQEUW981NDQcNJ5IAjiGPkIOBryCYI43aiqioaGBlqcQxD1hu6dnuyfIE4fRrvWiWg0NDTwG+hdnyBqm3y2/H9Zn7Ru6u1rKQAAAABJRU5ErkJggg==" alt="1549650957873"></p><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path<span class="token punctuation">,</span> ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>

data<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,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MQoxADgWuIXhkfwaNmyouUmTJpobNDhy3bF37964nhNQHa6IAcAxCjEAOEZrAjGXkpKiuVOnTpr79eunuVmzZprT0tJqlc8991zN3bt3FxGR1157TY/Zfc7s57zzzjuaBw4cqLm0tLTavw9Q37giBgDHKMQA4FggWhMnnXSS5htuuEFERC655BI9Zp+y2yfrJSUlmqdMmaL51Vdf1Xz48OHYnmwSyMjI0HzLLbdoHjZsmOZGjRpptq2M1NTUSrN93/+7777T7M1+6NGjhx5r3LixZruGwoknnqi5efPmmouLi6v9+yA+vA1C7Y4c2dnZmu338dChQ5rLy8s1b9++XfP69es12/9mEhFXxADgGIUYABxL2taEbUeMGjXqqNyuXTs9VtUSgBUVFZoPHjyoedWqVZoLCwujP9kkU1ZWptneEubn52v+4IMPNNvbTNvqsT+noKBAs73l9P58t27d9Njzzz+vuWvXrprfffddzbQj3LEtJzsD5qabbhIRkV69eukx2+ay30fbzsrMzNT87bffan7ggQc0P/7449Gedr3iihgAHKMQA4BjoXActxKI5y4A9snruHHjNPfs2VNEIm9t7K/AnqOdTWFvi1566SXNt912m+avv/66zufrtx0dRGo2nnYGQ1Vth9qyt7annHKKiIhMnTpVj51//vmaV6xYofm+++7TvGjRojp/fk34bTzj+d1s06aN5kceeUTz0KFDRSRy5pI9r40bN2p+7733NHfs2FGzbWvMmzdP85AhQ+p8vuzQAQABQCEGAMeSdtbEunXrNI8fP16zd1tr2wg222UT7a3sT37yE812BgWbLlbvwIEDMfk5tk10xhlnaP7DH/4gIiLnnHOOHlu9erXm3//+95rtWhNwZ/fu3ZqfffZZza1atRIRkeOPP16PLV++XPOjjz6qeefOnZq92RYikS/27Nu3L0ZnXP+4IgYAxyjEAOBY0rYm7A4Mb7/9drV/tm3btponT56s2d7mfPbZZ5r/85//aP7qq6+iOk9UzVt7QCRyJsSNN96ouW/fviIisnnzZj324IMParZP15EY7As8tl3kLUdq21BLly7VbNcKueuuuzTbl3bsbKhoZjHFG1fEAOAYhRgAHEva1kRVvB0bWrRooccee+wxzb1796703zvuuOM0d+nSRfPatWs1f/nllzE7z6CyO2pcdtllmr3l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" alt="1549650578727"></p><h4 id="imagedatabunch-from-csv"><a href="#imagedatabunch-from-csv" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_csv</h4><p>When you’ve got a .csv file with filenmaes and classes</p><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span> ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_csv<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>

data<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549651318454.4f9a3f2f.png" alt="1549651318454"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVQAAAFZCAYAAADHDNdrAAAeTklEQVR4nO3deXBW9fXH8RPCGlZFCGtYJcoqe0FgKCAFa7UKWiuoIDgMiyCtMlMUfggthSKdai1TxYXFFjqIiKhAQSwWAWWRHQSRTSBg2HcC5PeH8xxOaiIJnGe7eb/+6Weu9MmVb57j/d7vlpCZmZkp/yN0KSEh4X//EQDkaz9WHxNsQc3MzKSIAkAu/W/NLJDTPwAA/LiEhASxnfwCIhRTALhetqgmZPcOFQCQdwWopwBw4zIzM6++QwUA3Bi6/ADgJJBPqBkZGTJu3DhJTU2VtLS0aN8ObhDtGRxBb8tAFtQBAwZIUlJStG8DTmjP4Ah6Wwa2oA4ePDjatwEntGdwBL0tA1lQGzduHO1bgCPaMziC3paBLKgAEA0UVABwQkEFACcUVABwEriJ/enp6dKzZ08REdm1a5ekpKRIYmKiTJ06VZKTk6N8d8gr2jM48kNbBq6gAkC00OUHACcUVABwQkEFACcUVABwQkEFACcFPT+Mc6lyFo+TKWjPnMVbe9KWOfNsS55QAcAJBRUAnFBQAcAJBRUAnFBQAcAJBRUAnFBQAcAJBRUAnFBQAcAJBRUAnLguPY0FoSV2BQpc/W/F5cuXo3U7APIRnlABwAkFFQCcxG2X33bpy5Urp7l69eoiIvKTn/xEr919992aExMTNdtdZmbPnq158eLFmg8cOKD57NmzN3rbAAKMJ1QAcEJBBQAnrsdIh3sTW/v5tWrV0tyjRw/NDz74oIiIFC1aVK+dPn1a8+7duzWHXg+IiNx2222aN2/erHns2LGa582bp/nixYt5uvd425BYJHftWapUKc1NmjTRbF+tHD58WHNSUpLm4sWLX/P60aNHRURk9erVes2+erly5YrmjIyMa96vl3hrzxv5bg4cOFCzbe+VK1dq/uabbzSnpaVpvnDhwnX/3Ehhg2kAiEEUVABwElej/CVLltT88MMPax46dKjmdevWiYjIlClT9Jodqd+/f79m2+Vv1aqV5k6dOmm+6667NM+fP19zXrv8QVKkSBHNvXv31jxy5EjNZ86c0bx3717Ntstos23bEiVKaL506ZKIiHz11Vd67d1339W8Z88ezRs2bMg2x1v3PNY8+eSTmuvWrat5165dmm37/Oc//8n2+tKlS0Uk6yu4oOEJFQCcUFABwElcdfm7deumuV+/fpo3btyoeeLEiSIismTJEr1mu5/W1q1bNa9du1bzwYMHNW/fvl3zuXPnrue2A6dKlSqaO3furLl06dKay5Qpo7ly5crX/Ew7Wp+enq459HqhUaNGes3m48ePa96xY4fmPn36aLazNpB39u+1YcOGmm+++WbNzZo102xfk9nXLaHPsa9ptmzZovmTTz7RfOjQIc32ldH58+c1x+JCG55QAcAJBRUAnMRVl79ChQrZZtu9D00Az6mbb9lu5pEjRzR/9NFHmr/77jvNjBZ/z3bJ7YT7du3aabYT9e2ft3sm2L/zb7/9VvPChQs1d+3aVUREevbsqdfq1aun2b5aaN68ueaXXnpJs/3/2knnyJ0XXnhBs33FY2dSzJw5U3OlSpU0t2zZUnPjxo1FRKRixYp6rU2bNpo7duyo2Xb5169frzklJUWz/b1atWqV5gULFmg+duyY5kh8f3lCBQAnFFQAcBJXXf7atWtrtpOD7ai8HQXMCztR305Yxg+dOHFCs13PbUddbZffduft3gj2ek5ee+01Ebk6KVwk6wyP7t27ay5fvrxm+/rh448/1my7oEGeYO7JrtO3i2TsFpr2NY0dlbdC+2/YVzNdunTRXK1aNc12AUH79u0120Ultv2aNm2qecWKFZptlz8SeEIFACcUVABwEvNdfrtNnx2t3blzp2Y7yh/pR/z8zo6anzx5UvMtt9yiuU6dOprt4oxQd14k50UToQMW7SKMMWPGaP788881270Ebr31Vs12a8ZBgwZpfuuttzTbUWVkZbfgs137++67T7M9NSOnLn/oO2sn9tt1/3YPh9TUVM01atTQbBeV2GxnAtjfw0jPzOEJFQCcxPwTaoMGDTSHdh4SESlcuLBmu2sRIssu63zmmWc023mgVatW1fz4449rXrZsmWa79De7pwp7zc4/nDVrlmY7YPH8889rtnMX7dOtnQ85ZMiQH/xMfM8ew24HfB577DHNdn7qmjVrfvTz7Pc4p3nBX3/9dbbXbRvbXpAdEI1mL5UnVABwQkEFACcx3+W3c+BsV8FuSGy7bogsO3/3008/1fzee+9pfuqppzTb+YX2LDB71pddknot9hypt99+W7N9JWR/vh2seuCBBzT/+c9/1mwHTZCVfTVz6tQpzb169dI8adIkzXbOsgc7QGY3i48VPKEC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" alt="1549651350934"></p><h4 id="imagedatabunch-from-df"><a href="#imagedatabunch-from-df" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_df</h4><p>Get data from loaded DataFrame</p><div class="language-python extra-class"><pre class="language-python"><code>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'labels.csv'</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_df<span class="token punctuation">(</span>path<span class="token punctuation">,</span> df<span class="token punctuation">,</span> ds_tfms<span class="token operator">=</span>tfms<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> pandas <span class="token keyword" data-v-54601d22>as</span> pd

<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
df <span class="token operator" data-v-54601d22>=</span> pd<span class="token punctuation" data-v-54601d22>.</span>read_csv<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'labels.csv'</span><span class="token punctuation" data-v-54601d22>)</span>

data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_df<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> df<span class="token punctuation" data-v-54601d22>,</span> ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>classes
</code></pre></div></div></div><p><code>[0,1]</code></p><h4 id="imagedatabunch-from-name-re"><a href="#imagedatabunch-from-name-re" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_name_re</h4><p>Get data from regular expression in the file name. <a href="https://regexr.com/" target="_blank" title="https://regexr.com/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>regexr</span></a></p><p><img src="data:image/png;base64,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" alt="1549652416468"></p><div class="language-python extra-class"><pre class="language-python"><code>pat <span class="token operator">=</span> r<span class="token string">&quot;/(\d)/\d+\.png$&quot;</span>
data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>path<span class="token punctuation">,</span> fnames<span class="token punctuation">,</span> pat<span class="token operator">=</span>pat<span class="token punctuation">,</span> ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> pandas <span class="token keyword" data-v-54601d22>as</span> pd

<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> recurse<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>

pat <span class="token operator" data-v-54601d22>=</span> r<span class="token string" data-v-54601d22>&quot;/(\d)/\d+\.png$&quot;</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_name_re<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> fnames<span class="token punctuation" data-v-54601d22>,</span> pat<span class="token operator" data-v-54601d22>=</span>pat<span class="token punctuation" data-v-54601d22>,</span> ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>

data<span class="token punctuation" data-v-54601d22>.</span>classes
</code></pre></div></div></div><p><code>['3', '7']</code></p><h4 id="imagedatabunch-from-name-func"><a href="#imagedatabunch-from-name-func" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_name_func</h4><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_func<span class="token punctuation">(</span>
    path<span class="token punctuation">,</span> 
    fnames<span class="token punctuation">,</span> 
    ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span>
    label_func <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">'3'</span> <span class="token keyword">if</span> <span class="token string">'/3/'</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'7'</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> recurse<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>


data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_name_func<span class="token punctuation" data-v-54601d22>(</span>
    path<span class="token punctuation" data-v-54601d22>,</span> 
    fnames<span class="token punctuation" data-v-54601d22>,</span> 
    ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
    size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>,</span>
    label_func <span class="token operator" data-v-54601d22>=</span> <span class="token keyword" data-v-54601d22>lambda</span> x<span class="token punctuation" data-v-54601d22>:</span> <span class="token string" data-v-54601d22>'3'</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token string" data-v-54601d22>'/3/'</span> <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token string" data-v-54601d22>'7'</span><span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>classes
</code></pre></div></div></div><p><code>['3', '7']</code></p><h4 id="imagedatabunch-from-list"><a href="#imagedatabunch-from-list" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_list</h4><p>Get Image data from the list that contains list of classes for each file in fnames.</p><div class="language-python extra-class"><pre class="language-python"><code>labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'3'</span> <span class="token keyword">if</span> <span class="token string">'/3/'</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'7'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> fnames<span class="token punctuation">]</span>


data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_lists<span class="token punctuation">(</span>path<span class="token punctuation">,</span>
                                 fnames<span class="token punctuation">,</span> 
                                 labels<span class="token operator">=</span>labels<span class="token punctuation">,</span> 
                                 ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                 size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> recurse<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
labels <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'3'</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token string" data-v-54601d22>'/3/'</span> <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token string" data-v-54601d22>'7'</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> fnames<span class="token punctuation" data-v-54601d22>]</span>


data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_lists<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                 fnames<span class="token punctuation" data-v-54601d22>,</span> 
                                 labels<span class="token operator" data-v-54601d22>=</span>labels<span class="token punctuation" data-v-54601d22>,</span> 
                                 ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                 size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>classes
</code></pre></div></div></div><p><code>['3', '7']</code></p><h3 id="databunch-own-item-list"><a href="#databunch-own-item-list" aria-hidden="true" class="header-anchor">#</a> DataBunch / Own Item List</h3><p>Usually you have a lot of datasets with a lot of different type of data, folder structure, etc… It is impossible to write all possible combinations to write your own DataBunch for calculation, that’s why you can step by step put different function on each step of your dataset.</p><table><thead><tr><th>No</th><th>Step</th><th>Description</th></tr></thead><tbody><tr><td>1.</td><td><code>DataType</code></td><td>Define what is your  DataSource, and what is the output</td></tr><tr><td>2.</td><td><code>from_*</code></td><td>Define how to get the input data (files, dataframes, csv)</td></tr><tr><td>3.</td><td><code>*split*</code></td><td>How to split  your data for training, validation and test</td></tr><tr><td>4.</td><td><code>label_*</code></td><td>How to label your data, output y. Returns DataSet.</td></tr><tr><td>5.</td><td><code>Transforms</code></td><td>List of transformations for your input data</td></tr><tr><td>6.</td><td><code>databunch(bs=*)</code></td><td>Convert to <code>DataBunch</code>class</td></tr><tr><td>7.</td><td><code>normalize()</code></td><td>Optional step for DataBunch to normalize input.</td></tr></tbody></table><h4 id="examples-1-planet-data"><a href="#examples-1-planet-data" aria-hidden="true" class="header-anchor">#</a> Examples 1/ Planet Data</h4><p>We’ve got all files in one folder, without dividing into <code>train</code> and <code>validation</code>.</p><p><img src="/assets/img/1550778286094.55beabbc.png" alt="1550778286094"></p><p><img src="/assets/img/1550778228993.b2862b51.png" alt="1550778228993"></p><div class="language-python extra-class"><pre class="language-python"><code>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> <span class="token punctuation">(</span>ImageItemList
       <span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span>
                 <span class="token string">'train_v2.csv'</span><span class="token punctuation">,</span> 
                 folder<span class="token operator">=</span><span class="token string">'train-jpg'</span><span class="token punctuation">,</span> 
                 suffix<span class="token operator">=</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>random_split_by_pct<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>label_from_df<span class="token punctuation">(</span>label_delim<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	   <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> Config<span class="token punctuation" data-v-54601d22>.</span>data_path<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'planet'</span>
path<span class="token punctuation" data-v-54601d22>.</span>mkdir<span class="token punctuation" data-v-54601d22>(</span>parents<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>,</span> exist_ok<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22>#Download and install planet competition from kaggle, extract all files</span>
!kaggle competitions download <span class="token operator" data-v-54601d22>-</span>c planet<span class="token operator" data-v-54601d22>-</span>understanding<span class="token operator" data-v-54601d22>-</span>the<span class="token operator" data-v-54601d22>-</span>amazon<span class="token operator" data-v-54601d22>-</span><span class="token keyword" data-v-54601d22>from</span><span class="token operator" data-v-54601d22>-</span>space <span class="token operator" data-v-54601d22>-</span>f train<span class="token operator" data-v-54601d22>-</span>jpg<span class="token punctuation" data-v-54601d22>.</span>tar<span class="token punctuation" data-v-54601d22>.</span>7z <span class="token operator" data-v-54601d22>-</span>p <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span> 
!kaggle competitions download <span class="token operator" data-v-54601d22>-</span>c planet<span class="token operator" data-v-54601d22>-</span>understanding<span class="token operator" data-v-54601d22>-</span>the<span class="token operator" data-v-54601d22>-</span>amazon<span class="token operator" data-v-54601d22>-</span><span class="token keyword" data-v-54601d22>from</span><span class="token operator" data-v-54601d22>-</span>space <span class="token operator" data-v-54601d22>-</span>f train_v2<span class="token punctuation" data-v-54601d22>.</span>csv <span class="token operator" data-v-54601d22>-</span>p <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span>  
!unzip <span class="token operator" data-v-54601d22>-</span>q <span class="token operator" data-v-54601d22>-</span>n <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span><span class="token operator" data-v-54601d22>/</span>train_v2<span class="token punctuation" data-v-54601d22>.</span>csv<span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>zip</span> <span class="token operator" data-v-54601d22>-</span>d <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span>
!7za <span class="token operator" data-v-54601d22>-</span>bd <span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>-</span>so x <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span><span class="token operator" data-v-54601d22>/</span>train<span class="token operator" data-v-54601d22>-</span>jpg<span class="token punctuation" data-v-54601d22>.</span>tar<span class="token punctuation" data-v-54601d22>.</span>7z <span class="token operator" data-v-54601d22>|</span> tar xf <span class="token operator" data-v-54601d22>-</span> <span class="token operator" data-v-54601d22>-</span>C <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span>


tfms <span class="token operator" data-v-54601d22>=</span> get_transforms<span class="token punctuation" data-v-54601d22>(</span>flip_vert<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>,</span> max_lighting<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span> max_zoom<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1.05</span><span class="token punctuation" data-v-54601d22>,</span> max_warp<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>.</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><ol><li>We setup random value in the begining to get the same <code>validation</code>, and <code>training</code> set each time.</li><li>The Input is Image and output is list of categories, that’s why we use <code>ImageItemList</code></li><li>The labels are form <code>.csv</code> file, the first column has image filename (default <code>cols=0</code>), and the file is <code>train_v2.csv</code> in the <code>path</code>. Folder for images is <code>train-jpg</code>, and after read the image name add suffix <code>.jpg</code>.</li><li>Because there is no split, we add random split <code>0.2</code></li><li>Labels are in the 1st column (default <code>cols=1</code>), with space delimeter <code>label_delim</code></li><li>We add default transforms <code>tfms</code>, with <code>flip_vert=True</code>, because this are satelite images.</li><li>Create <code>DataBunch</code>, with <code>bs=16</code>.</li><li>We normalize images with <code>imagenet_stats</code></li></ol><h4 id="example-2-imdb-database"><a href="#example-2-imdb-database" aria-hidden="true" class="header-anchor">#</a> Example 2 / IMDB DataBase</h4><p><img src="/assets/img/1550778883858.533d5087.png" alt="1550778883858"></p><div class="language-python extra-class"><pre class="language-python"><code>data_lm <span class="token operator">=</span> <span class="token punctuation">(</span>TextList<span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
           <span class="token comment">#Inputs: all the text files in path</span>
            <span class="token punctuation">.</span>filter_by_folder<span class="token punctuation">(</span>include<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token string">'unsup'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
           <span class="token comment">#We may have other temp folders that contain text files so we only keep what's in train and test</span>
            <span class="token punctuation">.</span>random_split_by_pct<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
           <span class="token comment">#We randomly split and keep 10% (10,000 reviews) for validation</span>
            <span class="token punctuation">.</span>label_for_lm<span class="token punctuation">(</span><span class="token punctuation">)</span>           
           <span class="token comment">#We want to do a language model so we label accordingly</span>
            <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span>bs<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>text <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>


path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>IMDB<span class="token punctuation" data-v-54601d22>)</span>

data_lm <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span>TextList<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>)</span>
           <span class="token comment" data-v-54601d22>#Inputs: all the text files in path</span>
            <span class="token punctuation" data-v-54601d22>.</span>filter_by_folder<span class="token punctuation" data-v-54601d22>(</span>include<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>[</span><span class="token string" data-v-54601d22>'train'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'test'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'unsup'</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span> 
           <span class="token comment" data-v-54601d22>#We may have other temp folders that contain text files so we only keep what's in train and test</span>
            <span class="token punctuation" data-v-54601d22>.</span>random_split_by_pct<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span>
           <span class="token comment" data-v-54601d22>#We randomly split and keep 10% (10,000 reviews) for validation</span>
            <span class="token punctuation" data-v-54601d22>.</span>label_for_lm<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>           
           <span class="token comment" data-v-54601d22>#We want to do a language model so we label accordingly</span>
            <span class="token punctuation" data-v-54601d22>.</span>databunch<span class="token punctuation" data-v-54601d22>(</span>bs<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>64</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

data_lm<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1550779135552.f3f72283.png" alt="1550779135552"></p><h3 id="databunch-1-datatype"><a href="#databunch-1-datatype" aria-hidden="true" class="header-anchor">#</a> DataBunch / 1. DataType <a href="https://docs.fast.ai/data_block.html#ItemList" target="_blank" title="https://docs.fast.ai/data_block.html#ItemList" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><table><thead><tr><th>Class</th><th>Description</th></tr></thead><tbody><tr><td><code>CategoryList</code></td><td>for labels and classification</td></tr><tr><td><code>MultiCategoryList</code></td><td>for labels in a multi classification problem</td></tr><tr><td><code>FloatList</code></td><td>for float labels in a regression problem</td></tr><tr><td><code>ImageItemList</code></td><td>for data that are images</td></tr><tr><td><code>SegmentationItemList</code></td><td>like <code>ImageItemList</code>but will default labels to <code>SegmentationLabelList</code></td></tr><tr><td><code>SegmentationLabelList</code></td><td>for segmentation mask</td></tr><tr><td><code>ObjectItemlist</code></td><td>like <code>ImageItemList</code>but will default labels to <code>ObjectLabelList</code></td></tr><tr><td><code>PointsItemList</code></td><td>for points (of the type <code>ImagePoints</code>)</td></tr><tr><td><code>ImageList</code></td><td>for image to image tasks</td></tr><tr><td><code>TextList</code></td><td>for text date</td></tr><tr><td><code>TabularList</code></td><td>for tabular data</td></tr><tr><td><code>CollabList</code></td><td>for collaborative filtering</td></tr></tbody></table><h3 id="databunch-2-from"><a href="#databunch-2-from" aria-hidden="true" class="header-anchor">#</a> DataBunch / 2. from_</h3><table><thead><tr><th>function</th><th>Description</th></tr></thead><tbody><tr><td><code>from_folder(path)</code></td><td>From folder defined in <code>path</code><a href="https://docs.fast.ai/data_block.html#ItemList.from_folder" target="_blank" title="https://docs.fast.ai/data_block.html#ItemList.from_folder" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>from_df(path, df)</code></td><td>From DataFrame (<code>df</code>)</td></tr><tr><td><code>from_csv(path,csv_name)</code></td><td>Create ItemList from <code>.csv</code> file,</td></tr></tbody></table><h3 id="databunch-3-split"><a href="#databunch-3-split" aria-hidden="true" class="header-anchor">#</a> DataBunch / 3. split</h3><p>How to split  your data for training, validation and test.</p><table><thead><tr><th>function</th><th>Description</th></tr></thead><tbody><tr><td><code>no_split</code></td><td>No split data between <code>train</code> and <code>val</code> (empty <code>validation set</code>)</td></tr><tr><td><code>random_split_by_pct(valid_pct=0.2)</code></td><td>Split by random value</td></tr><tr><td><code>split_by_files(valid_names)</code></td><td>Split by list of files for validation</td></tr><tr><td><code>split_by_fname_file(fname,path)</code></td><td>Split by list of files in the <code>fname</code>file.</td></tr><tr><td><code>split_by_folder(train='train', valid='valid')</code></td><td>Split by the folder name</td></tr><tr><td><code>split_by_idx(valid_idx)</code></td><td>Split by list of indexes of <code>valid_idx</code></td></tr><tr><td><code>split_by_idxs(train_idx,valid_idx)</code></td><td>Split by list of indexes of <code>train_idx</code>, <code>valid_idx</code></td></tr><tr><td><code>split_by_list(train,valid)</code></td><td>Split by list for <code>train</code>, and <code>valid</code></td></tr><tr><td><code>split_by_vavlid_func(func)</code></td><td>Split by the function that return True if it is for <code>valido .</code></td></tr><tr><td><code>split_from_df(col)</code></td><td>Split the data from <code>col</code> in the DataFrom</td></tr></tbody></table><h3 id="databunch-4-label"><a href="#databunch-4-label" aria-hidden="true" class="header-anchor">#</a> DataBunch / 4.label</h3><p>Define the output for items (grand truth)</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>label_empty()</code></td><td><code>EmptyLabel</code> for each item</td></tr><tr><td><code>label_from_list(labels)</code></td><td>Label from the list of labels</td></tr><tr><td><code>label_from_df(cols=1)</code></td><td>Set label as column in the dataframe</td></tr><tr><td><code>label_const(const=0)</code></td><td>Set label as value</td></tr><tr><td><code>label_from_folder()</code></td><td>Get label from the parent folder of the file (e.g. <code>cars\train\porshe\img_001.jpg</code>, tha label will be <code>porche</code>)</td></tr><tr><td><code>label_from_func(func)</code></td><td>Get label from the function</td></tr><tr><td><code>label_from_re(pat)</code></td><td>Get label from pattern</td></tr><tr><td><code>label_for_lm()</code></td><td>Labers are from Language Model</td></tr></tbody></table><h3 id="databunch-5-transforms"><a href="#databunch-5-transforms" aria-hidden="true" class="header-anchor">#</a> DataBunch / 5. Transforms <a href="&lt;https://docs.fast.ai/vision.image.html#ResizeMethod&gt;" target="_blank" title="&lt;https://docs.fast.ai/vision.image.html#ResizeMethod&gt;" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Add list of transforms like Data augmentation</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>tmfs</code></td><td>List of random transformation</td></tr><tr><td><code>size</code></td><td>size of the image <code>(224,224)</code> or <code>224</code> if it’s square</td></tr><tr><td><code>resize_method</code></td><td>Type of resize: <code>ResizeMethod.CROP</code></td></tr><tr><td></td><td><code>ResizeMethod.CROP</code> - resize so that the image fits in the desired canvas on its smaller side and crop</td></tr><tr><td></td><td><code>ResizeMethod.PAD</code> - resize so that the image fits in the desired canvas on its bigger side and crop</td></tr><tr><td></td><td><code>ResizeMethod.SQUISH</code> - resize theimage by squishing it in the desired canvas</td></tr><tr><td></td><td><code>ResizeMethod.NO</code> - doesn't resize the image</td></tr><tr><td><code>padding_mode</code></td><td>Padding mode</td></tr><tr><td></td><td><code>zeros</code> - fill with zeros</td></tr><tr><td></td><td><code>border</code> -fill with values from border pixel</td></tr><tr><td></td><td><code>reflection</code>- fill with reflection</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> <span class="token punctuation">(</span>ImageList<span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path<span class="token punctuation">,</span> 
                      convert_mode<span class="token operator">=</span><span class="token string">'L'</span>
                     <span class="token punctuation">)</span><span class="token punctuation">.</span>split_by_folder<span class="token punctuation">(</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span>label_from_folder<span class="token punctuation">(</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                 size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                 padding_mode<span class="token operator">=</span><span class="token string">'border'</span><span class="token punctuation">,</span>
                                 resize_method<span class="token operator">=</span>ResizeMethod<span class="token punctuation">.</span>PAD<span class="token punctuation">)</span>
                      <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22>#path, convert_mode='L'</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>
path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>DOGS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>  <span class="token comment" data-v-54601d22># http://files.fast.ai/data/examples/dogscats</span>


data <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span>ImageList<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> 
                      convert_mode<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'L'</span>
                     <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>split_by_folder<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
                      <span class="token punctuation" data-v-54601d22>.</span>label_from_folder<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
                      <span class="token punctuation" data-v-54601d22>.</span>transform<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                 size<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                 padding_mode<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'border'</span><span class="token punctuation" data-v-54601d22>,</span>
                                 resize_method<span class="token operator" data-v-54601d22>=</span>ResizeMethod<span class="token punctuation" data-v-54601d22>.</span>PAD<span class="token punctuation" data-v-54601d22>)</span>
                      <span class="token punctuation" data-v-54601d22>.</span>databunch<span class="token punctuation" data-v-54601d22>(</span>bs<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>64</span><span class="token punctuation" data-v-54601d22>,</span> num_workers<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1554552160493.c9355d27.png" alt="1554552160493"></p><h3 id="databunch-6-dataunch"><a href="#databunch-6-dataunch" aria-hidden="true" class="header-anchor">#</a> DataBunch / 6. Dataunch</h3><p>Convert to DataBunch. The difference from DataSet is that DataBunch divide data into <code>train</code>, <code>valid</code>, and <code>test</code> DataSet.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>
</code></pre></div><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>.show_batch(rows=5,ds_type=DatasetType.Train)</code></td><td>Show in the result example images<br><code>ds_type=[DatasetType.Train, DatasetType.Test, DatasetType.Valid,Single, DatasetType.Fix]</code></td></tr><tr><td><code>.dl(ds_type)</code></td><td>Returns <code>DeviceDataLoader</code></td></tr><tr><td><code>.c</code></td><td>Return count of classes</td></tr><tr><td><code>.classes</code></td><td>List of classes</td></tr><tr><td><code>.train_ds</code>, <code>train_dl</code></td><td>Return train DataSet, or train DataLoader. First value is input, and second value is output.(e.g. <code>data.train_ds[0]</code>):<br><code>(Image (3, 128, 128), MultiCategory haze;primary)</code></td></tr><tr><td><code>valid_ds</code>, <code>valid_dl</code></td><td>Valid DataSet, Valid DataLoader</td></tr><tr><td><code>test_ds</code>, <code>test_dl</code></td><td>Test DataSet, Test DataLoader</td></tr></tbody></table><h3 id="normalize"><a href="#normalize" aria-hidden="true" class="header-anchor">#</a> .normalize()</h3><p>Normalize data based on the mean and standard devation of the image using the Standard Score (<code>(x-mean)/std</code>). For the image you  normalize value for each channel separetely (R,G,B).  If you download images from standard sources you can use predefined statistics. Otherwise use <code>batch_stats()</code> that returns statistics for your images.</p><div class="language-python extra-class"><pre class="language-python"><code>cifar_stats <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.491</span><span class="token punctuation">,</span> <span class="token number">0.482</span><span class="token punctuation">,</span> <span class="token number">0.447</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.247</span><span class="token punctuation">,</span> <span class="token number">0.243</span><span class="token punctuation">,</span> <span class="token number">0.261</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
imagenet_stats <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
mnist_stats <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.15</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.15</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>
    path_img<span class="token punctuation">,</span> 
    fnames<span class="token punctuation">,</span> 
    pat<span class="token punctuation">,</span> 
    ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> bs<span class="token operator">=</span>bs
<span class="token punctuation">)</span>

data <span class="token operator">=</span> data<span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>data<span class="token punctuation">.</span>batch_stats<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#or data = data.normalize(imagenet_stats)</span>
</code></pre></div><h2 id="fast-ai-data-augmentation"><a href="#fast-ai-data-augmentation" aria-hidden="true" class="header-anchor">#</a> fast.ai   / Data augmentation <a href="https://becominghuman.ai/data-augmentation-using-fastai-aefa88ca03f1" target="_blank" title="https://becominghuman.ai/data-augmentation-using-fastai-aefa88ca03f1" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Group of functions that changes your data without changing the meaning of the data. Usefull to test your model when you want to add some data augmentation. For example little zoom on the image, flip the image,  rotate in a small range).</p><h3 id="get-transforms"><a href="#get-transforms" aria-hidden="true" class="header-anchor">#</a> get_transforms()  <a href="https://github.com/fastai/fastai/blob/master/fastai/vision/transform.py#L288" target="_blank" title="https://github.com/fastai/fastai/blob/master/fastai/vision/transform.py#L288" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>source</span></a></h3><p>Return list of transforms for the image that can be used in the <code>ImageDataBunch</code> as a <code>df_tfms</code> parameter. The list is divided into transformation for <code>train</code> and <code>validation</code></p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><code>do_flip</code></td><td>Image can be flipped</td></tr><tr><td><code>flip_vert</code></td><td>Image can be flipped vertically (like satelite images or images from top)</td></tr><tr><td><code>max_rotate</code></td><td>maximum rotation of the image (default: <code>10</code>)</td></tr><tr><td><code>max_zoom</code></td><td>maximum zoom of the image (default: <code>1.1</code>)</td></tr><tr><td><code>max_lighting</code></td><td>maximum lighting of the image (default: <code>0.2</code>)</td></tr><tr><td><code>max_warp</code></td><td>maximum warp of the image (default: <code>0.2</code>)</td></tr><tr><td><code>p_affine</code></td><td>the probability that each affine transform and symmetric warp is applied</td></tr><tr><td><code>p_lighting</code></td><td>the probability that each lighting transform is applied</td></tr><tr><td><code>xtra_tfms</code></td><td>a list of additional transforms</td></tr></tbody></table><p><img src="/assets/img/1549719418642.013380dd.png" alt="1549719418642"></p><h3 id="zoom-crop"><a href="#zoom-crop" aria-hidden="true" class="header-anchor">#</a> zoom crop() <a href="https://docs.fast.ai/vision.transform.html#zoom_crop" target="_blank" title="https://docs.fast.ai/vision.transform.html#zoom_crop" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Randomly zoom and/or crop</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><code>scale</code></td><td>Decimal or range of decimals to zoom the image</td></tr><tr><td><code>do_rand</code></td><td>if true, transform is randomized</td></tr><tr><td><code>p</code></td><td>probability to apply the zzom</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>tsfms <span class="token operator">=</span> zoom_crop<span class="token punctuation">(</span>scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> do_rand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tsfms <span class="token operator" data-v-54601d22>=</span> zoom_crop<span class="token punctuation" data-v-54601d22>(</span>scale<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.75</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> do_rand<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tsfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tsfms
</code></pre></div></div></div><p><img src="/assets/img/1549721099158.49d6b36e.png" alt="1549721099158"></p><h3 id="rand-resize-crop"><a href="#rand-resize-crop" aria-hidden="true" class="header-anchor">#</a> rand_resize_crop()</h3><p>Randomly resize and crop the image.</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><code>size</code></td><td>Final size of the image</td></tr><tr><td><code>max_scale</code></td><td>Zoom the image to a arandom scal up to this</td></tr><tr><td><code>ratios</code></td><td>Range of rations in which a new one will be randomly picked</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>rand_resize_crop<span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>rand_resize_crop<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549721362837.7e0f2c8b.png" alt="1549721362837"></p><h3 id="list-of-transforms"><a href="#list-of-transforms" aria-hidden="true" class="header-anchor">#</a> List of transforms</h3><h4 id="brightness"><a href="#brightness" aria-hidden="true" class="header-anchor">#</a> brightness() <a href="https://docs.fast.ai/vision.transform.html#_brightness" target="_blank" title="https://docs.fast.ai/vision.transform.html#_brightness" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply <code>change</code> in brightness of image. (<code>0</code> - black, <code>0.5</code> no change, <code>0.9</code> - bright)</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>brightness<span class="token punctuation">(</span>change<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>brightness<span class="token punctuation" data-v-54601d22>(</span>change<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549722249727.a3245d04.png" alt="1549722249727"></p><h4 id="contrast"><a href="#contrast" aria-hidden="true" class="header-anchor">#</a> contrast <a href="https://docs.fast.ai/vision.transform.html#_contrast" target="_blank" title="https://docs.fast.ai/vision.transform.html#_contrast" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply <code>scale</code> to contrast of the image. (<code>0</code> - grey, <code>&gt;1</code> - super contrast, <code>1.0</code> - original image)</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>contrast<span class="token punctuation">(</span>scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>contrast<span class="token punctuation" data-v-54601d22>(</span>scale<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>2.0</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549722744720.6c7f8e82.png" alt="1549722744720"></p><h4 id="crop"><a href="#crop" aria-hidden="true" class="header-anchor">#</a> crop <a href="https://docs.fast.ai/vision.transform.html#_crop" target="_blank" title="https://docs.fast.ai/vision.transform.html#_crop" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Crop the image with the <code>size</code> and return image with the new size.<code>row_pct</code> and <code>col_pct</code> are the position of the left/top corner.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>crop<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> row_pct<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>col_pct<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>crop<span class="token punctuation" data-v-54601d22>(</span>size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>250</span><span class="token punctuation" data-v-54601d22>,</span> row_pct<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span>col_pct<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549723001104.799099d0.png" alt="1549723001104"></p><h4 id="crop-pad"><a href="#crop-pad" aria-hidden="true" class="header-anchor">#</a> crop pad <a href="https://docs.fast.ai/vision.transform.html#_crop_pad" target="_blank" title="https://docs.fast.ai/vision.transform.html#_crop_pad" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Like <code>crop</code>, but if the final image is biggar it will also add padding to the image.</p><div class="language-python extra-class"><pre class="language-python"><code>crop_pad<span class="token punctuation">(</span>im<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'zeros'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>


path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

fig<span class="token punctuation" data-v-54601d22>,</span> axs <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>for</span> size<span class="token punctuation" data-v-54601d22>,</span> ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>zip</span><span class="token punctuation" data-v-54601d22>(</span>np<span class="token punctuation" data-v-54601d22>.</span>linspace<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>200</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>600</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> axs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    crop_pad<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span> <span class="token builtin" data-v-54601d22>int</span><span class="token punctuation" data-v-54601d22>(</span>size<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'zeros'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>.</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>.</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>,</span> title<span class="token operator" data-v-54601d22>=</span>f<span class="token string" data-v-54601d22>'size = {int(size)}'</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549730189408.ae194e54.png" alt="1549730189408"></p><div class="warning custom-block"><p class="custom-block-title">Why there is no effect in crop_pad on `apply_tfms`</p><p><code>crop_pad</code> is used but on an image that was resized so that its lower dimension is equal to the size you pass.* <a href="https://forums.fast.ai/t/crop-pad-doesnt-seem-to-work-properly-with-apply-tfms/34096" target="_blank" title="https://forums.fast.ai/t/crop-pad-doesnt-seem-to-work-properly-with-apply-tfms/34096" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>source</span></a></p></div><h4 id="dihedral"><a href="#dihedral" aria-hidden="true" class="header-anchor">#</a> dihedral<a href="https://docs.fast.ai/vision.transform.html#_dihedral" target="_blank" title="https://docs.fast.ai/vision.transform.html#_dihedral" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Randomly flip  and apply rotation of a multiple of 90 degrees.</p><p>If the target is an <code>ImagePoints</code>, or an <code>ImageBBox</code> use <code>dihedral_affine</code> function.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>dihedral<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>dihedral<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549731670616.259435c4.png" alt="1549731670616"></p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">for</span> k<span class="token punctuation">,</span> ax <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>axs<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dihedral<span class="token punctuation">(</span>im<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax<span class="token punctuation">,</span> title<span class="token operator">=</span>f<span class="token string">'k={k}'</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

fig<span class="token punctuation" data-v-54601d22>,</span> axs <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>,</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>8</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>for</span> k<span class="token punctuation" data-v-54601d22>,</span> ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>axs<span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    dihedral<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span> k<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>,</span> title<span class="token operator" data-v-54601d22>=</span>f<span class="token string" data-v-54601d22>'k={k}'</span><span class="token punctuation" data-v-54601d22>)</span>
plt<span class="token punctuation" data-v-54601d22>.</span>tight_layout<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549731840065.6ea70d7c.png" alt="1549731840065"></p><h4 id="flip-lr"><a href="#flip-lr" aria-hidden="true" class="header-anchor">#</a> flip lr<a href="https://docs.fast.ai/vision.transform.html#_flip_lr" target="_blank" title="https://docs.fast.ai/vision.transform.html#_flip_lr" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Randomly flip  horizontaly.</p><p>If the target is an <code>ImagePoints</code>, or an <code>ImageBBox</code> use ``flip_affine`function.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>flip_lr<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>flip_lr<span class="token punctuation" data-v-54601d22>(</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549732187896.f10b0505.png" alt="1549732187896"></p><h4 id="jitter"><a href="#jitter" aria-hidden="true" class="header-anchor">#</a> jitter <a href="https://docs.fast.ai/vision.transform.html#_jitter" target="_blank" title="https://docs.fast.ai/vision.transform.html#_jitter" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Changes pixels randomly replacing them with pixels from the neighorbhood. <code>magnitude</code> parameter is used to get information how far the neighborhood extends.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>jitter<span class="token punctuation">(</span>magnitude<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token punctuation">,</span><span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>jitter<span class="token punctuation" data-v-54601d22>(</span>magnitude<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>0.05</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.05</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549732538184.46a99401.png" alt="1549732538184"></p><h4 id="pad"><a href="#pad" aria-hidden="true" class="header-anchor">#</a> pad <a href="https://docs.fast.ai/vision.transform.html#_pad" target="_blank" title="https://docs.fast.ai/vision.transform.html#_pad" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply padding to the image: (<code>padding</code> - size of padding )</p><ul><li><code>mode=zeros</code> : pads with zeros</li><li><code>mode=border</code>: repeats the pixels at the border</li><li><code>mode=reflection</code>: pads by taking the pixels symmetric to the border</li></ul><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>pad<span class="token punctuation">(</span>padding<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>mode<span class="token operator">=</span><span class="token string">'zeros'</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>pad<span class="token punctuation" data-v-54601d22>(</span>padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>30</span><span class="token punctuation" data-v-54601d22>,</span>mode<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'zeros'</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549732802157.5d448562.png" alt="1549732802157"></p><h4 id="perspective-warp"><a href="#perspective-warp" aria-hidden="true" class="header-anchor">#</a> perspective warp  <a href="https://docs.fast.ai/vision.transform.html#_perspective_warp" target="_blank" title="https://docs.fast.ai/vision.transform.html#_perspective_warp" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply perspective warping that show a different 3D perspective of the image.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>perspective_warp<span class="token punctuation">(</span>magnitude<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>perspective_warp<span class="token punctuation" data-v-54601d22>(</span>magnitude<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549733306310.61d60245.png" alt="1549733306310"></p><h4 id="symmetric-warp"><a href="#symmetric-warp" aria-hidden="true" class="header-anchor">#</a> symmetric_warp  <a href="https://docs.fast.ai/vision.transform.html#_symmetric_warp" target="_blank" title="https://docs.fast.ai/vision.transform.html#_symmetric_warp" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply symetric warp of  <code>magnitude</code>.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>symmetric_warp<span class="token punctuation">(</span>magnitude<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>symmetric_warp<span class="token punctuation" data-v-54601d22>(</span>magnitude<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549733878458.4fe1a147.png" alt="1549733878458"></p><h4 id="cutout"><a href="#cutout" aria-hidden="true" class="header-anchor">#</a> cutout  <a href="https://docs.fast.ai/vision.transform.html#_cutout" target="_blank" title="https://docs.fast.ai/vision.transform.html#_cutout" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Cut out <code>n_holes</code> number of square holes at random location</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>cutout<span class="token punctuation">(</span>n_holes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>cutout<span class="token punctuation" data-v-54601d22>(</span>n_holes<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>20</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549734050015.f645d853.png" alt="1549734050015"></p><h2 id="fast-ai-learner"><a href="#fast-ai-learner" aria-hidden="true" class="header-anchor">#</a> fast.ai / Learner</h2><h3 id="basic-functions-2"><a href="#basic-functions-2" aria-hidden="true" class="header-anchor">#</a> Basic Functions</h3><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>learn.save('filename')</code></td><td>Save learner</td></tr><tr><td><code>learn.load('filename')</code></td><td>Load learner from the file</td></tr><tr><td><code>learn.export()</code></td><td>Export the learner as pickle file <code>export.pkl</code></td></tr><tr><td><code>learn = load_learner(path)</code></td><td>load learner from the folder whith the exported file <code>export.pkl</code></td></tr><tr><td><code>learn.load_encoder('fine_tuned_enc')</code></td><td>Load encoder</td></tr><tr><td><code>learn.save_encoder('fit-tuned-enc')</code></td><td>Save encoder</td></tr><tr><td><code>learn.data</code></td><td><code>DataBunch</code> connected with learner</td></tr><tr><td><strong>Collaborative filtering:</strong></td><td></td></tr><tr><td><code>learn.bias(arr,is_item)</code></td><td>a bias vector for user or item, <code>learn.bias(['Star Wars (1977)'],True)</code></td></tr><tr><td><code>learn.weight(arr,is_item)</code></td><td>a weight matrix for user or item, <code>learn.weight(['Star Wars (1977)'],True)</code></td></tr><tr><td><code>parameters()</code></td><td>list of all parameters</td></tr></tbody></table><p>Encoder is used in <code>seq2seq</code><a href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html" target="_blank" title="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a>  problem, by techinque called <code>trasfer learning</code>.</p><ul><li>The <code>encoder</code> is essentially tasked with creating a mathematical representation of the language based on the task for predicting the next word.</li><li>A <code>decoder</code> is responsible for taking that representation and applying it to some problem (e.g., predicting the next word, understanding sentiment, etc…) <a href="https://forums.fast.ai/t/what-is-an-encoder-and-what-is-save-load-encoder-actually-doing/8281/3" target="_blank" title="https://forums.fast.ai/t/what-is-an-encoder-and-what-is-save-load-encoder-actually-doing/8281/3" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>source</span></a></li></ul><h4 id="show-results"><a href="#show-results" aria-hidden="true" class="header-anchor">#</a> .show_results()</h4><p>Show the output of the learning with Ground Truth, and Predictions.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>show_results<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783391484.08e04e39.png" alt="1550783391484"></p><h4 id="predict"><a href="#predict" aria-hidden="true" class="header-anchor">#</a> .predict()</h4><p>predict the data</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>item</strong></td><td>The item to predict</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>im <span class="token operator">=</span> open_image<span class="token punctuation">(</span>fnames<span class="token punctuation">[</span><span class="token number">184</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>im<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token comment" data-v-54601d22># learner</span>
<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>
path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>DOGS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>  <span class="token comment" data-v-54601d22># http://files.fast.ai/data/examples/dogscats</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                   ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   bs<span class="token operator" data-v-54601d22>=</span>bs
                                  <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span>lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>save<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dog-cat'</span><span class="token punctuation" data-v-54601d22>)</span>


<span class="token comment" data-v-54601d22># Part that could be done separate</span>
<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

learn<span class="token punctuation" data-v-54601d22>.</span>load<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dog-cat'</span><span class="token punctuation" data-v-54601d22>)</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>learn<span class="token punctuation" data-v-54601d22>.</span>predict<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
im
</code></pre></div></div></div><p><img src="/assets/img/1549735528945.54158fe8.png" alt="1549735528945"></p><h4 id="partial"><a href="#partial" aria-hidden="true" class="header-anchor">#</a> partial()</h4><p>Partial is help function from Python, that can create a new function with different parameters. Normally accuracy_tresh get <code>tresh=0.5</code>, but with partial we can use this function with default <code>tresh=0.2</code></p><div class="language-python extra-class"><pre class="language-python"><code>acc_02 <span class="token operator">=</span> partial<span class="token punctuation">(</span>accuracy_thresh<span class="token punctuation">,</span> thresh<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
f_score <span class="token operator">=</span> partial<span class="token punctuation">(</span>fbeta<span class="token punctuation">,</span> thresh<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> arch<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span>acc_02<span class="token punctuation">,</span> f_score<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550780654267.1af9ec27.png" alt="1550780654267"></p><h4 id="to-fp16"><a href="#to-fp16" aria-hidden="true" class="header-anchor">#</a> .to_fp16()</h4><p>Normally precission is 32 bit, but you can downgrade this precission to 16bit. It can speed up yuor learning by 200%.</p><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> learn<span class="token punctuation">.</span>to_fp16<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="learner-cnn-learner"><a href="#learner-cnn-learner" aria-hidden="true" class="header-anchor">#</a> Learner / cnn_learner()</h3><p>Create a <code>Learner</code> object from the <code>data</code> object and model from the architecture.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td>DataBunch</td></tr><tr><td><code>arch</code></td><td>Architecture of the model</td></tr><tr><td><code>metrics</code></td><td>additional metrics to show during learning</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path<span class="token punctuation">,</span>
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> 
                                   bs<span class="token operator">=</span>bs
                                  <span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

learn <span class="token operator">=</span> cnn_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22>#path, convert_mode='L'</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>
path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>DOGS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>  <span class="token comment" data-v-54601d22># http://files.fast.ai/data/examples/dogscats</span>

data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                   ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   bs<span class="token operator" data-v-54601d22>=</span>bs
                                  <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>

learn <span class="token operator" data-v-54601d22>=</span> create_cnn<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> metrics<span class="token operator" data-v-54601d22>=</span>error_rate<span class="token punctuation" data-v-54601d22>)</span>
learn
</code></pre></div></div></div><p><img src="/assets/img/1549734500237.510f38b9.png" alt="1549734500237"></p><h4 id="example-using-imagelist-and-converts-to-black-white"><a href="#example-using-imagelist-and-converts-to-black-white" aria-hidden="true" class="header-anchor">#</a> Example using ImageList and converts to Black&amp;White</h4><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> <span class="token punctuation">(</span>ImageList<span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path<span class="token punctuation">,</span> 
                      convert_mode<span class="token operator">=</span><span class="token string">'L'</span> <span class="token comment"># 'L', 'RGB', or 'CMYK'</span>
                     <span class="token punctuation">)</span><span class="token punctuation">.</span>split_by_folder<span class="token punctuation">(</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span>label_from_folder<span class="token punctuation">(</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                 size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                 resize_method<span class="token operator">=</span>ResizeMethod<span class="token punctuation">.</span>SQUISH<span class="token punctuation">)</span>
                      <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1554551513821.813cc8f2.png" alt="1554551513821"></p><h3 id="learner-unet-learner"><a href="#learner-unet-learner" aria-hidden="true" class="header-anchor">#</a> Learner / unet_learner() <a href="https://docs.fast.ai/vision.models.unet.html#DynamicUnet" target="_blank" title="https://docs.fast.ai/vision.models.unet.html#DynamicUnet" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><a href="https://tuatini.me/practical-image-segmentation-with-unet/" target="_blank" title="https://tuatini.me/practical-image-segmentation-with-unet/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p><img src="/assets/img/1_dKPBgCdJx6zj3MpED3lcNA.5b8e95a4.png" alt="img"></p><p>Create Unet architecture learner that converts image to image (mask).  The suitable class that is used for DataBunch is <code>SegmentationItemList</code> (that is the same as <code>ImageList</code>).</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td>DataBunch</td></tr><tr><td><code>arch</code></td><td>Architecture</td></tr><tr><td><code>metrics</code></td><td>List of metrics</td></tr><tr><td><code>wd</code></td><td>From Learner class <code>weight-decay</code> for regularization in Adam optimalization <a href="https://arxiv.org/abs/1711.05101" target="_blank" title="https://arxiv.org/abs/1711.05101" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>bottle</code></td><td>bottle flags if we use a bottleneck or not for that skip connection</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> unet_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>metrics<span class="token punctuation">,</span> wd<span class="token operator">=</span>wd<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>callbacks<span class="token punctuation" data-v-54601d22>.</span>hooks <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22>#!git clone https://github.com/alexgkendall/SegNet-Tutorial.git</span>
    
path <span class="token operator" data-v-54601d22>=</span> Path<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'./SegNet-Tutorial/CamVid'</span><span class="token punctuation" data-v-54601d22>)</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'val'</span><span class="token punctuation" data-v-54601d22>)</span>
lbl_names <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'valannot'</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_y_fn</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> Path<span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>.</span>parent<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>+</span><span class="token string" data-v-54601d22>'annot'</span><span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span>x<span class="token punctuation" data-v-54601d22>.</span>name

codes <span class="token operator" data-v-54601d22>=</span> array<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token string" data-v-54601d22>'Sky'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Building'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Pole'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Road'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Sidewalk'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Tree'</span><span class="token punctuation" data-v-54601d22>,</span>
    <span class="token string" data-v-54601d22>'Sign'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Fence'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Car'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Pedestrian'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Cyclist'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Void'</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

img_f <span class="token operator" data-v-54601d22>=</span> fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span>
mask <span class="token operator" data-v-54601d22>=</span> open_mask<span class="token punctuation" data-v-54601d22>(</span>get_y_fn<span class="token punctuation" data-v-54601d22>(</span>img_f<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
src_size <span class="token operator" data-v-54601d22>=</span> np<span class="token punctuation" data-v-54601d22>.</span>array<span class="token punctuation" data-v-54601d22>(</span>mask<span class="token punctuation" data-v-54601d22>.</span>shape<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>:</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

bs<span class="token punctuation" data-v-54601d22>,</span>size <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>8</span><span class="token punctuation" data-v-54601d22>,</span>src_size<span class="token operator" data-v-54601d22>//</span><span class="token number" data-v-54601d22>2</span>

src <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span>SegmentationItemList<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>)</span>
       <span class="token punctuation" data-v-54601d22>.</span>split_by_folder<span class="token punctuation" data-v-54601d22>(</span>valid<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'val'</span><span class="token punctuation" data-v-54601d22>)</span>
       <span class="token punctuation" data-v-54601d22>.</span>label_from_func<span class="token punctuation" data-v-54601d22>(</span>get_y_fn<span class="token punctuation" data-v-54601d22>,</span> classes<span class="token operator" data-v-54601d22>=</span>codes<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

data <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span>src<span class="token punctuation" data-v-54601d22>.</span>transform<span class="token punctuation" data-v-54601d22>(</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> tfm_y<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token punctuation" data-v-54601d22>.</span>databunch<span class="token punctuation" data-v-54601d22>(</span>bs<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span>
        <span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>


name2id <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>{</span>v<span class="token punctuation" data-v-54601d22>:</span>k <span class="token keyword" data-v-54601d22>for</span> k<span class="token punctuation" data-v-54601d22>,</span>v <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>codes<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>}</span>
void_code <span class="token operator" data-v-54601d22>=</span> name2id<span class="token punctuation" data-v-54601d22>[</span><span class="token string" data-v-54601d22>'Void'</span><span class="token punctuation" data-v-54601d22>]</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>acc_camvid</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>input</span><span class="token punctuation" data-v-54601d22>,</span> target<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    target <span class="token operator" data-v-54601d22>=</span> target<span class="token punctuation" data-v-54601d22>.</span>squeeze<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
    mask <span class="token operator" data-v-54601d22>=</span> target <span class="token operator" data-v-54601d22>!=</span> void_code
    <span class="token keyword" data-v-54601d22>return</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>input</span><span class="token punctuation" data-v-54601d22>.</span>argmax<span class="token punctuation" data-v-54601d22>(</span>dim<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span>mask<span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>==</span>target<span class="token punctuation" data-v-54601d22>[</span>mask<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>float</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

metrics<span class="token operator" data-v-54601d22>=</span>acc_camvid
wd<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span>

learn <span class="token operator" data-v-54601d22>=</span> unet_learner<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> 
                     models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> 
                     metrics<span class="token operator" data-v-54601d22>=</span>metrics<span class="token punctuation" data-v-54601d22>,</span> 
                     wd<span class="token operator" data-v-54601d22>=</span>wd<span class="token punctuation" data-v-54601d22>,</span> 
                     bottle<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token comment" data-v-54601d22># bottle flags if we use a bottleneck or not for that skip connection.</span>

learn
</code></pre></div></div></div><p><img src="/assets/img/1550781130901.4862e43a.png" alt="1550781130901"></p><h3 id="learner-language-model-learner"><a href="#learner-language-model-learner" aria-hidden="true" class="header-anchor">#</a> Learner / language_model_learner <a href="https://docs.fast.ai/text.learner.html#language_model_learner" target="_blank" title="https://docs.fast.ai/text.learner.html#language_model_learner" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>A learner for language model that predicts next word. Usuefull also as an encoder for <code>text_classifier_learner</code></p><p><code>TextLMDataBunch</code> -  Text DataBunch for training a lanaguage model.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td>DataBunch</td></tr><tr><td><code>arch</code></td><td>Architecture (actually only <code>AWD_LSTM</code>)</td></tr><tr><td><code>drop_mult</code></td><td><code>drop_mult</code> is applied to all the dropouts weights of the config. Parameter for <code>WeughtDropout</code> layer.</td></tr><tr><td></td><td><strong>TextLMDataBunch parameters:</strong></td></tr><tr><td><code>text_cols</code></td><td>Text columns (<code>from_df</code> is the number of the column, default: 1)</td></tr><tr><td><code>label_cols</code></td><td>Label columns (<code>from_df</code> is the number of the column, default: 0)</td></tr></tbody></table><p><img src="/assets/img/1551290025513.770b1ade.png" alt="1551290025513"></p><p><a href="./twitter.csv">twitter.csv</a></p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>text <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> <span class="token string">'./textdata'</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">'twitter.csv'</span>
data_lm <span class="token operator">=</span> TextLMDataBunch<span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span><span class="token builtin">file</span><span class="token punctuation">,</span> text_cols<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">,</span>label_cols<span class="token operator">=</span><span class="token string">'Style'</span><span class="token punctuation">)</span>

learn <span class="token operator">=</span> language_model_learner<span class="token punctuation">(</span>data_lm<span class="token punctuation">,</span> AWD_LSTM<span class="token punctuation">,</span> drop_mult<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>text <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'./textdata'</span>
<span class="token builtin" data-v-54601d22>file</span> <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'twitter.csv'</span>
data_lm <span class="token operator" data-v-54601d22>=</span> TextLMDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_csv<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span><span class="token builtin" data-v-54601d22>file</span><span class="token punctuation" data-v-54601d22>,</span> text_cols<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'Name'</span><span class="token punctuation" data-v-54601d22>,</span>label_cols<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'Style'</span><span class="token punctuation" data-v-54601d22>)</span>

learn <span class="token operator" data-v-54601d22>=</span> language_model_learner<span class="token punctuation" data-v-54601d22>(</span>data_lm<span class="token punctuation" data-v-54601d22>,</span> AWD_LSTM<span class="token punctuation" data-v-54601d22>,</span> drop_mult<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.3</span><span class="token punctuation" data-v-54601d22>)</span>

learn<span class="token punctuation" data-v-54601d22>.</span>fit_one_cycle<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>predict<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;This is some text&quot;</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,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" alt="1551290431811"></p><h3 id="learner-text-classifier-learner"><a href="#learner-text-classifier-learner" aria-hidden="true" class="header-anchor">#</a> Learner / text_classifier_learner</h3><p>Learner to classify the text. It can be <code>positive</code>, or <code>negative</code> review, or the style of the text, or the emotion in the text. The <code>TextClasDataBunch</code> requires <code>vocab</code> value with vocabulary for the dataset.</p><p>A learner for language model that predicts next word. Usuefull also as an encoder for <code>text_classifier_learner</code></p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td>DataBunch</td></tr><tr><td><code>arch</code></td><td>Architecture (actually only <code>AWD_LSTM</code>)</td></tr><tr><td><code>drop_mult</code></td><td><code>drop_mult</code> is applied to all the dropouts weights of the config. Parameter for <code>WeughtDropout</code> layer.</td></tr><tr><td></td><td><strong>TextDataBunch parameters:</strong></td></tr><tr><td><code>path</code></td><td>path of the file</td></tr><tr><td><code>text_cols</code></td><td>columns contain texts</td></tr><tr><td><code>label_cols</code></td><td>columns contain labels</td></tr><tr><td><code>vocab</code></td><td>vocabulary for text</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>data_clas <span class="token operator">=</span> TextClasDataBunch<span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span><span class="token builtin">file</span><span class="token punctuation">,</span>
                                       text_cols<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">,</span>
                                       label_cols<span class="token operator">=</span><span class="token string">'Style'</span><span class="token punctuation">,</span>
                                       vocab<span class="token operator">=</span>data_lm<span class="token punctuation">.</span>vocab<span class="token punctuation">)</span>

learn <span class="token operator">=</span> text_classifier_learner<span class="token punctuation">(</span>data_clas<span class="token punctuation">,</span> 
                                AWD_LSTM<span class="token punctuation">,</span> 
                                drop_mult<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>text <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'./textdata'</span>
<span class="token builtin" data-v-54601d22>file</span> <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'data4.csv'</span>

data_lm <span class="token operator" data-v-54601d22>=</span> TextLMDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_csv<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span><span class="token builtin" data-v-54601d22>file</span><span class="token punctuation" data-v-54601d22>,</span>text_cols<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'Name'</span><span class="token punctuation" data-v-54601d22>,</span>label_cols<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'Style'</span><span class="token punctuation" data-v-54601d22>)</span>
data_clas <span class="token operator" data-v-54601d22>=</span> TextClasDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_csv<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span><span class="token builtin" data-v-54601d22>file</span><span class="token punctuation" data-v-54601d22>,</span>
                                       text_cols<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'Name'</span><span class="token punctuation" data-v-54601d22>,</span>
                                       label_cols<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'Style'</span><span class="token punctuation" data-v-54601d22>,</span>
                                       vocab<span class="token operator" data-v-54601d22>=</span>data_lm<span class="token punctuation" data-v-54601d22>.</span>vocab<span class="token punctuation" data-v-54601d22>)</span>

learn <span class="token operator" data-v-54601d22>=</span> text_classifier_learner<span class="token punctuation" data-v-54601d22>(</span>data_clas<span class="token punctuation" data-v-54601d22>,</span> 
                                AWD_LSTM<span class="token punctuation" data-v-54601d22>,</span> 
                                drop_mult<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22>#learn.load_encoder('fine_tuned_enc') Encoder need to be loaded </span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit_one_cycle<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>predict<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Angry!!!!!!!&quot;</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,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" alt="1551291317385"></p><h3 id="learner-tabular-learner"><a href="#learner-tabular-learner" aria-hidden="true" class="header-anchor">#</a> Learner / tabular_learner</h3><p>Learner for the tabular data like <code>XGBoost</code>, to predict values based on columns in the <code>DataFrame</code>.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>TabularDataBunch</code></td></tr><tr><td><code>layers</code></td><td>List of layers and size of each layer</td></tr><tr><td><code>metrics</code></td><td>additional metrics</td></tr><tr><td><strong>TabularList parameters</strong></td><td></td></tr><tr><td><code>cat_names</code></td><td>List of columns that are categories (also numbers like <code>day in month</code>)</td></tr><tr><td><code>cont_names</code></td><td>List of columns that are continuus numbers (like <code>cost</code>, <code>age</code>, <code>salary</code>)</td></tr><tr><td><code>procs</code></td><td>List of preprocessing for the input data</td></tr><tr><td><strong>List of preprocessing classes:</strong></td><td></td></tr><tr><td><code>FillMissing</code></td><td>Fill missing values, default using median <a href="https://docs.fast.ai/tabular.transform.html#FillMissing" target="_blank" title="https://docs.fast.ai/tabular.transform.html#FillMissing" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>Categorify</code></td><td>Categorize <code>cat_names</code>columns <a href="https://docs.fast.ai/tabular.transform.html#Categorify" target="_blank" title="https://docs.fast.ai/tabular.transform.html#Categorify" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>Normalize</code></td><td>Normalize input <a href="https://docs.fast.ai/tabular.transform.html#Normalize" target="_blank" title="https://docs.fast.ai/tabular.transform.html#Normalize" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr></tbody></table><p><img src="/assets/img/1551291408268.1333b73d.png" alt="1551291408268"></p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>tabular <span class="token keyword">import</span> <span class="token operator">*</span>

procs <span class="token operator">=</span> <span class="token punctuation">[</span>FillMissing<span class="token punctuation">,</span> Categorify<span class="token punctuation">,</span> Normalize<span class="token punctuation">]</span>
data <span class="token operator">=</span> <span class="token punctuation">(</span>TabularList<span class="token punctuation">.</span>from_df<span class="token punctuation">(</span>df<span class="token punctuation">,</span> path<span class="token operator">=</span>path<span class="token punctuation">,</span> 
                            cat_names<span class="token operator">=</span>cat_names<span class="token punctuation">,</span> 
                            cont_names<span class="token operator">=</span>cont_names<span class="token punctuation">,</span> 
                            procs<span class="token operator">=</span>procs<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span>split_by_idx<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                           <span class="token punctuation">.</span>label_from_df<span class="token punctuation">(</span>cols<span class="token operator">=</span>dep_var<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span>add_test<span class="token punctuation">(</span>test<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

learn <span class="token operator">=</span> tabular_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> layers<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span>accuracy<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>tabular <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>ADULT_SAMPLE<span class="token punctuation" data-v-54601d22>)</span>
df <span class="token operator" data-v-54601d22>=</span> pd<span class="token punctuation" data-v-54601d22>.</span>read_csv<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'adult.csv'</span><span class="token punctuation" data-v-54601d22>)</span>

dep_var <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'salary'</span>
cat_names <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token string" data-v-54601d22>'workclass'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'education'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'marital-status'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'occupation'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'relationship'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'race'</span><span class="token punctuation" data-v-54601d22>]</span>
cont_names <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token string" data-v-54601d22>'age'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'fnlwgt'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'education-num'</span><span class="token punctuation" data-v-54601d22>]</span>
procs <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>FillMissing<span class="token punctuation" data-v-54601d22>,</span> Categorify<span class="token punctuation" data-v-54601d22>,</span> Normalize<span class="token punctuation" data-v-54601d22>]</span>

test <span class="token operator" data-v-54601d22>=</span> TabularList<span class="token punctuation" data-v-54601d22>.</span>from_df<span class="token punctuation" data-v-54601d22>(</span>df<span class="token punctuation" data-v-54601d22>.</span>iloc<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>800</span><span class="token punctuation" data-v-54601d22>:</span><span class="token number" data-v-54601d22>1000</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>copy<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                           path<span class="token operator" data-v-54601d22>=</span>path<span class="token punctuation" data-v-54601d22>,</span> 
                           cat_names<span class="token operator" data-v-54601d22>=</span>cat_names<span class="token punctuation" data-v-54601d22>,</span> 
                           cont_names<span class="token operator" data-v-54601d22>=</span>cont_names<span class="token punctuation" data-v-54601d22>)</span>

data <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span>TabularList<span class="token punctuation" data-v-54601d22>.</span>from_df<span class="token punctuation" data-v-54601d22>(</span>df<span class="token punctuation" data-v-54601d22>,</span> path<span class="token operator" data-v-54601d22>=</span>path<span class="token punctuation" data-v-54601d22>,</span> 
                            cat_names<span class="token operator" data-v-54601d22>=</span>cat_names<span class="token punctuation" data-v-54601d22>,</span> 
                            cont_names<span class="token operator" data-v-54601d22>=</span>cont_names<span class="token punctuation" data-v-54601d22>,</span> 
                            procs<span class="token operator" data-v-54601d22>=</span>procs<span class="token punctuation" data-v-54601d22>)</span>
                           <span class="token punctuation" data-v-54601d22>.</span>split_by_idx<span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>list</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>800</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1000</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
                           <span class="token punctuation" data-v-54601d22>.</span>label_from_df<span class="token punctuation" data-v-54601d22>(</span>cols<span class="token operator" data-v-54601d22>=</span>dep_var<span class="token punctuation" data-v-54601d22>)</span>
                           <span class="token punctuation" data-v-54601d22>.</span>add_test<span class="token punctuation" data-v-54601d22>(</span>test<span class="token punctuation" data-v-54601d22>)</span>
                           <span class="token punctuation" data-v-54601d22>.</span>databunch<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

learn <span class="token operator" data-v-54601d22>=</span> tabular_learner<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> layers<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>200</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span> metrics<span class="token operator" data-v-54601d22>=</span>accuracy<span class="token punctuation" data-v-54601d22>)</span>

learn<span class="token punctuation" data-v-54601d22>.</span>fit<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
row <span class="token operator" data-v-54601d22>=</span> df<span class="token punctuation" data-v-54601d22>.</span>iloc<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span>
learn<span class="token punctuation" data-v-54601d22>.</span>predict<span class="token punctuation" data-v-54601d22>(</span>row<span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,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" alt="1551291709347"></p><h3 id="tabular-learner-add-datepart"><a href="#tabular-learner-add-datepart" aria-hidden="true" class="header-anchor">#</a> Tabular Learner / add_datepart</h3><p>This function helps you to add additional information for date column. This is very helpful for your neural network, because it can recognize some seasonal changes(like on sunday people more often visit your store) . The list of columns that are added:</p><ul><li>Year</li><li>Month</li><li>Week</li><li>Day</li><li>Dayofweek</li><li>Dayofyea</li><li>Is_month_end</li><li>Is_month_start</li><li>Is_quarter_end</li><li>Is_quarter_start</li><li>Is_year_end</li><li>Is_year_start</li><li>Hour (for time)</li><li>Minut</li><li>Second</li></ul><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>df</code></td><td>DataFrame</td></tr><tr><td><code>field_name</code></td><td>Name of the field</td></tr><tr><td><code>prefix</code></td><td>prefix column</td></tr><tr><td><code>drop</code></td><td>drop original column?</td></tr><tr><td><code>time</code></td><td>add time columns</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>tabular <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> datetime


df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
             <span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


add_datepart<span class="token punctuation">(</span>df<span class="token punctuation">,</span><span class="token string">'day'</span><span class="token punctuation">,</span>prefix<span class="token operator">=</span><span class="token string">'day$'</span><span class="token punctuation">,</span>drop<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>time<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre></div><p><img src="/assets/img/1552596629843.ff19ceac.png" alt="1552596629843"></p><h3 id="train-fit"><a href="#train-fit" aria-hidden="true" class="header-anchor">#</a> Train / fit</h3><h4 id="fit"><a href="#fit" aria-hidden="true" class="header-anchor">#</a> .fit()</h4><p>function that train the model based on the train dataset.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>epochs</strong></td><td>Number of epochs</td></tr><tr><td><strong>lr</strong></td><td>Learning rate</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549735202902"></p><h4 id="fit-one-cycle"><a href="#fit-one-cycle" aria-hidden="true" class="header-anchor">#</a> .fit_one_cycle()</h4><p>A better function to fit, that used 1cycle policy <a href="https://sgugger.github.io/the-1cycle-policy.html" target="_blank" title="https://sgugger.github.io/the-1cycle-policy.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><a href="https://docs.fast.ai/callbacks.one_cycle.html#The-1cycle-policy" target="_blank" title="https://docs.fast.ai/callbacks.one_cycle.html#The-1cycle-policy" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">3e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span><span class="token number">0.85</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>What’s the difference?:</strong></p><p>In the fit you always go with the same learning rate through all epoch. In the fit_one_cycle you define maximum learnig rate. On each cycle the learning rate go through half of the iterations from the minimum learning rate to the defined maximum, and next half of the iterations go down to the minimum.  On last couple of iterations the learning rate small decreasing.</p><div class="language- extra-class"><pre class="language-text"><code>1. We progressively increase our learning rate from lr_max/div_factor to lr_max and at the same time we progressively decrease our momentum from mom_max to mom_min.
2. We do the exact opposite: we progressively decrease our learning rate from lr_max to lr_max/div_factor and at the same time we progressively increase our momentum from mom_min to mom_max.
3. We further decrease our learning rate from lr_max/div_factor to lr_max/(div_factor x 100) and we keep momentum steady at mom_max.
</code></pre></div><p><img src="/assets/img/art5_lr_schedule.6871203a.png" alt="Learning rates to use in a cycle"></p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>cyc_len</strong></td><td>number of cycles</td></tr><tr><td><strong>max_lr</strong></td><td>maximum learning rate. We can use <code>slice(3e-5,3e-3)</code> to distribute learning rate between initial layers (first smaller value <code>3e-5</code>) to later layers (second higher value <code>3e-3</code>)</td></tr><tr><td><strong>moms</strong></td><td><code>default: (0.95,0.85)</code> Momentum value. Momentum is intended to help speed the optimisation process through cases, to avoid getting stuck in the &quot;shallow valleys&quot; when gradient is close to 0. <a href="https://blog.paperspace.com/intro-to-optimization-momentum-rmsprop-adam/" target="_blank" title="https://blog.paperspace.com/intro-to-optimization-momentum-rmsprop-adam/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a> (e.g. <code>moms=(0.95,0.85)</code> - momentum goes through the iterations like in the picture below )<img src="/assets/img/1551278535491.1ba54a73.png" alt="1551278535491"></td></tr></tbody></table><p><img src="/assets/img/1549735023401.c6dab121.png" alt="1549735023401"></p><h3 id="improve"><a href="#improve" aria-hidden="true" class="header-anchor">#</a> Improve</h3><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>unfreeze()</code></td><td>Unfreeze entire model. <code>fit</code>, and <code>fit_one_cycle</code> will update weights on all layers.</td></tr><tr><td><code>freeze()</code></td><td>Freeze up to last layer.</td></tr><tr><td><code>freeze_to(n=2)</code></td><td>Freeze up to <code>n</code> layers. <code>fit</code> and <code>fit_one_cycle</code> will update weights on <code>n</code> last layers.</td></tr></tbody></table><h4 id="recorder-plot-losses"><a href="#recorder-plot-losses" aria-hidden="true" class="header-anchor">#</a> .recorder.plot_losses() <a href="" target="_blank" title="" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Plot losses for the train and vaildation set. (after you call fit(), or fit_one_cycle())</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot_losses<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550170847911.459926b8.png" alt="1550170847911"></p><h4 id="lr-find"><a href="#lr-find" aria-hidden="true" class="header-anchor">#</a> lr_find() <a href="https://arxiv.org/abs/1506.01186" target="_blank" title="https://arxiv.org/abs/1506.01186" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Find best learning rate for a model. Determines how you update the weights or parameters.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong><code>start_lr</code></strong></td><td>start learning rate <code>float</code> number or <code>numpy array</code> (for example <code>learn.lr_find(np.array([1e-4,1e-3,1e-2]))</code>)</td></tr><tr><td><strong><code>end_lr</code></strong></td><td>The maximum learning rate to try.</td></tr><tr><td><code>num_it</code></td><td>Maximum number of iterations</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Plot learning rate and losses.</p><p><img src="/assets/img/1550170981108.9959431a.png" alt="1550170981108"></p><h3 id="how-to-choose-learning-rate"><a href="#how-to-choose-learning-rate" aria-hidden="true" class="header-anchor">#</a> How to choose learning rate?</h3><p>for learning rate you choose usualy two values that are  distribute learning rate between layers. The first value <code>3e-5</code> you can find in the <code>recorder.plot()</code> and it is he strongest downward slope that's kind of sticking around for quite a while. <a href="https://github.com/hiromis/notes/blob/master/Lesson2.md" target="_blank" title="https://github.com/hiromis/notes/blob/master/Lesson2.md" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a> and for the top learning rate usualy choose <code>1e-4</code> or <code>3e-4</code>, and it depends on you.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">3e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3e</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="learning-rate-lr-too-high"><a href="#learning-rate-lr-too-high" aria-hidden="true" class="header-anchor">#</a> Learning rate (LR) too high</h4><p>What you get is much higher valid_loss than train_loss.  You have to go back and create your neural net again and fit from scratch with a lower learning rate.</p><div class="language- extra-class"><pre class="language-text"><code>Total time: 00:13
epoch  train_loss  valid_loss  error_rate       
1      12.220007   1144188288.000000  0.765957    (00:13)
</code></pre></div><h4 id="learning-rate-lr-too-low"><a href="#learning-rate-lr-too-low" aria-hidden="true" class="header-anchor">#</a> Learning rate (LR) too low</h4><p>When your learning rate is too low your valid_loss will go down very slow, our error_rate go down but very slow. Try first show plot losses.  If you have a model like that, train it some more or train it with a higher learning rate.</p><p><img src="/assets/img/1550256445505.43176a2f.png" alt="1550256445505"></p><div class="language- extra-class"><pre class="language-text"><code>Total time: 00:57
epoch  train_loss  valid_loss  error_rate
1      1.030236    0.179226    0.028369    (00:14)
2      0.561508    0.055464    0.014184    (00:13)
3      0.396103    0.053801    0.014184    (00:13)
4      0.316883    0.050197    0.021277    (00:15)
</code></pre></div><h4 id="too-few-epochs"><a href="#too-few-epochs" aria-hidden="true" class="header-anchor">#</a> Too few epochs</h4><p>When you train in too few epochs, your train_loss is much higher than valid_loss. You can try more epochs, if it goes down very slow like in previous example, try highger learning rate.</p><div class="language- extra-class"><pre class="language-text"><code>Total time: 00:14
epoch  train_loss  valid_loss  error_rate
1      0.602823    0.119616    0.049645    (00:14)
</code></pre></div><h4 id="too-many-epochs"><a href="#too-many-epochs" aria-hidden="true" class="header-anchor">#</a> Too many epochs</h4><p>Too many epochs create something called &quot;overfitting&quot;.  Your error rate improves for a while and then starts getting worse again.</p><blockquote><p>Any model that is trained correctly will always have <strong>train loss lower than validation loss</strong>.</p></blockquote><div class="language- extra-class"><pre class="language-text"><code>33     0.189988    0.210684    0.065934    (00:09)
34     0.181293    0.214666    0.073260    (00:09)
35     0.184095    0.222575    0.073260    (00:09)
36     0.194615    0.229198    0.076923    (00:10)
37     0.186165    0.218206    0.075092    (00:09)
38     0.176623    0.207198    0.062271    (00:10)
39     0.166854    0.207256    0.065934    (00:10)
40     0.162692    0.206044    0.062271    (00:09)
</code></pre></div><h2 id="fast-ai-own-models"><a href="#fast-ai-own-models" aria-hidden="true" class="header-anchor">#</a> fast.ai / Own Models</h2><h3 id="learner"><a href="#learner" aria-hidden="true" class="header-anchor">#</a> Learner</h3><p>Instead of using prepared models, you can create your own one, and by class <code>Learner</code> use in the same way as other learners.</p><div class="language-python extra-class"><pre class="language-python"><code>model <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 14</span>
    nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 7</span>
    nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 4</span>
    nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 2</span>
    nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 1</span>
    nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment"># remove (1,1) grid</span>
<span class="token punctuation">)</span>
learn <span class="token operator">=</span> Learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> 
                model<span class="token punctuation">,</span> 
                loss_func <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                metrics<span class="token operator">=</span>accuracy<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST<span class="token punctuation" data-v-54601d22>)</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>128</span>
tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token operator" data-v-54601d22>*</span>rand_pad<span class="token punctuation" data-v-54601d22>(</span>padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>28</span><span class="token punctuation" data-v-54601d22>,</span> mode<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'zeros'</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

data <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span>ImageList<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> convert_mode<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'L'</span><span class="token punctuation" data-v-54601d22>)</span>
      <span class="token punctuation" data-v-54601d22>.</span>split_by_folder<span class="token punctuation" data-v-54601d22>(</span>train<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'training'</span><span class="token punctuation" data-v-54601d22>,</span> valid<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'testing'</span><span class="token punctuation" data-v-54601d22>)</span>
      <span class="token punctuation" data-v-54601d22>.</span>label_from_folder<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
      <span class="token punctuation" data-v-54601d22>.</span>transform<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>)</span>
      <span class="token punctuation" data-v-54601d22>.</span>databunch<span class="token punctuation" data-v-54601d22>(</span>bs<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
     <span class="token punctuation" data-v-54601d22>)</span>

bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>128</span>
tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token operator" data-v-54601d22>*</span>rand_pad<span class="token punctuation" data-v-54601d22>(</span>padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>28</span><span class="token punctuation" data-v-54601d22>,</span> mode<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'zeros'</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>


model <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>Sequential<span class="token punctuation" data-v-54601d22>(</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>Conv2d<span class="token punctuation" data-v-54601d22>(</span>in_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> out_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>8</span><span class="token punctuation" data-v-54601d22>,</span>kernel_size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> stride<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token comment" data-v-54601d22># 14</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>BatchNorm2d<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>8</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>ReLU<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>Conv2d<span class="token punctuation" data-v-54601d22>(</span>in_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>8</span><span class="token punctuation" data-v-54601d22>,</span> out_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>,</span>kernel_size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> stride<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token comment" data-v-54601d22># 7</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>BatchNorm2d<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>ReLU<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>Conv2d<span class="token punctuation" data-v-54601d22>(</span>in_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>,</span> out_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>32</span><span class="token punctuation" data-v-54601d22>,</span>kernel_size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> stride<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token comment" data-v-54601d22># 4</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>BatchNorm2d<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>32</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>ReLU<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>Conv2d<span class="token punctuation" data-v-54601d22>(</span>in_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>32</span><span class="token punctuation" data-v-54601d22>,</span> out_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>,</span>kernel_size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> stride<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token comment" data-v-54601d22># 2</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>BatchNorm2d<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>ReLU<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>Conv2d<span class="token punctuation" data-v-54601d22>(</span>in_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>,</span> out_channels<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>,</span>kernel_size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> stride<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token comment" data-v-54601d22># 1</span>
    nn<span class="token punctuation" data-v-54601d22>.</span>BatchNorm2d<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    Flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>     <span class="token comment" data-v-54601d22># remove (1,1) grid</span>
<span class="token punctuation" data-v-54601d22>)</span>
learn <span class="token operator" data-v-54601d22>=</span> Learner<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> 
                model<span class="token punctuation" data-v-54601d22>,</span> 
                loss_func <span class="token operator" data-v-54601d22>=</span> nn<span class="token punctuation" data-v-54601d22>.</span>CrossEntropyLoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                metrics<span class="token operator" data-v-54601d22>=</span>accuracy<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>learn<span class="token punctuation" data-v-54601d22>.</span>summary<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1554632305282.5c979788.png" alt="1554632305282"></p><div class="language-python extra-class"><pre class="language-python"><code>data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUcAAAFUCAYAAAC3C/5eAAAgAElEQVR4nO3dd3xUxfo/8M9mQ3oIEEwILSCwCYLEAiga5YrSFSGKiErTq16KF0VR9IegkosNK+3+UFGKiAhSvILYUUGUFsRIFQKhBakhmwSy5fvHyc4c3MkmJJs9u5vP+/XyxcOc3ZMxG548c86cGZPT6XRCz2qFs7gYOH8epqIiEBEFK2dkJBAWBlNYGBATA5hM4phJnxydTidMuoNERDXF3/NfSFkHiIhqEpPJBP1AOgRgYiQiAi5MkCa3a45ERIQQ5kYiogs5nU55zZGIiCQOq4mIFFg5EhEpBFVynDZtGtq3b4/w8HAMHTrU6O5QFZ08eRL9+vVDdHQ0kpOTsWDBAqO7RJUUExNzwX9msxmPPPKI0d3yKNToDnhTw4YNMX78eKxevRpFfLon4I0cORJhYWHIy8tDVlYWevfujbS0NLRp08bortFFKigoELHVakViYiL69+9vYI/KF1SVY0ZGBvr27Yv4+Hiju0JVZLVasWTJEkyaNAkxMTFIT09Hnz59MG/ePKO7RlW0ePFiJCQk4IYbbjC6Kx4FVXKk4LFr1y6YzWZYLBbRlpaWhuzsbAN7Rd4wZ84cDB482O8fPGFyJL9UUFCAuLi4C9ri4uJw9uxZg3pE3nDgwAGsWbMGQ4YMMbor5WJyJL8UExOD/Pz8C9ry8/MRGxtrUI/IG+bOnYv09HQ0b97c6K6Ui8mR/JLFYoHNZsPu3btF29atW3kzJsDNnTs3IKpGIMiSo81mQ3FxMex2O+x2O4qLi2Gz2YzuFlVCdHQ0MjIyMGHCBFitVqxduxbLly/HoEGDjO4aVdK6detw6NAhv79L7RJUyTEzMxORkZF46aWXMH/+fERGRiIzM9PoblElzZgxA0VFRUhISMDAgQMxc+ZMVo4BbM6cOcjIyAiYSyN8fJCISCGoKkciIm9hciQiUmByJCJSYHIkIlLwysITXUMC49a8kb5yfGJ0FyqMn2f5+HkGF9XnycqRiEiByZGISIHJkYhIgcmRiEghqFYCp5olpG0qAOBw13qy7bw8nrj+DADAuYlrQNLFY+VIRKTA5EhEpMBhNQUs13A66Yczom3/OPn73rnJ7JWvU3xbRwBAxGe/euV8FBhYORIRKbByJL8XktZaxDsfjxTxrze9CgDocPlo0VZrdy0R53XQNnBKXF+1r597i1ZDtPqsauehwMLKkYhIgcmRiEghKIfVIbpl2I/3byvinya9DQBIXT1ctFnu3+i7jtFFCbniMgDAgIVfi7Z7Y4/oXhEBANjV/f8r33/OWQIA2DlG1gAD1j0MAGj5ptxbyLlhm1f6W5OYL7kEAJDzcCvRVtRYfk9vSNsBAJib/INoK3HaPZ7zmbz2AIDsLrVFm/30mbJeXu1YORIRKTA5EhEpBOWwurCzvLu5IXOm7oh2JzNif5iPe0SVseOhGAB/H0pLltXaEPmyzOOibfdDSSJ+MeNDAECf6FOibfs/3gUAfN4xTrQ9/9ZgESdMW1fVbgct11AaAO7+cQsAYEDsSo/vKXHK+muFtS4AwOqQ//4G6D7bzERtHmm7J/4t2pqN/7kKPa4aVo5ERApBWTk6y/m/it3P3Wj91Z43rhVxVp83SiNZady2s4+IU6YWAQBse3NEW/NxMp49szMA4OnhjUXbC/0WAgDuiJHVZrdxb4r42rBHAQBJr8sKst7vpov/HwlCRVcli1hVMX5XFCPiEZ8PAwAkrZXH62w8CgA41aGBPM/rU93OE7u/yl31ClaOREQKTI5ERApBNaw2t0kBAIx4Wb350asnWwAA6n5g3EVeUnMNpzf3f0O0RZm04fQ3RVGizfSonMPq+M3zOo22/bkAgObjckXbvFnaUPut6XJRih/aLRJx5vAPAAAzfsgQbfHv8OcFAMKfcr8xph9KT3nwXhG3+s79mU3XLMhTgxt6/Dr+8v1m5UhEpBBUleOOh+sAAO6OPaU8/vFb3QAA8fCP30w13V//6iTizf1fByCrRQC4Y09vAIBtuHxiwvHHjip9TdfNm+hXrpKN82XYM+osAGDsWFk3NBtQpS8ZNC6vc9itbULm/SKu+53nf1ehyU0AAKPvWq483vFVbQGRBvCP6VSsHImIFJgciYgUAn5Ybf+HHB59etvbpVG4aCt0yB2XEj7WLuB7fvydqpPrphkAPPDv/4lYP5x2OfWWNq8u6o9fvN6PsIOnPR5fe518supeXO/1rx+I9AtC9El9AABQd33FL1EdeFO7mfZA3AHRdtx+TsSNl2jtNvgHVo5ERApMjkRECgE/rL76jc0iviJcG04ftBWItn7PjRVxvXzepTba9sflPMXlcTluxztNGCXiS776HQDgqP5uuen4jVz8IKWdVevHb1W7Ux7oLlhbcf1vFXqPfrGKsa2/BAA4dJ/odaseE7Eld0MVe+hdrByJiBQCt3K8th0AYGT8DF2jNlt/ct4toqXebFaL/sBs0Z5O+vGWN3WtcrMs14ISlyyUFYnDaq22/hS2jFe2u1YPj9sgb+rtfEBb6q7VaOVbyAPVYhVbzsmaLHXqWREbMULwhJUjEZECkyMRkUJADav1G2ddNl27WN80VD74bndqhfnPH8i5jwl+8ihSTddt6SYAQKI5Unl891bt0bKW1kPV2g9bl6sBAGOnzlMeb/f1SABAq+ny5+bMW9cqX0vlUy1WMTm3t4gdv/vvTS5WjkRECgFVOTpTm4n4tST33/xXbdCWTGowndWiP9AvLDG8juvpJfn7WL+qt2W8tj1qdVyUd1WLADBmlravTLdIebPn/fwmIk553Vpt/aiJPktZIWLX9/T3LPnvuBWO+rhHFcfKkYhIgcmRiEghoIbVeeNLPB637onzeJx861RH+XmFKH4Pu27CAN67EWNOaSnigtb1AABPTZkr2q4LPwkAGHc0XbT9cb9cDMPx23av9KMm0t8wNa3Q4lqmLNH2Qb62bW7qLLneqj8vAsPKkYhIgcmRiEjB74fVzuuvEPHKK6fpjmjzG0/ZC0VLylsHAfjPenA13Z7us0SsuvubOkWu61eZz0wM45IbibbEd+XwfHmTjwEABQ65ZmCHRWMAAC0e128AxaG0N+wb21bEWy3a7IQzDvnJ/jdT27QsLtt98y1/xMqRiEjB7yvHQ2PkRf0k3dMwLl1efkLECbmc3+hPzCb5u9fhdL/0XtJULmcVGhXhdvz0VQkAgBMZhW7HAKBFwnEAwHLLh8rjroqxw8dj5HueCIyqJVCc+Kecy7piyBTdEW1l947vy+99s/mBtQgMK0ciIgUmRyIiBb8dVp94QCvXV3d4Vdcqh9WbzmkbZzX4/qRo4yNf/kW/IrtqwYnPF8+u0vldw+Yt52uJtgFfjhBxvU3aj3eLWYE1nAsEpqvbAAAWPCuH0smhcpO0t0+lAgCaPRu433tWjkRECkyOREQKfjusLuypLZ/eWHGHGgDu/FYbPll+3+izPtHF6TJfbm720yBt+FU3xP2udHkKnXLv8Zf/ukbEX07T9pOOf08O3Szw/iZNIZ6fWq0xQpPl454TF38AQD2UBoDve19WGuX6pG/VgZUjEZGCX1WOIdHRIn4p7VO34/oL/K1fOQ3Avx9cr+maPyMruru/13anOj9G3kBb1ka9GrdLh8+0bTvrbzSLNv2GafHwzcV+zo3UOOLkv88rw9zrqnnvdxdx0v7An3PMypGISIHJkYhIwa+G1Tunywu6faLXuh2fdLSriO079/ikT+Qdtb7cWPqnbLsX13t8jwW/VmeX6CLtnyDThaN0VvFrJ+RiE00+/FPEwbD4CytHIiIFwyrHkAg5pWPv/7sSAPBDF/enYfQ3YQ5m1NMdr94tPIlIc/wh7Wm1rZ3kkoGup9E+mnezaGt4NPBvwuixciQiUmByJCJSMGxYbb9Kbmq084GZpZH70zA3rJTrwVkO8gI9ka9Zbylwa3v3zKUAgCazd4i2YJtzzMqRiEiByZGISMGwYXWto2dE3GtnLwDAypSVou3qTXcBAFLHys2PuF4jke81idce1T1iLxJti57sCQCIOBG8l7pYORIRKRhWOdr25si/3KT90R1yG9b62AWA1SKR0UJu1pYdexDpoi2iBjy9xMqRiEiByZGISIHJkYhIgcmRiEiByZGISIHJkYhIgcmRiEjB5HQ6nUZ3gojI37ByJCJSYHIkIlJgciQiUmByJCJSYHIkIlJgciQiUmByJCJSYHIkIlJgciQiUmByJCJSYHIkIlJgciQiUmByJCJSYHIkIlJgciQiUmByJCJSYHIkIlJgciQiUmByJCJSYHIkIlJgciQiUmByJCJSYHIkIlJgciQiUmByJCJSYHIkIlJgciQiUmByJCJSYHIkIlIIquQ4bdo0tG/fHuHh4Rg6dKjR3aEquu+++5CUlITatWvDYrHg3XffNbpLVAU5OTno1asX6tatiwYNGmDUqFGw2WxGd6tMQZUcGzZsiPHjx+P+++83uivkBU8//TRycnKQn5+PFStWYPz48di0aZPR3aJKGjFiBBISEnDkyBFkZWVhzZo1mDFjhtHdKlNQJceMjAz07dsX8fHxRneFvKBNmzYIDw8HAJhMJphMJvz5558G94oqa9++fbjrrrsQERGBBg0aoEePHsjOzja6W2UKquRIwWfEiBGIiopCamoqkpKS0KtXL6O7RJU0evRoLFy4EIWFhTh06BBWrVqFHj16GN2tMjE5kl+bMWMGzp49ix9//BEZGRmikqTA07lzZ2RnZ6N27dpo3Lgx2rdvj759+xrdrTIxOZLfM5vNSE9Px8GDBzFz5kyju0OV4HA40L17d2RkZMBqteL48eM4deoUnnrqKaO7ViYmRwoYNpuN1xwD1MmTJ5Gbm4tRo0YhPDwc8fHxGDZsGFauXGl018oUVMnRZrOhuLgYdrsddrsdxcXFfj1VgMp27NgxLFy4EAUFBbDb7Vi9ejU++ugjdOnSxeiuUSXUr18fzZs3x8yZM2Gz2XD69GnMmTMHaWlpRnetbM4gMnHiRCeAC/6bOHGi0d2iSjh27JjzxhtvdMbFxTljY2Odbdu2dc6aNcvoblEVbNmyxdm5c2dnnTp1nPHx8c4777zTmZeXZ3S3ymRyOp1OY9MzEZH/CaphNRGRtzA5EhEpMDkSESkwORIRKYR64yRdQ/p74zRB7SvHJ0Z3ocL4eZaPn2dwUX2erByJiBSYHImIFJgciYgUvHLN0QgpG2sBALJONBZtkd33GdUdIgoyrByJiBSYHImIFAJqWB0SESHi7nWyAACbjzcxqjtEFMRYORIRKQRU5Wi7prWIu0WuBQC8aFRniCiosXIkIlJgciQiUgioYTUFltDGjUT8x7MNAQC1ap8Xbbe03Cni9UeSAQCTL1sm2p75Q9uZ7tx6uQ9548nrqqezRH/DypGISIHJkYhIIeCH1Uf+ihNxSwP7Qe62ZzYQ8a6u//X84oZr3Zp+uXqBFlwt29qFPiLipi9wiO2vQi9tBgDYMUr+DDzU9RsAwBP15OWUYQf+IeJNh7U5y9Gf1RZtdT/4uVr76QkrRyIihYCqHENPFIk4z67Fprxwo7pD5Qlx39hy3NEOIl66VsbpHbYDAH7aIOeyfnrb2wCANmHyx3Tdg1NEfM9rXQEADqvVSx2mqjg1pJOI73lyFQBgRZ29Ht/zftPv5V+aan8c6VAomgYfHC3iWl9v8kIvK46VIxGRApMjEZFCQA2rbfGRIk40a3GDtseM6g6VI/XxXBHfHncnAMCx/5Boa1Xyi4jzXG2Qbf3rPwwA+KPze6Jt3bl68gu00uZGIusPb3WZLlLOx+1E/H2nV0WcYI4CAKT9Mki0XTIryu39Z5vIFNRj5E8AgOcv2SraXn1npojHDXoIABDyU1ZVu10hrByJiBQCqnIM3bxHxINyuhrYE6oI+19/yb/oYw+OjbpOxN+kv1IayRHD3nOJInZmy58Hqn76JQP3P3EVAGDL9W+KtnCTrAwti0YAAFo+tt7jOeN18eYVSQCAZT/uF219o0+L+Ei6dv5GP11kxyuJlSMRkQKTIxGRQkANqx1nz4p44zptTtW3A+RF4OGNBwAAbAcPgQLL6cHa5/nyo++ItqTSm24HbHJ+6+Jx3UUcUfKrj3pHABASL2+GbRs+rTSSKST1w5EibvXsZgCA+0zXstnztJur24sbijb9sNrXWDkSESkwORIRKQTUsFovaZ1D+/MeeSfzWFft+aN673NY7a/M9eX9ye0vXirib7tpl0cah8rP0/Wo4cbn2ou2iM84lDZKzuBmbm1t1w0Rccvn5PxEx7lzFTpnSHS0iE2NtbvVHaOWK19rTanYOb2FlSMRkULAVo4uITCJuKCJFtcr68VkGLOlBQCg21K5eMDyOl/qXqFVjDdt6y9a4oZqC0pEHGW16A8ctdzb6nwqKz9HYaH7C8phaiSXNNv+RF0AwM2R6gox5g/fLjLDypGISIHJkYhIIWCH1bHr9gEADth0pfzlZ8t4NRkh91n5KOBzgz4EAPSLPql87WOHtddGTZKrQNuPH6jG3tHFuvS9HPkXbU0QfD9lqmjqu13enHEoFgMJiY0FABSlp4q2A3fbRbztZte5wkRb1nmbiBtP1xaccFx81yuFlSMRkULAVo6u2fSDtg8WbZlp2hSAWbhU+R7yreJWxSIuq2J0ybdpF9tvnCkXKjh8rg4AYNW2K0Rb3Q3udwUS398iYkdxsdtxqj6hMIv4dGtZ9R+/R3viKaWjrDYHN9T2/Lkjek0ZZ9MqxhzdaPCeD8eKuFmhb/eTYeVIRKTA5EhEpBCww2oX62dyntStz5wAAEzrMUC0hX2xwed9Io3JJJcd0M9HVblgo6W/ayi3YDX3kL/P7c7SS/Pj5UvbrJU3Bep/rK3/F71Eri5OlWc/fkLEjx25BgDwRpL83v40ZYbbe8wm98/rnTNNRNsrX98q4oalo+2YvQWirdkWbs1KRORXmByJiBQCflgdWiiHbq47Z0c6yTuayV/4vEtUqtU/5Vy3m7toE+P295PHL0/J/ftb8Pu+RiKO3ardwS6+Vg6zUhrIDdUebqQNxbtFyn2rt13/gYhLrtPm0HW4Z5hoS/6X9n57BbdtIJ3LWoqwV53FANTDZgB44fjlAIBl73cWbQkbtbvQ+g2y9BuquVzMGpDViZUjEZFCwFeOeq7fYucanTe4JwQATt2yVeGrtBtjllXyuGp5gVY46vGc+vdMr6PdFJjcrbVoK7xXrhz9a3vtqZysa+eKtgFLegAArDd6/DI1nrluXRHnjNS+v5/88zXRllpLq+p3lchV2lvolpv75oV0AECDJfJmWqBh5UhEpMDkSESkEFTDav0FYQp+9tNnAAAxi+Qjh7VXyL2V2w9/BACw8Qm5OMLjjVcDAP4Tf4s8zwnPjzbWGCY5F/XYHXJxCNdmWi+euFK0LZt6EwDg9E1yWL2z82wRH+qp3QyzLKmervoCK0ciIgUmRyIihYAfVl/yvz0i3jWRK7LUdPpVeRJ/sbod7xiuzaKzXifn7HHTLk3+wGtE/Mvz00X8Z+m+4asnyjmL8Uu1x/ocoZ3kCeRh7Ok5CwDQC1dVR1d9gpUjEZFCwFeO+icdbl02BgAQk5xvVHdIx7XyMwCghbbYgHP7n6LJWcHtOyurpHaYW1uhU5sDay6yux2r6Y6nqRcHuXXdCABA86XuT7MkzN4s4g9HJ4j43ljtSaS/hsvK8pKZxi0iURmsHImIFJgciYgUAn5YrZf0o3axPbxtQTmvJF/Y+Z/LZHyHttbfqydk2+9nG4r44KutAACRyy7+5khIVJSIrd3ainj8lPfdXrv4bHMAQK2vN7kdq6lMoVoayOimHva2eLkEgHpjK/2lkTxbnO5I6QIf4Z7X8fRnrByJiBSCqnIUKz4H8Kz8oFKnxK1pbLxuy05d/OUUrWpZPK6Dx1OG6Ba0cpSuLt4iSt6Ueyp+ptt7fj0nq5cFo3oDAELBylFISwEATE6YJ5o+L4wRsWn/kQqd5p1t6SIec+NuL3XOOKwciYgUmByJiBSCalhN/qXxEvnjlZnWDgAwJn6jaIsyyXmIrtW8uzXxsNEWLtyoy6FYM7rEKecvjjt6PQAg+8l2oi30Ww6n/865ZQcAoNeOPqJtZeoKEb/+cemNljda4u+OXitX3V/eaYruiLYASORfgbsYDCtHIiIFJkciIgUOq6naRC6XcxbXL9eGX3d1fEi07c2Qd0Tv6fkDAKBR2CnR1iIsDwBwY4Tc9uKLIjmncXx2XwBA4W9ySf/EjXJY7fr6vDNdDof2Pctb3lQ0HWlVKOJv2nyqBe+WdyK5lubow9pjg3Efri/rxX6PlSMRkQIrR/KtX7eJ8FLdwzDrx7ku7CfoXqzFr5RxqgTs8GrXarrEt+VmWPdvHCni3fdpm2ntuf2/bu9Zr1s7ZPDaB0ScOvZwaZTn3U76ECtHIiIFJkciIgUOq4nIjWndVhFbSkfbvUZ4XtW7JbaI2FYtvfItVo5ERApMjkRECkyOREQKTI5ERAomp9Pp/vQ+EVENx8qRiEiByZGISIHJkYhIgcmRiEiByZGISIHJkYhIgcmRiEiByZGISIHJkYhIgcmRiEiByZGISIHJkYhIgcmRiEiByZGISIHJkYhIgcmRiEiByZGISIHJkYhIgcmRiEiByZGISIHJkYhIgcmRiEiByZGISIHJkYhIgcmRiEiByZGISIHJkYhIgcmRiEiByZGISCGokuO0adPQvn17hIeHY+jQoUZ3h6ogJibmgv/MZjMeeeQRo7tFVXDy5En069cP0dHRSE5OxoIFC4zukkehRnfAmxo2bIjx48dj9erVKCoqMro7VAUFBQUitlqtSExMRP/+/Q3sEVXVyJEjERYWhry8PGRlZaF3795IS0tDmzZtjO6aUlBVjhkZGejbty/i4+ON7gp50eLFi5GQkIAbbrjB6K5QJVmtVixZsgSTJk1CTEwM0tPT0adPH8ybN8/orpUpqJIjBac5c+Zg8ODBMJlMRneFKmnXrl0wm82wWCyiLS0tDdnZ2Qb2yjMmR/JrBw4cwJo1azBkyBCju0JVUFBQgLi4uAva4uLicPbsWYN6VD4mR/Jrc+fORXp6Opo3b250V6gKYmJikJ+ff0Fbfn4+YmNjDepR+Zgcya/NnTuXVWMQsFgssNls2L17t2jbunWr396MAYIsOdpsNhQXF8Nut8Nut6O4uBg2m83oblElrVu3DocOHeJd6iAQHR2NjIwMTJgwAVarFWvXrsXy5csxaNAgo7tWpqBKjpmZmYiMjMRLL72E+fPnIzIyEpmZmUZ3iyppzpw5yMjI8OuhF1XcjBkzUFRUhISEBAwcOBAzZ87068rR5HQ6nUZ3gojI3wRV5UhE5C1MjkRECkyOREQKTI5ERApeWXiiawinWpTnK8cnRnehwvh5lo+fZ3BRfZ6sHImIFJgciYgUmByJiBSYHImIFJgciYgUmByJiBSYHImIFIJqg63iWzsCAGZPf120DRs9RsSRy371eZ+IKDCxciQiUgj4ytF0tVwP7tWp0wEAjUPDRVtuD/layzKfdYuIAhwrRyIiBSZHIiKFgB9WFydEiTgtzP34WzfPF/F0WNxfQESkwMqRiEiByZGISCHgh9VHhxV7PD75+cEijsP66u4OEV2E0EubifjPl7RdJrdd/4Fos3z5kIyHbfJdx8DKkYhIKWArR3NiAgBgzOXfiLaQ0lw/bP/Noi1uPqtFIn+Sk9lJxG/dPVvEN0UWAAAcutcuv2m6iF9Zp01aDjHJVxwZ10JrW7PF6/1k5UhEpMDkSESkELDDatSpDQAYUnu/aHIV22u3tRJtFmzwZa+ISMdcJ07Ee566DACwYZBcGCbKJCcn64fTLim1zCJ+L/krAPLyGQC07ao9PtxsjVe6ewFWjkRECgFbOf45+JIyj0Xvq+XDnhDR34UmNwEAtF2WK9qWJrztOuq1r/PygHkAgFlvXiPa7MdPeOXcrByJiBSYHImIFAJ2WH0+wVbmsaaf5onY7ovOULVwzWVFXKxos+/60+N7QmLla0/2a6v92aNItO3oPNvtPXpZ57Wfq8ceHSXaor7YCgBwnjtXgV7XXCFXXCbihz/RFk/tHnXG43uyz8t/xwPnPAYA6ND9d9H2TtNv3N6j1zPqFADgmeEpoq3JpHUV7LFnrByJiBSYHImIFAJ2WO0SwvweVEKbJ4v4yqV7AQCD6y4VbcN3DxRxzraGWmCS7+95vXyMbEXDaW7nV82l02sXps2rO//wSdEW85227Yadw2o3oUkNRLzic7l2qgPO0sj93+fNv98p4ogX5DzIpmu14fCPyVeLtrxGK0Xc5eOxAIA9984UbSWlX+Zc3fI+2YvHzEJEpBCwlePT6Z8DABzl1gIUSM41ixfxv+p9CABINEeKti9ayyoSrbU/QnSlo6xYKsd1g+Dc/xJEmz1/T5XOGczCP5a3PPXfe9W/y8nHrwAAxAyQVbn99D6314WGy3OOy71NxC3G/gwAKLlH/zW1r2Oq2seuxMqRiEiByZGISCGghtX6PaqH1dZWBdYX7/fu7QkAcB445MtukReF/iTnuHWd/SQAwBahHjONu10bYqeGHxZtK87Ii/mfrtbWDYw6IofdG5+c6naeI3Y5D7LfN48CACwzvDNXLlgV9Nce11t06Zu6Vvcd7m7f2VfEIQNLAAD208c8nrvVCDnUPh0e7nZ83NEOIp7c4BcAwMu3LRBtsx6/1OP5K4qVIxGRQkBVjoef9XzzZf+ZegCAesXHfdEdqgbOkvMibvqc5+pt0TjXNJIGyuOJd2g/L3e+sNrjeXrMelLElkxWjGUJiYgQcfPHdgIAIkzqFOK6+VKSKT+b0LyK7QFjP+35qZoVX8tFJibfp1WO10XI0cO0HgNEHPZF5ZcsZOVIRKTA5EhEpBBQw+oX28o5brVM2pMMx+1ya9a412J83icynrluXRHvGZsq4ol3LH8kiTQAAATuSURBVAIA3BUjbwBsOa8NtUc9/2/R1vQjOdyrhulyQeNs7zQRL0t2f/pI77uJ1wMAIr/91ev9aL6sUP7lPu2PemZ54+ZsE5nW5KzZi8fKkYhIgcmRiEghoIbVdqfM5SVO7RGiCUflHtXm7zb7vE/kBxLk4Mk1lAbkcFo/j3FY6Z3pxh/Iu9IcSlfMkXQ5X1S14MuIgzeKOHKZ94fTKqp+hN8h13PFO1U5NxERuQmoylHluxy5DWtTbDOwJ+RrpvbaSt+fLZ8r2vSLH8zNbwQAyFx7q2izvMh5jJUV1SxfxKqFJbLfuFzEsVhfbf3Y1y/KYz/OLUkUcQz2VvrrsHIkIlJgciQiUgj4YXX0l5zbWJPoVwp/apG28rTZJH/HO5xyrb+pMzIAAJapHEpXRUh0NADgvSvmeHxd7MLqG0oDQNHtHQEAP9z9qq5Vm9942CZXaY/fZvXK12PlSESkwORIRKTg98Pq4w91EnHPKPmYl+vxQQp+oY0biTjtU7nWX6fS5fR3lchHSO8fM0bESZ9r8165kUbV5IzVHhtMC/ve7dgdu/vo/nbEK19Pv/rP0X9eJeIFT0wBANTXbZvhult968aHRVvj9b95px9eOQsRUZDx+8pRTz+nqYSPNQS/EG10cOy/0aJpUkKW7gXaExt3vjVWtCQtkTdfWDF6h7mo7GN/7E8ScasqVo4nh2mjxOI+cj3HjR3f0r2iltt75uc3AQAkPyNvyNjdXlU5rByJiBSYHImIFAJqWE01y75MbV5b9pVy7UD9UDnl6wcBAK1e5zzG6hR+SruGpVrkYectcmWHlLkPijjpf9pmW9G5ckx+oKf22N/5ZnIIXKeOnJP4y9WqNSLdv+YZh7wB9+EjvQEAtXZWbAuGi8HKkYhIwe8rx8SF2SJe86R84LxFrVMAgLo7it3eQ4HLtZgEAKy+1/UkhJy6saggQcStnzkKALD5pGc1V4NVuQCA7c+UiLaUWu5T6XbeLKtIx80Vux2mr0ZVi0iodFj1qIgtX1d+A63ysHIkIlJgciQiUvD7YbU9X64h91rLNm7HQ7DFl92halLUV7v5Mv/t10VbUumTEP12y/UYbU/IVb+dR7b7qHc1my33IABg7J93irYVqUvLerlXnXXIfcw7fDkaAGB5qPqG0nqsHImIFJgciYgU/H5YTcHLNZQGgNGvLAQgh9IAsNRaDwBwYpZcw7H2xupdM5DKZvuP3H5g8htXAACeqZ9V1ssrLXXlCBE3+Vxu6mXx0aZdLqwciYgUWDmST4WktRbx4f5y3lyfaG3eqqtaBICXX7sHAFB/wc8+6h15EvqtfArll6Fa5dj60WtEW1ydQhGvbz8PAPDUUbnk4Irf27md03QqTMQtF2rvT9m0VbQ5S867vcdXWDkSESkwORIRKXBYTT5hbpMCAMh/WS46sP3y+SJ2DadnD5RzGutv4nDaXzm3aI/1thqiPt4HHUoj+XBnK2yu2Lmr0jEvYuVIRKTAypGqjX4vkNxe2pMtmy+fKtrWFsuVnd94biAAoPYmTtUh/8DKkYhIgcmRiEjB5HQ6/eX6JxGR32DlSESkwORIRKTA5EhEpBDCS45ERBdyOp2sHImIVEJMJlP5ryIiqmFCAK2EJCIiLR+aTCbOcyQiUrngmiPzJBHVVH/PfxcsPGEymcQLeC2SiGqCsnLe/wEa5tuksMYM/gAAAABJRU5ErkJggg==" alt="1554632326883"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span>end_lr<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1554632348629.3238edd3.png" alt="1554632348629"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1554632377114"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>data<span class="token punctuation">.</span>train_ds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1554632400541"></p><p>You can short your model with <code>conv_layer</code> function</p><div class="language-python extra-class"><pre class="language-python"><code>model <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
    conv_layer<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span>ks<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">#    nn.Conv2d(in_channels=1, out_channels=8,kernel_size=3, stride=2, padding=1), # 14</span>
<span class="token comment">#    nn.BatchNorm2d(8),</span>
<span class="token comment">#    nn.ReLU(),</span>
    conv_layer<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span>ks<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">#    nn.Conv2d(in_channels=8, out_channels=16,kernel_size=3, stride=2, padding=1), # 7</span>
<span class="token comment">#    nn.BatchNorm2d(16),</span>
<span class="token comment">#    nn.ReLU(),</span>
    conv_layer<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span>ks<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">#    nn.Conv2d(in_channels=16, out_channels=32,kernel_size=3, stride=2, padding=1), # 4</span>
<span class="token comment">#    nn.BatchNorm2d(32),</span>
<span class="token comment">#    nn.ReLU(),</span>
    conv_layer<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span>ks<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">#    nn.Conv2d(in_channels=32, out_channels=16,kernel_size=3, stride=2, padding=1), # 2</span>
<span class="token comment">#    nn.BatchNorm2d(16),</span>
<span class="token comment">#    nn.ReLU(),</span>
    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 1</span>
    nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment"># remove (1,1) grid</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="reasidual-learning"><a href="#reasidual-learning" aria-hidden="true" class="header-anchor">#</a> Reasidual Learning <a href="&lt;https://arxiv.org/pdf/1512.03385.pdf&gt;" target="_blank" title="&lt;https://arxiv.org/pdf/1512.03385.pdf&gt;" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Adding more layers usually doesn’t improve model.  If we create a 56-layer model it would be worse than 20-layer model.</p><p><img src="/assets/img/1554633099049.c2470bfe.png" alt="1554633099049"></p><p>What would happende if we create something that skip</p><p><img src="/assets/img/1554633275010.058b6a42.png" alt="1554633275010"></p><h2 id="fast-ai-examples"><a href="#fast-ai-examples" aria-hidden="true" class="header-anchor">#</a> fast.ai  / Examples</h2><h3 id="dog-cat-example"><a href="#dog-cat-example" aria-hidden="true" class="header-anchor">#</a> dog-cat example</h3><h4 id="download"><a href="#download" aria-hidden="true" class="header-anchor">#</a> download</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai <span class="token keyword">import</span><span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>DOGS<span class="token punctuation">)</span><span class="token punctuation">;</span>

!ls <span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>fastai<span class="token operator">/</span>data<span class="token operator">/</span>dogscats
!ls <span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>fastai<span class="token operator">/</span>data<span class="token operator">/</span>dogscats<span class="token operator">/</span>train
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549483689248"></p><h4 id="train-model"><a href="#train-model" aria-hidden="true" class="header-anchor">#</a> Train model</h4><p>Train the model based on the previous learned model: <em>resnet34</em> with <em>learning reate=0.01</em> and <em>2 cycles</em></p><div class="language-python extra-class"><pre class="language-python"><code>bs <span class="token operator">=</span> <span class="token number">64</span>
data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path<span class="token punctuation">,</span>
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> 
                                   bs<span class="token operator">=</span>bs
                                  <span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>
learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>DOGS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>


bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                   ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   bs<span class="token operator" data-v-54601d22>=</span>bs
                                  <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>.</span>classes<span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>7</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

learn <span class="token operator" data-v-54601d22>=</span> create_cnn<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> metrics<span class="token operator" data-v-54601d22>=</span>error_rate<span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit_one_cycle<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> max_lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,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" alt="1549630231237"></p><h4 id="most-incorrect-data"><a href="#most-incorrect-data" aria-hidden="true" class="header-anchor">#</a> Most incorrect data</h4><div class="language-python extra-class"><pre class="language-python"><code>interp <span class="token operator">=</span> ClassificationInterpretation<span class="token punctuation">.</span>from_learner<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
<span class="token comment"># losses,idxs = interp.top_losses()</span>
interp<span class="token punctuation">.</span>plot_top_losses<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549630263523.8628fc97.png" alt="1549630263523"></p><div class="language-python extra-class"><pre class="language-python"><code>interp<span class="token punctuation">.</span>plot_confusion_matrix<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARoAAAEtCAYAAADXzK+vAAAdRElEQVR4nO3de1xUdf7H8ffMoFzEIYXwklIZWkTkCopp9hAUkZulGUkJpqEpCaRo6920CPPhY2srVGxFJTawVsTUAK+Z6aqBQYrprvdQvKEit0Fmhu/vD3/OSkFg8Z2D4/v5F+fM5XxG6+U5Z84wKiGEwK/cXqVSqX59ExFRvX6vG6o7QyOEYFyI6E/7dUvUDd1ARPRHqVQq3HmwpAYYGSJqfnfGRlXfORoiouakZmeISCYhxP/O0RARycJDJyKSjns0RCQdQ0NE0jE0RCQdQ0NE0jE0FkgIgdWrVyMkJARDhw6Fn58fFixYgPLy8j/1vNOnT8fAgQOxZ8+eu37soUOHEBkZ+ae239yysrJQUVFR721/+9vfkJ6ebuaJLBffdbJAS5YswQ8//IDExER06NABOp0O8fHxOH36NL744os/fBW4m5sbtmzZAhcXl2aeWBkBAQFYs2YNOnbsqPQolk+QRSktLRUeHh7i5MmTddZXV1eLHTt2CKPRKKqrq8X8+fOFv7+/CAgIEIsWLRIGg0EIIYSPj49IT08XI0eOFP379xeLFi0SQggRHh4uevToIfz8/MSuXbuEj4+PyMvLMz3/7WWDwSBmz54t/P39hZ+fn5g8ebIoLy8XBw4cEH5+fqZZ7nb7vxYeHi5WrFghXn75ZdG3b1/xz3/+UyxdulQMHTpUBAYGiqKiIiGEEKdOnRJhYWEiICBA+Pn5iU2bNgkhhJg1a5bp9eTl5YkZM2aIhIQEERISIrKzs8WMGTPE0qVLxaFDh8TAgQNFZWWlEEKI5cuXi5iYmOb667pv8NDJwhQUFKBjx47o1q1bnfXW1tYYNGgQ1Go1UlJScOHCBWRlZSEzMxN5eXn45ptvTPfNy8vDl19+iczMTKSmpuLixYtITU0FAKSmpmLgwIENbv/777/HuXPnkJOTg61bt6J79+4oKCioc58/sv365ObmIi0tDYsWLcKSJUvQsWNH5OTkwNXVFRkZGQCAxYsXw9fXF9nZ2UhISMCcOXNgMBiQkJBgej1eXl4AgH379mHdunUICAgwbcPDwwNDhgxBUlISLl26hLS0NMybN6/Rvweqi6GxMDdu3ICjo+Pv3mfXrl0YNWoUNBoNbGxs8Pzzz9c57xISEgKNRgNnZ2c4OTnhwoULTd5++/btceLECWzbtg3V1dV46623MGDAACnbHzRoEDQaDR5//HHodDpTIHr06IFLly4BAJYtW2Y6N+Tl5YWbN2/i8uXL9T5fv379YG1t/Zv1U6dORU5ODmbNmoU333wTDz74YJP/POgWhsbCtGvXzvQ/WUOuXbsGrVZrWtZqtbh69appuW3btqaf1Wo1amtrm7z9p59+GvPnz0dqair69++PadOmoaysTMr227RpY7oPANjZ2f3mMXv27MHo0aPh7++PoKAgCCHq/PqCOzk4ONS73s7ODoGBgTh48CCef/753339VD+GxsL07NkTV69exZEjR+qsNxgM+Oijj6DT6eDk5ITS0lLTbaWlpXBycrqr7Wg0GhiNRtPynTEZOnQoUlNTsWvXLuh0OiQnJ9d5bHNsvykMBgNiY2MRFRWFrVu3YuPGjX/oRPjly5exadMmBAcHIzExsdnnvB8wNBZGq9Vi/PjxmDFjBs6ePQsA0Ol0mDdvHn7++WfY2trCx8cH69atg9FohE6nw9dffw0fH5+72s6DDz6IY8eOAbj1NvHNmzcBABkZGVi2bBmAW3sI3bp1+83/3M2x/aaoqqqCTqfDU089BQD4/PPP0apVK1RVVQG4FcumvOUfHx+PCRMmYM6cOcjKysLRo0ebfVZLx9BYoJiYGLz88suIiorC0KFD8eKLL8LR0dH0r3FERAQ6deqE4OBgvPjii/Dx8alzArQpJk+ebLpW5+TJk3B1dQUA+Pn5obCwEP7+/ggMDMTJkycxbty4Oo9tju03xe3oDh8+HMOHD0fXrl3h5+eHN954AzqdDkFBQRg1ahSys7MbfI5du3bh3LlzGDVqFNq0aYO4uDjMnTu3zt4cNY7X0RCRdNyjISLpGBoiko6hISLpGBoiks5K6QGai22vaKVHkCbvX7PROzRB6TGkuZ5r2demtNYANRb8JpVNEyrCPZp7gLtrZ6VHoD9Bza9MY2iISD6GhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDorpQcgQKVS4dM5YXB37YQavREx768FACyd9wqEEAAAjUYNo7EWYYG9ET3aF7W1Asnr9yJlwz4lR6d6HCksROjIFxATOxVRk6NRVFSE0eERMBqN6NipE1atSYW1tbXSY5oV92hagGE+HnCwt4Hv2A8xaeEXWDR1BOLfegFLVm2F//iPAQAvDfGEnU1rzHojEEGTPoX/hI8RM9oX7bR2Ck9Pd6qsrETclBj4+g42rZs/fz4mRk3Gjl3f47HHXJGyepWCEyqDoWkBXF2ckXfkLADg9LkSuHRqj+4uzsgrPGu6z+B+T6CPxyM4eOQsyiqqUX1Tj30Fp9DvL92UGpvqYW1tjQ2bstCpc2fTul27diFk2PMAgKDgYdi5c7tS4ymGoWkBCk8Uw6+fG9RqFbo/7IxHuzji0tUyBDznbrqPs2NbdHTUouR6hWndlevl6OjkoMTI1AArKyvY2trWWVdZWWk6VHJ2dsbFCxeUGE1RLSo0ubm5uHr1qtJjmN3WvT8jr/AstidPQfRoXxw7fQnj532OkUM8kb0iBgCgguo3j6tvHbVst8+53W9a1MngjIwMREZGwtHRUelRzG7hss2mn49sfAfnL9/AyLeSAAC6/EScvXANxVduIMhJa7pfZ+cH8MPhM2afle6Ovb09dDodbG1tUVx8vs5h1f3CLHs0BoMB06ZNQ1hYGF577TUUFxdj4sSJiIiIQGhoKA4dOoS9e/di+/btmDlzJoqLixEfH4+wsDCEhoZi/fr15hhTMR49HkLSO6MBAEP6u6HgWBHmTAxEwID/HTplfXcYuYVn4PXkw3Cwt0Ub29bo95du2Jt/QqmxqYn8/PywYX0GACBzfQb8/QMUnkgBwgy++uorkZCQIIQQYvPmzSIlJUVs27ZNCCHEvn37RHR0tBBCiPDwcPHf//5XlJaWisGDBwshhNDr9eLLL79sdBuFx89Lmp6o6fLy8sTAgQPFww8/LFxdXcXAgQPFuXPnhJ+fnxgwYIAYPXq0qKmpUXpMszPLodORI0fQr18/AEBwcDDKy8vx7rvvIjk5GTU1NbCzq/sWrYODAx555BFERUUhMDAQw4cPb3QbvUMTpMzeEujyE2HbK1rpMaS5npuo9AjNxr2nF3K276qzzsYK2JS9zbRsBGA0mHkwiWyaUBGzHDppNJo6J8FSUlLQoUMHpKenY+HChfU+ZuXKlYiOjsbRo0cxadIkc4xJRJKYJTQeHh7Yv38/AODbb7/FsmXL4OLiAgDYtm0b9Ho9gFtXyBoMBpw/fx6ff/453N3dMWPGDJSWlppjTCKSxCyhCQ4ORlVVFcLDw5GSkoI1a9Zg9erVeP3119GzZ09cuXIFGRkZ8Pb2RmxsLMrLy5Gfn4+wsDBERERg5MiR5hiTiCRRCWEZb+xb8jkMnqO5t9lYAdUWdE7m11rMORoiur8xNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNIxNEQkHUNDRNJZNXRDbW3t7z5QrWajiKhpGgzNk08+CZVKBQAQQgAAVCoVhBBQqVQ4evSoeSYkonteg6E5duxYgw86e/aslGGIyDI1GJrbjEYj9uzZg+vXrwMAampqsHz5cnz77bfShyMiy9BoaN5++23cuHEDx44dg5eXF3766SfExsaaYzYishCNntG9ePEikpOT0a1bN3zyySdIT0/H4cOHzTEbEVmIJr91ZDAYcPPmTXTu3BnHjx+XORMRWZhGD52eeeYZrFy5En5+fhgxYgS6dOnS6FvfRER3ajQ0sbGxMBqN0Gg08PT0RElJCQYMGGCO2YjIQjQamoyMjN+sy8rKwsiRI6UMRESWp9HQ5OXlmX7W6/X46aef4OnpydAQUZM1GppFixbVWdbpdJg1a5a0gYjI8jQaml+ztbXFL7/8ImOWP+V6bqLSI0hlya+vXZ9opUeQSpefaNGvUZff+H+bjYbm1VdfNX3mCQAuXbqEHj16/LnJiOi+0mhopkyZYvpZpVLB3t4ebm5uUociIsvS6AV769evh7e3N7y9vdGnTx+4ubkhMjLSHLMRkYVocI9m06ZNSE9Px/HjxzF69GjTer1ej5KSErMMR0SWocHQDBs2DN7e3pg+fTpiYmJM69VqNbp3726W4YjIMvzuoVOHDh2wYsUKXL161XT4dPz4cbRq1cpc8xGRBWj0HM2MGTNw5coV03J1dTXefvttqUMRkWVpNDSlpaUYM2aMaXncuHEoKyuTOhQRWZZGQ6PX63Hy5EnTcmFhIfR6vdShiMiyNHodzaxZsxAVFYWKigrU1taiXbt2WLJkiTlmIyIL0Whoevbsia1bt+LChQs4cOAAMjMzMWnSJOzZs8cc8xGRBWg0NAUFBVi/fj2ysrJQW1uL9957D0OHDjXHbERkIRo8R7Ny5UoEBQVh6tSpcHR0REZGBlxcXBAcHAwrq7v+LCYR3ccaLMaHH36I7t2745133kHfvn0BoM6HK4mImqrB0OzevRuZmZmYP38+amtrMWLECL7bRER/SIOHTk5OTpgwYQK2bNmChIQE/PLLLzh//jwmTZqE7777zpwzEtE9rklft9KnTx988MEH2LNnD3x8fLB06VLZcxGRBWny9zoBQJs2bRAWFoavvvpK1jxEZIHuKjRERH8EQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0lkpPQDV70hhIUJHvoCY2KmY+lY0ioqKEDk2AkajER07dcKqNamwtrZWekwCoFKp8OmcMLi7dkKN3oiY99cCAJbOewVCCACARqOG0ViLsMDeiB7ti9pageT1e5GyYZ+So5sN92haoMrKSsRNiYGv72DTuvcWzMfEqMnYset7PPaYK1JWr1JwQrrTMB8PONjbwHfsh5i08AssmjoC8W+9gCWrtsJ//McAgJeGeMLOpjVmvRGIoEmfwn/Cx4gZ7Yt2WjuFpzcPhqYFsra2xoZNWejUubNp3e7duxAy7HkAQFDwMOzcuV2p8ehXXF2ckXfkLADg9LkSuHRqj+4uzsgrPGu6z+B+T6CPxyM4eOQsyiqqUX1Tj30Fp9DvL92UGtusGJoWyMrKCra2tnXWVVVWmg6VnJ2dcfHCBSVGo3oUniiGXz83qNUqdH/YGY92ccSlq2UIeM7ddB9nx7bo6KhFyfUK07or18vR0clBiZHNziyhqaqqgq+vrzk2dV+4fdxPLcPWvT8jr/AstidPQfRoXxw7fQnj532OkUM8kb0iBgCgguo3j6tvnaXiyeB7RBt7e+h0Otja2qK4+HydwypS3sJlm00/H9n4Ds5fvoGRbyUBAHT5iTh74RqKr9xAkJPWdL/Ozg/gh8NnzD6rEqTt0VRUVGDcuHF49dVXsXz5cgDADz/8gLCwMISHh2P69OmoqalBeXk5xo0bh1deeQVJSUkYNGgQAOAf//gHQkNDMWrUKCQlJcka854xaJAfNqzPAABkrs+Av3+AwhPRbR49HkLSO6MBAEP6u6HgWBHmTAxEwID/HTplfXcYuYVn4PXkw3Cwt0Ub29bo95du2Jt/QqmxzUraHs3GjRvRvXt3zJ49G1lZWdi8eTPmz5+P1atXo1OnTnj33XexadMmVFVVwdXVFXPmzEFaWprpsCA5ORl79+6FWq3G2rVrZY3ZIv148CBm/nUazp49g1atWuHrzHVITvkCb0SOxcp/rICLy8MIH/Oa0mPS/ys8Xgy1WoXvU6ejusaAcbPXwNamNVbFj8HcSUEAgJw9RwAA8z79GpuWTYYQAgkrslBWUa3k6GajEpIO+N999114e3sjICAAJSUl8Pf3R4cOHZCdnQ0A2LJlC3Jzc2EwGNC3b18EBgbi4sWLeOWVV/Dtt99iwYIFOHnyJEJCQhAcHAx7e/vf3V6tANT3zyEv0T1F2h6NEAIqlarOz3c2Ta/Xm25Xq28dwd1eBoAFCxbg1KlTyM7ORkREBNatWweNRtPg9mqMMl5Fy2BjBVQblJ5CnnZ9opUeQSpdfiJse1nua9TlJzZ6H2nnaB599FEUFhYCAPbv3w+tVguVSoXi4mIAQG5uLjw8PNC1a1ccPnwYALB7924AQHl5OZYuXYpu3bph8uTJcHBwQEVFRf0bIqIWT9oezfDhwzF58mS89tpr8PLygkqlQnx8PKZNmwYrKyt07doVwcHBKCsrQ1RUFCIiItC/f39oNBq0bdsW165dw0svvQQ7Ozt4enrCweH+uN6AyBJJO0fTVMXFxTh16hQGDBiA/Px8fPrpp1i16u4vr7fkQwseOt3beOjUAq6jsbe3x+rVq5GYeGvYuXPnKjwRETU3xUOj1WqRnJys9BhEJBE/60RE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCQdQ0NE0jE0RCSdSgghlB6CiCwb92iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGpoXasGED1q1bB71ej8jISIwcORLp6elKj0V3qba2FmVlZUqPoTiGpoVKT0/HiBEjkJOTgyeeeAIZGRnIyclReixqgs8++wxr165FZWUlXnrpJUyZMgUff/yx0mMpiqFpodRqNTQaDXJychASEgIAuHnzpsJTUVPs3LkTYWFh+Oabb+Dn54dVq1YhPz9f6bEUxdC0UO7u7hgyZAj0ej3c3NyQmpqKzp07Kz0WNUFtbS1qa2uxadMmBAUFAQAqKysVnkpZVkoPQPUbP348YmNjodVqAQCDBw9G3759FZ6KmmLIkCF49tlnERAQgEceeQTLli1Dz549lR5LUfw1ES3M9evXUVJSgtmzZ+ODDz7A7b8eg8GA2NhYbN26VeEJ6W5VVlaiTZs2So+hKO7RtDAnT55ERkYGzpw5gwULFpjWq9VqvPDCCwpORk01ePDg36zTaDTo2rUr4uLi4O7ursBUyuIeTQv173//G/3796+zLjMzEyNGjFBoImqqFStWQKvVYtCgQVCpVPjuu+9w7do19O3bF4sXL74vL1PgHk0LpdVqERsbi9LSUgCAXq9HSUkJQ3MP2L17N7744gvTcmhoKMaMGYOJEycqOJWyGJoW6r333kNcXByWLFmChQsXYtu2bff9CcV7hbW1NRISEuDl5QWVSoXDhw9Dr9dj7969sLOzU3o8RTA0LZSNjQ369u2L1q1bw93dHe7u7oiMjISvr6/So1EjPvnkE2zYsAEHDhyAEAIuLi5Yvnw5qqqq8Pe//13p8RTB0LRQtra22LlzJ7p06YIPP/wQLi4uuHDhgtJjURPY2NjAzs4OGo0GKpUKTk5O0Gq1eOCBB5QeTTE8GdxCFRcXY8eOHRgxYgTWrFmDpKQkrFmzBr1791Z6NGrE22+/DQcHB3h7e0Ov1yM3NxcGgwHx8fFKj6YY7tG0UHPmzMHLL78Me3t7REdHw93dHcuWLcOqVauUHo0acfHiRSxZssS0HBwcjDFjxig4kfL4EYQWqrq6GoGBgaZlX19f6PV6BSeiptLr9bh8+bJp+eLFizAYDApOpDzu0bRQDz30EBYvXgxPT0/U1tZi//79/KzTPSIuLg5jx46FSqWCEAIqleq+PmwCeI6mxTIajcjMzMSRI0eg0Wjg4eGB4OBgWFnx34aW6vYFegAghMCNGzegUqmg1WqhVquxfft2hSdUDkND1Ex0Oh2EEEhKSoKbmxu8vb0hhMD+/ftx5swZREdHKz2iYniOhqiZ2Nraws7ODj/++CMCAwPh6OgIJycnhISE4ODBg0qPpyjuhxM1s9atW+ODDz5Ar169oFarcfjwYRiNRqXHUhQPnYiaWWVlJTZu3IgTJ05ACIFHH30Uw4cPR9u2bZUeTTEMDRFJx3M0RCQdQ0NE0jE01GTnz5/HU089hYiICERERCAsLAzTpk37w99b9K9//QszZ84EAEydOhWXLl1q8L75+fkoKipq8nMbjUY8/vjjf2guan4MDd2V9u3bIzU1FampqVi7di06dOiA5cuX/+nn/eijj9ChQ4cGb8/IyLir0FDLwre36U/p3bs3vvzyS/j6+iIoKAhFRUX45JNPkJ2djdTUVAgh0L59e7z//vt44IEHkJaWhrS0NHTs2BHOzs6m5/H19cWaNWvQtWtXxMfHo7CwEADw+uuvm77f6tChQ5g9ezZcXFywcOFC6HQ6VFVVIS4uDv3798fp06cxffp02Nra8hsjWhpB1ETnzp0Tzz33nGnZYDCImTNnis8++0z4+PiIr776SgghRHFxsRg2bJi4efOmEEKIlJQUsWjRIlFWVib69Okjrl+/LoQQYtKkSWLGjBlCCCF8fHzEmTNnxIYNG0RMTIwQQogbN26ICRMmCIPBIMLDw8XevXuFEEJMmDBB7N+/XwghxJUrV4SPj48wGAwiLi5OpKWlCSGE2LJli+jRo4cZ/lSoKbhHQ3fl2rVriIiIAHDri9J69+6NsWPHIi0tDb169QIAFBQU4MqVK4iMjAQA1NTUoEuXLvjll1/QpUsX0y+AeuaZZ3D06NE6z//TTz+Z9ka0Wi0+++yz38xw4MABVFZWQq2+deTfqlUrXL16Ff/5z39Mv5f3mWeekfDq6Y9iaOiu3D5HU59WrVoBuHVl7NNPP40VK1bUub2wsND0oUMA9V4tq1KpUFtb+7sztG7dGomJiWjXrl29jwfQ6HOQefFkMDU7Dw8PHDp0CCUlJQCAnJwc7NixAy4uLigqKkJZWRmEENi3b99vHturVy98//33AICKigqEhoZCr9dDpVKZfqeLl5cXsrOzAdz6wr33338fAPDYY4+hoKAAwK2vq6GWg3s01OycnZ0xZ84cvPHGG7C1tYWNjQ0WL14MrVaLqKgovPrqq+jatSseeughVFdX13lsYGAgfvzxR4SFhcFoNGLcuHFo1aoVnn32WcyfPx+zZ8/G3LlzMW/ePGzevBk1NTV48803AQDR0dH461//ipycHHh6ekKj0Sjx8qke/AgCEUnHQyciko6hISLp1DxyIiKZhBDcoyEi+dR3XtdARCSDGri1a0NE1NzE/3/dDN/eJiLp6pyjYXOIqDn8uiV1rgy+/c16t38mIrobDfXj/wBgMPWozAgS1wAAAABJRU5ErkJggg==" alt="1549630283099"></p><h4 id="improve-model"><a href="#improve-model" aria-hidden="true" class="header-anchor">#</a> Improve model</h4><ul><li>find better learn_fs</li></ul><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>sched<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549630308144.3b797b6f.png" alt="1549630308144"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549630351231.9874b287.png" alt="1549630351231"></p><p>Our model val improve from <code>0.0100</code> to <code>0.007</code></p><div class="language-python extra-class"><pre class="language-python"><code>interp<span class="token punctuation">.</span>plot_confusion_matrix<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549630404325"></p><h3 id="dogs-cats-breeds-example"><a href="#dogs-cats-breeds-example" aria-hidden="true" class="header-anchor">#</a> dogs/cats breeds example</h3><p>This examples is more complicated that recognizing dogs and cats. It can also recognize  12 cat breeds and 25 dogs breeds. The whole core functions are the same as previous. The only difference is that now we use <code>URLS.PETS</code> to download data  and <code>ImageDataBunch.from_name_re</code>.</p><h4 id="get-data"><a href="#get-data" aria-hidden="true" class="header-anchor">#</a> Get data</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> error_rate

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>PETS<span class="token punctuation">)</span><span class="token punctuation">;</span>
path<span class="token punctuation">.</span>ls<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'images'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ls<span class="token punctuation">(</span><span class="token punctuation">)</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549484272998"></p><p><img src="/assets/img/1549484431215.31bb6b73.png" alt="1549484431215"></p><h4 id="get-data-2"><a href="#get-data-2" aria-hidden="true" class="header-anchor">#</a> Get Data</h4><div class="language-python extra-class"><pre class="language-python"><code>fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
pat <span class="token operator">=</span> r<span class="token string">'/([^/]+)_\d+.jpg$'</span>

data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>
    path_img<span class="token punctuation">,</span> 
    fnames<span class="token punctuation">,</span> 
    pat<span class="token punctuation">,</span> 
    ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> bs<span class="token operator">=</span>bs
<span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">)</span>
data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><code>['Abyssinian', 'Bengal', 'Birman', 'Bombay', 'British_Shorthair', 'Egyptian_Mau', 'Maine_Coon', 'Persian', 'Ragdoll', 'Russian_Blue', 'Siamese', 'Sphynx', 'american_bulldog', 'american_pit_bull_terrier', 'basset_hound', 'beagle', 'boxer', 'chihuahua', 'english_cocker_spaniel', 'english_setter', 'german_shorthaired', 'great_pyrenees', 'havanese', 'japanese_chin', 'keeshond', 'leonberger', 'miniature_pinscher', 'newfoundland', 'pomeranian', 'pug', 'saint_bernard', 'samoyed', 'scottish_terrier', 'shiba_inu', 'staffordshire_bull_terrier', 'wheaten_terrier', 'yorkshire_terrier']</code></p><p><img src="/assets/img/1549630449518.8e2fd393.png" alt="1549630449518"></p><h4 id="learn-using-resnet34"><a href="#learn-using-resnet34" aria-hidden="true" class="header-anchor">#</a> Learn using resnet34</h4><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-1'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549630532549"></p><div class="language-python extra-class"><pre class="language-python"><code>interp <span class="token operator">=</span> ClassificationInterpretation<span class="token punctuation">.</span>from_learner<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
interp<span class="token punctuation">.</span>plot_top_losses<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549630635258.abc02566.png" alt="1549630635258"></p><h4 id="most-confused-breeds"><a href="#most-confused-breeds" aria-hidden="true" class="header-anchor">#</a> Most confused breeds</h4><div class="language-python extra-class"><pre class="language-python"><code>interp<span class="token punctuation">.</span>most_confused<span class="token punctuation">(</span>min_val<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p><code>[('Egyptian_Mau', 'Bengal', 11), ('american_pit_bull_terrier', 'staffordshire_bull_terrier', 7), ('British_Shorthair', 'Russian_Blue', 5), ('Persian', 'Ragdoll', 4), ('staffordshire_bull_terrier', 'american_pit_bull_terrier', 4), ('american_bulldog', 'staffordshire_bull_terrier', 3), ('beagle', 'basset_hound', 3), ('miniature_pinscher', 'chihuahua', 3)]</code></p><h4 id="find-better-learning-rate"><a href="#find-better-learning-rate" aria-hidden="true" class="header-anchor">#</a> Find better learning rate</h4><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549631049501.d316faf7.png" alt="1549631049501"></p><p>There is no point to train the whole network with a small value. Better is to define a small learning layer on the first layers and higher learning rate on the last layer and distribute other layers with values between.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549630793542"></p><p>After we define the error rate drop to 0.06 which is a good value (better than human).</p><h4 id="resnet50"><a href="#resnet50" aria-hidden="true" class="header-anchor">#</a> Resnet50</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> error_rate

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>PETS<span class="token punctuation">)</span><span class="token punctuation">;</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span>
fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
pat <span class="token operator">=</span> r<span class="token string">'/([^/]+)_\d+.jpg$'</span>

bs <span class="token operator">=</span> <span class="token number">64</span>

data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>
    path_img<span class="token punctuation">,</span> 
    fnames<span class="token punctuation">,</span> pat<span class="token punctuation">,</span> 
    ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    size<span class="token operator">=</span><span class="token number">299</span><span class="token punctuation">,</span> bs<span class="token operator">=</span>bs<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet50<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-1-50'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549631790524.4f5969d3.png" alt="1549631790524"></p><p><img src="/assets/img/1549631798510.fdf30da7.png" alt="1549631798510"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549631818381"></p><h3 id="isic-archive-skin-melanoma-recognition"><a href="#isic-archive-skin-melanoma-recognition" aria-hidden="true" class="header-anchor">#</a> ISIC - Archive (Skin melanoma recognition)</h3><p>ISIC archive contains plenty of skin images categorised and available for download from the webpage <a href="https://www.isic-archive.com" target="_blank" rel="noopener noreferrer">https://www.isic-archive.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. This is a good point to test fast.ai and verify the first fast.ai lesson for this list of images.</p><p>I’ve used the <a href="https://chrome.google.com/webstore/detail/curlwget/jmocjfidanebdlinpbcdkcmgdifblncg" target="_blank" title="https://chrome.google.com/webstore/detail/curlwget/jmocjfidanebdlinpbcdkcmgdifblncg" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>CurlWget</span></a>  to generate <strong>wget</strong> command that can be copied to the jupyter notebook and download the whole archive.</p><p><img src="/assets/img/1549633920675.e97f9730.png" alt="1549633920675"></p><p><img src="/assets/img/1549633967565.fe42a7cb.png" alt="1549633967565"></p><p><img src="/assets/img/1549634016294.03c8372d.png" alt="1549634016294"></p><p>After you download first selected 240 images, and next selected 240 images for the bening.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#part 1 (240 images 1-3 pages)</span>
!rm ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span>
!wget <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
!unzip <span class="token operator">-</span>o <span class="token operator">-</span>q ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d isd<span class="token operator">/</span>benign
!cp isd<span class="token operator">/</span>benign<span class="token operator">/</span>ISIC<span class="token operator">-</span>images<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>jpg isd<span class="token operator">/</span>benign

<span class="token comment">#part 2 (240 images 4-6 pages)</span>
!rm ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span>
!wget <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
!unzip <span class="token operator">-</span>o <span class="token operator">-</span>q ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d isd<span class="token operator">/</span>benign
!mv isd<span class="token operator">/</span>benign<span class="token operator">/</span>ISIC<span class="token operator">-</span>images<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>jpg isd<span class="token operator">/</span>benign


<span class="token comment">#part 1 malignant</span>
!rm ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span>
!wget <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
!unzip <span class="token operator">-</span>o <span class="token operator">-</span>q ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d isd<span class="token operator">/</span>malignant
!mv isd<span class="token operator">/</span>malignant<span class="token operator">/</span>ISIC<span class="token operator">-</span>images<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>jpg isd<span class="token operator">/</span>malignant

<span class="token comment">#part 2 (page 4-6 - 240 images)</span>
!rm ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span>
!wget <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
!unzip <span class="token operator">-</span>o <span class="token operator">-</span>q ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d isd<span class="token operator">/</span>malignant
!mv isd<span class="token operator">/</span>malignant<span class="token operator">/</span>ISIC<span class="token operator">-</span>images<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>jpg isd<span class="token operator">/</span>malignant
</code></pre></div><h4 id="second-option-to-download-data"><a href="#second-option-to-download-data" aria-hidden="true" class="header-anchor">#</a> Second option to download data</h4><p>You can use a python library to download images <a href="https://github.com/GalAvineri/ISIC-Archive-Downloader" target="_blank" rel="noopener noreferrer">https://github.com/GalAvineri/ISIC-Archive-Downloader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> .</p><div class="language-python extra-class"><pre class="language-python"><code>!git clone https<span class="token punctuation">:</span><span class="token operator">//</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>GalAvineri<span class="token operator">/</span>ISIC<span class="token operator">-</span>Archive<span class="token operator">-</span>Downloader<span class="token punctuation">.</span>git
  
!mkdir isic
!mkdir isic<span class="token operator">/</span>bening
!mkdir isic<span class="token operator">/</span>malignant

!python <span class="token string">&quot;ISIC-Archive-Downloader/download_archive.py&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>num<span class="token operator">-</span>images <span class="token number">500</span>  <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">filter</span> benign <span class="token operator">-</span><span class="token operator">-</span>images<span class="token operator">-</span><span class="token builtin">dir</span> isic<span class="token operator">/</span>bening
!python <span class="token string">&quot;ISIC-Archive-Downloader/download_archive.py&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>num<span class="token operator">-</span>images <span class="token number">500</span>  <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">filter</span> malignant <span class="token operator">-</span><span class="token operator">-</span>images<span class="token operator">-</span><span class="token builtin">dir</span> isic<span class="token operator">/</span>malignant
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549636028509"></p><p><img src="data:image/png;base64,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" alt="1549636128365"></p><h4 id="import-libraries"><a href="#import-libraries" aria-hidden="true" class="header-anchor">#</a> Import libraries</h4><p>I’ve used the <code>recurse</code> option to get also filenames from the subfolder.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> error_rate
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path


bs <span class="token operator">=</span> <span class="token number">64</span>
<span class="token comment">#bs = 32   # uncomment this line if you run out of memory even after clicking Kernel-&gt;Restart</span>

path <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">'./isic/'</span><span class="token punctuation">)</span>
fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path<span class="token punctuation">,</span> recurse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><p>Then I can create the <code>ImageDataBunch</code> to prepare data to learn.  I can filp vertical the images (<code>get_transforms(filp_vert=True)</code> ) because the image is not done from front but from the above. (like satelite images) and for recognition it doesn’t matter.</p><p>The example path is:</p><p><code>isic/bening/ISIC_000001.jpg</code></p><p>The regular expresssion is try to find regular expression.</p><ul><li><code>r</code> - means that text is regular expression</li><li><code>([a-zA-Z]+)</code> - the name contains text and because they are in the first bracket they are used as a class for image recognition(<code>bening</code> or <code>malignant</code>)</li><li><code>ISIC_\d+.jpg</code> - any file with the extension <code>.jpg</code> and name started as <code>ISIC_</code> with the number <code>\d+</code> after underline.</li><li><code>$</code> - this means that this that whole regex should be in the on of the name (like <code>.jpg.jpg</code> wouldn’t match the experession)</li></ul><p>You can verify your regex on the page <a href="https://regexr.com/" target="_blank" title="https://regexr.com/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>regexr</span></a>.</p><p><img src="/assets/img/1549645995061.aaccfbb5.png" alt="1549645995061"></p><div class="language-python extra-class"><pre class="language-python"><code>pat <span class="token operator">=</span> r<span class="token string">&quot;([a-zA-Z]+)/ISIC_\d+\.jpg$&quot;</span>

data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>path<span class="token punctuation">,</span> 
                                   fnames<span class="token punctuation">,</span> 
                                   pat<span class="token operator">=</span>pat<span class="token punctuation">,</span> 
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span>flip_vert<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#FLIP VERTICAL </span>
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">)</span>
data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549635940232.22b0c8f8.png" alt="1549635940232"></p><p>Now we can try our first learn</p><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-1'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549636165565"></p><p>This is not a very good result but we can try to find better learning rate. It shws that propably <code>1e-2</code> is the best to learn. This is one magnifi</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549636207163.93a9756e.png" alt="1549636207163"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549646496183.4b945fb0.png" alt="1549646496183"></p><div class="language-python extra-class"><pre class="language-python"><code>interp <span class="token operator">=</span> ClassificationInterpretation<span class="token punctuation">.</span>from_learner<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
interp<span class="token punctuation">.</span>plot_confusion_matrix<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549646581287"></p><p>I go down with the <code>14%</code> of error rate. This is not yet a good result, but for now enough to improvement in the future. Mostly the problem is with the skin that is consider as <code>bening</code>, but in real they are <code>malignant</code>.</p><h3 id="planet-amazon-dataset"><a href="#planet-amazon-dataset" aria-hidden="true" class="header-anchor">#</a> Planet Amazon dataset</h3><p>Planet Amazon DataSet is the DataSet of satellite images, that we can categorize with multiple labes for each image.</p><p><a href="https://www.kaggle.com/c/planet-understanding-the-amazon-from-space" target="_blank" rel="noopener noreferrer">https://www.kaggle.com/c/planet-understanding-the-amazon-from-space<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h4 id="download-data"><a href="#download-data" aria-hidden="true" class="header-anchor">#</a> Download Data</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> Config<span class="token punctuation">.</span>data_path<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">'planet'</span>
path<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

!kaggle competitions download <span class="token operator">-</span>c planet<span class="token operator">-</span>understanding<span class="token operator">-</span>the<span class="token operator">-</span>amazon<span class="token operator">-</span><span class="token keyword">from</span><span class="token operator">-</span>space <span class="token operator">-</span>f train<span class="token operator">-</span>jpg<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>7z <span class="token operator">-</span>p <span class="token punctuation">{</span>path<span class="token punctuation">}</span> !kaggle competitions download <span class="token operator">-</span>c planet<span class="token operator">-</span>understanding<span class="token operator">-</span>the<span class="token operator">-</span>amazon<span class="token operator">-</span><span class="token keyword">from</span><span class="token operator">-</span>space <span class="token operator">-</span>f train_v2<span class="token punctuation">.</span>csv <span class="token operator">-</span>p <span class="token punctuation">{</span>path<span class="token punctuation">}</span>  

!conda install <span class="token operator">-</span>y <span class="token operator">-</span>c haasad eidl7zip <span class="token comment">#install 7zip if not exist</span>

!unzip <span class="token operator">-</span>q <span class="token operator">-</span>n <span class="token punctuation">{</span>path<span class="token punctuation">}</span><span class="token operator">/</span>train_v2<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d <span class="token punctuation">{</span>path<span class="token punctuation">}</span>
!7za <span class="token operator">-</span>bd <span class="token operator">-</span>y <span class="token operator">-</span>so x <span class="token punctuation">{</span>path<span class="token punctuation">}</span><span class="token operator">/</span>train<span class="token operator">-</span>jpg<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>7z <span class="token operator">|</span> tar xf <span class="token operator">-</span> <span class="token operator">-</span>C <span class="token punctuation">{</span>path<span class="token punctuation">}</span>
</code></pre></div><h4 id="load-data"><a href="#load-data" aria-hidden="true" class="header-anchor">#</a> Load Data</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> Config<span class="token punctuation">.</span>data_path<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">'planet'</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'train_v2.csv'</span><span class="token punctuation">)</span>

tfms <span class="token operator">=</span> get_transforms<span class="token punctuation">(</span>flip_vert<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> max_lighting<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> max_zoom<span class="token operator">=</span><span class="token number">1.05</span><span class="token punctuation">,</span> max_warp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">)</span>


np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
src <span class="token operator">=</span> <span class="token punctuation">(</span>ImageList
       <span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'train_v2.csv'</span><span class="token punctuation">,</span> folder<span class="token operator">=</span><span class="token string">'train-jpg'</span><span class="token punctuation">,</span> suffix<span class="token operator">=</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>random_split_by_pct<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>label_from_df<span class="token punctuation">(</span>label_delim<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>src
        <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550781434208.6ef889aa.png" alt="1550781434208"></p><h4 id="load-learner"><a href="#load-learner" aria-hidden="true" class="header-anchor">#</a> Load Learner</h4><p>F-score is helpful for Kaggle competitions. Submission is for the F2-score, with <code>betha</code>equal=2. (this is default for <code>fbeta</code> function)</p><p><img src="/assets/img/1550781708755.e62123c6.png" alt="1550781708755"></p><p><img src="/assets/img/1550781531925.2fdd6ff5.png" alt="1550781531925"></p><div class="language-python extra-class"><pre class="language-python"><code>arch <span class="token operator">=</span> models<span class="token punctuation">.</span>resnet50

acc_02 <span class="token operator">=</span> partial<span class="token punctuation">(</span>accuracy_thresh<span class="token punctuation">,</span> thresh<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
f_score <span class="token operator">=</span> partial<span class="token punctuation">(</span>fbeta<span class="token punctuation">,</span> thresh<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> arch<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span>acc_02<span class="token punctuation">,</span> f_score<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="find-learning-rate"><a href="#find-learning-rate" aria-hidden="true" class="header-anchor">#</a> Find learning rate</h4><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550781750813.732f9141.png" alt="1550781750813"></p><h4 id="learn-model"><a href="#learn-model" aria-hidden="true" class="header-anchor">#</a> Learn Model</h4><div class="language-python extra-class"><pre class="language-python"><code>lr <span class="token operator">=</span> <span class="token number">0.01</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550781783734.3ab29938.png" alt="1550781783734"></p><h4 id="tune-model"><a href="#tune-model" aria-hidden="true" class="header-anchor">#</a> Tune model</h4><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782018201.ed21dd59.png" alt="1550782018201"></p><div class="language-python extra-class"><pre class="language-python"><code>lr <span class="token operator">=</span> <span class="token number">0.01</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> lr<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-2-rn50'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1550781829671"></p><p>We can resize the model to smaller images and retrain again.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'stage-2-rn50'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>src
        <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>data <span class="token operator">=</span> data
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>freeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782136754.10ff030c.png" alt="1550782136754"></p><div class="language-python extra-class"><pre class="language-python"><code>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782161671.ab59884b.png" alt="1550782161671"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> lr<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot_losses<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-2-256-rn50'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782237657.646b6494.png" alt="1550782237657"></p><p><img src="/assets/img/1550782247706.65559f86.png" alt="1550782247706"></p><h3 id="camvid-mask-images"><a href="#camvid-mask-images" aria-hidden="true" class="header-anchor">#</a> CamVid / mask Images</h3><p>CamVid DataSet is huge dataset with images from camera in the car and mask that each pixel give some class. This is a classification for each pixel. The inptu is image, and the output is also image with classes instead of RGB.</p><p><a href="http://mi.eng.cam.ac.uk/research/projects/VideoRec/CamVid/" target="_blank" rel="noopener noreferrer">http://mi.eng.cam.ac.uk/research/projects/VideoRec/CamVid/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h4 id="load-data-2"><a href="#load-data-2" aria-hidden="true" class="header-anchor">#</a> Load Data</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>hooks <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>CAMVID<span class="token punctuation">)</span>
path_lbl <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'labels'</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span>

fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
lbl_names <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_lbl<span class="token punctuation">)</span>

path<span class="token punctuation">.</span>ls<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1550782441540"></p><p>We can load the image by <code>open_image</code>, and mask by <code>open_mask</code>. (<code>x.stem</code> is filename without extenstion, <code>x.suffix</code> is the extension). We can combine input file with the output by adding <code>_P</code> in the file name for <code>path_lbl o</code> directory.</p><p><img src="data:image/png;base64,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" alt="1550782825543"></p><div class="language-python extra-class"><pre class="language-python"><code>img_f <span class="token operator">=</span> fnames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
img <span class="token operator">=</span> open_image<span class="token punctuation">(</span>img_f<span class="token punctuation">)</span>
img<span class="token punctuation">.</span>show<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

get_y_fn <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> path_lbl<span class="token operator">/</span>f<span class="token string">'{x.stem}_P{x.suffix}'</span>
mask <span class="token operator">=</span> open_mask<span class="token punctuation">(</span>get_y_fn<span class="token punctuation">(</span>img_f<span class="token punctuation">)</span><span class="token punctuation">)</span>
mask<span class="token punctuation">.</span>show<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782654727.093e61f7.png" alt="1550782654727"></p><p><img src="data:image/png;base64,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" alt="1550782661576"></p><div class="language-python extra-class"><pre class="language-python"><code>src_size <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>mask<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
codes <span class="token operator">=</span> np<span class="token punctuation">.</span>loadtxt<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'codes.txt'</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Codes give us list of codes in the order. When in valudation set if pixel on the position <code>x,y</code>  has value 0, this means that this is <code>Animal</code>,</p><p><img src="/assets/img/1550782526202.67103a78.png" alt="1550782526202"></p><h4 id="create-dataset"><a href="#create-dataset" aria-hidden="true" class="header-anchor">#</a> Create DataSet</h4><p>First size of the DataSet is twice smaller than regular. This is called: &quot;progressive resizing&quot;. The dataset learn faster and generalized better.</p><div class="language-python extra-class"><pre class="language-python"><code>size <span class="token operator">=</span> src_size<span class="token operator">//</span><span class="token number">2</span>
bs<span class="token operator">=</span><span class="token number">4</span>

src <span class="token operator">=</span> <span class="token punctuation">(</span>SegmentationItemList
       <span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
       <span class="token punctuation">.</span>split_by_fname_file<span class="token punctuation">(</span><span class="token string">'../valid.txt'</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>label_from_func<span class="token punctuation">(</span>get_y_fn<span class="token punctuation">,</span> classes<span class="token operator">=</span>codes<span class="token punctuation">)</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>src
        <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span>size<span class="token punctuation">,</span> tfm_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span>bs<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
</code></pre></div><p>For mask DataBunch, you can define <code>alpha</code> to set <code>opacity</code> for the mask.  (<code>1.0</code> - means you will not see image)</p><p><img src="/assets/img/1550783072226.e290e8f1.png" alt="1550783072226"></p><h4 id="create-model"><a href="#create-model" aria-hidden="true" class="header-anchor">#</a> Create Model</h4><p>We create our own accuracy, without <code>void</code> class for the image.</p><div class="language-python extra-class"><pre class="language-python"><code>name2id <span class="token operator">=</span> <span class="token punctuation">{</span>v<span class="token punctuation">:</span>k <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>codes<span class="token punctuation">)</span><span class="token punctuation">}</span>
void_code <span class="token operator">=</span> name2id<span class="token punctuation">[</span><span class="token string">'Void'</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">acc_camvid</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">:</span>
    target <span class="token operator">=</span> target<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    mask <span class="token operator">=</span> target <span class="token operator">!=</span> void_code
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token operator">==</span>target<span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

metrics<span class="token operator">=</span>acc_camvid
wd<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span>
learn <span class="token operator">=</span> unet_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> 
                     models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> 
                     metrics<span class="token operator">=</span>metrics<span class="token punctuation">,</span> 
                     wd<span class="token operator">=</span>wd<span class="token punctuation">)</span>
</code></pre></div><h4 id="find-lr"><a href="#find-lr" aria-hidden="true" class="header-anchor">#</a> Find LR</h4><div class="language-python extra-class"><pre class="language-python"><code>lr_find<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783275635.2bd57907.png" alt="1550783275635"></p><div class="language-python extra-class"><pre class="language-python"><code>lr<span class="token operator">=</span><span class="token number">3e</span><span class="token operator">-</span><span class="token number">3</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token punctuation">)</span><span class="token punctuation">,</span> pct_start<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-1'</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>show_results<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783296270.c0c89214.png" alt="1550783296270"></p><p><img src="/assets/img/1550783514365.0c4cc0a1.png" alt="1550783514365"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
lrs <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token operator">/</span><span class="token number">400</span><span class="token punctuation">,</span>lr<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> lrs<span class="token punctuation">,</span> pct_start<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/1550783555937.cb1856e7.png" alt="1550783555937"></p><h4 id="go-to-the-normal-size"><a href="#go-to-the-normal-size" aria-hidden="true" class="header-anchor">#</a> Go to the normal size</h4><div class="language-python extra-class"><pre class="language-python"><code>size <span class="token operator">=</span> src_size
bs<span class="token operator">=</span><span class="token number">3</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>src
        <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span>size<span class="token punctuation">,</span> tfm_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span>bs<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>

learn <span class="token operator">=</span> unet_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>metrics<span class="token punctuation">,</span> wd<span class="token operator">=</span>wd<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'stage-2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

lr_find<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783772526.1bdc6fd7.png" alt="1550783772526"></p><div class="language-python extra-class"><pre class="language-python"><code>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token punctuation">)</span><span class="token punctuation">,</span> pct_start<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783798472.9cbac060.png" alt="1550783798472"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
lrs <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span>lr<span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> lrs<span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-2-big'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783824462.fe3bff5d.png" alt="1550783824462"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'stage-2-big'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
learn<span class="token punctuation">.</span>show_results<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783851169.f7115eee.png" alt="1550783851169"></p><h3 id="imdb-nlp-text-classification"><a href="#imdb-nlp-text-classification" aria-hidden="true" class="header-anchor">#</a> IMDB / NLP Text Classification</h3><p>For text classification we can use IMDB database with reviews to check if review is positive or negative. We cannot use text  directly in our fastai library. 1st we need tokenize the text and replace the text values with a number. For this we need to have vocabulary.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">%</span>reload_ext autoreload
<span class="token operator">%</span>autoreload <span class="token number">2</span>
<span class="token operator">%</span>matplotlib inline

<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>text <span class="token keyword">import</span> <span class="token operator">*</span>

bs <span class="token operator">=</span> <span class="token number">48</span>
path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>IMDB<span class="token punctuation">)</span>
path<span class="token punctuation">.</span>ls<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551279684037.2fed9921.png" alt="1551279684037"></p><p>In the fastai library when you download your data, you’ve got your vocabulary in the dataset. (<code>imdb.vocab</code>), also you have your temporary language model that has labels equal 0 as <code>(tmp_lm)</code>.</p><p>We load our <code>Language Model Databunch</code>. This is special DataBunch model without labels (labels are constant equal <code>0</code>) . This data</p><div class="language-python extra-class"><pre class="language-python"><code>data_lm <span class="token operator">=</span> TextLMDataBunch<span class="token punctuation">.</span>load<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'tmp_lm'</span><span class="token punctuation">,</span> bs<span class="token operator">=</span>bs<span class="token punctuation">)</span> <span class="token comment">#lm is a laguage model</span>

<span class="token comment"># OR LONGER VERSION</span>

<span class="token comment"># data_lm = (TextList.from_folder(path)</span>
<span class="token comment">#            #Inputs: all the text files in path</span>
<span class="token comment">#             .filter_by_folder(include=['train', 'test', 'unsup']) </span>
<span class="token comment">#            #We may have other temp folders that contain text files so we only keep what's in train and test</span>
<span class="token comment">#             .random_split_by_pct(0.1)</span>
<span class="token comment">#            #We randomly split and keep 10% (10,000 reviews) for validation</span>
<span class="token comment">#             .label_for_lm()           </span>
<span class="token comment">#            #We want to do a language model so we label accordingly (label = 0)</span>
<span class="token comment">#             .databunch(bs=bs))</span>

data_lm<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551281143436.1e3a32e4.png" alt="1551281143436"></p><p><code>language_model_learner</code> is used to predict next word in the sentence. <code>AWD_LSTM</code> is a model for text, that was pretrained on the english wikipedia. But the IMDB reviews contains language that is not the same as used in the wikipedia. That’s why we need to add a new vocabulary, and retrain the model with new text.</p><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> language_model_learner<span class="token punctuation">(</span>data_lm<span class="token punctuation">,</span> AWD_LSTM<span class="token punctuation">,</span> drop_mult<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>skip_end<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551280626376.1b23179e.png" alt="1551280626376"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'fit-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551280644438"></p><p>Accurracy is not great, but it is enough to train our model, but guessing next word is not an easy task even for huma.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551280679602.b6982aff.png" alt="1551280679602"></p><p>We save our model, and our encoder in the new file.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'fit-tuned'</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save_encoder<span class="token punctuation">(</span><span class="token string">'fit-tuned-enc'</span><span class="token punctuation">)</span>
</code></pre></div><p>We can test our encoder on some predefined text.</p><div class="language-python extra-class"><pre class="language-python"><code>TEXT <span class="token operator">=</span> <span class="token string">&quot;I liked this movie because&quot;</span>
N_WORDS <span class="token operator">=</span> <span class="token number">40</span>
N_SENTENCES <span class="token operator">=</span> <span class="token number">2</span>

learn<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'fit-tuned'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>TEXT<span class="token punctuation">,</span> N_WORDS<span class="token punctuation">,</span> temperature<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N_SENTENCES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551281719408.c3f9f1ac.png" alt="1551281719408"></p><p>Next step is to use this learner as an encoder. This is now <code>TextClasDataBunch</code>, that try categorize our data.</p><div class="language-python extra-class"><pre class="language-python"><code>path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>IMDB<span class="token punctuation">)</span>

data_clas <span class="token operator">=</span> TextClasDataBunch<span class="token punctuation">.</span>load<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'tmp_clas'</span><span class="token punctuation">,</span> bs<span class="token operator">=</span>bs<span class="token punctuation">)</span>

<span class="token comment"># OR LONGER VERSION</span>

<span class="token comment"># data_clas = (TextList.from_folder(path, vocab=data_lm.vocab)</span>
<span class="token comment">#              #grab all the text files in path</span>
<span class="token comment">#              .split_by_folder(valid='test')</span>
<span class="token comment">#              #split by train and valid folder (that only keeps 'train' and 'test' so no need to filter)</span>
<span class="token comment">#              .label_from_folder(classes=['neg', 'pos'])</span>
<span class="token comment">#              #label them all with their folders</span>
<span class="token comment">#              .databunch(bs=bs))</span>

data_clas<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551281169972.7df744d6.png" alt="1551281169972"></p><p>Now we create a <code>text_classifier_learner</code>, that is used for text classification, based on the same model <code>AWD_LSTM</code>. The only difference is that we also add <code>load_encoder</code>. Encoder is used in <code>seq2seq</code><a href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html" target="_blank" title="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a>, by techinque called trasfer learning.</p><ul><li>The <code>encoder</code> is essentially tasked with creating a mathematical representation of the language based on the task for predicting the next word.</li><li>A <code>decoder</code> is responsible for taking that representation and applying it to some problem (e.g., predicting the next word, understanding sentiment, etc…) <a href="https://forums.fast.ai/t/what-is-an-encoder-and-what-is-save-load-encoder-actually-doing/8281/3" target="_blank" title="https://forums.fast.ai/t/what-is-an-encoder-and-what-is-save-load-encoder-actually-doing/8281/3" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>source</span></a></li></ul><p>We get our encoder that helps faster classify data, because it is used previously learned network.</p><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> text_classifier_learner<span class="token punctuation">(</span>data_clas<span class="token punctuation">,</span> AWD_LSTM<span class="token punctuation">,</span> drop_mult<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>load_encoder<span class="token punctuation">(</span><span class="token string">'fine_tuned_enc'</span><span class="token punctuation">)</span>
</code></pre></div><p>We freeze to last <code>-3</code> layers.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">5e</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.6</span><span class="token operator">**</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551281849210"></p><p>We now unfreeze our last two layers, and retrain a model.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>freeze_to<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.6</span><span class="token operator">**</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAT4AAABwCAYAAACHHRyYAAAQi0lEQVR4nO3df0gcd/7H8adpG2j/VmKo0nPhKHQDMR5FDIFAkC4xxD8utn/EP47jCIlo/HES758jf/Tun6/FUzeKhNI/7g/zR2sOskFliwSEIyIhGwNuuFJYWjTEZP2j/af9p8l8/5iZ3ZnZ2Z9ZjTqvB0jjzsxnPp/3fuY9n89npkmNYRgGHj/99BPvvvsuL1++9G4SEdkX3nrrLQ4dOkRNTQ1vv/22a5vrN8MwqKmp4eeff+bw4cO7WkkRkWp6+fJlZvD222+/cfjwYQ4dOgTAIXsnO+mJiBw0r1694tdff+XVq1eANeLzS3rpdHr3aycisoPeeecdjh49So3fGp+IyEF2SHlPRILEMIzsGp+ISFBoqisigaMRn4gEjhKfiASOEp+IBI4Sn4gEjhKfiASOEp+IBI4Sn4gEjk/iSxPrCxEK+fz0xaju/8GbYDrUQ2yrxN23YvSUs381PZp2xGKaRJ7dEjeKxKlAOem7Pa54Tz+qbhNExGIU9NCYarpi3HlWeC+nF7ErRlP0YYl7Fy6/vLJ20LM7xhVHPV/ErhhNvXeMF777NflvK1rOC+NO1HFcYspoapoy9kDrRQ4cTXVLkH6wSHzoEp315u915y8xvLDIimfkmfhmkGNDwxWWU0fn1U7q7J1PtDHMOptvYnQrcsBVkPgSTLumwNnpWuJGiNaBOIx3uaZqlUzh/MtyT43Td3sI3UiY00tHXZzn67nrnnS66+Kue+iG3wQ2zUo8zvCpFsdnLbQNxVl84Cj70TRd303w2ancdpjlllhOpp5fMuZIkiJSPWUmvgTToS7WJ1dJpVKkUilWJ9fpsta0Wq6mWJ2MwNAcqVSK3hMAaVZ+OMtqZv8IY18VXyv0L8vHeBcrp8yy54bG6AqFuM7nZv1uDxMf+DqT3NJ3e2iNO+uyTpdvsitXgukL60z83TFiq8RWjB4rKV/nc1JXW4ofIyJlKy/xPVphrGOCz89nL+98074s9xSu7uOzRBY22Kiouj6G5jJJseXUMDDMJbt+rumiNeL6i6Mu5y8xPL5CAjPRVppoEje6WJ/83Hd0Vla59Z3MWEn5c64XfIgiIpV7u/guWenNdfiwzTOqaaSxI87GMyDftOzRNKELY44PhrlUXj1Lc7SRSAc0+m7cYGMBxhZCjLk+jzCxBS0VTCmPNdSRvttD13cTrF6tfKx3rCH32LrzM8z9EOLLu58xc/61xpEi4lFW4qtrOAbxTdK0eJJfhMajeQ56NE3oq0ZWUynzmK0YPSerNt4rQyONHREm/j5T5rpZHQ0fwuJmGk7YrU6wMh6h8dM0K1/FYSFOa2jQdVRraJGJ+85zFSrntRomImUqb6p7oo3hhUGuOx4YpO9eZ5CztOVJJuYosSGTKNMPFolXWNnXU0dbBAb/6b++mP/hBrR8OgED1x0PVb5krOMsbfV1dE6lMuud9roiHROspsyk5yw3fznAVozpu56HJeMRzn6s0Z5ItZU14oMWelNzTIdaCQ1YH3VMsDrlWTcLdREah+HbKXodvwNEhoaJlHi2nLLyPeAouTxz+uganQ3NFV+Dq+9k5vYGoZMhBiGnzSUrVE59Aww44krEM2IUkWrR38AsIoGjF5hFJHCU+EQkcJT4RCRwlPhEJHCU+EQkcJT4RCRwlPhEJHCU+EQkcJT4RCRwlPhEJHCU+EQkcJT4RCRwlPhEJHCU+EQkcJT4RCRwlPhEJHCU+EQkcJT4RCRwlPhEJHCU+EQkcJT4RCRwlPhEJHCU+EQkcJT4RCRwlPhEJHCU+EQkcJT4RCRwlPhEJHCU+EQkcJT4HBI3QoRCPcS23nRNyvBomlAoROhGoqLD92WbS5Ym1hciFJomAYVjtRWjp0gcD3asgkWJbw9I3+157Qsq8rvG6lXogFOs5O03XQFJsxKPA5HKDj/RSyrVW9UaHViKlVj2xYjPnGLYP9a0xZ6a9PWY/w15pyH2NMdvG9lpj8+2xX9mj+u5m97BlqWJ9bUyuAAQZ/CkeT57StVj1X/6kT0qdLTHnpJZ7TDrabc5e6x9fMlccXFP/dx1sGLm2b+sc5UjZ5qaYDoUItQXI233BW8fyVOG/Z262nNykHilddprscrDfR25+7ZrW18MK0Lua+hGIieGhfuf2e5yzvs/K26ZfUpYgqiIscc9jDYZTU1TxkPDMIxnd4wrTU1GU/Rh9s/ebb13jBeZ464Yd54ZhmG8MO70On5PTBlNdjk552oyphLOY6zyd4ynbo56XIm98D3C1TarLea+nrI8MSlaljO+huGOk1/MSii/ejzfh6vdDr7x8DnG09YXsSu+fcJp/8SqGHdc3P3eu0+2XxqGkRt333h7yyrjvJ442d+Lf3mV2+MjvgQr4wBjdDnvyt9tkrlnDLXRAlDfxtkOYGGDDfu4jrO01QPU0RaJAHE2nkHiv2NAhIlPW3zOGaHxqPP3dTbfyGJ2hLMf17k+sUcRXeNgt8XfMRrqgfoGjoEVk+LSDxaJA8OnrLicaGMYzHgfbTQn4+Nd2RFVpvxBWnd80d/+Ds3vw/wOh7l03oqRPTK4MAZA/IfCLfa2te7js2UtNuztWOVnjrDsWcY6m1v2tTLBZyccO26tsLgADF2is77cswzTdsL9Scnnre/k0hCwsMjKlr0MlFve69rjic/SMcFqKkXK/pnqpK74UQeIOa1rHYCJ+ylWJytcD3wd9Z3MpFaZ6AD7RjT9qIXeVIq5IXBO1XeKmZziLD6ImReNddNL3DBvikyukro/UelqafXsgVjlsG4MXePDzGXqsTfP23JqGIiz+GCFjQWITH6G3xDldezxxNdIYwewMMjX9nrIVoyYc21kfMV6VeFr824y1EYLLbRl7hqQfYBg3jkaf2eO/ga/qfK6QUXqaPiwyC5bm6xD5u678UPZq1Gl1cQa9Yz9114/XGEMiETarBtNHZ1T2cS7vmleuC1XU6RuDwPFR1qvxRrVxwcGGcMebaXZ/A4yo79nGyWt1dU1HAOybbVHcKXa87HysuJiJhE7ZuB7jUF2hDr+pXt0ao1m7bqnN9ere17IjJ7N7zl35lMNezzx1dE5Zd45xy5kF6Hd3cWaBl8YM0eGV817Q8vVVSY6zDurOcSOMHG/lxag7vyM2SHHu/wffOyylk8niBQaBdjDf6u+X363Q2Oa+k5mbg9n43JhDIbmmDlf51qYbx2Im59/vJJ9qOCJ/86wp7uQnf7U0fmXYTL94Kv10kZ8J3rN0YfV1tZ4mc/V93ysPE58xkQHxAdaCYWus5jZ4HON9cVI00Jvao5h7GvIesDg6YvXi90tyj4vYA9cwLFcVV01hmEY1S92F2zF6Dk5SHxojtRudiAR2XnW9c3kqnkzqbI9PuKTasl5HWbHX9XZvxSrNy/xzSBx58OrKtMLzAFRd36G1Pk3XYv9QbF6gx5NW0/ms0tTO2H/TnVFRCqkqa6IBI4Sn4gEjhKfiASOEp+IBI4Sn4gEju/rLL/88stu10NEpCLvvfde2cdoxCcigaPEJyKBo8QnIoGjxCcigaPEJyKBo8QnIoGjxCcigaPEJyKBo8QnIoGjxJfH2kyYcPgma7t2xm3m/xomHDZ/Bha2/Xd7fDOzTzgcJjyzln9beID55+Vu829zbjzWuOkqbw/GyvZ8ngHf/dxtuPm42OeOI/36h3WevMeVEOfqKzVW+fcz2+rTLk97Mz9/nWfbZ7srHq5tjr5YbFuVKPHlMDtA99TunnVt5jQj8XZG7yVZ/qKdpWunfS+47acNzCaTJJPmfkx1Zzrp9tMnQH9mezI5ybkjFN72fJ6Bi1HomyWZXGY0EqXb7rjmkXnj0fDFslnWrX4gSvfM7lzKpcYKMJPNmRGWvJ8/n2cg3M0Tuw3JJJePg9nebqJWrJa/aCd60Xnx5YvHGjfPjLDUN5v5bpzHbS8MEL74hNF7dvwv01yVaBRWaqyc+yVv9bv3+2CU5WSSZHKWfiB60UraR84xmelPVn8E+v90jtqC8bC2RUZZTi4zGlli5Ix9Iyi0rXqU+DzWZk4z8vt++nf3rKxOAZFPaD0CtX/4hHYgej/3667tOJe5YGrf/wiApR83Kz7z9sNvWQL6TzYDtbS2t0N8hNtWp88fj2bOddSafzzeam7//ilFxl5VUHqszKT+hP6+9txS/jPCEv382W5D5phVvo0Dfa00Y5e/xMh/rMsyXzyeP+UJ0P5BA2B/N0vWP0a/xu1rS9D358yNaHeUGiv3fvb3Gf23eQNs7jiHGaVmWvsAnvA0ZxRmtTEyyoXjFI7H41WiQHt7K7V2nyPK6uMi26pIic+juSdJsqd1d09qdRJ+/77ZwY68z0dQNJGYo7hs59r8cQmI0u0zXSm0zc+Tp+b2kuLh6qw7rJxYHTnHZHKSCx94N2zz9HtwxqPo1NMqP288jrTySQSWrv2D+edr3LwYzUkCTHX7L1HslAr7VUZ8E/ct1ZMgnbx9oEA87H770ftmb7Fv4E+ebhfcVk1KfPvV45ucvrYEjlFLc4897VhmNNPpKLjN7ljmKGCb1aWcSWFe2wsD5kV8MUr/rSST3tHTnrXJZhzAmtrdG6XdnqrbyWFqlTWyI+Liajn3p35giZEz3e4ksLVplhExp4z2EkXe6fmua6AhAsS/ZfU5mSSWkVlz6ybaN0vyX+c8N7ht5v8dBdcIukA89gAlvn3IXC+KWheS31qRPUVY4tuH3julZ9vxy5kLMRw+zYj1D0Tbd9xCajsmzWR6b5QnFx2L2vuFPXJxJbtmLtuJMBy2bi5kR035PL5pfieONS3vepp94btvNntBLef+NUs/S4ycMW9kAEQaaADHWt4yo993+zyMcC8PACXF401S4tsLvFMQ7xTFyR7pRUZZzrnz5iqUwDLTCTuBZRao+2k9Xk79zWlN7tRoB5QTq7ysEY5XzoVujwbtNdD87CmavZ8rudU3kLvKmF2i2DFlxaqZy5kHFeZDjNwRWvamaa5dWqwRrbM9heLhnb46p7eFtlWTEt+eYC0aW1MNc3rVzugfm8m+WnGTtcyUop3Rv/lMNxbWMn82p6x2Aiu0zeH5PP+4tuS+c+fzeD5717fv+Hbi2FGlxqoQ+yGONbWzF+JzLvRt5v/PfAhS7EbgHcW5Lnx7vWtple3MtnY++cNOT/wqi9XaTDfRTP3WmM+sB9t9p52Gesf+96M57SkYD+vhiRkPq0x7PbTQtirSPyi+RzT3zNI/1c3ImTAA/beSPk8A7bUpc0oyYn/cN0uypwGWuglfsz9sZ/SeYxqcd9saN8Pd2TWdvlmSPaW8aLHprgP9zJYwAq2G0mJVWG3HJLM/hum229A3S9Jan1qbcb6u0s9sKa+eHL9M8haEL3YTto5t/2LZekXGnEpuhrs5HR6puM6VKDVW2wsD2Wk97Yzey74KtXnttKPvQP+tSUcZ9oOij3jfWW7BeDRz+VY/0YsjnA6DGePsk+P826rH9x8U1189LyL7hf7qeRGREijxiUjgKPGJSOAo8YlI4CjxiUjgKPGJSOAo8YlI4CjxiUjg+L7ALCJykGnEJyKBo8QnIoGjxCcigXNIS3wiEiSGYWjEJyLBc6impuZN10FEZFcdAnPoJyJy0BmGQU1Njd7jE5Hgca3xKQeKyEHkzW2uf3OjpqYms4PW/kRkv8uXz/4fe3JcS9oMLWMAAAAASUVORK5CYII=" alt="1551281895175"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>freeze_to<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">5e</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.6</span><span class="token operator">**</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551281913865"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.6</span><span class="token operator">**</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551281930937"></p><p>The last step is to predict on the example.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token string">&quot;I really loved that movie, it was awesome!&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551281976865"></p><h3 id="twitter-text-recognition"><a href="#twitter-text-recognition" aria-hidden="true" class="header-anchor">#</a> Twitter / Text recognition</h3><p>On the webpage you can check working example on the current twitter statuses <a href="https://klemenko.pl/twitter" target="_blank" rel="noopener noreferrer">https://klemenko.pl/twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p><p><img src="/assets/img/1551282519719.bca241b9.png" alt="1551282519719"></p><p>I am using my own prepared data based on the EmoInt(Shared Task on Emotion Intesity) <a href="http://saifmohammad.com/WebPages/EmotionIntensity-SharedTask.html" target="_blank" rel="noopener noreferrer">http://saifmohammad.com/WebPages/EmotionIntensity-SharedTask.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a href="./twitter.csv" target="_blank" title="./twitter.csv" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>download</span></a> . This data contains categorized text on real source. These emotions are <code>[anger,fear,joy,sadness]</code>.</p><p><img src="/assets/img/1551282811689.a5651809.png" alt="1551282811689"></p><p><img src="/assets/img/1551282849287.67ed8223.png" alt="1551282849287"></p><p>First we look to our data:</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

path <span class="token operator">=</span> <span class="token string">'./textdata'</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">'twitter.csv'</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> <span class="token builtin">file</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Style'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551282940905.a5c073a3.png" alt="1551282940905"></p><p><img src="data:image/png;base64,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" alt="1551282958641"></p><p>Because we don’t have vocabs, we need to create one, and save labels.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>text <span class="token keyword">import</span> <span class="token operator">*</span>

data_lm <span class="token operator">=</span> TextLMDataBunch<span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span><span class="token builtin">file</span><span class="token punctuation">,</span>text_cols<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">,</span>label_cols<span class="token operator">=</span><span class="token string">'Style'</span><span class="token punctuation">)</span>
data_lm<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'labels'</span><span class="token punctuation">)</span>
</code></pre></div><p>We prepare learner like in the IMDB database.</p><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> language_model_learner<span class="token punctuation">(</span>data_lm<span class="token punctuation">,</span> AWD_LSTM<span class="token punctuation">,</span> drop_mult<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>skip_end<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551283064635.d55ad3e5.png" alt="1551283064635"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551283091608.34ae590a.png" alt="1551283091608"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551283128284"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551283164603.44f04b0f.png" alt="1551283164603"></p><p>Now we save our model and encoder.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'fit-03'</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save_encoder<span class="token punctuation">(</span><span class="token string">'fine_tuned_enc'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="classifier"><a href="#classifier" aria-hidden="true" class="header-anchor">#</a> Classifier</h4><p>After we save our encoder, we can move to the classifier. When we load <code>TextClasDataBunch</code>, it is required to have <code>vocab</code>, for <code>imdb</code> it was already ther, but now, we can use <code>TextLMDataBunch</code> vocab loaded previously.</p><div class="language-python extra-class"><pre class="language-python"><code>data_clas <span class="token operator">=</span> TextClasDataBunch<span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span><span class="token builtin">file</span><span class="token punctuation">,</span>
                                       text_cols<span class="token operator">=</span>text_col<span class="token punctuation">,</span>
                                       label_cols<span class="token operator">=</span>label_col<span class="token punctuation">,</span>
                                       vocab<span class="token operator">=</span>data_lm<span class="token punctuation">.</span>vocab<span class="token punctuation">)</span>

data_clas<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551283410731.7d62fcb6.png" alt="1551283410731"></p><p>We now create text classifier and learn to predict them emotions, using saved previously <code>encoder</code>.</p><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> text_classifier_learner<span class="token punctuation">(</span>data_clas<span class="token punctuation">,</span> AWD_LSTM<span class="token punctuation">,</span> drop_mult<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>load_encoder<span class="token punctuation">(</span><span class="token string">'fine_tuned_enc'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551283502675.9de44bb6.png" alt="1551283502675"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'text-01'</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>freeze_to<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.6</span><span class="token operator">**</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.6</span><span class="token operator">**</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.6</span><span class="token operator">**</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> moms<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>The first hit wasn’t so sucecsfull, but after a lot of training I end up with the <code>0.79</code> accuracy.</p><p><img src="data:image/png;base64,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" alt="1551283588598"></p><p><img src="data:image/png;base64,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" alt="1551283639923"></p><p>Now you can predict some text.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token string">&quot;You are a lovely boy&quot;</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token string">&quot;More evidence Trump relies on Putin's advice as much or more than US intelligence—a violation of his&quot;</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'text-02	'</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>export<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551283694281"></p><p><img src="data:image/png;base64,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" alt="1551283703083"></p><h4 id="twitter-implementation"><a href="#twitter-implementation" aria-hidden="true" class="header-anchor">#</a> Twitter Implementation</h4><p>Install your twitter library.</p><div class="language-python extra-class"><pre class="language-python"><code>!pip install python<span class="token operator">-</span>twitter
</code></pre></div><p>For twitter you need to have a valid phone, with active account. On the webpage <a href="https://developer.twitter.com/en/apps" target="_blank" rel="noopener noreferrer">https://developer.twitter.com/en/apps<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, you can create a new app, and on the <code>Keys and tokens</code> you will have 4 values for your keys that you need to write in your project.</p><p><img src="/assets/img/1551284072912.cff8ef12.png" alt="1551284072912"></p><p>You can now write your</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> twitter

api <span class="token operator">=</span> twitter<span class="token punctuation">.</span>Api<span class="token punctuation">(</span>consumer_key<span class="token operator">=</span><span class="token string">'XXX'</span><span class="token punctuation">,</span>
                      consumer_secret<span class="token operator">=</span><span class="token string">'XXX'</span><span class="token punctuation">,</span>
                      access_token_key<span class="token operator">=</span><span class="token string">'XXX'</span><span class="token punctuation">,</span>
                      access_token_secret<span class="token operator">=</span><span class="token string">'XXX'</span><span class="token punctuation">)</span>

api<span class="token punctuation">.</span>VerifyCredentials<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><p><img src="data:image/png;base64,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" alt="1551284213322"></p><div class="language-python extra-class"><pre class="language-python"><code>api<span class="token punctuation">.</span>GetFriends<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551284243248.a0a51e9a.png" alt="1551284243248"></p><div class="language-python extra-class"><pre class="language-python"><code>api<span class="token punctuation">.</span>GetSearch<span class="token punctuation">(</span><span class="token string">'obama'</span><span class="token punctuation">,</span>count<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>lang<span class="token operator">=</span><span class="token string">'en'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551284663961.17185efb.png" alt="1551284663961"></p><p>We can now define <code>predict</code>function, and <code>get_tweets</code>function to return data.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>text <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment">#learn_tweets = load_learner('textdata'); # !! YOUR FOLDER OF THE MODEL!!</span>

<span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    
predict<span class="token punctuation">(</span><span class="token string">'some text'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAAAlCAYAAACjxNxUAAADf0lEQVR4nO2bQUgbQRSG/5UaBEFQkKZSqdlLKXrRS21A60EaWjF48FIsRZBCJC1VpMVT9dgWRGsScvCgFS+FHppULQFBEbR4SKQYFUFSQ0Vtggoeinh5PbiJm+0GY7IbM3Y+WMjMm5n9k5/Mm1l2BCIiKIhVCYKgDOUk4XD4siXoQkFBAQwGA/Lz81FYWJjghyA3joiYMet/Q+lNXrIAJ7cQBAHyyTEP4Kaxgtw8QS3HcXKfPO4bexDRWY7jsAWfKhmF/+MYhRvHKNw4RuHGMQo3jlG4cYzCjWOUq2/csgui2Anvnno44BAhitLlCOguJ+AQIT73IprhONfS7hmdwmL3O5xIxaLeedRUpdAv6MLc209SoRbXB9/jTmnaKs7nRjksCKrHll1o3RjCUsgKPSXIKa+wABuZj5O+cQDQ6EZDe6VK4ADr/S34vanSrsqOhgk7ACA89hp/MhKQGdHtIHD7XtZM0xRKl8gkLYwGVQL7tNZXRwu+/XjNge8V+Vf+bbk1+orWImqDB8nfVkezfZN0kLbA5ES8NjKZTIrLRp7dWAs/OWUxm1cmctdDNnk/u4ci8pjdQ37Z+Al9NUR741acKf/gSY2LTNJCWx3NtjlpK22B5xPx2sg07FfWkscuN1FZTsQ/bCJnQCpIpsbN2vWQzeQk5R20ILOpUoXDnTAM5sc4GqvHj5nTOsPTLzA/KEl9kNImmCeatJaWGnvf8W3aB9+0iC5ZdU8HACMABOASWzEgi1kqokB1bMLtwbNm6bPRCndIH5maGwcAJ+Mt2O+dR0M7EMt3gbIUFy+5wKMhLDnVFywBRysGuj8j9KJGKosYya46ADpsB4rLbgGNbplJJTCaa3G8c6D1rfTBeBNV011481VtwR7F9gZgqSg/Le55MTKYVXVxtN/HVTWgaOYj1uPfexU/x4Hi6gtMlVhF4Ek95vqncKi5wPOogX1xCHh592x/J7pwusMrhbWjB75YzPwLDz9Ysq4Q0GWqrETN4H0sdtdjTqop6p2/2F4tuoVjANjcwhGAYs01nlLa7IZqCjJa4Q5Z1TtV2xEK2ROq4i11zGlKdMlxGS8uLnNxwgiZGTfTiTlp5Zj2kxPuT1rwd04Y5eo/ZL6icOMYhb8QyyDEX4hllzx+2INN4qd1OGxA0skqvh1glIQcxz3MXZTeJDw5STg4x3NfTpDMj785rQ3CRzDMbgAAAABJRU5ErkJggg==" alt="1551284560815"></p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_tweets</span><span class="token punctuation">(</span>search<span class="token punctuation">)</span><span class="token punctuation">:</span>
    text <span class="token operator">=</span> api<span class="token punctuation">.</span>GetSearch<span class="token punctuation">(</span>search<span class="token punctuation">,</span>count<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>lang<span class="token operator">=</span><span class="token string">'en'</span><span class="token punctuation">)</span>
    textDict <span class="token operator">=</span> <span class="token punctuation">[</span>t<span class="token punctuation">.</span>AsDict<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> text<span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>predict<span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'screen_name'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> textDict<span class="token punctuation">]</span>

get_tweets<span class="token punctuation">(</span><span class="token string">'obama'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551284806471.6fdb7e49.png" alt="1551284806471"></p><h3 id="tabular-data-2"><a href="#tabular-data-2" aria-hidden="true" class="header-anchor">#</a> Tabular Data</h3><p>For learning we can also use our DataFrame as a source, to predict values based on columns instead of images or text. This is categorization problem with we predict if the person ear <code>less than 50k</code> or <code>more or equal 50,000</code> dolars, based on his status, occuppation etc...</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>tabular <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>ADULT_SAMPLE<span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'adult.csv'</span><span class="token punctuation">)</span>

dep_var <span class="token operator">=</span> <span class="token string">'salary'</span>
cat_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'workclass'</span><span class="token punctuation">,</span> <span class="token string">'education'</span><span class="token punctuation">,</span> <span class="token string">'marital-status'</span><span class="token punctuation">,</span> <span class="token string">'occupation'</span><span class="token punctuation">,</span> <span class="token string">'relationship'</span><span class="token punctuation">,</span> <span class="token string">'race'</span><span class="token punctuation">]</span>
cont_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'fnlwgt'</span><span class="token punctuation">,</span> <span class="token string">'education-num'</span><span class="token punctuation">]</span>
procs <span class="token operator">=</span> <span class="token punctuation">[</span>FillMissing<span class="token punctuation">,</span> Categorify<span class="token punctuation">,</span> Normalize<span class="token punctuation">]</span>
</code></pre></div><p>We prepare <code>test</code> data, and <code>data</code> to learn. We need define <code>cat_names</code> for categorical data, <code>cont_names</code> for number values, and <code>procs</code> to prepare our data before learn.</p><ul><li><code>FillMissing</code> - Fill missing Values</li><li><code>Categorify</code> - Transform the categorical variables to that type.</li><li><code>Normalize</code> - Normalize number values</li></ul><p>We also <code>add_test</code></p><div class="language-python extra-class"><pre class="language-python"><code>test <span class="token operator">=</span> TabularList<span class="token punctuation">.</span>from_df<span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">800</span><span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                           path<span class="token operator">=</span>path<span class="token punctuation">,</span> 
                           cat_names<span class="token operator">=</span>cat_names<span class="token punctuation">,</span> 
                           cont_names<span class="token operator">=</span>cont_names<span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>TabularList<span class="token punctuation">.</span>from_df<span class="token punctuation">(</span>df<span class="token punctuation">,</span> path<span class="token operator">=</span>path<span class="token punctuation">,</span> 
                            cat_names<span class="token operator">=</span>cat_names<span class="token punctuation">,</span> 
                            cont_names<span class="token operator">=</span>cont_names<span class="token punctuation">,</span> 
                            procs<span class="token operator">=</span>procs<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span>split_by_idx<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                           <span class="token punctuation">.</span>label_from_df<span class="token punctuation">(</span>cols<span class="token operator">=</span>dep_var<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span>add_test<span class="token punctuation">(</span>test<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551285333505.ffd23237.png" alt="1551285333505"></p><p>Now we prepare <code>tabular_learner</code>.  We need specify matrices and layers. This will create two <code>BatchNorm1D</code> layers, one with the size <code>200</code>, and one with the size <code>100</code>, between each layer there is <code>ReLU</code> activation function, nad last is <code>Linear layer.</code></p><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> tabular_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> layers<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span>accuracy<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>model
</code></pre></div><p><img src="/assets/img/1551285643382.0263f6ca.png" alt="1551285643382"></p><p>We can fit the value, and predict some value.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
row <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>row<span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551285779712"></p><p><img src="data:image/png;base64,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" alt="1551285767498"></p><h3 id="collaborative-matrix-predict-movie-score-for-the-user"><a href="#collaborative-matrix-predict-movie-score-for-the-user" aria-hidden="true" class="header-anchor">#</a> Collaborative Matrix / Predict movie score for the user</h3><p>If we have list of users and score for movies, we can show this as a 2D matrix (two dimensional tensor). When on rows we will have users, and on columns will have movies. Of course there is some missing points. Some users doesn’t set a score for a movie. That’s why we can fill missing values.</p><p><img src="/assets/img/1551885030551.4f865baf.png" alt="1551885030551"></p><p>It can be done by  <code>Embedding matrices</code>. As <code>parameters</code> (weigths as yellow cells and bias as blue cells), we can find a prediction for missing movie scores (orange cells).  The width of the matrix is called <code>n_factors</code> - how big is the matrix to calculate result (in the example 4). On  the output you can find missing values.</p><p><img src="/assets/img/1551948571334.e19e4b0c.png" alt="1551948571334"></p><h4 id="implement-in-fast-ai"><a href="#implement-in-fast-ai" aria-hidden="true" class="header-anchor">#</a> Implement in fast.ai</h4><p>The data for movies can be downloaded from the MovieLens dataset: <a href="http://files.grouplens.org/datasets/movielens/ml-100k.zip" target="_blank" rel="noopener noreferrer">http://files.grouplens.org/datasets/movielens/ml-100k.zip<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. When we extract the data we found a lot of files. For our purpose we need only <code>u.data</code> that contain ratings, and <code>u.item</code> that contains titles for movies.</p><p><img src="/assets/img/1551889081731.f288a150.png" alt="1551889081731"></p><ul><li>Becaise there is no header, and delimiter for <code>csv</code> is unusual a <code>tab</code> instead of semicolon, we need to define columns, and delimeer for data.</li></ul><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>collab <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>tabular <span class="token keyword">import</span> <span class="token operator">*</span>

path<span class="token operator">=</span>Config<span class="token punctuation">.</span>data_path<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">'ml-100k'</span>

user<span class="token punctuation">,</span>item<span class="token punctuation">,</span>title <span class="token operator">=</span> <span class="token string">'userId'</span><span class="token punctuation">,</span><span class="token string">'movieId'</span><span class="token punctuation">,</span><span class="token string">'title'</span>
ratings <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'u.data'</span><span class="token punctuation">,</span> 
                      delimiter<span class="token operator">=</span><span class="token string">'\t'</span><span class="token punctuation">,</span> 
                      header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                      names<span class="token operator">=</span><span class="token punctuation">[</span>user<span class="token punctuation">,</span> item<span class="token punctuation">,</span><span class="token string">'rating'</span><span class="token punctuation">,</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

ratings<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551889251429"></p><div class="language-python extra-class"><pre class="language-python"><code>movies <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'u.item'</span><span class="token punctuation">,</span>  
                     delimiter<span class="token operator">=</span><span class="token string">'|'</span><span class="token punctuation">,</span> 
                     encoding<span class="token operator">=</span><span class="token string">'latin-1'</span><span class="token punctuation">,</span>
                     header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                     names<span class="token operator">=</span><span class="token punctuation">[</span>item<span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'date'</span><span class="token punctuation">,</span> <span class="token string">'N'</span><span class="token punctuation">,</span> <span class="token string">'url'</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">[</span>f<span class="token string">'g{i}'</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
movies<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>delimiter now is <code>|</code>, and encoding is <code>latin-2</code>, because there are also 19 columns that is not important for us (the <code>genre</code> of the movie), we define them as a list of <code>g*</code> columns</li><li><code>*[f'g{i}' for i in range(19)]</code> - star <code>*</code> means that we don’t add the array  but values of the array to the array <code>names</code></li></ul><p><img src="/assets/img/1551889563326.34cfad6f.png" alt="1551889563326"></p><p>We can now combine ratings and movies. This is done by column <code>movieId</code></p><div class="language-python extra-class"><pre class="language-python"><code>rating_movie <span class="token operator">=</span> ratings<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>movies<span class="token punctuation">[</span><span class="token punctuation">[</span>item<span class="token punctuation">,</span> title<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
rating_movie<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551889619310.97b172c6.png" alt="1551889619310"></p><p>We can now create DataBunch for movies, and users.</p><ul><li><code>seed</code> -parameter for split_by_random_pct, <code>seed</code> value for generate random values</li><li><code>pct_val</code> - number of validation set</li><li><code>item_name</code> - name show in the output batch.</li></ul><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> CollabDataBunch<span class="token punctuation">.</span>from_df<span class="token punctuation">(</span>rating_movie<span class="token punctuation">,</span> 
                               seed<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span> 
                               valid_pct<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>  <span class="token comment">#changed in the new version</span>
                               item_name<span class="token operator">=</span>title<span class="token punctuation">)</span>
data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551889983434.d0f979f7.png" alt="1551889983434"></p><p>Now we can create <code>collab_learner</code> for collaborative matrix.</p><ul><li><code>n_factors</code> - size of the embedding matrix</li><li><code>y_range</code> - range of the score. It is better to setup little more than maximum (<code>5.5</code>), because in the <code>sigmoid</code> activation the output never touch maximum value, and sometimes it happens that user score a movie as a <code>5</code>.</li></ul><div class="language-python extra-class"><pre class="language-python"><code>y_range <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5.5</span><span class="token punctuation">]</span>

learn <span class="token operator">=</span> collab_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> n_factors<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span> y_range<span class="token operator">=</span>y_range<span class="token punctuation">,</span> wd<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>model

learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>skip_end<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551890251264"></p><p><img src="/assets/img/1551890204073.5bf91b0f.png" alt="1551890204073"></p><p>We now fit our model</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'dotprod'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551890223039"></p><h4 id="predict-2"><a href="#predict-2" aria-hidden="true" class="header-anchor">#</a> Predict</h4><p>You can now predict your model based on <code>userId</code> and <code>title</code>:</p><div class="language-py extra-class"><pre class="language-text"><code>learn.predict({'userId': 196, 'title': 'Philadelphia (1993)'	})
</code></pre></div><p>If you got error: <code>RuntimeError: Expected object of backend CPU but got backend CUDA for argument #3 'index'</code>, just put <code>learn.model.cuda()</code> before predict.</p><p><img src="data:image/png;base64,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" alt="1554545660312"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>model<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'userId'</span><span class="token punctuation">:</span> <span class="token number">196</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">:</span> <span class="token string">'Philadelphia (1993)'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAicAAAAfCAYAAAA85m00AAAM5ElEQVR4nO2dTWgb1xbH/06fLSpFyE1sGZppkPGiktXErogQlArHZtpiokJB3ZgJaaBQ6hCYQtKVU/oCdRdJCxYtUeiiNCYm0NrQGpngoFg1ThZGQVES5LgLU1FPFvqoa9WWF/VCb+E3U2k0+v6y4/PbGM9czT137n90z5xz71VTKpVKIY27d+/iyZMnCAaDePDgAQiCIAiCIKrNiRMnYDKZ8Oqrr2JwcBAqlUo61yQ6J/F4HJcuXcK9e/caZihBEARBEPsPg8GAb775Bp2dnQD+75w8e/YMTqcTm5ubDTaPIAiCIIj9iEqlwvfff4+enp4d5+Ts2bOUwiEIgiAIoqEYDAZMTU3hBZvN9t8bN2402h6CIAiCIPY56+vrUKvVOOD3+xttC0EQBEEQBADgwYMHOPD48eNG20EQBEEQBAEACAaDaDKbzanCRQmCIAiCIOrDgUYbQBAEQRAEkQ45JzWEYRiMjIyAYZhGm0IQ+wqO48BxXKPNqDo6nQ6ffvopLBZLo03ZU+xnPezVtv+n0QY8rzAMg+HhYSwtLUEQBOk4x3GwWq0ZZWOxGL799lskEglYLBYMDQ2hubkZAODxeOD1eutqO8/z0kY4IslkEm63O6MtjUR+n7a3t3Hr1i0EAoGiPs+yLBwOR9Zx8ToAMq6fjtgnxdog1vX777/D5XJlnJPfa3kZUUcajUbxPJENx3Ho7u6G2+2WjsnvI1DasyXv63Q8Hg/8fj/Onz+P9vb2rPNinxVrg1gOQNYzl0gk8PDhQzidTkSj0V3zPO5m9rse5ufnMTw8DJZl6z6WVELd55y43W4cPXpU+j8YDGJkZKSqdYyOjqK3t1f6/48//pA6t17wPA8AWQMJx3EwGAySM5ILUZA+n68mgirGjnxlLBYL3n//fUxOThbtENSSYu9rPliWRX9/f04nrFCblWzgeR4tLS1oaWnB5uZmXsdCqc95nkcoFILX681weCcmJspqYy5y6XWvUawuC/V1NerS6XQ4f/48wuGwYn8p2SAeW11dxSuvvJLTPp7ncfDgwYr0ng/SQ/XraqQeWJbFO++8U9ILXKNpSFrnzp07OHXqFE6dOpXhmPT09GB8fBwzMzOYmZnB5OQkBgYGsj4vL/fLL7/g9OnT0vmRkRHp+nfu3KlLm9KxWCzo6OjAwsJC3ever0QiEajVami12rI+r9PpYLPZsiJd6djtdkQikZwPt9wGlmURj8fx3XffFWXDxsYGtra20NHRIR1zuVySoyIIApaWlmAwGKDT6Upp3r6hUB+JrK2toampCXq9vmZ1Wa1WqNVqzM/PF2UDwzAwm824cuUKNjY28tY9NTUFtVqdFYUlMiE97OD1eiEIAux2ewktaiy7Jq0zMDCAc+fO4bfffsOZM2cA7ERAzp07BwCYm5sDsOOYXLhwAclkUip3+vRp9Pf348mTJ3j06FFjGpCGyWQq6oEoF3lKQh7qFz10MaSYnm6Qp5UuX76cVSYf8nDmmTNnpH7w+/3SG4G8XPo5juPw8ssvo6WlBe3t7bh37x5ef/11tLS0lO3Zm83misLcVqsVra2tePr0qeJ5i8UChmEwOztbtA2iU1GsI9HV1QWNRpPThlogTyuNjY0ByE7jpZeTn+M4Dm1tbYjH45K25JqU60F+DXmIO1cdoVBI0r5SCuyll17C9PR0wXabTCYkk0msrKyUesuk9uTTg+js5tOk3AZBEIqOVAiCgGg0CrPZXNXIKunh+dVDKBRCf38/GIbZE+nAXeOczM3NSQ6IyI8//ogLFy7g2LFj0rmTJ08CAK5fvy6Vu3nzJm7evFlWvWIKqFrpJZ1OB4PBgHA4XPG1lBDDc+Pj4wgEApIjwvO8JOS33noLt2/flgZ5nucxODiIlZUVTExMYGJiouw0SCAQQCAQyBvCFL94ZmdnM9IRHMdJDsqRI0fg8XhgNpths9nw888/4+TJkzCZTGXNGxHn7ZSL2WyGIAg56zaZTFhfX4d808JKbZA7kh6PJ6cNDMOgu7sbS0tLVQvli5rJF8YXQ8aff/45EokEOI7D8PBwxmAhDlSffPKJ1P9ijpthGDidTkkPSu2Sp6ty1aHX6/HVV18BQFYe3Wg0orm5GdFoVLGt6QOiONiVex9z6UFEdDRv375dMxtCoRBsNht0Oh3pAaSHQnpYXl7Gm2++Cb1eT85JpRw+fBhqtTrjmNFoxOrqatUiJIcOHcr4WylarRZqtRqRSCRnmfb2diliAZQ2yVE+iCYSCSwuLmZ4xJOTkxmfET1mrVZbk/y0HJPJBEEQ8qYjYrEY/H6/1J779+/jxIkTJdXj9XqlOliWxaVLl8qKvIhpOPl9ExGdAp/Pl3X/KrUhkUhgdHQUwL+OitlsVtSD0+kEgJxh4VqQ/vYptn1+fh7d3d0wGo3Sl1wsFsMPP/wAAFhZWcH6+npGegpAzrc6o9EoXVdEqY70t2edTpeVAuvo6MDW1lbOELjoWAM7fc7zfM4BstA9yaUHkVwh/mrZICKmEevxXAOkh1z3ZK/oobm5uWpjXa3Z1c7JsWPHsLW1hV9//RXATkpHo9EgHA5jfHwchw8fBgD8+eef+Prrr8tyWNbW1nD06FGsra1V1fZ8pK/OKQWdToeDBw9mRWXSc5WCICjOJE8mk1WxvRja2trQ2dkphYRFYrFYzer0+/2w2WwlRV5ECuWK+/r6sLW1lfOtqBo2AMqOpgjP82AYBrdu3arrW49er4dGo8lI35WKIAhwu90YHh6WNJGe5lMaRJTm36SXSXfqyiEQCMBut5eVFimkh0LObjVsaBSkh2z2sx5qya51TgYGBmC327GwsJDldLzxxhv46aefpFSO2+3Gxx9/XNaKnGqvFFJ6iKpFIpHA5uYm2traMo4fOnQIqVQK0WhUCpkGg0HpYRdnfNeLeDwOoDEz/fNFrJQolCsuJ5VSqg1y5F/MHMdJjkm9Z9pHo1Ekk0lMT09XVLcgCNKzJjrPkUgEXq8XkUgE3d3dGW98xUQg5ShdpxCiVoulGD3Y7faS5i+UakM6+SIDtYD0kMle08P29nZdX8QrYVduwpY+OVZpgJubm8uYY3L//n20trYqruypN4lEAuFwuGYrKkKhEBiGkTbdYRgG/f390ioTvV6PlpYW6SEWz8uJRCJobW1FV1dXWXZEo1GkUimYTKasc0+fPgXDMGBZtqxrl4PD4YBarcby8nLGcY7jMDY2JuXQ5RTKFSuFmEu1oVjEvgqHw9IXHcuysFqtmJ2dzTsY8DyPsbGxsu95PB6HXq/P2jBQEAT89ddfGBwcrJqeo9Eo/vnnH+l/8X719fVJx5xOZ1HRqnTE64h9lg+WZcEwTNbkY4vFgqtXr2J0dFRx88RCemAYBnq9HouLiwUHxFw2FIvZbMbm5qZiPaQH0oOSrfnm4Ow2dl3kJN0xkUc1Hj16hNXV1aLEVizVnhAL7AzOZrMZXV1dJb9dyFfTOBwOOBwOKezp9XrR0dGRc5VMIBCAyWSSPre9vY3FxUW89tprGfV4vV6YzWbpOumrdeQz9i9fvpw1W14QBPh8PjgcDsle0Q6xzUNDQxmritLtrBT5fYrFYrhy5UpJqTKLxYLe3l7Mzs4qfk7u+JVqgzy91t7ejrGxMSmtp9Vq827ClO5Yiv2pVA7YcVo7Ozths9ng9/tLThl6PB4YDAZcvHgRQGY+3+Vygef5jHlSpWzKp5Rm9Pv9GXOSpqamMDQ0JN3PclKf+VYsyFe4JZNJuFyuklJkhfQA5B9EC9kgnxwNABcvXlRcSScOej6fT9EO0gPpQU6lKxrrTUM2YVteXlaMiORzTORlFhYW4HK5pKXFq6urip/heR5GozFnykfcFK7aG7XVepMkgkhHXOEQjUb3/MZZlSBfKfa8UmiTNNLDDqSHHaqxyVy92TVpnZ6eHpw9exYvvvgient7pQ3WZmZmMD4+jp6eHgA7KZ1r167BbrdjZmYGX375ZU7HpBjE/Fu183DipjhKW6QTRLXp6+uDRqNBKBRqtCkNJRAIIBgMSpOKn0dYloVer8fU1FTOMqSHHUgP/0Z4fD7fnnFMgF0WOakFhSIntYRhGHzwwQe4cePGnhIFsXcQ35Ar2cDueUT8obNqb/PfaHQ6HT766CPcvXtXsa9JD8rsVz0Ae7ft9Ns6BEEQBEHsKprefvvt1LNnzxptB0EQBEEQBFQqFQ4cP3680XYQBEEQBEEA2Fn2TM4JQRAEQRC7huPHj6Pp77//Tr377rsV7UpHEARBEARRKSqVCtPT0zig1Wpx9erVRttDEARBEMQ+57PPPsORI0d29jmxWq24fv161m+2EARBEARB1BqVSoUvvvgC7733HgCgKZVKSUuJNzY2cO3aNTx+/LisX/glCIIgCIIoFqPRCKPRiA8//DDjZ1P+Byd9XYjh9+pEAAAAAElFTkSuQmCC" alt="1554545743870"></p><h4 id="bias"><a href="#bias" aria-hidden="true" class="header-anchor">#</a> Bias</h4><p>Bias for movie can define the total score. Let’s</p><ul><li>define the top 1000 movies by the score.</li></ul><div class="language-python extra-class"><pre class="language-python"><code>g <span class="token operator">=</span> rating_movie<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'rating'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span> 
top_movies <span class="token operator">=</span> g<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">]</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1551890952660"></p><ul><li>Get bias for each movie in the array. <code>is_item</code> means that it will be looking by the <strong>item name</strong> instead of user id. <code>mean_ratings</code> are real values for ratings, and <code>movie_ratings</code> are ratings defined from the <code>movie_bias</code> array.</li></ul><div class="language-python extra-class"><pre class="language-python"><code>movie_bias <span class="token operator">=</span> learn<span class="token punctuation">.</span>bias<span class="token punctuation">(</span>top_movies<span class="token punctuation">,</span> is_item<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
mean_ratings <span class="token operator">=</span> rating_movie<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'rating'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
movie_ratings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> i<span class="token punctuation">,</span> mean_ratings<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span>b <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>top_movies<span class="token punctuation">,</span>movie_bias<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token builtin">sorted</span><span class="token punctuation">(</span>movie_ratings<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> o<span class="token punctuation">:</span> o<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">]</span>
</code></pre></div><p><img src="/assets/img/1551891196592.44c1e4d9.png" alt="1551891196592"></p><ul><li>The result is similar to the real values, but this is unbiased value of how movie is good.</li><li><code>user bias</code> we can interpret as overall how this user rate movies</li></ul><blockquote><p>movie bias numbers as a way of saying what are the best movies or what do people really like as movies even if those people don't rate movies very highly or even if that movie doesn't have the kind of features that people tend to rate highly. (jeremy howard)</p></blockquote><h4 id="movie-weights"><a href="#movie-weights" aria-hidden="true" class="header-anchor">#</a> Movie weights</h4><ul><li>We can get weights and squeeze them into 3 factors, by using pca.This will reduce number of columns</li></ul><div class="language-python extra-class"><pre class="language-python"><code>movie_w <span class="token operator">=</span> learn<span class="token punctuation">.</span>weight<span class="token punctuation">(</span>top_movies<span class="token punctuation">,</span> is_item<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
movie_pca <span class="token operator">=</span> movie_w<span class="token punctuation">.</span>pca<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
fac0<span class="token punctuation">,</span>fac1<span class="token punctuation">,</span>fac2 <span class="token operator">=</span> movie_pca<span class="token punctuation">.</span>t<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>pca can define hidden meaning of weights and define a 3 different approches that is get to the output.</li><li><code>fac0</code> - define the one factor on movies that on top are <code>classic</code> movies, and on the bottom are also popular movies, but not defined as a classic one. We can call this division as a <code>connoisseur level</code></li></ul><div class="language-python extra-class"><pre class="language-python"><code>movies_fac0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> f<span class="token punctuation">,</span>i <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>fac0<span class="token punctuation">,</span> top_movies<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span> 
    <span class="token operator">*</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>movies_fac0<span class="token punctuation">,</span> key<span class="token operator">=</span>itemgetter<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>movies_fac0<span class="token punctuation">,</span> key<span class="token operator">=</span>itemgetter<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
</code></pre></div><p><img src="/assets/img/1551892475753.d14057f5.png" alt="1551892475753"></p><ul><li><code>fac1</code> - We can define them as a great hits on the top, and on bottom some disutopian movies or more brutal that are not for everewhyone.</li></ul><div class="language-python extra-class"><pre class="language-python"><code>movies_fac1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> f<span class="token punctuation">,</span>i <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>fac1<span class="token punctuation">,</span> top_movies<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span> 
    <span class="token operator">*</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>movies_fac1<span class="token punctuation">,</span> key<span class="token operator">=</span>itemgetter<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>movies_fac1<span class="token punctuation">,</span> key<span class="token operator">=</span>itemgetter<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
</code></pre></div><p><img src="/assets/img/1551892653296.016b81fd.png" alt="1551892653296"></p><ul><li><code>fac2</code> 0 The same for</li></ul><div class="language-python extra-class"><pre class="language-python"><code>movies_fac2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> f<span class="token punctuation">,</span>i <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>fac2<span class="token punctuation">,</span> top_movies<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span> 
    <span class="token operator">*</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>movies_fac2<span class="token punctuation">,</span> key<span class="token operator">=</span>itemgetter<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>movies_fac2<span class="token punctuation">,</span> key<span class="token operator">=</span>itemgetter<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
</code></pre></div><p><img src="/assets/img/1551893011316.6d4c5789.png" alt="1551893011316"></p><ul><li>We can plot pca <code>fac0</code> and <code>fac2</code> together on one plot. (the color is random)</li></ul><div class="language-python extra-class"><pre class="language-python"><code>idxs <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>top_movies<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
idxs <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> fac0<span class="token punctuation">[</span>idxs<span class="token punctuation">]</span>
Y <span class="token operator">=</span> fac2<span class="token punctuation">[</span>idxs<span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>

<span class="token keyword">for</span>  i<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>top_movies<span class="token punctuation">[</span>idxs<span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>i<span class="token punctuation">,</span> color<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0.7</span><span class="token operator">*</span><span class="token number">0.7</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1551893767396.aab33e6f.png" alt="1551893767396"></p></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/40.aee014e6.js" defer></script><script src="/assets/js/73.087e681b.js" defer></script><script src="/assets/js/61.c7f5657d.js" defer></script><script src="/assets/js/65.4dceeb43.js" defer></script><script src="/assets/js/63.e1ab2c6b.js" defer></script><script src="/assets/js/72.1fe6a8a2.js" defer></script><script src="/assets/js/71.6ada6e59.js" defer></script><script src="/assets/js/70.861e664c.js" defer></script><script src="/assets/js/69.56cedfc5.js" defer></script><script src="/assets/js/68.8ff4e941.js" defer></script><script src="/assets/js/67.fc848148.js" defer></script><script src="/assets/js/66.ddf0dd8b.js" defer></script><script src="/assets/js/57.06646fcd.js" defer></script><script src="/assets/js/59.f921245b.js" defer></script><script src="/assets/js/76.77a97c63.js" defer></script><script src="/assets/js/app.59fe83e9.js" defer></script>
  </body>
</html>
