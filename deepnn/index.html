<!DOCTYPE html>
<html lang="en-EN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deep Learning | One Page Knowledge</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.82341e2f.css" as="style"><link rel="preload" href="/assets/js/app.620103ab.js" as="script"><link rel="preload" href="/assets/js/37.7772b5b4.js" as="script"><link rel="preload" href="/assets/js/70.347f2c09.js" as="script"><link rel="preload" href="/assets/js/58.7dba1b4b.js" as="script"><link rel="preload" href="/assets/js/62.53a2512a.js" as="script"><link rel="preload" href="/assets/js/60.eb7f75de.js" as="script"><link rel="preload" href="/assets/js/69.9af65d65.js" as="script"><link rel="preload" href="/assets/js/68.4d0e3cbf.js" as="script"><link rel="preload" href="/assets/js/67.d88188d3.js" as="script"><link rel="preload" href="/assets/js/66.d1ca85ac.js" as="script"><link rel="preload" href="/assets/js/65.c56daf15.js" as="script"><link rel="preload" href="/assets/js/64.f6ad6fd8.js" as="script"><link rel="preload" href="/assets/js/63.63ab144f.js" as="script"><link rel="preload" href="/assets/js/54.6c678409.js" as="script"><link rel="preload" href="/assets/js/73.fb7d948d.js" as="script"><link rel="preload" href="/assets/js/56.ff5f34ac.js" as="script"><link rel="prefetch" href="/assets/js/1.aa821848.js"><link rel="prefetch" href="/assets/js/2.20161488.js"><link rel="prefetch" href="/assets/js/3.abdf75c4.js"><link rel="prefetch" href="/assets/js/4.93b4e08d.js"><link rel="prefetch" href="/assets/js/5.36c4c943.js"><link rel="prefetch" href="/assets/js/6.42641c36.js"><link rel="prefetch" href="/assets/js/7.11cd7a58.js"><link rel="prefetch" href="/assets/js/8.4276f2ca.js"><link rel="prefetch" href="/assets/js/9.363d66d8.js"><link rel="prefetch" href="/assets/js/10.8d91a9ce.js"><link rel="prefetch" href="/assets/js/11.16aa54e2.js"><link rel="prefetch" href="/assets/js/12.640adc18.js"><link rel="prefetch" href="/assets/js/13.7c7a4b3e.js"><link rel="prefetch" href="/assets/js/14.7a0af98b.js"><link rel="prefetch" href="/assets/js/15.1239a368.js"><link rel="prefetch" href="/assets/js/16.b0df437e.js"><link rel="prefetch" href="/assets/js/17.e20d4152.js"><link rel="prefetch" href="/assets/js/18.aeebd855.js"><link rel="prefetch" href="/assets/js/19.25ce785e.js"><link rel="prefetch" href="/assets/js/20.6e1c87f8.js"><link rel="prefetch" href="/assets/js/21.5b7a33ba.js"><link rel="prefetch" href="/assets/js/22.8668bb06.js"><link rel="prefetch" href="/assets/js/23.2044d948.js"><link rel="prefetch" href="/assets/js/24.98fbb681.js"><link rel="prefetch" href="/assets/js/25.31c2ffc9.js"><link rel="prefetch" href="/assets/js/26.adb27b42.js"><link rel="prefetch" href="/assets/js/27.c85e420f.js"><link rel="prefetch" href="/assets/js/28.181e027c.js"><link rel="prefetch" href="/assets/js/29.147a9d6a.js"><link rel="prefetch" href="/assets/js/30.150859c9.js"><link rel="prefetch" href="/assets/js/31.c6121504.js"><link rel="prefetch" href="/assets/js/32.8d504080.js"><link rel="prefetch" href="/assets/js/33.47e27d53.js"><link rel="prefetch" href="/assets/js/34.103cc75b.js"><link rel="prefetch" href="/assets/js/35.fe7f7dc1.js"><link rel="prefetch" href="/assets/js/36.a15a3bc0.js"><link rel="prefetch" href="/assets/js/38.1d86af09.js"><link rel="prefetch" href="/assets/js/39.77b1cffa.js"><link rel="prefetch" href="/assets/js/40.994c22d8.js"><link rel="prefetch" href="/assets/js/41.4b79eeb0.js"><link rel="prefetch" href="/assets/js/42.3ae73b02.js"><link rel="prefetch" href="/assets/js/43.1e6ed17e.js"><link rel="prefetch" href="/assets/js/44.9ac489bb.js"><link rel="prefetch" href="/assets/js/45.262ce5e2.js"><link rel="prefetch" href="/assets/js/46.39589cff.js"><link rel="prefetch" href="/assets/js/47.04882daa.js"><link rel="prefetch" href="/assets/js/48.e184eae0.js"><link rel="prefetch" href="/assets/js/49.9ac695a7.js"><link rel="prefetch" href="/assets/js/50.16da30bc.js"><link rel="prefetch" href="/assets/js/51.01879da0.js"><link rel="prefetch" href="/assets/js/52.732d9a57.js"><link rel="prefetch" href="/assets/js/53.306c72d0.js"><link rel="prefetch" href="/assets/js/55.bb5d1408.js"><link rel="prefetch" href="/assets/js/57.556919d3.js"><link rel="prefetch" href="/assets/js/59.e4a590db.js"><link rel="prefetch" href="/assets/js/61.7aa1d84c.js"><link rel="prefetch" href="/assets/js/71.165532fd.js"><link rel="prefetch" href="/assets/js/72.dc9c4951.js"><link rel="prefetch" href="/assets/js/74.8213c449.js"><link rel="prefetch" href="/assets/js/75.21855687.js"><link rel="prefetch" href="/assets/js/76.c0c79443.js"><link rel="prefetch" href="/assets/js/77.f0dc6145.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82341e2f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      One Page Knowledge
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Deep Learning</span><!----></p><ul class="sidebar-group-items"><li><a href="/deepnn/#gpu-servers" class="sidebar-link">GPU Servers</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/deepnn/#artificial-neural-network" class="sidebar-link">Artificial Neural Network</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#single-layer-perceptron" class="sidebar-link">Single Layer Perceptron</a></li><li class="sidebar-sub-header"><a href="/deepnn/#modern-neural-network" class="sidebar-link">Modern Neural Network</a></li><li class="sidebar-sub-header"><a href="/deepnn/#forward-function" class="sidebar-link">Forward Function</a></li><li class="sidebar-sub-header"><a href="/deepnn/#gradient-descent" class="sidebar-link">Gradient Descent</a></li><li class="sidebar-sub-header"><a href="/deepnn/#backpropagation" class="sidebar-link">Backpropagation</a></li><li class="sidebar-sub-header"><a href="/deepnn/#do-i-have-to-implement-all-these-functions" class="sidebar-link">Do I have to implement all these functions?</a></li><li class="sidebar-sub-header"><a href="/deepnn/#example-of-sgd-for-linear-function" class="sidebar-link">Example of SGD for linear function</a></li></ul></li><li><a href="/deepnn/#data-source" class="sidebar-link">Data / Source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#resources" class="sidebar-link">Resources</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-google-drive" class="sidebar-link">Data Download / Google Drive</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-google-images" class="sidebar-link">Data Download / Google Images</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-wget" class="sidebar-link">Data Download / wget</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-kaggle" class="sidebar-link">Data Download / kaggle</a></li><li class="sidebar-sub-header"><a href="/deepnn/#data-download-linux-commands" class="sidebar-link">Data Download / linux commands</a></li></ul></li><li><a href="/deepnn/#activation-functions" class="sidebar-link">Activation Functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#sigmoid-function" class="sidebar-link">Sigmoid function</a></li></ul></li><li><a href="/deepnn/#pytorch" class="sidebar-link">PyTorch</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/deepnn/#fast-ai" class="sidebar-link">fast.ai</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#installation-google-colab-v-1-0" class="sidebar-link">Installation / Google Colab (v 1.0)</a></li><li class="sidebar-sub-header"><a href="/deepnn/#installion-aws-v-1-0" class="sidebar-link">installion / AWS (v 1.0)</a></li></ul></li><li><a href="/deepnn/#fast-ai-help-functions" class="sidebar-link">fast.ai / Help functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#open-image" class="sidebar-link">open_image()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#open-mask-fn" class="sidebar-link">open_mask(fn)</a></li><li class="sidebar-sub-header"><a href="/deepnn/#show" class="sidebar-link">.show()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#apply-tfms" class="sidebar-link">.apply_tfms()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#imagecleaner" class="sidebar-link">ImageCleaner</a></li></ul></li><li><a href="/deepnn/#fast-ai-data" class="sidebar-link">fast.ai / Data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#imagedatabunch" class="sidebar-link">ImageDataBunch</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-own-item-list" class="sidebar-link">DataBunch / Own Item List</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-1-datatype" class="sidebar-link">DataBunch / 1. DataType</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-2-from" class="sidebar-link">DataBunch / 2. from_</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-3-split" class="sidebar-link">DataBunch / 3. split</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-4-label" class="sidebar-link">DataBunch / 4.label</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-5-transforms" class="sidebar-link">DataBunch / 5. Transforms</a></li><li class="sidebar-sub-header"><a href="/deepnn/#databunch-6-databunch" class="sidebar-link">DataBunch / 6. DataBunch</a></li><li class="sidebar-sub-header"><a href="/deepnn/#normalize" class="sidebar-link">.normalize()</a></li></ul></li><li><a href="/deepnn/#fast-ai-data-augmentation" class="sidebar-link">fast.ai   / Data augmentation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#get-transforms" class="sidebar-link">get_transforms()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#zoom-crop" class="sidebar-link">zoom crop()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#rand-resize-crop" class="sidebar-link">rand_resize_crop()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#list-of-transforms" class="sidebar-link">List of transforms</a></li></ul></li><li><a href="/deepnn/#fast-ai-learner" class="sidebar-link">fast.ai / Learner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#save-load" class="sidebar-link">save/load</a></li><li class="sidebar-sub-header"><a href="/deepnn/#partial" class="sidebar-link">partial()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#create-cnn" class="sidebar-link">create_cnn()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#create-unet" class="sidebar-link">create_unet()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#fit" class="sidebar-link">.fit()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#fit-one-cycle" class="sidebar-link">.fitonecycle()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#recorder-plot-losses" class="sidebar-link">.recorder.plot_losses()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#show-results" class="sidebar-link">.show_results()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#predict" class="sidebar-link">predict()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#lr-find" class="sidebar-link">lr_find()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#how-to-choose-learning-rate" class="sidebar-link">How to choose learning rate?</a></li></ul></li><li><a href="/deepnn/#fast-ai-examples" class="sidebar-link">fast.ai  / Examples</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#dog-cat-example" class="sidebar-link">dog-cat example</a></li><li class="sidebar-sub-header"><a href="/deepnn/#dogs-cats-breeds-example" class="sidebar-link">dogs/cats breeds example</a></li><li class="sidebar-sub-header"><a href="/deepnn/#isic-archive-skin-melanoma-recognition" class="sidebar-link">ISIC - Archive (Skin melanoma recognition)</a></li><li class="sidebar-sub-header"><a href="/deepnn/#planet-amazon-dataset" class="sidebar-link">Planet Amazon dataset</a></li><li class="sidebar-sub-header"><a href="/deepnn/#camvid-mask-images" class="sidebar-link">CamVid / mask Images</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"><div class="warning custom-block"><p class="custom-block-title">Source</p><p>The material based mostly on the free deep learning course and library <strong>fast.ai</strong> (from 2017)</p><p><a href="https://course.fast.ai/index.html" target="_blank" rel="noopener noreferrer">https://course.fast.ai/index.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div><h2 id="gpu-servers"><a href="#gpu-servers" aria-hidden="true" class="header-anchor">#</a> GPU Servers</h2><p>This is a short list of GPU Servers that can be used for fast.ai.</p><table><thead><tr><th>Server</th><th>Free</th><th>Description</th><th>Limitation</th></tr></thead><tbody><tr><td><a href="https://colab.research.google.com/" target="_blank" rel="noopener noreferrer">Google Colab<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>Yes</td><td>Free notebook for use (required setup a GPU)</td><td>12 continuus hours per session</td></tr><tr><td><a href="https://www.kaggle.com/" target="_blank" rel="noopener noreferrer">Kaggle Notebook<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>Yes</td><td>Free kaggle notebook <a href="https://www.kaggle.com/dansbecker/running-kaggle-kernels-with-a-gpu" target="_blank" title="https://www.kaggle.com/dansbecker/running-kaggle-kernels-with-a-gpu" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>60 continuus minutes per session.</td></tr><tr><td><a href="https://www.paperspace.com/" target="_blank" rel="noopener noreferrer">Paperspace<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No</td><td>Pay as you go consoles to run machines</td><td></td></tr><tr><td><a href="https://azure.microsoft.com/" target="_blank" rel="noopener noreferrer">Microsoft Azure ML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No/200$ for start</td><td>Free 200$ for machines that can have GPU inside</td><td></td></tr><tr><td><a href="https://cloud.google.com/" target="_blank" rel="noopener noreferrer">Google Cloud<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No/300$ for start</td><td>Free Tier to use $300 dolars <a href="https://cloud.google.com/free/docs/gcp-free-tier" target="_blank" title="https://cloud.google.com/free/docs/gcp-free-tier" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td></td></tr><tr><td><a href="https://aws.amazon.com/free/" target="_blank" rel="noopener noreferrer">Amazon AWS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No</td><td>Free Tier doesn’t have GPU machines.</td><td></td></tr></tbody></table><h2 id="artificial-neural-network"><a href="#artificial-neural-network" aria-hidden="true" class="header-anchor">#</a> Artificial Neural Network <a href="https://towardsdatascience.com/multi-layer-neural-networks-with-sigmoid-function-deep-learning-for-rookies-2-bf464f09eb7f" target="_blank" title="https://towardsdatascience.com/multi-layer-neural-networks-with-sigmoid-function-deep-learning-for-rookies-2-bf464f09eb7f" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Artificial Neural Network (ANN) is an paradigm for the deep learning method based on how the natural nervous system works.  They can be used in the ImageRecognition, SpeechRecognition,  natural language processing, desease recognition etc…</p><p>The simplest architecture of the Artifical Neural Network is a Single-layer Perceptron that was introduced in the 1957 by Frank Rosenblatt. <a href="https://en.wikipedia.org/wiki/Perceptron" target="_blank" title="https://en.wikipedia.org/wiki/Perceptron" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><h3 id="single-layer-perceptron"><a href="#single-layer-perceptron" aria-hidden="true" class="header-anchor">#</a> Single Layer Perceptron</h3><p>This architecture contains:</p><ul><li>Input <code>x</code> as a vector</li><li>Weights for each <code>x</code> input (<code>w</code>)</li><li>bias (<code>b</code>)</li><li>and Activation function that on output has been activated or not (<code>0</code> or <code>1</code>)</li></ul><div class="perceptron"><input placeholder="x1" size="mini" value="0.2" class="x1 red"><input placeholder="x2" size="mini" value="0.3" class="x2 green"><input placeholder="x3" size="mini" value="0.8" class="x3 blue"><input placeholder="w1" size="mini" value="0.2" class="w1 red"><input placeholder="w2" size="mini" value="0.3" class="w2 green"><input placeholder="w3" size="mini" value="0.5" class="w3 blue"><input placeholder="b" size="mini" value="0.1" class="b"><input placeholder="w1" size="mini" value="0.2" class="w1a red"><input placeholder="w2" size="mini" value="0.3" class="w2a green"><input placeholder="w3" size="mini" value="0.5" class="w3a blue"><input placeholder="x1" size="mini" value="0.2" class="x1a red"><input placeholder="x2" size="mini" value="0.3" class="x2a green"><input placeholder="x3" size="mini" value="0.8" class="x3a blue"><input readonly="readonly" size="mini" value="0.04" class="m1 red"><input readonly="readonly" size="mini" value="0.09" class="m2 green"><input readonly="readonly" size="mini" value="0.4" class="m3 blue"><input placeholder="b" size="mini" value="0.1" class="mb"><input readonly="readonly" size="mini" value="0.63" class="msum" style="color:green;"><img src="/deepnn/perceptron.png" alt="Card image cap" width="740" height="578" class="image"><span class="answer" style="background-color:green;">σ = 1 </span></div><h4 id="when-use"><a href="#when-use" aria-hidden="true" class="header-anchor">#</a> When Use?</h4><ul><li>Can only classify linearly separable cases with the binary output (0 or 1)</li><li>Single Layer perceptron cannot  solve non-linear problem.</li><li><strong>Not used in modern Deep Learning architecture</strong></li></ul><h3 id="modern-neural-network"><a href="#modern-neural-network" aria-hidden="true" class="header-anchor">#</a> Modern Neural Network</h3><p>Modern Neural Networks has something more than only one layer. In previous architecture, you wouldn’t find any better calculation than some simple linear functions.  To create more complicated functions we need hidden layers.  With this first input goes to the activation function in the first layer, and the following output if the hidden layer can go to the next layer with the activation function or to the final output. More dense Neural Network gives us the opportunity to define more parameters on weights and biases in the network and next recognise more complicated tasks. Each layer can have some special functions. For example in the image recognition first layer is used to extract features (like edges) on the image.</p><p>For example, we define a neural network with one hidden layer with three neurons, two input values, and one output. For the moment we don’t set our activation function yet.</p><p><img src="/assets/img/1547391156214.3d92b6e8.png" alt="1547391156214"></p><p>Let’s explain all parameters defined in the network:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAUCAYAAADskT9PAAABtUlEQVRIie2VIY/qQBSFz2xCSRgFCbYJCkQDAhSOkBoSkkp0+Qd1KGw9GlMDAoEEhcARDAIDCQIECQZBCgSanFU02+V1u2+f2JfsXnnmztxvzr2TESSJb4yX7yz+/wOMx2OUSiUIIVAsFnE+n309lUpBCIF8Po/ZbAYA2O12qFQqEEIgHo+j3+9HEzAkHMehaZp0XZfdbpcA6DgOW60WHcchSV83DIOj0cjP32w2TCaTlFLycDiElSBJhgK8DcuyqCgKy+Uye72er0+nUwIgAJqm6euXy4Wqqn4KIHIGPM/Der3G7XaDrutoNBpPOVJK2LYdbffftOAzt7EsiwDYbrcD+sMZwzAi3Y10YL/f43Q6Qdd1pNPpJ2cURUGtVgvsWa1WAIBCoRBpQCTAZDLB8Xh8OszzPCwWC2iaBk3TAvpwOPwj2JcAlsslACCXywX0+XyO7XYLVVWRSCSewGKxGDKZzL8BXK9XDAYDSClRrVYDa2E2P8Det+xLAI/+Z7NZSCkDa2HOvA3P89DpdNBsNsOLfDShYdP80cu43++s1+sEQEVRaNs2XdcNrSHI39/wF+CHA7wCzQYaadGCWGIAAAAASUVORK5CYII=" alt="1547390335050"></td><td>Number of the examples.</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAnCAIAAAAU41arAAAABnRSTlMA/wD/AP83WBt9AAABIklEQVRYhe2Yu5ECMQxA5avlSG6uAlEC+ZVgp1eKaYP85A6ogAi7F12A96MBFsvsDAR6ode23lifYB0zwxvw8WqBinlIzENiHhLzkJiHxDwk5iHReJR92DrnnNvu07SYLoshLZxsgBvJETFm5hwRADBmZmYmX6/x1HrRbZo95kI1bo44GT2J3mMIHyPelSCvfaIOjyEZeDcQedA+VI/HlJn16K2PtUWU86OksPn9JvIAcDqX6w0puNraNz4+3bfkwRPnqfwWKqAva00eYyrG0LMpMgwWsVndzU0elwZBP7+cqptcrZv1Q6WnXxbRjw5mVtfpQ8r5BIBfG+25lT3K3+EI+LP7fLHHSElB17orl0dtravqfYRj+/8xxzwk5iF5F49/cIBei6jEs00AAAAASUVORK5CYII=" alt="1547389815746"></td><td>Input on the <strong>i</strong> position. Sometimes it shows as a zero activation layer. <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAAAtCAIAAADEABlTAAAABnRSTlMA/wD/AP83WBt9AAAEZ0lEQVRoge2bP0jrXhTHTx+1gtVBUHBpoIJSKKUQ0EEKVmlxqrSgOFVQZysUF/+ADg6CuHRQl+ok0inFQZy00C6KSyAOVkggoYsOTmnVBPobLi/kpTGJmvS9n8ln8+R6e/jmnHvPOVVXs9kEh+/x62878BNwRDQBR0QTcEQ0AXuJKIri0dFRPB5/fn7WWHZ8fDw/P39/f29036ZtEAQhkUhsbGzwPK+7mKbpsbGxs7MzIzvbRUSk4NbWlsK4traGgikQCBAEIX9K0/TAwMDNzY3u5nYRsVwue73ep6cnuTGbzXq9XoqiBEHIZrMAoAi9fD6P47hu5NpCRBSGyWRSbqRpure3V1Kt0WhgGKaQzGAw2uJi4TiuUqnMzc3JjdfX1zzPDw4Ooh/dbnc4HH54eOB5Xlrj8/lGRkYuLi6097eFiLVaTa4XQnH5ut3uoaEhQRAYhlEYSZLU3t8WIn5ER0eH3+/XXcaybL1e11hgCxGr1aqqXoq4+zK2EHF4eFhXL1EUHx8fDcamAluIqEoqlXp/f5cuDVEUSZKMx+P9/f2KlRiGdXV1ae1lej3xD6KoZhCo7pHqxFwu5/F4FNUMqnsUJXorthBRtU5E9uXlZRRMoVCotR40WCfaQsTmBx2LLk7H8geqvbM2JvTONE1Ho1EAwHFceoEsyyKjwfFGe2BZdmpqCmWlx+PZ3d3N5XKxWEwRQe2e4tA0jZzI5/MAgF4gOmUB4At5IVEulw3enq3HvCqXl5foTVMU1fx9h0g+KxAE4fDwMBaLafufz+fT6TTa0Ag66Yx8SiaT6DUaOSDaCXJP7hXys8254tYOB5/PF4lEWJbd29ur1WrlclmnYmojoiiurKy8vLwcHBwovPJ4PIpO2Vp0ZUaDtlAo9OUUtgh0MiiSQ3WiZTX6HUswGASA9fX11lIewXHcxMTE9va2me/WANVqFQASiYQ8DO/u7liW1e8xTEVHRIZhVldXAaBQKLQ+5Tguk8lgGFYqlQx+XqVScRmjs7Pz9vZWYys0ywoEAnIjQRAAoBgdWo2WiBzHRaPR/f19DMNax0EMw6TT6cnJSeMXLgBEIhGDOfL29jY6OvrRPmheoDAyDHNyctLuA1FVxEqlkkqlOI6LRCI4ji8sLMzMzFAURVGUfJnf7y+VSslksl2u/gEal8otr6+vmUwmHA6rTmIsPXNURKxWq8ViEcOwvr6+09NTAAgGg2jgIYri7Oysdpa1jVQqBQCFQqFer3Mct7m5ubOz09PTg55eXV3F43H06LNnzqdpzSN0HafTaemCazQaqPhS7dJROn+qozIL6QtPydtcLocsi4uLPM/TND0+Pk4QhKVOmtA7/0URjWOpk/YdypqII6IJmCAiKnpJktT+SuwH83URRVGcnp52uVxLS0sAUCwWvV5vd3e39h9c/Uh0BhBav+l2n5+fm+jK/xe7nInWnjlWXPn/DtJ4Uc53hsqquJrOv2B8G7uks6U4IpqAI6IJOCKagCOiCfwHCnjQetP2MvkAAAAASUVORK5CYII=" alt="1547389977628"></td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAcCAYAAACZOmSXAAABUUlEQVRIie2WMY6CQBiFH1uMxdDAAbgBDV6AC5hYcwxLGk5CY2PrHWjEmhoTSqElFpC8LTbDLioug25MNryE6g/vm3+G9w8GSeJN+ngXeIaPUtu2CMMQhmF0j2maKMsSAHA6nWDbdldbLBY4Ho+PTampzWZDAJRSMsuyXi1JEgKgEILb7fZXL224Aniex7que7U4jgmAu91ulJc2/HK50HEcSil5Pp9vFhVF0WgvbTh522Ge57Qsi+v1WstnElzBPM9jVVV0HEcbPBneNA1XqxWFEFwul3fP/8/g5PfWX5+9jiYNmbZtsd/vp7z6XM7Jr6xLKRkEgVa0rqUNj+OYQgimadrFa8rHpg1XMNXpUOZfDh/Kshq3U7Z+FFx1eC9Sj8bt03CV6aHufl4maZq+Dl4UBX3fJwACoOu6vZvscDjQsqyurrsAg5z/4Wb4DP/n8E+2KzNgiEfCMwAAAABJRU5ErkJggg==" alt="1547390011533"></td><td>Input vector. The size of the input vector is <em>(input_layer x m)</em> . <br>Where <em>m</em> is a number of examples  (In this example 1).</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA0CAIAAAC2D6d2AAAABnRSTlMA/wD/AP83WBt9AAAD+klEQVRoge1ZMUjzThR//VNvMFNBJSBGKlSFVoSCDq7aRVB0EJVSwdlBEC2WDDpbJxcdjItDHYRuUhcd0qGKS6EBtRChEgQFHSQ2NIF+w/HlH9Omre0l8kF/2z3ucr+7e/d7711c5XIZ/kH899sEmkSbt7No866ApmlHR0ehUOjt7a1u55OTk5WVFUEQGv162R6oqjozM8OyrCzLDQ4RRXFiYiKRSDTS2RbemPTOzs5PB4qiSNP0zc1N3Z628OZ5nqKo19fXJsZyHBcMBuueEnneeLPn5uaMxlQq5fF4EEKJREJV1VgsBgC4aRre4JaTv5fPz8/pdHpxcVG3nJ6e8jyfz+dpms7lctvb2+FwuFgs0jQdj8e/vr6Mw/v6+sbGxi4uLmrP4ibOW5IkWZYHBgZ0SyQSAQBFUQAgHo/zPO/3+3GTYZjOzs5vhNxun8+XzWZrz+Kcft/d3RUKhVgsNj4+DgAvLy+fn5+jo6NVOxcKBdM5mECe9+PjY0dHh9frrbQjhKanp3FTkqSPj4/h4eHmZiHPe3BwUFXVp6cnk10QBON6kskkQsjoTj+CQ36iKMr5+XkoFOru7gYATdPy+XwgEAgEAlX7V/q9CeR59/b2UhQliqLRaPJmTdOy2SzDMAihhYWF29tbvSdeoZXf/w/C6m2h3zzPA4BRrTmOA4CRkRGTVDeo3+14acDv5Cf4TAHAtG58sjqbYrHIMAzuWRmufycfTKVSAGA6642NDSNvPBPDMFYuoarq4eHh1NRUIw7DcVwkEsnlco2QtuSN99JISN9d44UTRdHj8TThD62jlg4awweO0qYOkiSVSqW1tbU6mmUDqvN2u91GBdU0bW9vLxqNMgyjZw7YuLm5iUOJw7Dk7fP5SqUSDh+ZTObq6mp9fd24mEwmI0lSNBp1iOl31I+XiqKEw+Hj4+Oenh4AeHh4kGUZG7e2tozROJ1Ou1yus7Ozyi/09/fPz887wdvv9wPA/f09y7JdXV2zs7P4ELDTsywbDAaXlpaMQ6xSJXw36ofuH8HqwmIVX15eNgYCjuMQQqurq42ENFtRhzd8F2wcehBCjYQ0W2HJG2uzaV/xYioFu+oiywbVJ34+xPITfBRV63OGYUzpYesgmX9b1S816simQYy3IAhV65cW60grkOGNi5SqxVUymaQoanJykshEOsjwtnpUwHXk0NAQRVFEJtJBhvf19bUsy/obgw69jqxd5DYBwnXx5eXl7u6u3qz9uNMSiKgSFnuE0P7+vtFuJY6tg8z7oNfrfX9/r7QLgmDHpQSw7X9D+W+wJB5xMGz8T3JwcGBfJmMLb1xBV77pEISr3P7P7STavJ1Fm7ezaPN2Fv8q7z+lOQlPqm9RLQAAAABJRU5ErkJggg==" alt="1547389753231"></td><td>the weight on the layer <em>n</em>, from the input from the previous layer position (<em>i</em>) to the activation layer position (<em>j</em>)</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAjCAYAAAAg/NwXAAADx0lEQVRoge2ZPUjzXBTH/32IFYxLBEEsLUSwiwVBUUQEP7AghUo3p7o4SpcgBe2grq4WKmJ1swoOfoCjFaLix1SsS4cEWlSwOFaLLdx3eJpiniT1to/Pa4b8oEN7zr3n3H9Obs5NbYQQAgv8+ukEzIIlRAVLiAqWEBVMKUS5XMbGxga8Xi/y+TzVmO3tbczOzuLh4aGxoMRklEol4vf7SSQSIYVCoa6xkiSR4eFhkkgk6o5rKiEUEZaXlw19stksGRsbM/SRJIl0dHSQm5ubumKbSghRFAnLsuTl5UVjy2azJBQKEQAEQE2x4vE46evrq6uiTLNHlMtlrK2twev1or29XWWTZRnBYBATExMQRfHLucbHx/H09IR0Ok0d3zRC5HI5XFxcYGZmRmPjeR7n5+cIBAJUczmdTgwMDOD09JQ6PpUQ6+vrsNls1U9zczNub29VPuVyGdPT07DZbNjb21PZZFlGW1ubao6VlRWVz+PjIwqFArq6uqiTN4JhGHR3dyOVSlGPoRIiFApBEAQAgN1uhyiKGBwcVPlcX1/j5OREdzzP80gkEtXvkUgE4XCYOslGyWazeHt7o/JlaCft6ekBAHg8Hng8HpVNub9r4Xa7wXEceJ7H0tISWlpaVPZMJoOmpibwPE+b0rdCvUe43W5DWy6Xw93dHfr7+w19kskkCoUCYrGYRgRl/lKpBFmWaVP6Vr5ls4xGoxgaGsLo6KiuvVgsYnV1FT6fT3NL/UtcLpeu6Hr8tRCyLGN3dxeLi4uGPpFIBK+vr9jc3DT0cTgcYFkWkiTVjJfJZAAAqVTK8P4vFos4ODhAb28vxQp+Qy2Ew+EAx3Ga35VqMLrSsixjZ2cHCwsLmv7gM06nEyMjI9jf39fYPj+R5ubmAACHh4dgWRatra2a88jz8zM+Pj7g8/lol0e/WeqhVMPR0ZGhTzQaBc/zXz4lGIZBOBzG1NQU8vm8SjSGYXB8fEydVzKZRGdnp2ZTrwltCypJEuE4TtW6CoJAAoFA1UcQBGK326t9vjKG9hBEc9agyfOfnjX+FEIv4GchlEXV2/Ob/vT5/v5OXC5XdWF/VgMhaiFEUVRVRz2USiUSi8XI5OSk7gFMj3g8ToLBIEmn03XHI6RBIe7v73XLTxHi8vKS+P1+jVBmpqHN8qsnxdXVFc7Ozn6sOWoIWsWUigBgWPKCIFC9LzAj1H0EwzDVBuWrDpFlWczPz//lJfp/aaiz1Htn8Jmtra2azZMZsRFi/eUHmOgN1U9jCVHBEqKCJUQFS4gKlhAVLCEq/AdXuokfEVKMaAAAAABJRU5ErkJggg==" alt="1547390155358"></td><td>The matrix on the layer <em>n</em>. The size of the matrix is (<em>current_layer</em> x <em>previous_layer</em>). In the example <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAjCAYAAAAg/NwXAAADx0lEQVRoge2ZPUjzXBTH/32IFYxLBEEsLUSwiwVBUUQEP7AghUo3p7o4SpcgBe2grq4WKmJ1swoOfoCjFaLix1SsS4cEWlSwOFaLLdx3eJpiniT1to/Pa4b8oEN7zr3n3H9Obs5NbYQQAgv8+ukEzIIlRAVLiAqWEBVMKUS5XMbGxga8Xi/y+TzVmO3tbczOzuLh4aGxoMRklEol4vf7SSQSIYVCoa6xkiSR4eFhkkgk6o5rKiEUEZaXlw19stksGRsbM/SRJIl0dHSQm5ubumKbSghRFAnLsuTl5UVjy2azJBQKEQAEQE2x4vE46evrq6uiTLNHlMtlrK2twev1or29XWWTZRnBYBATExMQRfHLucbHx/H09IR0Ok0d3zRC5HI5XFxcYGZmRmPjeR7n5+cIBAJUczmdTgwMDOD09JQ6PpUQ6+vrsNls1U9zczNub29VPuVyGdPT07DZbNjb21PZZFlGW1ubao6VlRWVz+PjIwqFArq6uqiTN4JhGHR3dyOVSlGPoRIiFApBEAQAgN1uhyiKGBwcVPlcX1/j5OREdzzP80gkEtXvkUgE4XCYOslGyWazeHt7o/JlaCft6ekBAHg8Hng8HpVNub9r4Xa7wXEceJ7H0tISWlpaVPZMJoOmpibwPE+b0rdCvUe43W5DWy6Xw93dHfr7+w19kskkCoUCYrGYRgRl/lKpBFmWaVP6Vr5ls4xGoxgaGsLo6KiuvVgsYnV1FT6fT3NL/UtcLpeu6Hr8tRCyLGN3dxeLi4uGPpFIBK+vr9jc3DT0cTgcYFkWkiTVjJfJZAAAqVTK8P4vFos4ODhAb28vxQp+Qy2Ew+EAx3Ga35VqMLrSsixjZ2cHCwsLmv7gM06nEyMjI9jf39fYPj+R5ubmAACHh4dgWRatra2a88jz8zM+Pj7g8/lol0e/WeqhVMPR0ZGhTzQaBc/zXz4lGIZBOBzG1NQU8vm8SjSGYXB8fEydVzKZRGdnp2ZTrwltCypJEuE4TtW6CoJAAoFA1UcQBGK326t9vjKG9hBEc9agyfOfnjX+FEIv4GchlEXV2/Ob/vT5/v5OXC5XdWF/VgMhaiFEUVRVRz2USiUSi8XI5OSk7gFMj3g8ToLBIEmn03XHI6RBIe7v73XLTxHi8vKS+P1+jVBmpqHN8qsnxdXVFc7Ozn6sOWoIWsWUigBgWPKCIFC9LzAj1H0EwzDVBuWrDpFlWczPz//lJfp/aaiz1Htn8Jmtra2azZMZsRFi/eUHmOgN1U9jCVHBEqKCJUQFS4gKlhAVLCEq/AdXuokfEVKMaAAAAABJRU5ErkJggg==" alt="1547390155358"> (<em>3 x 2</em>)</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAAjCAYAAAAqoHJFAAADJUlEQVRoge2ZP0vrUBjGHy/Xg5ipgxAQAzqIQ0UI6ODkYBdBcBEF0Q9RRKwZ+gEE14p4ujh0EbpJ97goLkILkkIKERF06CC1hQTeO1xSbJsmObm297a3P8hyTt435znvn3NKx4iI8J/w428voJ+MxA4rI7G9wnEcnJ+fI5FI4P39Xdg+m83i4OAApVIp2gKoT9i2TZubm6RpGtVqtch+TNOk1dVVyuVywrZ9EesKTafT3+LPNE2SZZnu7u6E7PoiVtd1kiSJ3t7evs0n55xUVRXKkp6LdaO6tbXlOV8oFCgWixFjjHK5HNm2TalUigA0x7yIEt2eN6jn52fc3t5iZ2enY+7q6gq6rqNcLkOWZRSLRRwfH2Nvbw/1eh2yLOP09BSfn58dtjMzM1heXsbNzU34xYhESdd1AhD4fI2iruvEGPONQL1eJ0VRWt5zx7plBBFRMpn0nW9HKLL5fB4AoGkaarUa6HcZgIjAOQcASJKEi4sLEbd4eHiAZVlIpVJYWVkBALy+vuLj4wNLS0u+tpZleUbei9BiHcdBuVyGqqo4OTnB5ORkc65SqeDw8BAAcHl5iampqeacYRgYHx/H7OxsV9+GYYAxho2NjebYy8sLqtUqFhYWwi4xECGxT09PyGQyLUIbjQbW1tZQrVaRTqexu7vbYjc/Pw/btlGpVLr6LpVKHRuSz+fBGMPc3JyIHl9+hn1xYmIChmF0jGuaBsuyoKoqjo6OhBfQaDRwfX2NRCLRzAg3i+LxOOLxuK+9oigtm+/HH3XjbDaLs7MzMMY6Iu4yPT0NSZJgmqanD6/adBwHj4+PUBQFjDFsb2/j/v6+xc7dpKCabiF0K2vDNE2KxWIEwPfqFnTOuh2+3QfnnADQ4uKiZyePcs5GEuseC2g7Zrox0DeoZDJJAEJ/bGDvxm7aBV0U2hm4Xz1h67Qbtm1TJpOh9fX1SCnNOaf9/X0qFovCtkQCYt3IhK3Tf5HQYt069Wo0bsOKEu1+EkpsUJ1yzr+92/aCQLFf69SrmxYKBaHO/DfxFfu1ToOeQajjMaLR3x9DyUjssDISO6yMxA4rvwCixYf6hR0JhgAAAABJRU5ErkJggg==" alt="1547587884160"></td><td>The Z value on the layer (n). The product on output from the previous layer (or input) and weights on the current layer. The size of the matrix is (<em>current_layer</em> x <em>m</em>)</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEMAAAA3CAIAAADYG2DzAAAABnRSTlMA/wD/AP83WBt9AAACcklEQVRoge2aP7KbMBDGP+csfi48PsFyAk8aV2lfJ8qXJl3KHECUoXttKppIJ3icwENhcRelEPgPyG+EQDLx8HUIGO+PXe2udrzSWuMp9OXRBkymhWR+Wkjmp4VkfopGUsssTZJMujyaJUmayXrgL+gYUpxAXKhBbxAxMeA3IpAYjAEUfu+FJxEMGPRxLxrEEppEceqCKMEIAEzwtFewxdIQlMAkPRDFGXGhtGAAccEZE0obx9lsHoASmMQYbLFEMFzbLhjsMegemw+qJ7LIAeLvb2sAQH06ArR9sT98PLkk5LAk9ekI7DZr6zp9+9reUFVpfW6IwpKsNzvrJ+1Ybjx0zyWOekh0ySIH2GHfXHY91JWbswKTvGwJZaVuF7u74uyhOkuS7MaBssidnTUmMznIUk/6iUrxpsB0s9yM6ol+nhqv/5O+SwlG1MYpMS4EJ7pbqufaC6u2TDcGNsF+7zMqwRkRd7FNcSI2iFtrfxJj943VDYrnnhgtvyxcZ6/fS4D9fOtl+rEFzl8++J3273rVZ2tPIx+f1Kcj+kVZFjlGN08j5EOiqhI9mw3IpQW5upOuVqvUZRQxSh4kxiWdtexXDvsmmaQ9dJAHyXqz66zI9LXaEeyxtf+ttf7op4ap5RNd+wMDkBeyhpljFYf3H9v2bi17fWAc+SWKdoxw6foEP6+ca5rJcZESWvCJxL0D+uQKftL67IA+qQKTTHFAd1RYks4xN6iCknw+/JlYQUkixlZYkqguCUlS//0T0SUhSVRVRtvuCEkSM28BCDXvUoJT5GPX9CRNs9UfwwXWSi//JZqbFpL5aSGZnxaS+el5SP4BTR7r3k81pagAAAAASUVORK5CYII=" alt="1547390538540"></td><td>The value on the activation function on the layer <em>n</em> and position <em>j</em>. Activation on the last layer is the output on the neural network:  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAwCAIAAABVDSmEAAAABnRSTlMA/wD/AP83WBt9AAADQElEQVR4nO2bMbbiIBRAH3NmKYmFxxU8VqDT/Gra6Uipzd8HKX+6aaeyGViBrMBjIewlU2A0JkQjPxL/hFtiPMEbeDwekZRlCZHn823sDkyFKDoQUXQgouhARNGBiKIDEUUHIooGACPzjNJc3r4opzTLpfG9STl1NEdALnTPaxGZ8LnNxEVby3XJWgvOEKtxiIzrO9/ox7RFCwZwNUA1R4DzANecATSu8FU9ZdGaY9NiU6IVP4TpCYt2eG4hGEBbqo/pCWcd+qAA5+mtS+S2AMCfP5Lr5mS2AHXQD91twqLvYXK6KpCJ3Tpxfbw/PpTpfUK0zCghhNDcO7UcFXPcAyxmTokAJqfpRjGx+1gOcztf0TKjq0IBAKhN+iVdJ7NF17CsLJdDWQZP0Sanq0Ih41prwRDUJs1ub6u+EH0td06GDh5dq+1ijay2ldKCOZKgl8eZddhfV88oNMdmhiGYIxW5w6OiNccryed20e7Pq9M2bdPmFjGP/iytnWEf4s7Qg8elhah1nGIxNAOUYB1zbFS0uK4NCcHRFd1ernonmA3OVmuj5GVjm7fny6O6S6/RpKtOnvxVsbfjy7Zgx2/3XnNE1vOBOPAIHaJd0nLWXkajKsHpZtOYPfSJ0W3TPvnOs3A6dbgPjI/oZq/7lMGC4YpsXVW4kPjsDJPZAuBSvjJ//yjk7419lJEZHaEOYo57aBfc5LaAx/dyw+LzdOpD2nEYJLg7O+lmuMXQsYB0NAbGL4++LH7NlP+8No8zWV0B+tQ28hriV72zwWO/zeiqYKJefUnWu93HejnWHLUdqyOzX4cFgjtwBIxvnmXSdI4AqijUtebxWb4xACi20oB9X2P79vt9Xn1qZE6tVyPzjJL0VOoNgedMuBv2xlvnL/vX6lUBwc8t4rSuBI9vn4jRtzs4fkLVg4Cd/O4xCWSWbhRy7T5LizjpG6PNKbiZnJJVgVx3HFlGOug7ovVBqSIlGwDoPhiuYTcO6qANJPGJQO8Rbb3Z1eT2wbDJKSGEpBsFAFCsUkII+X9OFL3pOaKT9a5cD3zltJj0CzS1+PZ8AmQ2r4fzEPa5tRBSxn/OBmHSoSMkUXQgouhARNGBiKID8Q+YYksmp31qhAAAAABJRU5ErkJggg==" alt="1547390776342"></td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAAjCAYAAAAqoHJFAAADI0lEQVRoge1ZsUvzUBD/+aFvaHHIIATEgA7iUBEERZztIggu4iA6+A8ImQwZxNk/QB3ioGAXwUEQOz+HKiIILWgLKaSIoIOD1BYSuG96xbZpmqS2fvbrDzLk3bvL/XL37i6kj4gI/wn+/LQDnUSPbLeiR7ZdcBwHBwcHiMfjeHt7C6x/dHSEjY0NZDKZcA5Qh2DbNi0tLZGu61QsFkPbMU2T5ufnKZFIBNbtCFlBdGdn51vsmaZJsizTzc1NIL2OkOWcUzQapdfX12+zaRgGTU9PB8qStpMVUV1eXnaVX11dkSRJxBijRCJBtm2TpmkEoLLmhjDRbXuBKhQKuL6+xurqap3s5OQEnHPkcjnIsox0Oo3t7W2sra2hVCpBlmXs7e3h8/OzTndkZAQzMzO4vLz070yocNXAMAwC4Bo9zjkxxjwjUCqVSFGUqn1irVFGEBGpquopr0XLkS2Xy9jd3QUAWJblGoVmuLu7g2VZ0DQNs7OzAICXlxd8fHxgamrKUzfIM1smq+s6IpEIJElylWezWQwMDGB0dLShjWw2C8YYFhcXK2vPz894f3/HxMREqy5W0BLZfD6P09NTHB4eYnBw0HXP+Pg4bNtGPp9vaCeTydS9kPPzczDGMDY21oqLVQhN1nEcbG1tYW5urpJ6T09PKBaLgeyUy2WcnZ0hHo9jaGioYjuXyyEWiyEWi3nqK4qCSCTi61mhyaZSKSSTSWia5rlveHgY0WgUpmm6yt3OpuM4eHh4gKIoYIxhZWUFt7e3VXriJTU701XwXcpcqqeYiMS92+DQrM9yzglAXT8VFX5yctK1kofps6HIGoZRRUwQatRifu0EZZomSZJUNec2I/trZ2NVVeuiJMi4pWPtnl/z1SPOl9fl5YRt27S/v08LCwuhUtowDFpfX6d0Oh1YlygAWRGZRudEVdWmZH8a/X6r9vHxMZLJJDjnnn3t8fHRfyvoMHz1WTH/+mny/zJ8kdV1HZZlNZxWCoUC7u/vAQAXFxehPgY6Aq8c/1plxVXbPsRA8XXP5uZmSxW3Xegj6v3+6Er0yHYremS7FT2y3Yq/4zbnNyZuKqgAAAAASUVORK5CYII=" alt="1547587796103"></td><td>Activation matrix on the layer (n). The size is the same as</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAcCAYAAAB2+A+pAAABkklEQVRIie2WMYvCQBSEJ8exhVsp2FoLFoKFrQE7IZD/YGkhBBsr/4aNCDY2QgR/hWCpjUUCNoKNhWiEXZgrjhwcMbI5BDnIwDb7kvdlJrxNLJLEG/TxDmgONpbWGuPxGKVSCZZlwbIsdLtd3G438ybMqCiKaNs2hRD0fZ8kGQQBi8UiXdc17pMJrJSi4zgUQnC9Xif2pZQ8nU5GvTJFPZvNsFqtMBwO0Ww2E3WlFMIwfG3UURSxUqk8dJWWxDMZgyeTCQFwNBpleqg0GUWttcZyuYQQAp1OJ1E/Ho+4XC5mEWeJOnYE4OlqNBq8Xq+vc7zZbHA4HOC6Lvj9en4tz/MAAI7joFAoGBk2Au/3ewBAvV5P1O73OxaLBQCgWq0aQY3BsR41jtOQUqLdbr8WvNvtUmu+7wMABoMByuXya8FpCsMQ0+kUUkr0er1M936aXFSr1RJ7Wmv0+32cz2fM5/NMbgGYjVP8EYjHRSlFz/NSDxQTGZ9cQRDQtu2fmW21Wtxut3+CkqRF5v9cOTgH/3PwF+DfR2VLzcqfAAAAAElFTkSuQmCC" alt="1547390298914"></td><td>Set of parameters of the model. In the example two matricies: <img src="data:image/png;base64,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" alt="1547390430000"></td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFUAAAAuCAIAAADWcsIPAAAABnRSTlMA/wD/AP83WBt9AAADwklEQVRoge1aPUvzUBS+ealXsS4RnMRABT+gDUIHcXBIBxdRUQi49yd0cXCov0FEUQiFInSs4uISHBIHxaWQgB9QIUVERRwkVppA3uFCCElzc5NaHZJn6/14znnuOTn3g1KWZYEY499fO/DHSPTHG4n+eCPRH28k+uONRH+88Rv6ZVkeHR0dHBy8vr7+BXPhYAWh3W4zDIMGr6+v+w0TRZHjuHK57GqXJImmaTQdQnh1dRVoMRQEQWBZtl6vR5serN+yLMMwVldXAQC1Ws2vF0LodaLZbNI0zbLs5eXl+fk5TdPpdPr19TWar35AS5/P53VdDzuXSL9lWaVSqWv0UHZ0tY3EF4tFu0vTNI7j+rEEKAYRmIn0I5FedoxVwzB4nq9Wq9723d1d72fSOzCRwIBIP4qkl1qSJABAP8REgyAIfh+pH4j0d9UZOeX6hwgpQLT/1et1AMDs7KyzsdVqybK8tLQ0NjbmGt9qtQqFAkVRrj1PlmWKoiiKGhkZeXt7wxuNQDI0NMTzvKIoiqKQ6AKAYP+zy7ur+KFk8yZ/u91eWVlRFAVljSsaaBZmH+2RxM8rP6QCF8g0zUajkcvlcrmcs11VVeBJChSEs7MzAMD39zfDMHd3d7quDw8PO8dsbm7ijUYmmZ6eBgA0Go1AXQjB+X9zc6NpGsMwTvOmaT48PEAIJycnMRp4ntd1XRRFu1FV1Xw+v7a2RuhfWJLx8XGapjVN+/r6IuEPjv/9/T0AYG5ujtBjJ7LZLADg9vYW/Xx8fKxUKvv7+65I/gKJHwLib5rmyckJhHB5eTkCuysbLy4uMpkMefB/kMQPAfFHH//AwEAmk4nA7szGl5eX7e3t09PTsHH7ERI/BMT/+fn58/NzZmYmnU4721Op1NTUVKfTaTabmOkTExOLi4uoeu3t7S0sLMzPz4d1MRTJ09PTx8eHq1phEKAfQ+f6LLsCLZNhGFtbW4eHh0dHR64BaDPf2NjohcSJsNUquP4hmKZ5cHDw/v6+s7ODWgqFAk3TgTtNNpvtdDqVSqVWq3lPSoQgJ1FVNVy1wh8P7JsvhLBarToPIYTnX3SA8Tvw4HvDDotw/iW9/2Lcwhy20BphHCK5sQSShGJzoSf9gSng92qAgMJVLBbxVvAkLra+3H9DWRUEoVwu+90anEAjMV0kJAj9ff8gsW2/f5VKJVRZIIShUtGJUCSiKKJXtgg38R/QbzvBcdzx8TGqlyzLKooSjcouuiQkkiT18v5JWcn/X+KMRH+8keiPNxL98UaiP96Iu/7/szOcW2SqxwgAAAAASUVORK5CYII=" alt="1547391042187"></td><td>Loss function on the one example.</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAAjCAYAAAA0aUL2AAAD50lEQVRYhe1YMUgzWRD+/uNcgttsCnGrkFgFDChpLA3YCcHtTCm2FsZgkS6WdgGbVJJoYSyE2KWMYhEEIS4oMQoa0mSx2YCEDSbwXfHfhkR312y88/Dwg23emzcz38yb9+btL5LE/wx//NcO/Bv4IfVZdDod5HI5HB8ff0rP9fU1dnd30Wq1LOe/jNTOzg4CgQAODg4QDAY/pUuSJKiqikAggK2tLXQ6nWEBjoGLiwsCGPpSqZStfDKZpMfjYT6fd9Tb7XaZyWTo9Xr7etfX19luty3lK5UKZVlmLBYbGh+LFDlMzIlQJpMhAKbTaUd9hmEwEolQEAQWCgWS5OPjI71eLxVFsV1XKpUIgPF4vD82NinToCiKfH5+tpRpNpsE4OgU+TtD0WiUgiDw8vLy3biTDZJMpVIEwGKxSPIfyJSTw6axUqnkqGt/f98y43Zk3+Jt8MYmlUgkHLeeYRiUZZmyLDvqMQyDPp/PMhujkiLJSCRCAGw2mxzr9Ov1enh4eAAA25Ps7OwMmqZBURRHXUdHR2g0Gtje3sbU1NQ7O6qqYmJiAoFAwFHPysoKACCXy413pJvGRFHE0tKSpczd3R0AYHp62lHP6ekpBEHA8vLyu/lms4mXl5eRfDKDW6vV8OdIK97g6uoKjUYD4XAYoihaytRqNQCA3++31WMG5/X1FQsLC7ZyTnZMSJIEAKjX6+Nl6v7+HgAQjUYxOTlpKVOv14eMWcEMjqIo4O/6HvoSicSHdkzIsgwA0DTNPSlzywD29QSgf8s7kTKDMzc3Z7n+5OTkQztW68YipaoqBEHAzMyMrdzgdvgIVk6bWXSq20EMBtE1KbN4Q6EQQqGQrZxZS3ZNJwDc3t7azhUKBQCwPBWtoGla365rUqVSCbquw+fzOe5z89RzImWHp6cnZLNZiKKIjY2NkdaYpGRZdn/6mdFdXV11lJufnwcAnJ+f28rMzs6+G+v1etjc3ISu68jn8yNlCQBUVQXwd32O3EK4vOFJMhgM9m95K5j9YzgcZrvdZrfb/bBTsYPf76ckSTQMw12bNEoTO4h0Ok0AzGQyjjrNFgcAFxcXeXNz48YtlsvloU7dFalRmthB6LpOSZLo9/up67orR90gEonQ4/GwWq2SdEHK3HoAPnzsDaJSqdDj8YwcCLdIJpNDzw5yRFLdbpd7e3uusjSIYrFIj8fDWCxmW19uoes64/E4ATCbzQ7NOZIynwUAGAwGeXh4OLYT1WqVa2trlCSp/7IdF+VymbIsU1EUy7faL/Jrf2ZqmoZWq/Wpny+apqHT6dg2y19O6ivw8zPzu+CH1HfBD6nvgh9S3wV/Acpe75TyoElqAAAAAElFTkSuQmCC" alt="1547391083924"></td><td>Cost function on all examples in the one batch. (Very often show as C or E)</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F

<span class="token keyword">class</span> <span class="token class-name">Neural_Network</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputSize <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> outputSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> hiddenSize <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>Neural_Network<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># parameters</span>
        self<span class="token punctuation">.</span>inputSize <span class="token operator">=</span> inputSize
        self<span class="token punctuation">.</span>outputSize <span class="token operator">=</span> outputSize
        self<span class="token punctuation">.</span>hiddenSize <span class="token operator">=</span> hiddenSize
        
        <span class="token comment"># weights</span>
        <span class="token comment">#self.W1 = torch.randn(self.hiddenSize, self.inputSize) # 3 X 2 tensor</span>
        <span class="token comment">#self.W2 = torch.randn(self.outputSize, self.hiddenSize) # 1 X 3 tensor</span>
        self<span class="token punctuation">.</span>W1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>W2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="forward-function"><a href="#forward-function" aria-hidden="true" class="header-anchor">#</a> Forward Function</h3><p>To calculate the output we need to go from the input to the output with all calculations. For example, we define all activation as sigmoid functions, and our loss function as binary cross entropy (the loss function if we have binary output).</p><p>For example you have a function to predict that is:</p><p><img src="data:image/png;base64,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" alt="1547485837571"></p><p>This is a simple function with the binary output (like when you predict if on the image is dog or cat)</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">fun_to_predict</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token number">1.0</span> <span class="token keyword">if</span> <span class="token number">3</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0.0</span> <span class="token comment">#must be float</span>
</code></pre></div><p>To calculate the output you need to go through your defined neural network and calculate all the layers.</p><ol><li>calculate the first layer by multiply the input with the first layer weights.</li></ol><p><img src="data:image/png;base64,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" alt="1547586657031"></p><ol start="2"><li>Caclulate activation function on the weights.</li></ol><p><img src="data:image/png;base64,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" alt="1547586732170"></p><ol start="3"><li>Calulate the second layer by multiplying the output on the first layer with weights on the second layer.</li></ol><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANAAAAAoCAYAAACPZXQAAAAFZElEQVR4nO2cvVLrOhSFV+6cRyEUDE8gPwHcnpZOKUlzO8rTpZFL0tGe6jTIT4CfgKFAfpd9C9mJcSTbsoyxw/5mUmTiv720l362DCsiIjAMM4h/vvsBGGbJsIEYJgI2EMNEwAZimAjYQAwTwTcZqECWbpAkKbKQs9IEySZFVnzZgy2McB3PQ8MZ5Q9NjiElQEJpMoNOVySEIKnHfq6lEaHjojWcV/5MbKAqeFfohoxWJIUgAOVHkHQdaxQJCHJe5kfg0/HcNWzLn/phmmTbcSPGPq2BtCRAksv8RtlGP/YshpS0SeDqLYwSBKGG9UJLx6Pj2WvYkj9ERGQ0KXnsPNqMNlbsExrI9h7wjJ3OgIwiAc85i+xBx8Cv43lr2J4/dmomSWlTGq1jpBop9ukMVDZk0NyzVYiew/m5EarjuWgYEncfA40U+7AqXLbBarXq/mxqNRLzjhwCV+uA2/zdAxC4+/fC8esFLq+B/N0MCuEryNKkoUGC9KTiUyBN7O+bZgmpSJE0NEyaFwjUcUkaFpV+J8JgUP60M07sgwxkGwUQSsPYUezwMUqUR0nop5vBD1akCW73AlK/4sHV9hVvH5hLRfbm4RVaVt8ElHE8e7bDNvdc4OIBz8cLQCiN59bg21mWhhl2lTBTPk/kvQYYqMDHGwCh8Pxwg0/tUqS4L0WQ+gl1+xQfbwCucdkjH4o0wXqbQ+pXRHjwW1hflR2IuMNpp18g/b1vPf9ifQUBuPVFfx2XpmG2ucVeCAjP7yH5MyUDDGTwnguo54dG42bYrLfIAQhlThrt4vIawBs+Oux+bHhaRMM3sXF6KF7wJxcQviwBULz8QQ6XvvXrt+u4OA2LFL/3Aur5ET71+ubP1Aww0A2e6HRKkG1usQfKnnNYNzGo4a8vnYk2R7LdFrl8xKPXY+U0Rj62T7lamE7DDBvXGi2YAum91eUQc/6OyVZlkfkzyqs8dq4NoKXnxPoKAjm8a7Zy+ncyehUpkiR1zFMz/N0DYrxV5ddS9bL/+bPadkIda8c2HSfVcI2rlpG0N9kO27xdF3u7jvypYad7tkDgt/dI+RNVwyM67jN0lhjb6vjlb/B8xtrDKMub4Z+A+1R6NPZjtDzGoV2bm+V53WVVn44TaFjttZjj/exlDWkpSMjQ12s0yU8x2+/uzdKOfaDW+B3Xm8c+UBVwW2D1wzt2kgOY7S66y0CNxnIZSMtT03kZScdBGpa7/UJqUhIkpLTGl4p0YGPYNyfqcVQm8CT2DPMnykBVIvR/kJE27ua8g+4wUH30OXyvP3/wJvMIOkZqWL02BAi7+z/o/s0YOgw0w/wZbqDDdCj0Qeb1Nu3oNA3kaKzPBiqTJrg3/J63sU31oqZUpCRIKvvyqtQm6DmsBs3R5DgN8z/bvPJnmIF6r3u8FyCtJAmhgoZjo8SgqcK0lNPa0hDN0YeoYSAtB3RCFeE6RmlYf9+MbByHNZCS/ddAPdaiXevpueTPAAPVFmuzHQY8TFFEqBvIM1U4GqhrYTxnhk6n2kdcZ4FlxvwKrdplm3X5Koqr3Jphs7oF5rqBd/MEoqfJbvey2yKXGq++jYaXHba5hH6do1hdGLznAO7CzirSe1u2Np7tjpK3jwK4WcAOX5DdOtY9p1WVn0itMunR6VB86VW2Pic+T2+dR8hl6dLfQLV1jys4U5lrjqXlSeme4h4N9LM6m0Pc3r/psQWKJeVRTwN1bNJ1bdj9KLorSUub58dzmj+nnXB95C6PCd6YnZ4VEf9vbIYZCv9fOIaJgA3EMBGwgRgmAjYQw0TABmKYCNhADBMBG4hhImADMUwEbCCGiYANxDARsIEYJoL/AcboBoss8ru2AAAAAElFTkSuQmCC" alt="1547586904341"></p><ol start="3"><li>Calculate the output by activation function in the previous output.</li></ol><p><img src="data:image/png;base64,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" alt="1547586933870"></p><ol start="4"><li>Calculate the cost and lost function.</li></ol><p><img src="data:image/png;base64,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" alt="1547587606618"></p><p><img src="data:image/png;base64,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" alt="1547587697072"></p><div class="warning custom-block"><p class="custom-block-title">What’s the difference between cost and loss function?</p><p>Usually, they are used interchangeably. But in this case, I thought a cost function as an error on the whole data set as a scalar, but loss function as a single function on one example.</p><p><a href="https://www.coursera.org/learn/neural-networks-deep-learning/lecture/yWaRd/logistic-regression-cost-function" target="_blank" title="https://www.coursera.org/learn/neural-networks-deep-learning/lecture/yWaRd/logistic-regression-cost-function" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><a href="https://stats.stackexchange.com/questions/179026/objective-function-cost-function-loss-function-are-they-the-same-thing" target="_blank" title="https://stats.stackexchange.com/questions/179026/objective-function-cost-function-loss-function-are-they-the-same-thing" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>stackoverflow</span></a></p></div><p>Below you can find the example of calculating the output of the 2 layers neural network defined before. You can change values and play with weights on the network.</p><div class="deepnn"><div class="mw"><div class="mx-row"><input title="0.5" size="mini" value="0.5" class="mb"><input title="0.5" size="mini" value="0.5" class="mb"></div><div class="mx-row"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"></div><div class="mx-row"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"></div></div><div class="mx"><div class="mx-row"><input title="0.1" size="mini" value="0.1" class="mb"><input title="0.2" size="mini" value="0.2" class="mb"><input title="0.3" size="mini" value="0.3" class="mb"><input title="0.4" size="mini" value="0.4" class="mb"></div><div class="mx-row"><input title="0.5" size="mini" value="0.5" class="mb"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"><input title="0.8" size="mini" value="0.8" class="mb"></div></div><div class="mz1"><div class="mx-row"><input readonly="readonly" title="0.3" size="mini" value="0.3" class="mb"><input readonly="readonly" title="0.4" size="mini" value="0.4" class="mb"><input readonly="readonly" title="0.5" size="mini" value="0.5" class="mb"><input readonly="readonly" title="0.6000000000000001" size="mini" value="0.6000000000000001" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.41" size="mini" value="0.41" class="mb"><input readonly="readonly" title="0.54" size="mini" value="0.54" class="mb"><input readonly="readonly" title="0.6699999999999999" size="mini" value="0.6699999999999999" class="mb"><input readonly="readonly" title="0.7999999999999999" size="mini" value="0.7999999999999999" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.41" size="mini" value="0.41" class="mb"><input readonly="readonly" title="0.54" size="mini" value="0.54" class="mb"><input readonly="readonly" title="0.6699999999999999" size="mini" value="0.6699999999999999" class="mb"><input readonly="readonly" title="0.7999999999999999" size="mini" value="0.7999999999999999" class="mb"></div></div><div class="mw2"><div class="mx-row"><input size="mini" title="0.1" value="0.1" class="mb"><input size="mini" title="0.2" value="0.2" class="mb"><input size="mini" title="0.3" value="0.3" class="mb"></div></div><div class="ma1"><div class="mx-row"><input readonly="readonly" size="mini" title="0.574442516811659" value="0.574442516811659" class="mb"><input readonly="readonly" size="mini" title="0.598687660112452" value="0.598687660112452" class="mb"><input readonly="readonly" size="mini" title="0.6224593312018546" value="0.6224593312018546" class="mb"><input readonly="readonly" size="mini" title="0.6456563062257954" value="0.6456563062257954" class="mb"></div><div class="mx-row"><input readonly="readonly" size="mini" title="0.6010878788483698" value="0.6010878788483698" class="mb"><input readonly="readonly" size="mini" title="0.6318124177361016" value="0.6318124177361016" class="mb"><input readonly="readonly" size="mini" title="0.6615031592029523" value="0.6615031592029523" class="mb"><input readonly="readonly" size="mini" title="0.6899744811276125" value="0.6899744811276125" class="mb"></div><div class="mx-row"><input readonly="readonly" size="mini" title="0.6010878788483698" value="0.6010878788483698" class="mb"><input readonly="readonly" size="mini" title="0.6318124177361016" value="0.6318124177361016" class="mb"><input readonly="readonly" size="mini" title="0.6615031592029523" value="0.6615031592029523" class="mb"><input readonly="readonly" size="mini" title="0.6899744811276125" value="0.6899744811276125" class="mb"></div></div><div class="mz2"><div class="mx-row"><input readonly="readonly" size="mini" title="0.3579881911053508" value="0.3579881911053508" class="mb"><input readonly="readonly" size="mini" title="0.375774974879296" value="0.375774974879296" class="mb"><input readonly="readonly" size="mini" title="0.3929975127216616" value="0.3929975127216616" class="mb"><input readonly="readonly" size="mini" title="0.40955287118638584" value="0.40955287118638584" class="mb"></div></div><div class="ma2"><div class="mx-row"><input readonly="readonly" size="mini" title="0.5885533447669059" value="0.5885533447669059" class="mb"><input readonly="readonly" size="mini" title="0.592853675444023" value="0.592853675444023" class="mb"><input readonly="readonly" size="mini" title="0.5970040807235782" value="0.5970040807235782" class="mb"><input readonly="readonly" size="mini" title="0.6009806609022761" value="0.6009806609022761" class="mb"></div></div><div class="my"><div class="mx-row"><input readonly="readonly" size="mini" title="0" value="0" class="mb"><input readonly="readonly" size="mini" title="0" value="0" class="mb"><input readonly="readonly" size="mini" title="1" value="1" class="mb"><input readonly="readonly" size="mini" title="1" value="1" class="mb"></div></div><div class="ml"><div class="mx-row"><input readonly="readonly" size="mini" title="0.8880759021818458" value="0.8880759021818458" class="mb"><input readonly="readonly" size="mini" title="0.8985826383577421" value="0.8985826383577421" class="mb"><input readonly="readonly" size="mini" title="0.5158313302300179" value="0.5158313302300179" class="mb"><input readonly="readonly" size="mini" title="0.5091925231638667" value="0.5091925231638667" class="mb"></div></div><input readonly="readonly" size="mini" title="0.7029205984833681" value="0.7029205984833681" class="mj mb"><img src="/deepnn/deepn.png" alt="Deepn Network" width="780" height="475" class="image"></div><div class="language-python extra-class"><pre class="language-python"><code>    <span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> torch<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>        
      
    <span class="token keyword">def</span> <span class="token function">loss_function</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>yhat<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token operator">-</span>y <span class="token operator">*</span> torch<span class="token punctuation">.</span>log<span class="token punctuation">(</span>yhat<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token operator">*</span> torch<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>yhat<span class="token punctuation">)</span><span class="token punctuation">;</span>
   
    <span class="token keyword">def</span> <span class="token function">loss</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> yhat<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Binary classification logistic loss </span>
        <span class="token keyword">return</span> torch<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>self<span class="token punctuation">.</span>loss_function<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># m - number of examples</span>
        <span class="token comment"># (3 X 2) * (2 x m) = (3 x m)  </span>
        self<span class="token punctuation">.</span>z1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>self<span class="token punctuation">.</span>W1 <span class="token punctuation">,</span> X<span class="token punctuation">)</span> 
        <span class="token comment"># (3 X m) activation function</span>
        self<span class="token punctuation">.</span>a1 <span class="token operator">=</span> self<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>z1<span class="token punctuation">)</span> 
        <span class="token comment"># (1 x 3) * (3 x m) = (1 x m)</span>
        self<span class="token punctuation">.</span>z2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>self<span class="token punctuation">.</span>W2<span class="token punctuation">,</span> self<span class="token punctuation">.</span>a1<span class="token punctuation">)</span> 
        <span class="token comment"># (1 x m) final activation function</span>
        yhat <span class="token operator">=</span> self<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>z2<span class="token punctuation">)</span> 
        <span class="token keyword">return</span> yhat    
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Neural_Network</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>Neural_Network<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># parameters</span>
        self<span class="token punctuation" data-v-54601d22>.</span>inputSize <span class="token operator" data-v-54601d22>=</span> inputSize
        self<span class="token punctuation" data-v-54601d22>.</span>outputSize <span class="token operator" data-v-54601d22>=</span> outputSize
        self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize <span class="token operator" data-v-54601d22>=</span> hiddenSize
        
        <span class="token comment" data-v-54601d22># weights</span>
        <span class="token comment" data-v-54601d22>#self.W1 = torch.randn(self.hiddenSize, self.inputSize) # 3 X 2 tensor</span>
        <span class="token comment" data-v-54601d22>#self.W2 = torch.randn(self.outputSize, self.hiddenSize) # 1 X 3 tensor</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.3</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>/</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>+</span> torch<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>        
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_function</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>-</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
   
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># Binary classification logistic loss </span>
        <span class="token comment" data-v-54601d22># Special case of cross entropy </span>
        <span class="token comment" data-v-54601d22># (http://wiki.fast.ai/index.php/Log_Loss)</span>
        <span class="token comment" data-v-54601d22># nn.BCELoss()</span>
        <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># m - number of examples</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X 2) * (2 x m) = (3 x m)  &quot;.dot&quot; does not broadcast in PyTorch</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>a1 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X m) activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>z2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x 3) * (3 x m) = (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z2'</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span>
        
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m) final activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A2'</span><span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>return</span> yhat    
    
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

NN <span class="token operator" data-v-54601d22>=</span> Neural_Network<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.4</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.7</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.8</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'X:'</span><span class="token punctuation" data-v-54601d22>,</span>X<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Y:'</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span>

Yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#or NN(X)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'L:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'J:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h3 id="gradient-descent"><a href="#gradient-descent" aria-hidden="true" class="header-anchor">#</a> Gradient Descent <a href="https://towardsdatascience.com/gradient-descent-algorithm-and-its-variants-10f652806a3" target="_blank" title="https://towardsdatascience.com/gradient-descent-algorithm-and-its-variants-10f652806a3" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>When you know how to calculate your result is time to update weights to get the best result in your neural network. For this you need to use Gradient Descent. This algorithm is use the fact that if you want find the minimimum of the cost function you can use derivative of the cost function to recognize the direction how to update weights and the value shows how much to update.</p><p>Let’s assume that you have only one weight (w), so the cost function J(θ) you can present in a 2D plot. (on the x axis weight, and on the y axis J(θ)).</p><p><img src="data:image/png;base64,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" alt="1548179188819"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAAtCAYAAAByBT9fAAADjElEQVR4nO2bsbKiMBSG/+zso6DFHZ8gPAF3m1tte7tYarPdlnY2oYRu261us+EJLk/AWBjeJVtAEBVUSMRrJt+MMw4hITk/OZxzRKKUUvA8Pd8ePQGPHbyQjuCFdAQvpCN4IR3BC+kIXkhH8EI6ghfSEbyQjuCFPKNEFi8RhgSEEJBlZnf4bFmNS0KEyxhZWdoZV1lDKsGZooBC/aFMKGnvAvdH8nr+VDFx55lLoTit7cTNr2VJSKEYrQzAtQG0UZiwc4m7IxvDTjdlfU2qTLW0IGTfZPRxpp5CymY3TjtfyamVXWn8jCzjd6xzgPI/WAVdZxTYW3oMTAJ9wezRcxiBoZAZtuscAMPvbhWfj3wH+eg5jMBIyDLeIAVA+S9EZ60SuxwAFpg/g8bBHAsAnR6kiTQJSBjjtLmMQxBCEMbtlgxL3YcQ9AW/sjISFoZGMhCyxL+/OQCKnz86JlHuUYwf/EDbiIM+IeJBLj3CGwOAHLvTLRklkIJV3zt2rBbjdLxEclS9GN7O73QAJfYFAFC8GPrz7+O76h2XYz0jWPedZvrMiRIolZiMYIUgegNDivSsJcNHfTDfSQDHN3WBPo/VxoLXGh0mCVbliz2xumD2cqQpkOJauiQUQ0d0ru3Q1Vew61Fw3Z9ys5x7tJCXw2a96ClzsrHIGxPzrjSrOkY5r9ZLeUsM3XaDPE3qM95exkJ2Xri5S58kh1SHHUkvWFJ7meaUZsfVIreFFOxE2N5BG0/wkB15tqiONitute26Bn2GV0uqeff3O15z5XWq76fFj3bbJewVTQyCnR7KGJsUsJZbTh7s1FFrx9RnLxRAjmJfIvt4RUo5ZAQAAeYLAHmdumxfkTIBdTnCwSFgNGd0+lEt6pQS8fsaOQAmkiuR2lfjeioQzKtME7stNikF/7Nq9Nb22G1DvBYcMrll9TNU3VJ8mP7IMnov6wd08xyQTxepHqMDtAturuXmT9eoY4ahLt2WzcyK5pLXv3rUk6FM3fvXn7txdmMOPKdJI4YZwFbR3OwZGayQfK7w+HR9IoIVPtWqu+3BhQv/hoBG11onLpp/gVqra+haq4XA42Z0ea+vFjsAI8fsHIcy3BSvejCLbyT4HXlEhERJCL5AsZnd9+Wr2QbFgkNIhZsylSsQpfwfXV3A70hH8EI6ghfSEbyQjuCFdAQvpCN4IR3BC+kIXkhH8EI6ghfSEf4Dd1cE1syEVzsAAAAASUVORK5CYII=" alt="1548137149402"></p><p><img src="data:image/png;base64,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" alt="1548137409720"></p><p>Where your whole function to calculate the final cost <strong>J(θ)</strong> is:</p><p><img src="data:image/png;base64,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" alt="1548137505581"></p><p>Your gradient will be a derivative cost function on your weight.</p><p><img src="data:image/png;base64,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" alt="1548137519406"></p><p><img src="/assets/img/1548138648303.18d18150.png" alt="1548138648303"></p><p>If your gradient is positive, this means that the plot is increasing, so we have to subtract the value of the gradient (go to the left). If your gradient is negative, this means that you need to add the value to your weight (go to the right).</p><p>In your final neural network, you have more dimensions, and it is impossible to show it on the single plot.</p><h3 id="backpropagation"><a href="#backpropagation" aria-hidden="true" class="header-anchor">#</a> Backpropagation</h3><p>When you know how to update weights, it is time to calculate the gradient for your neural network. You need to find the gradient on your weight, but the problem might be your equation that is little more complicated.</p><p>Let’s look how you calculate your final cost.</p><p><img src="data:image/png;base64,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ynxjfLMV+3qQ3GZ5SicrAEaariKbNlc4BopTWaj1Abe62dEDaMin0rC5oCSR55599lkAwIULFwJOiXtmZmYAAM8991zAKSEiok6dPHkSGxsbOHbsWNBJccXZs2exvLyMiYkJxOPxoJMTeoODgzhx4gSWl5ehKErQyfGAjtvGau+QZJQqZTh9ucfi4iLOnTuHoaEh5PN511NYr09chcCTwtOdEHW1N/sQtmvo818u49t/mg46GT1tY2MDjz32GO7fv49bt25teeVZFC0vL2P//v3o7+/H9evXbfcS+3YuhvA6JIocH64j1k/hcODAASwuLuLKlSs4ePBg0Mnp2OrqKp544gnEYjHcvXvX0QhmmM7FY68O4/QXX/N1n88//zwuXLiAEydO4OTJk76/rjSszp07h2PHjqG/vx9Xrlxx3MHjtCz9f884EVEPiMViOH36dNeMPhw7dgwbGxs4ffo0K2wioohTVRX9/f04evQoFhcXg05OR1ZXV/H8888DqB4P6yZnzp8/j1OnTkFRFBw4cKD9++d7wPPPP4+jR49idHS0o0C8EwzGiYg8cvjwYZw8eRILCwu1YDZqzM6E1157DadPn8bw8HDQSSIioh2Kx+O4du0aEokEDhw4gJdeeilSddS5c+fwxBNPYHV1FVeuXMHg4GDQSYqkEydO4O7duxgfH2dnBoAnn3wSt27dwuzsrG+PPDAYJyLy0Msvv4zZ2VksLCxg//79kRqBWFxcxP79+7GwsIBLly55/twUERH5J5FI4Nq1a5idncXVq1cjNTJ68eJFnDp1CtevX2cgvkOJRAL5fJ7BOICJiQkMDAz4us9dvu6NiKgHHTlyBIcPH8bZs2exsrKCoaGhoJNky40bN5DL5TAxMRF0UoiIyCNHjhzBkSNHgk6GI6qqBp0EIlcwGCci8kEsFovcyDKDcCIiIiLvcJo6ERERERERkc8YjBMRERERERH5jME4ERERERERkc/4zDgRERER+eKhB3fh818uB50MIjz0IMMgCh7PQiIiir5dceDNvqBTQRRtu7x/r+6lqX/o+T6IoubBDz+EY68OB50McsGDH37I0fcZjBN1IY48UFj4NvKQXvNnP0RERC779//svwSdBApIn/huXOCD+0Gngyi6dsUZCBARERERkSP/HxgTuqUH4LmFAAAAAElFTkSuQmCC" alt="1548183708290"></p><p>In backpropagation, you need to go back from right to left and on each step calculate derivative to update the previous layer.   For this you use the <strong>chain rule</strong>: <a href="https://en.wikipedia.org/wiki/Chain_rule" target="_blank" title="https://en.wikipedia.org/wiki/Chain_rule" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><p>In the <strong>chain rule</strong>, you can calculate the partial derivative of the composition of two or more functions.</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhIAAACACAYAAABeDIDeAAAcB0lEQVR4nO3dO2zbWLoH8L8vbqFS3Wqq1QJ2oA0CrNM5VONuHadYTePxVM40lKeKphggCxjwFgFcpDDV3MRqMq6yk8aeIuR22SbydElh2IFJwO6creSt5O67BUW9rAffOpL+P8DATCSRPOfw8fE8F0REQERERBTC/0z6AIiIiGh6MZAgIiKi0BhIEBERUWgMJIiIiCg0BhJEREQUGgMJIiIiCo2BBBEREYXGQIKIiIhCYyBBU+H29ha///57pG1E/T2l4+bmJvRvb29vYzyS6RMl71Qz72U5TRhIkNK+fv2Kf/zjH/jmm2/w66+/ht7Ozc0NfvzxRzx8+BC//PJLjEdIcfn8+TO+/fZbfP/996F+f3Nzg2+++QY//fQTvn79GvPRqS1q3qlmnstyGjGQIGVdXV3h0aNH+PXXX2FZFvb390NvK5vN4tOnT9ja2sJPP/2EH374IcYjpX6OVUaxuICFhdZfsQpnxPd//PFHPHr0CH/5y1/w9u3bUPv0yvjq6gp/+tOfpjZgnETe+TuuKsrFBRSro45mzDaqRSwUy6hao7cxK2U5N4RIQY1GQwqFguTzeWk0GrFu27IsASDPnz+PdbvkMnUIoIthi4jY7v/r5tDvVyoVyWQycnJyEtsx7O/vCwCxLCu2baZBhby7yxZDgwCaGKYdfWumIboGgWaIn61Na1nOEwYSpKTV1VXJZDLy6dOnRLa/t7cnAOTNmzeJbH9e2YYmAEQz/D1wkiyHUqkkmUxGzs/PY992ElTKuw5TdPh/6PvnBSe6DA+TOqatLOcNAwlSzqdPnwSAPH36NLF9NJtNyWazsry8nNg+5k/roePz4dBsNiWTycja2loiR3N9fS2ZTEZKpVIi24+XWnnnCvawD85/kDJdZTl/2EeClHNwcAAA+O677xLbRyaTQalUwufPnzmaIy7WMWoAoN3Hko+vv379Gre3t4mVcy6Xw+rqKo6Pj/H58+dE9hEbxfLOPaaXqNQBzfgZjxPZwWP8bGhAvYKX1uhvTlVZziEGEqpyLJTbHa6KuNO/ySp3OmMtlDHmOpwgB1a1jOJCp/NYsViGZVkoF++m6+bmBr/88guy2SxWV1dHbLbayZ9itTf9XXlXHpEx3k24Wq2GTh15HFSPa+5/PriHRR+/ODg4aAd0SfHK+PDwMLF9RKdi3jmovqgB0LHzzM8RhbP4bAc6gNqL0R1KgWkpyzk16SoRGsQUXdPFtEXE1AVDqv+8NtVRnbF6N9vaVuA/TXw22/YfYbuTlt7upNXqQDakGvfk5EQAyOrq6ojNGqK18uNuu7JXRTy+Svb6+loASKFQCJO45Iwtp7DlkYxOed79G3ZqXl5eCgBZWVkZvmHbdDvlDUtzTz4NLmtvP/l8PmzyEpVY3t1hi2noonVtX9N0MU1TdG1A3tqG+91x9xbb6JSRZvSWQVf5jdqMmwfjz2nVy3KeMZBQ3vC2U+8h6jeOSJcXRAw4vhHB0dHRkQDw3xbac8Nr7TNAxzAAks1mfX47He0ba18Pee+h47czXrqBY1fPfh+//fDhgwAY0cYfXzANQDKZjN+EtHY/zXk3fPt+A3pfHT9jCuiDdDINVZaUOAYSU8C74PvvlaaeRG/qmHg34kE3+NZng24c3lCv7e1tnzvqBA+GoQXOj3w+LwBiH2IanpuegWUNiKZm1ChBe/e/ffs2QIfaaMF0LpcTAHJ9fe1jX5OQZN6FC+iH3XOG7yZCQD/qXtFH/bKcT+wjMQWW7msAgNOLrlZEp4oXNUDfeearTTVdXvsqoJfudtNyLk4BAA/u3T1yb4rfP/zhDz73tYh7DwDUK6i8ewDzY7j8UGdq4UU8+yg46Mo2p1rEeg2AbuLjQTLd3iLzOgv6bOO/uroCAPzxj3/08e3HKOkAUMNxX58X+6wOaAZ+HpEtmUwGANSdITHJvGt1mIRuYtipo2086duvA/cS1XDfT89PAFh8gg0NwOkFqtUtVGDA9nstLt2HBve34/pJKF+Wc4qBxBRYvPcAAFA/s9v/5rx/h/qYG+jk2DirA4COu3GEg/fv6hh2k/JuFP/5z398780LtPSdg9C9y739qsapFrHkdp2HrWoQgU5wqPl88nj5/d///tfX96cvmPYvubwLH9AHF09AT9OJgcQ06I/YnSq2KoBxGPBi7RnpEeRvwKiRUZwLuC80A4ayOe/hxhEbeDLg4HO5HIAANQROFVuVOgCg1v+66oP3duftVylWuRNEKH5jtt3I0fdDKWg5RwmmvbfXfD7va19pSy7vwgf0YcQR0I+jelnOKwYS08CrNqyfwQZgvaygru8g8KisxwcQt19MwL+PwfZln6E+5CPrZcX9bEg1rneD8FV16VgoL1XwwDShA76qRrt5N2Ilb0pOFUW3PSP8211agSMsuKMXBz2wBvPy3AvkxgoZTN/e3uL29haZTAbZbNbfvoDZyLsIAX1gEQN6P0KXJSWOgcRUaFUb4hTH5SLWazpMhau52zf9Pk61iBen7ifDqnELhQKAETdJq4yFstUKItZR000cPG61odff4X2Am/iXL1969qkMp4riUgV1aDDsCG93aQWOox5YQwSueQoZTHvnUeBgcRbyLnRA791v6uiqABouYkDfPs4xfURClyUljoHElHCrDeuo1erQzeSqDmOxeA/ufajzYHeqZbzEIQ433P8fVo2by+WwtraGq6urgTNOOhenQG0dC0vrqHX1G/Dy5917B4CD6oDJrvr99ttvAICtra3gaUyMe1N2g4jeh5JVXnCDKMU479/5ehB0y+fzWF5exufPn33WSoQLpo+PjwEAa2trPo8sXYnmXYSAfmCflG4xBvR++4ioXpZzLcERIRSnAEOklNAzUU1n/Lq3uuGoVHhzSQxanbMzDLJ/aJnZHuYGTfc1Hj+Xy0kul5NmsxkkZQnqHu/f90mr/FUs/sBDBVtevXolAGRvb8/X99tzRgTY18rKigBQdrGnZPPOGzbbmZ/CNnTRDXv8sNkxE1J1l0X3MM/eOSFsMQZNdtV/lD4npFK9LOcZA4mpEHyipUkxdU00Y9jdyf94ee8hn9T8Dt5YfJWWEu+5OU/BjJauYJMpdQu8cFrAYPr8/DzgxE1pSyHvQgf0oxfsii+g93dPUL8s5xsDiSngN2KftHFvOUFm4jw5OUlstb/Ly0vJZrOysrKiUG3ElPLeXEOuEPnmzRsBILu7u+N2FCiYbjabsrKyItlsNrGl6CNLMO9iCehHTBwXFz/3hKkoyznHQEJBtqF1VQ1ORxAhMi7gCbZMsoiIZVntWoO4HviXl5eyvLwshUJBodksp1gMTW67u7sCQCzLGrGbYNfB8+fPJZPJjNzmxCWUd/EF9GosIz4VZTnnGEgoqHchn7vt5crqujF23xjsdvVq8IDo6OhICoWC5PP5SDeSRqPRviFtbm7K5eVl6G1RR1y1Zbu7u+2yub6+Dh1Mn5ycyMrKiuRyOeUfPEnlXbwBfbDpu/0bH6RMU1nOOwYSyrF72hjNKaiJ6GabhuhaX1u/polumJFuRJZlyf7+fujfN5tNqVQqDCBiZMfcAfj6+loqlYqsra2FCqabzaYUCgV59eqV8k1WSeZd/AF9VzAXww3JNltNOtrwIGKaypIYSBBRYJ3RAHoibW7THUyPlnTeuZII6N1tRhw5ZOpuJ8zZKtS5tyAiEss4UiIiIpo7nJCKiIiIQmMgQURERKExkCAiIqLQGEgQERFRaAwkiIiIKDQGEkRERBQaAwkiIiIKjYEEERERhcZAgoiIiEJjIEFEREShMZAgIiKi0BhIEBERUWgMJIiIiCg0BhJEREQUGgMJIiIiCo2BBBEREYXGQIKIiIhCYyBBREREoTGQICIiotAYSBAREVFoDCSIiIgoNAYSREREFBoDCSIiIgqNgQQRERGFxkCCiIiIQmMgQURERKExkCAiIqLQGEgQERFRaAwkiIiIKLT4AwnHQrlYxMLCgvtXLKPqxL6XyZuFdM5CGoiIaKJiDSScahELW8coHX6EiEBsE3q9hspScaYeULOQzllIAxERTd6CiEgsW3KqKC6dYUcO8Lj7360yFtZrgG5CDh4P+/X0mIV0zkIaiIhICfHVSCw+w8f+BxMAPC5BB4DTC8zEi+4spHMW0kBEREpIr7Nl/Qx2ajuboFlI5yykgYiIUsFRG0RERBRavIHEoFEA1sXg71rlzvcG/inc6W8W0uk3DY6FcnHEsfakrwwrlYMnIiJVxBZIONUiFpbWUcMGTFvckQCH93G2XkENALT7WOr6vnVcA6DBMG33u60/U3c/14xDPFuM6+jiMwvp9J8GC+WtY5QOBWLqAOqobFV7+088PoBtaO5/66W7/S6IiGi2SRxMXQAINEPsOx/B/Uw3u/7VFkOD9PxT13e1/g9UMQvpDJyG9qeiAwLo0v+pbWgC3E0nERHNvhgCCfdhOexB4j1kNKP/sTX4e4MfYiqYhXRGS4MXaAwMjAYEJkRENPuiN21YL1GpA9AM/DygXts+qwMAHtwbXn/vVItYqtQBzYCt6vwFs5DOiGlYuu82YZxedDVuOFW8qAH6zjMo2BJFREQJixxIOBenAABt48mAB4mF4xoA6CgNe25a5c7D9aO6D6NZSGfUNCzeewAAqJ91Boc679+hPiQwISKi2Rc5kBj5Fmsdu533hnXCc6oortcA6DAVDiKA2UhnpDQAwNJ9aEBnwiqniq0KYByqXXZERJScROeRaI9YGPS66lRRXKqgDg2GPWCWxSkyC+kcmQbP4hNsaGhPWGW9rKCu7yg5uoaIiNIROZAY2G4OAFYZ7kv4oAeNhXL74fqx53OrvICFsnqzEcxCOsOlodsi3NaNUxyXi1iv6TBV7dNCRHj9+jX+/Oc/4/Xr15M+lNj88MMPePToEf71r39N+lDIE72/ZmtYYFevfds0RBsyxLAzckC70/vfbg1NVHPgxiykM2ga7mqPOlG2nIio0WjI2tqaZDIZ2dvbm/ThxKrRaMjTp08FgGxvb0/6cEhiGf4pIrYpemtYIQCBpolumAMfTN0PosF/mowZQTk5s5DOAGkYyJuHYtajCLsVYDFgCob5lhyfedtsNmV1dVVyuZycn5+nd3wpOzo6EgDy9OnTSR/K3IsnkKA50aplmYc5I7yAacAEXMNcXl5Gevvb3d2Vy8vL0L9XwgTyTWRG8m4cn3m7vb0tAGR/fz+1Q5tUGW5ubgoAefPmTaR9pyrENaI6LtpFvlnlJVTq2tSP0nCsMorFrvVOitU7y6a3h8oaP4/tIPvlyxd8++23ePjwYeRje/jwIb7//nt8+fIl8rYmYVL5Bkx33sV1Tv7+++94/fo1lpeXUalUEj1mYPJluL+/j0wmg7///e+4vb2N5RiS5pWjnyUFHKuKcnEBxZALMjnVYmsdpYQXdJp0JEPqsg2tNctlp7+Hss1OPrmzc+qtdNju/9+pJ/af3svLS8nlclIqlaTRaEQ+vuvraymVSpLL5abwDXty+SYyvXkX5znp9R04OjpK8IhdqpTh3t6eAJBXr17FcgxJGzZDcK+u8jaj3XRt03CbsxOsSWYgQUO1197A4E6j08bvNObtTqljEtxoNCSfz0uhUJBmsxnbcTabTSkUClIoFGK7QadjsvkmMn15F+c52Ww2JZvNSjabjT1f+6lUhufn5wJAVldXYz2OZAxfs+jOd2J98HuBSTLNKQwkaIjOuhzQdIkYFCvAzwXc0urUNi5wKpVKkslkEnn7PT8/l0wmI5ubm7FvOzEK5JvINOVdvOekZVkCQEqlUpwHOZBqZZjP5wWAXF9fJ3I8sfE6zA4tyCQf+EkEKC4GEjQfRqx62s99Sxx9IV9fXwuARB9W3vA95W+OLarkm8iU5F3M56TXrJF0Fb+KZeh1MFW+ecPURzdPtc6J8TVU4SS1UjM7W04lC+WF8B1w5o+DqruQCPDg3tiOojbGdxasVqsAgL/97W9xHOBA3333HW5vb0NOJpT+OaJKvgFR8y4N8Z+T//73vwEAq6urcRzgUCqW4V//+lcAwG+//RZgD+lfI87FKaBt4MnAAndQfeEupbCT0HTBi892oAOovbjbmTeSeOMSSodb/ZVU1DpLevt59P5Ficpzudzotuie+ToGvIG0h4ANr8ZsNBoCQHK5XIgjjOscscU09Pb8BQBE03QxTVN0LXjn27H5JiJiG52804zevOnK11HlFy3vkpXUOeltI1ifheDlq2IZfvjwQQDI8vLy2O92HUjq14ipj9jf2GaPzvei5K17/sXbcX42Aomem3KQvykahWAbommdnt2G5p0otpi6JpoeYFKpSUu9vOIddeLd4PL5/JBvmKJ7/UpGVF+3Jy0bcePI5XL+Hw6xnyPds7O250LtehAGa8cdn29eGty8utsR0etT4G/fgfJuys9Jr7kh2Lth8PJVtQw/ffrkL+hQ+Brx1fE2hrz138HXv9kIJOaFbYrROtkNHaLpbhSs6cYMdIZMUrydjIL1Eh/eoc5Pe2WhUBAA/mcojO0c6XS2vXN8Adr2uwXuXd/zhhZ8MrTAeZeqeM9J70E68gHfI1z5qlqGl5eX/gMpRa8Rf8NCu3cfMm8TmJ2YgcQU6ky/HX2M8VyI+cIJ2jt+2A3C1Mdf+KurqwJAPnz4EOgYI58jo/IsZIew4KMKOjdHw9ACP3TD5l0qEjonfVfthyxfVcvQqykB4HskiVrXSJgaqpB5awdbX8mP0J0t2zOwpfA3SSql03EslIsL2DrbgKEDurGBsxdbKFvO2I4zKqUjbe0ZAe8vxbK9r1+/AgCy2ayv7w9cddWp4kUN0Hf8zRJ6dXXla19RzpGurbQ6fQF66W73Pi8/H9wL1iEsaL61V5utV1B59wDmx3AzqvrNuzRN9pwMX76qlqH/41H7GgkmnryNQ+hAQtzajFT+JkmZdDpVbG0d4/6OjY8Hz3APAO49w8HHQ5QuXmKrbI28CJRJxwTYZ3UA8V3U+XwegP8H1KK79jrqZ3b735z371DXDPw8Zo5cb9pfb58jRTxHOmy4Wabj7j3Swft3dQAagj4Dg+Yb0AnC9J2DsdMJ9wuUdylL6pz0HvRj9h66fFUtw+50ZzKZ4V9U/BoJKkrexipwHYaK5qGzZY8pH7WRankFmPTHJ6891nc1cn9Vom2I5jMt3kQ7wSf+iXCOjKr6jFAtGjrfQjYBBMq7KT8nvb4LvkapRChfVcswUB+JzsEpdI2EaNoIm7cqNW0o5fFByLfnj0houG7CvGh4SqVZXs4FTgFAu4+4Xg5yuRwA4Obmxt8PFp9gQwNQP4MNwHpZQV3f8ZUW703L26d/Ec4R+wzDfmq9rLif+Zj7oF+gfHMslJcqeGCa0AHg9CLwuPdAeTcj56SvGokI5atqGXrfC1b7pNI10mqmQB1dFZfDRclb79hDXMNDxRSQECnJzxDLMLze5H5nTvTGbuv6+BkKPd5bZqFQiHawQQ15Y7ENTTQt2tCxkflm6m452b3rSoQZ9z6xvPMhqXMyk8kIgPHrU0QsXxXL0JtHYmVlxf8OokjgGhk7LDOmvE1i+Ods1EgQDeG1RQ/qEBVFuVwGABwfH/v6vtuWWUetVodu+mvP/Oc//9mzr9Qs3oP7cvQO71uvOU61jJc4xOGG+/9h2/ZH5ZtzcQrU1rGwtI6aZsA+cHPJy7t37x0ADqrFIsZNRjixvPMhqXPSd/+FiOWrYhl6aU6tP0wC18jikw24FZeDqyTiylv3/NOwMXh6zXBiC0lEWrNqaZ32w/bEHzNmVtI5K+kYKrnlzxuNhmQyGf/j6UMM9ysUCqms5DhQz+x5ncl2vCWvw75Lj8o3b5ispve33Zo9C8j5KcuJ5t1IyZ2Tz58/FwCyu7vr4zDCl6+KZbi5uSkA5O3bt+M3HJfYr5HRC3bFk7fJLNwVWyBhG1rvKpFe9cvUdmgcbFbSOSvpGKndGSmZpXO9hYIsyxp3IIEn4jk6OhIA8vz586iHGYipa6IZw3IrnpuQ/3wLZ1J550uC5+TJyYkAoyeLiqt8VSvDbDYrmUwmlcAx0WtkShftiieQsA3RBl0YCcygNVGzks5ZScc4Caen2WzK6uqqZLPZkb3Kg7ZhXl5eSjablbW1tZiO1J9xN5m4bkJ+8y2MSeWdbwmfk/l8XjKZzMB+EnGWr0pl6PWPSGPZ+OSvES4jPkByB66WWUnnrKTDlcTiNP0ajYYsLy9LoVBoz75nG1rrjSJ4NfaHDx+kUCjI8vJy6tXyo/Mr3iGLg/ItqknmnV9Jn5OVSkUAyP7+fsB9By9fVcrQqx05OjqK5RhGSecaSeI+nGSAklYgkdDBq2NW0jkr6RCxU6xdub6+lt3dXcnlcrK5udm3uqPm++1kc3NTcrmc7O7uju95n4SuPOvpid5uC473Adifb1FMPO98SOOcvL6+lkwmI7lc7u6oigTKd9Jl6DXnBFv1M4LUrpGul5CIyyDYpjfCJLn7OgOJWMxKOmchHZ2+HnrKnT2azaYcHf1fT8enIPcAy7Im/iZtm0ZvB1yvI5mR3Oqybr5Fe5tUIe+GS/ecfPXqlQCQ7e3tO58lVb6TKsPl5WUBICcnJ5H2HUSa14i7rwhNJabudsBMeE2m+AKJQSMATGPwgymGteonxm86u9IxMErtmUlvAg/ueSkvojnkNXHs7e1N+lAS0Wg02iM13rx5M+nDmXuxBBLtCVa0rmVYbe+h1NfWE+Na9Wnzn05TdO9tdMRysklNTDPOvJQX0Tzb29sTwJ2kSc2l1MOxLEtyuZxks9l0h3vSUNEDiREPynZb8fAurpHWqk9V6HQOby5IaijOSPNSXkQk5+fnsr29reZS6iHt7+/L8+fPfc8qS8mLGEjY7fbgQc+e8VNxRlurPj3R0uk9oPt/a+ppP4jnpbyIiCgt0abItl6iUgcwZDnk8UvlqrOe+kgR0+kt9Xp60TVvqVPFixqg76SY5nkpLyIiSk2kQMK5OAUAaBtPBjxQLBzXgMHrtXcos576CFHTuegu69Yzh7rz/h3qQx7oSZmX8iIiovRECiRGvsFax3CfS6XhDxyniq2Ku43asRXlUBIVOZ1L96EBnaVenSq2KoBxmO4b/byUFxERpSex1T+t4xoADcawV+4Y1qpXwdh0AsDiE2y4y7rBRmu9en0HzxRqF5iX8iIionhFCiQGtv0DgFXGeg1A/8PSKmOhbLUeSuuo6SYOHj9GSUfPcqyqCZzOO1p9C3CK43IR6zUd5kH6DQPzUl5ERJSiaH01784J3pmOc8S8Cf2/6RktYIuhqbYCZbB0DtKd9slN3DQv5UVERGmJPo9EzwyOo6cKjXOt+tQFSOdAqqysOS/lRUREqVgQEUm5EmQOOagWl1CBAZtDJomIaIb876QPYB5Y5SVU6hoMm0EEERHNlsRGbcwzp1pEserArYlYwHpNg2F/VGqUBhERURzYtJEAq7zgjoIAAGjQzY+YwCANIiKixLFGInYOWhNIApoO02YQQUREs4s1EkRERBQaaySIiIgoNAYSREREFBoDCSIiIgqNgQQRERGFxkCCiIiIQmMgQURERKExkCAiIqLQGEgQERFRaP8Poc/8Yr6tToUAAAAASUVORK5CYII=" alt="1548140736187"></p><p>For example in your neural network you if you want to calculate new weights on your first layer and the second layer according to the <strong>gradient descent</strong> you have to calculate partial derivative on your cost function.</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAABFCAYAAADqzTvdAAAKPElEQVR4nO2dP3KrPBfGH755l2JukckKxAqc26Rym04u7eZ2Lt2lgTLu0rpKE7ECs4KMi4i96CsAmxjx12Bs5/nNMHNvLBCRw8PR0TlHjjHGgBBCRuB/Y98AIeT3QgEihIwGBYgQMhoUIELIaFCACCGjQQEihIwGBYgQMhoUIEIuRRxi7nlwHCc5vDmCuO8uAsw9B94ZF44DL7m3sOebs0ABIuQCxIEH5+UDz+87GGNgtIKMNli6nl2EwvlRqNKjWlRiBJ4D92mLh5XGbjEpbRcGc3j5685D5K88WeygVw/Yr104XoBBZcgQQoZF+0ZAGnX6cyUNAANZ+OTn54ARvq7oQBkJGAjfVLUyRhkpYABhfKVz91Z2D9r4Aga2e+8JChAho1EjHJk4VApAU5HI2gnzU8vqzm8qbt3gFIyQsYn20Laf6z0iAJDPmJadG75iGQHC/1feBkAcvKTt3mGfnX3h2zrXmuKfL4BoidewooOOUIAIuVLCjw0AQDy4JS1iBOsNAIlVqc8HAEK8LqMG7exMFitIAJt1//4gChAhl8C2AhZ+V52A76/kX49/SkQj/sQ2QrWFBCAO1tigzErS2EcA8IiyboApniWAaIvPnhWIAkTIwMSBB8d9wgYzKG2SVbD3B+yfltgAgHhA0cbJhEHiuURd4s8tIlRZSAAQ43MbARCY/bUoTPyNrwa/g/sgAETY9qxAFCBChiScw02cL9C7BaaZBkwWiVUBAI9/UJCG8KNCnBJ0olDlFlLSKhWyCEvXKSztO+4y8TNV9AMAkz+PAIBob/VWdYYCRMhgZD4aQK4WBZFJrAq7BROn8y8x+1sUp/TaSROBSgMoEzKpEsvr5FCpCJb3c7hZCAD4+u7VD0QBImQo0hUqCB//LNOocgsmmzbVWTf1HITMqlIhUj/32f10hQJEyEBUWzHZw2/z8WTTphrrpgVWgcmsowo/09BQgAgZiEofzWFqZFnByhzDYgab37jLPdg4LPPXxBANyQ0JUJrD4gVoGg8VBx68eYAL5NTdEBzHayB5+AV8y9wsW92yOqcPTJD4hSN08gvHAdapBdYoNigLiqy8pw4MEF09AEm4uPBV+3Bw7RshhClLt/ldcBwvifaFPY+rJgdMyST/q26sS69vafPzWln6RX0fbfrqwg0IUPbQVPziOkmyK22jfSMKOTC/DY7j5SnmUWmV5neV5laV5WzZmlYlkp60OfSnDwLXRkySc/r/7q9fgJQsT5TTyvhSNMoY1r4YLKHuJuA4joPOMtDTQwgjqyzQRgmoh8bNElG1/+MehJBGtfoCh0tIvXIBSgfYpvDaN0LIpKxAatJWv91/89ub43gz1JXoKGnf99Qoj30a1w/XLUDp26D2F2/0JTSYgtwrHMcbob1vZviaPVdajiMMvJOwbltlt6RKm+M4mJ8uucTBj6ps1opveo+ot1iIZNWg71Dyc+E4koQYYVoyA1LhrfG6+ASLnYLEBk+9Vy+MEXhP2EBC7YqR3H3QWYCmi90hjBsQ8PWuWGckiwS1MVng/XgBCF/hvUOpgNb0HEp+LhzH306IuePAcVw8bQGpNExz9UmZ4s1o+FjCdbxeajnHYQDPcbGEhDJvg8UJnRUHlOWy2AOmjnkwZUyy/BLh430xLShsEklaVSbgPuA4/mameMtys3Y7vE27fkkTLHYGWs2wX7tFS7kN4Rzueo+Z0jC74cQHOFOAsgxZK/EntpGAEFVNtogg4L/bzbvk+mWV2u4HjiPpi8l0gbedaTGFszB9g9m9YdFZDJszWCR0+LpEJFdYlT5baZU2uSopETkQfUdyDgzHcSySqdE529uQeoYRoDjAemMPM88I56lzq0qq3QeIBqHmWdJftNcVfokk+a+6eNOVwXFsRhwimJfst5Vtb9PaQeviocLqJD1x1hpaIcoyQcljHIM1rDw9r34ptyJ+JbdkWTwsS5Jd4ldy26K0O1r2c+/jOCRKHsbuuNOMSO+9RVRxcmISE6WNycYlGTJtlBRGyA4pLKSS/gXo5A/U9uAo2SKuoCqCt9WtXnEEL8exGyXCfYh7krJ9AF0aFS6kMr6EETIROCH9ltHDpAm9C1D+rX34f/4N1DQo7tjJ+YFv1/bWPoXj2IGqoL00eO6MCOEs+vfHJn6kd/oVIMsf6M8HJ/2jaf0GvfMs7nsdxyGnsGXWT9Jx5+hdnSXkSt/4Ekb6vpFCGKl07bW6/a73cXTlzFSMn1/06VvbmJMHR8n2/pED2ihfGiH8xtMI7YsbMZ05jm2pLA/R2jrMnZflxZlkzA8+IF/SBzQA/QlQiXl+fHCqHKFXyqWc0Pc+jgNQVTOnaT2dapjzdgn+Q098vi4RSYVdWXDI5yuWkYTajVX8sQPTNxjzdtEu73Ice+e4aV/xo6zS37m5b2ld5tk51yC1nKdfR2df2Vs/exvhDIfg/cNxbIvdytHGl75RvjhjivobuJ5p+JkClIshqSkvOVy5gHuA49iaXN2cxC+vjBTJ2PyoX5P9nGKUcl0LOr0JUNlN9TMfv3c4jl1Q+SqOeQex9o/L8BSfHNdXlve6C5IRcutoZaQ4CiUOkdYjcIVleW9oWx5Cbos48OC8fOD5fZeU29AKMtpg6f4sOneRonRZWRfrPmQBvJcP4PkdJldbqozJ3xlEtMVnH3m6PYgYIeQU7RthszZKaj4ffXwl05tcSIi1tHfuc6t/50rL8tICImQIJgvsbJUEp8+QQKGi5NBF6a61LC8FiJAxiPbIP75DF6UbhB7K8lKACLly+ihKd61leSlAhAxFHGLunRRKC79bXqOfonTXWpaXAkTIAMSBB8d9wgYzKJ0WnX9/wP5piSRT5AE/3DGZD+eEzPopLbebpp4I/9+gxeOt9FCWlwJESN+Ec7jLCBA+9G6BQ233yQLP2Sp3k4e3ifXzukQk/PqtmK60LC8FiJBeOa5YyVXRIZytdjV5eO3WT24lK7V+bP0UmPzFTACbD9t+PccYIzfbgG7zBNdx4DhzFM6Iv/EFgVlxua41FCBC+iTbRFL4sBkuep884I913uBa6ydG8JJYPxUGUo4JFisJbD6KgpLuKWaM7SiGEsSfW0TWcIH2UIAI6ZFsCiNmfy1WSTJ1ASSeT5/qyR/kF7lqfT/hK5ZRy2X36T/4YoP1OVsNxQFeluhtub+3ekCEkBoLJ/xIHNC2dIg8mfWjK6yf9QaQquVecBMsdhrwXHhQ9oDFmvvyXrZ4VJbtwztCC4iQCxF+bABUO5WBrChdhfWTFaXrtP1pIkIrfODFCyzTMTtx4MF7BVbvu/N2XT3l7GQOQsiB0lrVJTlguQa/sigdLSBCemSyWEECiLafh2XsOAzgPW2SZflS8yG3E2vtNtsSq4vuwz0cFCBCemWKN60gsUyXsR246y0efQW9a+a4lQUP9cnnypLkeqM4xhgz9k0QQn4ntIAIIaNBASKEjAYFiBAyGhQgQshoUIAIIaNBASKEjAYFiBAyGhQgQsho/B8TEP9NlViCBQAAAABJRU5ErkJggg==" alt="1548193684435"></p><p><img src="data:image/png;base64,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" alt="1548193713633"></p><p>By using <strong>chain rule</strong>, you can calculate partial derivative based on the partial derivative on each function.</p><p><img src="/assets/img/1548194181907.8e75351c.png" alt="1548194181907"></p><p>You can go from the right to the left and calculate the error on each step, and next propagate this to the previous layer and update your weights.</p><div class="warning custom-block"><p class="custom-block-title">Hadamard product <a href="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)" target="_blank" title="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><p>Sometimes you will see ∘ instead of ∗ in the multiplication between matrices. This sign is a Hadamard product, and by this, you multiply two matrices with the same dimension by multiply each part of matrix themselves. For example if your f(x)=x*(x-1). The matrix calculation wouldn’t be multiple two matrices but Hamarad product of this.</p><p><img src="data:image/png;base64,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" alt="1548182006468"></p></div><p>Below you can find an algorithm for a matrix with <strong>m</strong> examples .</p><p><img src="data:image/png;base64,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" alt="1548182396033"></p><ol><li>Calculate the error on the cost function</li></ol><div class="deepnn-01"><div class="ma2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="0.5970040807235782" size="mini" value="0.5970040807235782" class="mb"><input readonly="readonly" title="0.6009806609022761" size="mini" value="0.6009806609022761" class="mb"></div></div><div class="my"><div class="mx-row"><input readonly="readonly" title="0" size="mini" value="0" class="mb"><input readonly="readonly" title="0" size="mini" value="0" class="mb"><input readonly="readonly" title="1" size="mini" value="1" class="mb"><input readonly="readonly" title="1" size="mini" value="1" class="mb"></div></div><div class="mdL"><div class="mx-row"><input readonly="readonly" title="2.4304487283618257" size="mini" value="2.4304487283618257" class="mb"><input readonly="readonly" title="2.456119433450796" size="mini" value="2.456119433450796" class="mb"><input readonly="readonly" title="-1.675030426572603" size="mini" value="-1.675030426572603" class="mb"><input readonly="readonly" title="-1.663947053635071" size="mini" value="-1.663947053635071" class="mb"></div></div><img src="/deepnn/deepn01.png" alt="Deepn Network" width="740" height="225" class="image"></div><ol start="2"><li>Backpropagate this to calculate the loss on the <strong>dJ/Z[2]</strong> layer.</li></ol><div class="deepnn-02"><div class="ma2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="0.5970040807235782" size="mini" value="0.5970040807235782" class="mb"><input readonly="readonly" title="0.6009806609022761" size="mini" value="0.6009806609022761" class="mb"></div></div><div class="mdL"><div class="mx-row"><input readonly="readonly" title="2.4304487283618257" size="mini" value="2.4304487283618257" class="mb"><input readonly="readonly" title="2.456119433450796" size="mini" value="2.456119433450796" class="mb"><input readonly="readonly" title="-1.675030426572603" size="mini" value="-1.675030426572603" class="mb"><input readonly="readonly" title="-1.663947053635071" size="mini" value="-1.663947053635071" class="mb"></div></div><div class="mda2"><div class="mx-row"><input readonly="readonly" title="0.2421583051305935" size="mini" value="0.2421583051305935" class="mb"><input readonly="readonly" title="0.24137819495653604" size="mini" value="0.24137819495653604" class="mb"><input readonly="readonly" title="0.2405902083229735" size="mini" value="0.2405902083229735" class="mb"><input readonly="readonly" title="0.23980290612373953" size="mini" value="0.23980290612373953" class="mb"></div></div><div class="mdz2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="-0.40299591927642175" size="mini" value="-0.40299591927642175" class="mb"><input readonly="readonly" title="-0.3990193390977239" size="mini" value="-0.3990193390977239" class="mb"></div></div><img src="/deepnn/deepn02.png" alt="Deepn Network" width="740" height="434" class="image"></div><ol start="3"><li>Backpropagate to get update for the second Layer <strong>W[2]</strong></li></ol><div class="deepnn-03"><div class="ma1"><div class="mx-row"><input readonly="readonly" title="0.574442516811659" size="mini" value="0.574442516811659" class="mb"><input readonly="readonly" title="0.598687660112452" size="mini" value="0.598687660112452" class="mb"><input readonly="readonly" title="0.6224593312018546" size="mini" value="0.6224593312018546" class="mb"><input readonly="readonly" title="0.6456563062257954" size="mini" value="0.6456563062257954" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div></div><div class="mdz2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="-0.40299591927642175" size="mini" value="-0.40299591927642175" class="mb"><input readonly="readonly" title="-0.3990193390977239" size="mini" value="-0.3990193390977239" class="mb"></div></div><div class="ma1t"><div class="mx-row"><input readonly="readonly" title="0.574442516811659" size="mini" value="0.574442516811659" class="mb"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.598687660112452" size="mini" value="0.598687660112452" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6224593312018546" size="mini" value="0.6224593312018546" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6456563062257954" size="mini" value="0.6456563062257954" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div></div><div class="mdw2"><div class="mx-row"><input readonly="readonly" title="0.1845463214020981" size="mini" value="0.1845463214020981" class="mb"><input readonly="readonly" title="0.18644836043998914" size="mini" value="0.18644836043998914" class="mb"><input readonly="readonly" title="0.18644836043998914" size="mini" value="0.18644836043998914" class="mb"></div></div><img src="/deepnn/deepn03.png" alt="Deepn Network" width="692" height="595" class="image"></div><ol start="4"><li>We go further to update <strong>W[1]</strong>. First calculate <strong>dJ/dA[1]</strong></li></ol><div class="deepnn-04"><div class="mw2"><div class="mx-row"><input title="0.1" size="mini" value="0.1" class="mb"><input title="0.2" size="mini" value="0.2" class="mb"><input title="0.3" size="mini" value="0.3" class="mb"></div></div><div class="mw2t"><div class="mx-row"><input readonly="readonly" title="0.1" size="mini" value="0.1" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2" size="mini" value="0.2" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.3" size="mini" value="0.3" class="mb"></div></div><div class="mdz2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="-0.40299591927642175" size="mini" value="-0.40299591927642175" class="mb"><input readonly="readonly" title="-0.3990193390977239" size="mini" value="-0.3990193390977239" class="mb"></div></div><div class="mda1"><div class="mx-row"><input readonly="readonly" title="0.05885533447669059" size="mini" value="0.05885533447669059" class="mb"><input readonly="readonly" title="0.059285367544402306" size="mini" value="0.059285367544402306" class="mb"><input readonly="readonly" title="-0.04029959192764218" size="mini" value="-0.04029959192764218" class="mb"><input readonly="readonly" title="-0.0399019339097724" size="mini" value="-0.0399019339097724" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.11771066895338118" size="mini" value="0.11771066895338118" class="mb"><input readonly="readonly" title="0.11857073508880461" size="mini" value="0.11857073508880461" class="mb"><input readonly="readonly" title="-0.08059918385528436" size="mini" value="-0.08059918385528436" class="mb"><input readonly="readonly" title="-0.0798038678195448" size="mini" value="-0.0798038678195448" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.17656600343007176" size="mini" value="0.17656600343007176" class="mb"><input readonly="readonly" title="0.1778561026332069" size="mini" value="0.1778561026332069" class="mb"><input readonly="readonly" title="-0.12089877578292652" size="mini" value="-0.12089877578292652" class="mb"><input readonly="readonly" title="-0.11970580172931716" size="mini" value="-0.11970580172931716" class="mb"></div></div><img src="/deepnn/deepn04.png" alt="Deepn Network" width="736" height="501" class="image"></div><ol start="5"><li>Next we calculate <strong>dJ/dZ[1]</strong></li></ol><div class="deepnn-05"><div class="ma1"><div class="mx-row"><input title="0.574442516811659" size="mini" value="0.574442516811659" class="mb"><input title="0.598687660112452" size="mini" value="0.598687660112452" class="mb"><input title="0.6224593312018546" size="mini" value="0.6224593312018546" class="mb"><input title="0.6456563062257954" size="mini" value="0.6456563062257954" class="mb"></div><div class="mx-row"><input title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div><div class="mx-row"><input title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div></div><div class="mda1"><div class="mx-row"><input readonly="readonly" title="0.05885533447669059" size="mini" value="0.05885533447669059" class="mb"><input readonly="readonly" title="0.059285367544402306" size="mini" value="0.059285367544402306" class="mb"><input readonly="readonly" title="-0.04029959192764218" size="mini" value="-0.04029959192764218" class="mb"><input readonly="readonly" title="-0.0399019339097724" size="mini" value="-0.0399019339097724" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.11771066895338118" size="mini" value="0.11771066895338118" class="mb"><input readonly="readonly" title="0.11857073508880461" size="mini" value="0.11857073508880461" class="mb"><input readonly="readonly" title="-0.08059918385528436" size="mini" value="-0.08059918385528436" class="mb"><input readonly="readonly" title="-0.0798038678195448" size="mini" value="-0.0798038678195448" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.17656600343007176" size="mini" value="0.17656600343007176" class="mb"><input readonly="readonly" title="0.1778561026332069" size="mini" value="0.1778561026332069" class="mb"><input readonly="readonly" title="-0.12089877578292652" size="mini" value="-0.12089877578292652" class="mb"><input readonly="readonly" title="-0.11970580172931716" size="mini" value="-0.11970580172931716" class="mb"></div></div><div class="mdz1s"><div class="mx-row"><input readonly="readonly" title="0.24445831169074586" size="mini" value="0.24445831169074586" class="mb"><input readonly="readonly" title="0.24026074574152914" size="mini" value="0.24026074574152914" class="mb"><input readonly="readonly" title="0.2350037122015945" size="mini" value="0.2350037122015945" class="mb"><input readonly="readonly" title="0.22878424045665732" size="mini" value="0.22878424045665732" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2397812407499373" size="mini" value="0.2397812407499373" class="mb"><input readonly="readonly" title="0.23262548653056345" size="mini" value="0.23262548653056345" class="mb"><input readonly="readonly" title="0.22391672956746583" size="mini" value="0.22391672956746583" class="mb"><input readonly="readonly" title="0.2139096965202944" size="mini" value="0.2139096965202944" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2397812407499373" size="mini" value="0.2397812407499373" class="mb"><input readonly="readonly" title="0.23262548653056345" size="mini" value="0.23262548653056345" class="mb"><input readonly="readonly" title="0.22391672956746583" size="mini" value="0.22391672956746583" class="mb"><input readonly="readonly" title="0.2139096965202944" size="mini" value="0.2139096965202944" class="mb"></div></div><div class="mdz1"><div class="mx-row"><input readonly="readonly" title="0.01438767570016593" size="mini" value="0.01438767570016593" class="mb"><input readonly="readonly" title="0.014243946617778747" size="mini" value="0.014243946617778747" class="mb"><input readonly="readonly" title="-0.009470553703205323" size="mini" value="-0.009470553703205323" class="mb"><input readonly="readonly" title="-0.009128933642299017" size="mini" value="-0.009128933642299017" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.028224810251146867" size="mini" value="0.028224810251146867" class="mb"><input readonly="readonly" title="0.027582574938319723" size="mini" value="0.027582574938319723" class="mb"><input readonly="readonly" title="-0.018047505654682168" size="mini" value="-0.018047505654682168" class="mb"><input readonly="readonly" title="-0.017070821146424515" size="mini" value="-0.017070821146424515" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.04233721537672029" size="mini" value="0.04233721537672029" class="mb"><input readonly="readonly" title="0.04137386240747958" size="mini" value="0.04137386240747958" class="mb"><input readonly="readonly" title="-0.027071258482023245" size="mini" value="-0.027071258482023245" class="mb"><input readonly="readonly" title="-0.025606231719636767" size="mini" value="-0.025606231719636767" class="mb"></div></div><img src="/deepnn/deepn05.png" alt="Deepn Network" width="641" height="660" class="image"></div><ol start="6"><li>The last step before update is to find the <strong>dJ/dW[1]</strong></li></ol><div class="deepnn-06"><div class="mx"><div class="mx-row"><input title="0.1" size="mini" value="0.1" class="mb"><input title="0.2" size="mini" value="0.2" class="mb"><input title="0.3" size="mini" value="0.3" class="mb"><input title="0.4" size="mini" value="0.4" class="mb"></div><div class="mx-row"><input title="0.5" size="mini" value="0.5" class="mb"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"><input title="0.8" size="mini" value="0.8" class="mb"></div></div><div class="mdz1"><div class="mx-row"><input readonly="readonly" title="0.01438767570016593" size="mini" value="0.01438767570016593" class="mb"><input readonly="readonly" title="0.014243946617778747" size="mini" value="0.014243946617778747" class="mb"><input readonly="readonly" title="-0.009470553703205323" size="mini" value="-0.009470553703205323" class="mb"><input readonly="readonly" title="-0.009128933642299017" size="mini" value="-0.009128933642299017" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.028224810251146867" size="mini" value="0.028224810251146867" class="mb"><input readonly="readonly" title="0.027582574938319723" size="mini" value="0.027582574938319723" class="mb"><input readonly="readonly" title="-0.018047505654682168" size="mini" value="-0.018047505654682168" class="mb"><input readonly="readonly" title="-0.017070821146424515" size="mini" value="-0.017070821146424515" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.04233721537672029" size="mini" value="0.04233721537672029" class="mb"><input readonly="readonly" title="0.04137386240747958" size="mini" value="0.04137386240747958" class="mb"><input readonly="readonly" title="-0.027071258482023245" size="mini" value="-0.027071258482023245" class="mb"><input readonly="readonly" title="-0.025606231719636767" size="mini" value="-0.025606231719636767" class="mb"></div></div><div class="mdxt"><div class="mx-row"><input readonly="readonly" title="0.1" size="mini" value="0.1" class="mb"><input readonly="readonly" title="0.5" size="mini" value="0.5" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2" size="mini" value="0.2" class="mb"><input readonly="readonly" title="0.6" size="mini" value="0.6" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.3" size="mini" value="0.3" class="mb"><input readonly="readonly" title="0.7" size="mini" value="0.7" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.4" size="mini" value="0.4" class="mb"><input readonly="readonly" title="0.8" size="mini" value="0.8" class="mb"></div></div><div class="mdw"><div class="mx-row"><input readonly="readonly" title="-0.0022051826743088613" size="mini" value="-0.0022051826743088613" class="mb"><input readonly="readonly" title="0.0018076713146672708" size="mini" value="0.0018076713146672708" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.0039035841421958244" size="mini" value="-0.0039035841421958244" class="mb"><input readonly="readonly" title="0.0043720392131481375" size="mini" value="0.0043720392131481375" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.005855376213293734" size="mini" value="-0.005855376213293734" class="mb"><input readonly="readonly" title="0.006558058819722202" size="mini" value="0.006558058819722202" class="mb"></div></div><img src="/deepnn/deepn06.png" alt="Deepn Network" width="651" height="607" class="image"></div><ol start="7"><li>The final step is to update your weights with new values, and calculate new loss and cost.</li></ol><div class="deepnn-07"><input title="0.1" size="mini" value="0.1" class="malpha"><div class="madw1"><div class="mx-row"><input readonly="readonly" title="-0.00022051826743088614" size="mini" value="-0.00022051826743088614" class="mb"><input readonly="readonly" title="0.0001807671314667271" size="mini" value="0.0001807671314667271" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.00039035841421958245" size="mini" value="-0.00039035841421958245" class="mb"><input readonly="readonly" title="0.00043720392131481377" size="mini" value="0.00043720392131481377" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.0005855376213293734" size="mini" value="-0.0005855376213293734" class="mb"><input readonly="readonly" title="0.0006558058819722203" size="mini" value="0.0006558058819722203" class="mb"></div></div><div class="mw1p"><div class="mx-row"><input readonly="readonly" title="0.5002205182674309" size="mini" value="0.5002205182674309" class="mb"><input readonly="readonly" title="0.49981923286853325" size="mini" value="0.49981923286853325" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6003903584142195" size="mini" value="0.6003903584142195" class="mb"><input readonly="readonly" title="0.6995627960786851" size="mini" value="0.6995627960786851" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6005855376213294" size="mini" value="0.6005855376213294" class="mb"><input readonly="readonly" title="0.6993441941180277" size="mini" value="0.6993441941180277" class="mb"></div></div><div class="madw2"><div class="mx-row"><input readonly="readonly" title="0.01845463214020981" size="mini" value="0.01845463214020981" class="mb"><input readonly="readonly" title="0.018644836043998914" size="mini" value="0.018644836043998914" class="mb"><input readonly="readonly" title="0.018644836043998914" size="mini" value="0.018644836043998914" class="mb"></div></div><div class="mw2p"><div class="mx-row"><input readonly="readonly" title="0.08154536785979019" size="mini" value="0.08154536785979019" class="mb"><input readonly="readonly" title="0.1813551639560011" size="mini" value="0.1813551639560011" class="mb"><input readonly="readonly" title="0.2813551639560011" size="mini" value="0.2813551639560011" class="mb"></div></div><div class="ml"><div class="mx-row"><input readonly="readonly" title="0.8880759021818458" size="mini" value="0.8880759021818458" class="mb"><input readonly="readonly" title="0.8985826383577421" size="mini" value="0.8985826383577421" class="mb"><input readonly="readonly" title="0.5158313302300179" size="mini" value="0.5158313302300179" class="mb"><input readonly="readonly" title="0.5091925231638667" size="mini" value="0.5091925231638667" class="mb"></div></div><input readonly="readonly" title="0.7029205984833681" size="mini" value="0.7029205984833681" class="mb mj"><div class="mlp"><div class="mx-row"><input readonly="readonly" title="0.8687608795922419" size="mini" value="0.8687608795922419" class="mb"><input readonly="readonly" title="0.8781937863190606" size="mini" value="0.8781937863190606" class="mb"><input readonly="readonly" title="0.5305700340917647" size="mini" value="0.5305700340917647" class="mb"><input readonly="readonly" title="0.5243942768254239" size="mini" value="0.5243942768254239" class="mb"></div></div><input readonly="readonly" title="0.7004797442071229" size="mini" value="0.7004797442071229" class="mb mjp"><button class="btn">Update W1 and W2 weights </button><img src="/deepnn/deepn07.png" alt="Deepn Network" width="661" height="671" class="image"><input size="mini" value="1" class=" mtimes"></div><hr><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Neural_Network</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>Neural_Network<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># parameters</span>
        self<span class="token punctuation" data-v-54601d22>.</span>inputSize <span class="token operator" data-v-54601d22>=</span> inputSize
        self<span class="token punctuation" data-v-54601d22>.</span>outputSize <span class="token operator" data-v-54601d22>=</span> outputSize
        self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize <span class="token operator" data-v-54601d22>=</span> hiddenSize
        
        <span class="token comment" data-v-54601d22># weights</span>
        <span class="token comment" data-v-54601d22>#self.W1 = torch.randn(self.hiddenSize, self.inputSize) # 3 X 2 tensor</span>
        <span class="token comment" data-v-54601d22>#self.W2 = torch.randn(self.outputSize, self.hiddenSize) # 1 X 3 tensor</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.3</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>/</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>+</span> torch<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>        
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_function</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>-</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
   
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># Binary classification logistic loss </span>
        <span class="token comment" data-v-54601d22># Special case of cross entropy (http://wiki.fast.ai/index.php/Log_Loss)</span>
        <span class="token comment" data-v-54601d22># nn.BCELoss()</span>
        <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># m - number of examples</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X 2) * (2 x m) = (3 x m)  &quot;.dot&quot; does not broadcast in PyTorch</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>a1 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X m) activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>z2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x 3) * (3 x m) = (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z2'</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span>
        
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m) final activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A2'</span><span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>return</span> yhat   
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># derivative of sigmoid</span>
        <span class="token keyword" data-v-54601d22>return</span> s <span class="token operator" data-v-54601d22>*</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>-</span> s<span class="token punctuation" data-v-54601d22>)</span>
      
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token operator" data-v-54601d22>/</span>yhat<span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>      
          
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>backward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22>#lr learning rate</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 1:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># yhat = a2</span>
        dL <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>loss_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># cost function dI/da2  (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dL:'</span><span class="token punctuation" data-v-54601d22>,</span> dL<span class="token punctuation" data-v-54601d22>)</span>

        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 2:'</span><span class="token punctuation" data-v-54601d22>)</span>
        da2 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#  da2/dz2 (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dA2:'</span><span class="token punctuation" data-v-54601d22>,</span> da2<span class="token punctuation" data-v-54601d22>)</span>
        
        dz2 <span class="token operator" data-v-54601d22>=</span> dL<span class="token operator" data-v-54601d22>*</span>da2 <span class="token comment" data-v-54601d22># dl/dz2 from the chain rule (1 x m) - the same as a2</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dz2:'</span><span class="token punctuation" data-v-54601d22>,</span> dz2<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 3:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># dL/da2 * da2/dz2 (*) dz2/dW2(T)  [a1]  | (1 x m) * (3 x M)^T = (1 x 3)</span>
        dW2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz2<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> 
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dW2:'</span><span class="token punctuation" data-v-54601d22>,</span> dW2<span class="token punctuation" data-v-54601d22>)</span>
        
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 4:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># dl/da1 = dz2/dW2(T) * dL/dz2 | (1x3)^T * (1 x m) = (3 x 1) * (1 x m) = (3 * m)</span>
        da1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>,</span> dz2 <span class="token punctuation" data-v-54601d22>)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'da1:'</span><span class="token punctuation" data-v-54601d22>,</span> da1<span class="token punctuation" data-v-54601d22>)</span>
        
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 5:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22>#  dz1 = dL/da1 * da1/dz1  | (3 x m) * (3 x m) = (3 x m)</span>
        dz1 <span class="token operator" data-v-54601d22>=</span> da1 <span class="token operator" data-v-54601d22>*</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'sZ1: '</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dZ1: '</span><span class="token punctuation" data-v-54601d22>,</span> dz1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 6:'</span><span class="token punctuation" data-v-54601d22>)</span>
        dW1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz1<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>  <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (3 * m) * (m x 2) = (3 x 2)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dW1: '</span><span class="token punctuation" data-v-54601d22>,</span> dW1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>

        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 7:'</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW1
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'alpha*dW1: '</span><span class="token punctuation" data-v-54601d22>,</span> lr<span class="token operator" data-v-54601d22>*</span>dW1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'W1: '</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW2
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'alpha*dW2: '</span><span class="token punctuation" data-v-54601d22>,</span> lr<span class="token operator" data-v-54601d22>*</span>dW2 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'W2: '</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
        <span class="token keyword" data-v-54601d22>return</span>      
    
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

NN <span class="token operator" data-v-54601d22>=</span> Neural_Network<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.4</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.7</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.8</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'X:'</span><span class="token punctuation" data-v-54601d22>,</span>X<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Y:'</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Forward:'</span><span class="token punctuation" data-v-54601d22>)</span>
Yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#or NN(X)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'L:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'J:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Backward:'</span><span class="token punctuation" data-v-54601d22>)</span>
NN<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>,</span>Yhat<span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span>


Yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#or NN(X)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'L: '</span><span class="token punctuation" data-v-54601d22>,</span> NN<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'J: '</span><span class="token punctuation" data-v-54601d22>,</span> NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h4 id="pytorch-implementation"><a href="#pytorch-implementation" aria-hidden="true" class="header-anchor">#</a> Pytorch Implementation</h4><div class="language-python extra-class"><pre class="language-python"><code>NN <span class="token operator">=</span> Neural_Network<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># random values from [0,1] (2 x m)</span>

<span class="token keyword">def</span> <span class="token function">fun_to_predict</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token number">1.0</span> <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0.0</span> <span class="token comment">#must be float</span>

Y <span class="token operator">=</span> torch<span class="token punctuation">.</span>t<span class="token punctuation">(</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>fun_to_predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> torch<span class="token punctuation">.</span>t<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">]</span>   <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment"># (1 x m)</span>
yhat <span class="token operator">=</span> NN<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot; Loss: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>NN<span class="token punctuation">.</span>loss<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># trains the NN 100 times</span>
  NN<span class="token punctuation">.</span>train<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span>

yhat <span class="token operator">=</span> NN<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; Loss: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>NN<span class="token punctuation">.</span>loss<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ypred <span class="token operator">=</span> NN<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
     
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Predicted data based on trained weights: &quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Input: \n&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Output: \n&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ypred<span class="token punctuation">)</span><span class="token punctuation">)</span>   
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Real: \n&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Neural_Network</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>Neural_Network<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># parameters</span>
        self<span class="token punctuation" data-v-54601d22>.</span>inputSize <span class="token operator" data-v-54601d22>=</span> inputSize
        self<span class="token punctuation" data-v-54601d22>.</span>outputSize <span class="token operator" data-v-54601d22>=</span> outputSize
        self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize <span class="token operator" data-v-54601d22>=</span> hiddenSize
        
        <span class="token comment" data-v-54601d22># weights</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>inputSize<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># 3 X 2 tensor</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>outputSize<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># 1 X 3 tensor</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># m - number of examples</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X 2) * (2 x m) = (3 x m)  &quot;.dot&quot; does not broadcast in PyTorch</span>
        self<span class="token punctuation" data-v-54601d22>.</span>a1 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X m) activation function</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x 3) * (3 x m) = (1 x m)</span>
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m) final activation function</span>
        <span class="token keyword" data-v-54601d22>return</span> yhat
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>/</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>+</span> torch<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># derivative of sigmoid</span>
        <span class="token keyword" data-v-54601d22>return</span> s <span class="token operator" data-v-54601d22>*</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>-</span> s<span class="token punctuation" data-v-54601d22>)</span>
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># Binary classification logistic loss </span>
        <span class="token comment" data-v-54601d22># Special case of cross entropy (http://wiki.fast.ai/index.php/Log_Loss)</span>
        <span class="token comment" data-v-54601d22># nn.BCELoss()</span>
        <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>-</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>

      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token operator" data-v-54601d22>/</span>yhat<span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>      
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>backward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22>#lr learning rate</span>
        <span class="token comment" data-v-54601d22># yhat = a2</span>
        dL <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>loss_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># cost function dI/da2  (1 x m)</span>
        
        da2 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#  da2/dz2 (1 x m)</span>
        dz2 <span class="token operator" data-v-54601d22>=</span> dL<span class="token operator" data-v-54601d22>*</span>da2 <span class="token comment" data-v-54601d22># dl/dz2 from the chain rule (1 x m) - the same as a2</span>
        
        <span class="token comment" data-v-54601d22># dL/da2 * da2/dz2 (*) dz2/dW2(T)  [a1]  | (1 x m) * (3 x M)^T = (1 x 3)</span>
        dW2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz2<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> 
        

        <span class="token comment" data-v-54601d22># dl/da1 = dz2/dW2(T) * dL/dz2 | (1x3)^T * (1 x m) = (3 x 1) * (1 x m) = (3 * m)</span>
        da1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>,</span> dz2 <span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22>#  dz1 = dL/da1 * da1/dz1  | (3 x m) * (3 x m) = (3 x m)</span>
        dz1 <span class="token operator" data-v-54601d22>=</span> da1 <span class="token operator" data-v-54601d22>*</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>  
        dW1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz1<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>  <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (3 * m) * (m x 2) = (3 x 2)</span>

        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW2
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW1
        <span class="token keyword" data-v-54601d22>return</span>
     

    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>train</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> lr <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># forward + backward pass for training</span>
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>saveWeights</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> model<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># we will use the PyTorch internal storage functions</span>
        torch<span class="token punctuation" data-v-54601d22>.</span>save<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>&quot;NN&quot;</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># you can reload model with all the weights and so forth with:</span>
        <span class="token comment" data-v-54601d22># torch.load(&quot;NN&quot;)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>predict</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>xPredicted<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>xPredicted<span class="token punctuation" data-v-54601d22>)</span>
        y <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span> <span class="token keyword" data-v-54601d22>if</span> y <span class="token operator" data-v-54601d22>&gt;=</span> <span class="token number" data-v-54601d22>0.5</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>for</span> y <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
        <span class="token keyword" data-v-54601d22>return</span> y
              

<span class="token comment" data-v-54601d22># torch.manual_seed(123) # set the constant seed for the random (JUST FOR TESTING)</span>

NN <span class="token operator" data-v-54601d22>=</span> Neural_Network<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># random values from [0,1] (2 x m)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>+</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

Y <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m)</span>
yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot; Loss: &quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>detach<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>  

<span class="token keyword" data-v-54601d22>for</span> i <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>  <span class="token comment" data-v-54601d22># trains the NN 1,000 times</span>
  NN<span class="token punctuation" data-v-54601d22>.</span>train<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>1.0</span><span class="token punctuation" data-v-54601d22>)</span>

yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;#&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>i<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>+</span> <span class="token string" data-v-54601d22>&quot; Loss: &quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>detach<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>  

ypred <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>predict<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
     
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Predicted data based on trained weights: &quot;</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Input: \n&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Output: \n&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>ypred<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>   
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Real: \n&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><div class="language-python extra-class"><pre class="language-python"><code>Loss<span class="token punctuation">:</span> <span class="token number">0.7505306005477905</span>
<span class="token comment">#99 Loss: 0.00372719275765121</span>
Predicted data based on trained weights<span class="token punctuation">:</span> 
Input <span class="token punctuation">(</span>scaled<span class="token punctuation">)</span><span class="token punctuation">:</span> 
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.5810</span><span class="token punctuation">,</span>  <span class="token number">1.3010</span><span class="token punctuation">,</span>  <span class="token number">1.2753</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2010</span><span class="token punctuation">,</span>  <span class="token number">0.9624</span><span class="token punctuation">,</span>  <span class="token number">0.2492</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4845</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0929</span><span class="token punctuation">,</span>
         <span class="token operator">-</span><span class="token number">0.8199</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4210</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.9620</span><span class="token punctuation">,</span>  <span class="token number">1.2825</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3430</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6821</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9887</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.7018</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7498</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.1285</span><span class="token punctuation">,</span>
          <span class="token number">0.4135</span><span class="token punctuation">,</span>  <span class="token number">0.2892</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Output<span class="token punctuation">:</span> 
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
Real<span class="token punctuation">:</span> 
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="do-i-have-to-implement-all-these-functions"><a href="#do-i-have-to-implement-all-these-functions" aria-hidden="true" class="header-anchor">#</a> Do I have to implement all these functions?</h3><p>Fortunately no. All gradient and backpropagation the only think what you have to set up in the Neural Network is:</p><ul><li>architecture of the network - How many hidden layer?, What are the activation functions on each layer?</li><li>Loss Function - How to calculate loss function in the Neural Network</li></ul><ul><li>Optimilization Function  - How to update weights. If you choose wrong you can finish in the local minimum instead of the better result</li><li>Learning Rate - Find learning rate to use in the neural network</li></ul><a href="https://github.com/jcjohnson/pytorch-examples" target="_blank" title="https://github.com/jcjohnson/pytorch-examples" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more examples</span></a><p>Let’s bring again the same neural network that we define in previous chapter. For all activation we want to use sigmoid function and for loss</p><p><img src="/assets/img/1547391156214.3d92b6e8.png" alt="1547391156214"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA1MAAABlCAYAAACoc7mxAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABqxSURBVHhe7d0/bPPG+cDxx7+l2fpuzfgO1ovUeId0K6glY+x3qCc3m9tFymYvL5ACBroY6OAh0tTKS+upgJe4g8Ux6CClWzoYTvCKQNqp7dR2Sjf97jnyJEoiJYr6R1LfT8DoNSVRJO94vIe8Ox4MDQEAAAAALOX/olcAAAAAwBIIpgAAAAAgB4IpAAAAAMiBYAoAAAAAciCYAgAAAIAcCKYAAAAAIAeCKQAAAADIgWAKwAYE4rebUj9oih/NAQAAqBqCKQBrFfhtadZrcnJ5K/1oHgAAQBURTAFYj8CXdrMutet7kddeNBMAAKC6CKYArIV/cy3Pp3cy7PWk07mSRjQfAACgqgimAKzFcccEUceH0V8AAADVRzAFAAAAADkQTAEAAABADgRTAAAAAJADwRQAAAAA5EAwBQAAAAA5EEwBAAAAQA4EUwAAAACQA8EUAAAAAORAMAUAAAAAORBMAVi7oH0tt/Zft/LgB/ZfKIe//e1v0b+KpajrhWJYJX+UOW/tw3HBsY+iI5gCsB5+Uw4ODuxUu+xHM004dVIL59eb0iauKiytsPzyl7+Un/zkJ/MrLyad6zad61tNz1/96lfy4x//WP7whz9Ec4D15Nsy5q3M210BHPt7YkfnlrUYAhX0/fffD3/7298OX758OfzHP/4Rzc3uk08+Gf7iF78YfvPNN9EcoGy6w4Yp4rWYt1OjG82fpceKfubTTz+df7x0G0Mvvkzxhq1B9N4WfPHFF/aY/vDDD4f//ve/o7nYnsk85W0z8ROsM9+WKW9l3u4K2X36FCvvxw26rWHDK9Y6LS3DMTpoeUPxGsNWt3jbSTBVEd1GmAHn1JdKajBsNcwBFDvAPLOR8w4l3/eH77//vi10v/zyy2jucrSwvry8HL733ns2sALKyRw/5iQ7r2zQSoq+//nnn0dzUgxa4clOT2aDgTmBu5Nfw1QztkePTa1Uffzxx/aiCbbPnW92WXnbRL4tQ97KvN3WYNht6fZu9xjdlCKkTxHy/pgr303gMTfAKHg+WOIYdYGjeK259cBtI5iqApPx9ODWqVrBlCsozAEVHTV6IIUHmZe4rV9//fXwxYsXawuAdHkaUOkVQKCMwpN/8h2kr776yubv09PTaE6K6GQ3cyFj0A1PbFs+Sbv15rjcDXuFWPPDjiqUm8y3Rc5bmbfbGFU67fmyoJXoHHadPrvO+2PRnbIFQUXh80Guc0usbhjN2TWCqdKbvPVcqWDKXa2Y3igXPE7N/+677+wdqQ8++GCtV61+//vf29/7zW9+E80BysKVD8knHa2UacVkfrMZPXHpxYu0U7Ze9fS2XrnQZrh6XOpxj+3adYVy0/m2qHkr03abSqhtzaHbPmrVUZ1gSu0yfYoRTGUIJkqRD1Y5t2QLJreFYKrk7FVnk5lalWzml1YRDAuS6QNMr1TpPthEPydtVqAnsX1pn46KGDWfmD3haF7WPK15u4y0Oa8e79ocF9u1ywrlNvJtEfNW1u3umorzuHI6/2JKWe0yfQoRTEUXlOetwz7kA5cWRaj3MppfmflNObn1pHV3Ia+iWdVyLB0TLerw2idNP5xlHcpFbyi9i8Pob5H//Oc/dqSfn/70p/LBBx9Ec9fn5z//ufzvf/9jNCGUy+BZdFxF7+yNOWom/e53v7N5WvN2GX300Ufy4sWL0XZgWb40Dw6kXrJhs7aRb4uYt7Ju93GnJ53j6aO9WlZPn3Lm/VAg7Wt98EhDrmJ1oGn7kA8OL67MXjA1xOu22Su7VflgKtChFuvhcM0H9fEOt/PtEIw6PzZkc2AOMvf5g7pM1OELxaznya14rTuZczyV33FHwnjqZG7Bp0GOFqo/+9nPojnrdXp6Ku+995602+3CnFyBRfyH8Glfr1/NFhJ//vOf7atWTFJNlYczh6ApR8P3dGqaUmkJKy5bj0e9eKLH41/+8pdobsVscv9LTY686J/rZta73azH1s1UXPU8m/rMucBsSn18Tk6aovP3NvJtEfNWpu0ui52nTznzvhU8yr1eIWucynE4p5zWUrYdy6nWD/v38pi2e7clukNVSQMdvaQRdmob3w4cTNz+dPO1/40dQST6vHkjbB6zzG3R2EAQy03LDy8cdiofr1v4d/UGoNC00v3jRR0o07bPnGDs+wub+C1Mo/S0MIW3/Yx2gAWKz7WrT87TOiqW5uf0/hfdYcMzZYx+1x03Cc0F42VodutZtus7of0al7LFsjq/Dex/Pa/ZEbPsHzZ/hF8Ly9qZTuAp3G8mNjMy6+qalkanWfMF3ZZwH85+J5ZPx1+wfSWStnlb+TZ33tqQxdudxOwL3cZCNe/aUfpUIO+rub+fqmj5YD15QOXbH+u3N32mwmBDK+UaSEUzlUtITYzJN4rbxjRa5/jqVi6Yig0+ER4i89NDB53Q7V/Up8nlg+lhRN3+m3dAusL7j3/8YzQng1j+Wm7aZqUN1RQdMwknKaX9LzSvZZN+/LmTWf6yJ/+yP/vsM/t+9QeHWeP+jzqm6/lO+9p6jbAC6DViFcAF0iswc8rp0QXKqbLNlZEzG5B8MWBb+bZoeWu57XbmpEchbDl9Sp73Vb66XpHzQf48YKXuw+3akz5Tgbx70te+yNmddBLvjTbkKvmNgvFt8z6TcVK2owKCttRrl9L3WjIwGxk2UDqWt6Z00f5T1zP3g8Onwav333/fviYL80Gj25OLWFtiv3kguktNATvRD2uattFW//znP+1rJscdPfvlmMw6Vrn5JjbPfzBHi/H61Ux/Kc3D2kTm5cuX0ZxFouYUZokPU+0tBs+mXDXH6tvc5VH+Zf/gBz+wr3//+9/ta3Wtcf8fHstFpyd3R9dyaTJI//ZJzroD6XUuZNUuFkH7OsxzSU2QDi/kym5DX+5jbXKC8OQs3lHNvo4dyqvX+tqX54GdsdV8W6S8tfx2l8WW06fEeT/k6rKezHyltFYs22pHZm8YT+/GTSF3YE+CqYFomtiAaaqG6voUeK23kweAq4gUrF1qeMB60pqbuwJp1xPaoJaCWfdzE0jpNt5dTFQCD9+c2YOmf/84cdDo4BN6opkfSKlw4Ip4EBq06zaQ0uC0tyA6/eEPf2hfq19xQxWkn6jDPgdKj52salEng6d3saMvaIv2hW5cTR6ry1p12e5CR2FMtPdfZkovt9e1/4Oor8L585m0TCWm0TqT5+tzafrBypURW/kxkvKcctvQn6whWrPzZiuOu8i3mfPWBtLcybPdK9vg9sRt89gvc97fiZLkgSLYj2AqeCc2X84ERuMMe/ZmMrnmVUR2x5ebSz1g+3JZm8y8NiAwbk/075rYj5WRfxOue+Mq/c5M/9mEx2MaSOWhgVRNf8wL74CVUTwPMC03VVsgj7aX8mzZprQCotMylbPD8FLpxIk/eLy3d5Az3xVJkXfZ//rXv+zrj370I/taGBu4I72W/W8qKOfnD3J0FV6Nt6PAvrqQTu9OTt/dyHnTX7lSuSw3IpcOMqSV2lAgfvvcngu82Llgm/l26by1wVYIebZ7ZVtqVbG19Cl53t+JgueBItmLYMominmdDYyiO1bemUzWN+ZXRFJtPIo/lk5ixh2GI94Zja6bV85mYqM7hUlB7OErCQ+5J4lfwNA7UnrlbqnmdyatRoFUL9uVj//+97/2tUgVt+l8wJR9qjZ3N/61JAzkZ7k7ua6J7ELTzSm0cnIpM3eQc8m5bFe5XLr505auuK7VOvb/4YX0ep2omXN4MTG8Gnwoxxcde3d+5bRcmjmvDVp2225PatF+rsnJvZ7PtOI7WZvaVr7Nnbc2ZOntLottpU8F8n5lbfLcsiV7EUy5268zwwOn9ilYXBFJRP+YFbk7hQlppdwdxoR0cSeaTAGVOVDrYds+6WYMpFSuk2sZK20oP3eseEeSdm/d5ePMFyEO38iZnvGiO8P+zaX013XlNOeyv/32W/vqjv/MylhWr33/u/Pc+sxryqSSm0L50jy/l7PB1L7uJT8nZ1v5Nnfe2pClt7ssdpI+5cz7Zmel9KUquVXKtuhZikl9g7dpD4IpX8KbHQ05nQryU5vyFbS/1P5Ibifs7jAmpYs70SxsBqGBlA5uYX6jNegslb65Cm8CbOxChhOMe/jnn/70J/u6mDuRP8lDU/saNqSbduXUXUTI/KC+JZYd0Sv0f/3rX+1DuvWZM9W3/D6aL2zpMG/QnWW5fq1ye51wMWh8Lo73Xbb9gDWzZqwcbjTfRoqYt5bf7rLYRfqUM++rxP5FpZe/bCtMlxxTcas2NyRlwvDAqUNMTgy1GI75PzlsetG4YTSThussl/RhP93wmclDhuvwqPq9+cOkpi/D/u6cNNZne+jQtCaQGn7//ffRXKCgksqwqUyv+Vjz88uXL6M5i7mhapOP0Zgcw9VmXnbEHfOff/55NKf6lt1Hm+LK6aT0Ha2je46MndkdnaOmvxLfpsRp9Gyg0EbzbaSIeWv17U44cRZEmdJnl3nfij02Jqsy5INl84ATpkdyvXCbqh9MpZ7U5427Pw5ONJEarWwPc9sNtx2xaZmcWDSj5zEkFUZTzwiL0edLabCjD9ZNNn5uw/Qy9GHNut/m7TZ9MKB+5vLyMpoDFNlUGWYOpqQyTPOzfsb3/WjOAlmDpBzB1DLf0Yrlhx9+aI/5vbq4kWe/rlU8X0VT0sM2u61hw5usKOoDU5PrcQnLnJkmK0sby7dGkfNWpu1225o2JVXQd60U6VOMvD/+TlLdNaZs+SBX2RbVf1OepbhN1Q+mUD4meJopjDI8VM89VPebb76J5owtvAI0U2BN+vjjj23hveihwECZ6B1XfeC1XvFenLejk3iGE5c73rKfF7MvW/3617+2y9eLHPtjuX1UFmFeSSl/9VwQldHxvLSpfKuKnLeW2+6y2N9jP0/et6LAo+wtkcbylW3Ln2c2h2AKlaFB1IsXL+zdqXVesXJ3pbQQLwdt1qVPdl9w5arSosI5OhlNTvMD533z3Xff2aZDH330ka2spcnenCKsBCzTNHqZphpffPGFTcf5TXqrpyjNWdYqQ5OltArT+vNtOfJW1u0ui7099lfI++PzWzXO8fnKtuLclVIEU6iUr776yt5BWldzPA3QdHmffPJJNKfYwiYGWjBVp6DNJyxoG7HS2Z2YqnM1b320gqaVM73i7foh6P4K95U7cWc72Y2/ly7PsvVYPD09tRdM9qGfVN79XyoZKpTzKlrryrdly1tJ210WHPuRFfN+0YKJZaxetrnvFaeOQzCFytH25Fro6snm66+/juYuR+9s6dUvXY4W4kVrOz9D+5U1TLDgecOGvmohu7aCJiq4ylRoazOI2Pq6fnFhAY40X375pT1utAlReCJ3U3p/xTzyLPuzzz6zx2QVrsZnscn9XxyuUqTH5nTf5IHZB9kugKyab8uat+LbXRYc+8468n4sGFnUD6JAVinb9IKxDUK1H1o0rwgIplBJWuhq4Zu3bbn2v9K7UXqnqwy04B2P0uPaWlcjmNKrWOOCd86UViLn6ti678Yn+omRqdZik8uuin3aR1Gz5Kl+slrJytJXdhJ5q9hIn0nryfuuRUo5TnEr5AF7kbRRyMDxQP9nNgpAZfjSPDiRW30o8XC5Z2klC6Rdr8mltGSwxEOOC8E9V6zRlUFnF0+4BwAAVbYHD+0FUDyB+O2m1OsH4cNddao3xV/ncwhdIOWZIJBACgAAbADBFIDt0iDnoCYn9yJXd7apsQy6DZH+rZzc+NGHVhT40nSBlLubZn/XBGz2AwAAAKsjmAKwPfG7Rb2OHEe3iw5rR+LpP57eyeo3pzSQipo5jpolBuLf6O8eSc3+DQAAsDqCKQBbEkj73AQ0Jmxq3U32vQoe7818Ee/szcrN8fymBlLqVk5cE0K9E2ZmrmP5AAAADsEUgJDfHPdfmphqcqmRTv9Saonv16Wd5XZS8Cj3upzGlVzYiCaQIPCl3axLzfyA12jJXfjGSo47YdPBpKm3huUDAAA4BFMAQsedxABkOBxIS9vgadO8xPd7UXA0n7v7JLcnURBWk/Pza3mWM+kOTKDTKdlIgQAAYO8RTAHYisGzDaX0cU+jQKzX60nHBFGu7xQAAECZEEwB2IJA3j3pqydHjAABAAAqgmAKwBYcyqvX+tqX54GdMSFoN6WZqeMVAABAcRBMARUTtK9Ho9k9rPUpuKs5ftuyw5/fXrfHw5+7ASjuRU7f0NYPAACUC8EUUAWxkfh0ZDzn9qQWzq83s424t0mHF3LXbUlDYqMC6gAUp3cTz5wCAAAoi4Oh9gIHgFSBtOs1EwLpg3YZcQ8AAMAhmAIAAACAHGjmBwAAAAA5EEwBAAAAQA4EUwAAAACQA8EUAAAAAORAMAUAAAAAORBMAQAAAEAOBFMAAAAAkAPBFAAAAADkQDAFAAAAADkQTAEAAABADgRTAAAAAJADwRQAAAAA5EAwBQAAAAA5EEwBAAAAQA4EUwAAAACQA8EUAAAAAORQsWDKl+bBgRyYqelHs5AikHZ9xf3kN82+bpq9nmLR+yvymyatSehSIu0AAEAVZAymwiCl+HWfY+kMWuKZ/45q0azKCsRvN6UeBY8HB3Wpt9eZQGGwRYV3Q4J2LO3MVG+bPY4ysQHhBi8WAACA4ssWTAXv5GmXAYqteGastAyepe+dyZvD6O+K8ps1uX4+lbvhUIZmMjGk9C9PuCNXCiZQPb+Xs0GYdsNhVxr9Szlvby+c2sSdof252xReXDq5jf4EAAB7K1swdXghvWFPLnYSoATi39ybAOlIssRywbsnkdevpOKxlBx3htLrHI+28/DiShrm9enduirkh3LRMxV98xtYN9238ePpWE5N4vWfB9HfKDK/eSK3XksGXT3iAADAPlsYTIVNWQ6kPrpqHki7Wbfz7EXowJemNgdb4TPjecZEPxu9AlyTk9u+3naRmvns/GY1gTze98WbvoUW+31tDtf029JsjptV+W49YlfV3XZPXmkfr7OdRk2z0ra3Lsk3G8znR+szZ9pK0y/dx+43J9d35k7DRNM089l30Xxn0fsz2x1Py/C9pp++PoulL99uy9T+DNomzeJpmLpuuk5mXUy+CbcvYb1svo1/fzxNZKEkZr9d34o0TpcJXLPsy+hPNTquwvfsXZXbk/C7YaY183W70vZ/nmUuI1xG0vZsNO1ypJteyBj2Lip/wQYAAGQwXKg7bJiPNbrRX63GsDswrw0Zeq3WsNXqDs2fw0HLG4rXsv+e+xkx7818Rt8NxZcTGgxb3vj359N19YaxxekCh55Zf88sIJwdbs/oN7stu+z4uoWml+W+Fy3HLjd8f2JbGo1hw35GPx9f3mbN7rdFwv0qsW3U9Y8vw/492vHR50d/h/tjvM+WfX96nRevz7Sk9YstfvL9bmNi2e7zYT5YtG7T27IGUb7UQ1Cn+HovNru+dlun9vXEMu32j9d/ct+paJmxfTR5TORZZrpSp50ztf0AAGD/LA6mbKVvusIwW4FJq5xpEDOSUikafyReSYrEgpaFEtbVrtdEhXz6NyPTv6N/p23fwIRKjXhFU83uk23RyqM3J+hIlrAf5lWOk9Ih/vk875t3xgHr4vWZNpvnJiUFa6O8FV+fhesWVsg3l7RRhT/rDyTul/g6Lpm2VsJ3Vl5mukqk3YL8CQAAqm9xnyk7oMNUf6XgUe77nrTeumZJgWhXpYlmStFnzkafMbP0Q/JaXrn2MfYzDRl/bSDPfe3yFGtAs8SAEsHjdN8qXx60+dRVrEnOzG9GDl+ZNeuL67bi3zzH1j1czqgJ0/m5PBxdyWDYkdFiZvbJPNPNklKmDM38Ar8p5/dncrfpZkeaDvG0m7bofasvl7X4Np7IbWyfr2xqhLzapclMI4fy5syT/v2j3adhXonnqxXXbZVmfjoKpYku5PYh1jxtz+wq7VZKNwAAsO8W95kyUYR39mayoj5dcU4KUGaCoLA/k4m4RgHIdPATtK9NJWhyOfr7WQeUGJhIbGJdE0Yh9G8upwIuJxwE4PbB1KBMxe7h6O14gIBoOS03+lqvJ52L8eAPVqZgwokGd4hG4kudFgVIGkhdH8UCKV+am6oB1o7MHniS1PEtFr1vxfZhbFrLGBdaGa9dyuvueLmDlhe9GbKDdPQv5cYP8+JEkL3quh13Zr7rptKO4bGtUTx3mXZVTDcAALA1C4Kp8I6TiWXsHRBXT7cBTiwoCgMnDVACaUcDO9jPyLOEF4cDU+8/l0sTcHVjNRQNfpyg3ZZHE4zIxHLC3w8HlAifq5T+KCW3rocT66pXrcMr1Pp9EyTpPzU4MxW45tQoArUjU4F7epDmjcjb+NCFo7tW7vO6PTqQRfSnMbNPNk0roNciV7GAK/AfTDA6ltRxP7doH9w/RkvT34+PDb3w/Tdy5vXl8mZDwd4MX24m7m6oKGA+qdm8OArat71uum8m0sXk93AEilH+mZt2x6fSMCl9EsuAboS58Mboobwyh5K9MGCZIDtpHO+ndzPLvz0ZD9BgL3aMLhDkX+byCpx2AAAAccMFbN8G8YaNsAOCMdV/QXUbQ9uZ3nP9B6L+FY1ovpm8RssO0jDBfW+i/0N8OTpL+yZNr0Oy2XU189z3dZlm9sD2c9D1cQNSxNj3pvtfhAat8bbMrkvCPtmo8PfCdZmaYp1D7P5I7UsVpVG8w8dUH5CZfi0ufeyk+1P/Hn9+4fuJ6+3eX7w+06bXb5xXdDLpaNJsZvuj9J/trzNv3dbf7ybMq7FpauHz006F6zT6/sxn4+8npEU8rexvu/0f/15SXyT3XpZlpqtU2tkpudwAAADVdqD/M5WB9dIr7zV9KOmunk2VT9Buys2rTkWa9+iQ0NdyVLI02LhS5M1dpJ3246vJ81WBm7eVtFwBAADVle2hvcua6S9VdNoEsC7n8rYy/SS0/9lT645K55TZwQuKh7RLVoa0AwAA+2UjwZTtP9S/t53Fi82NqncuD6/upFeh2uvhRa9S27Me0UOdpwdUKRjSLkk50g4AAOyXzTTzAwAAAICK20wzPwAAAACoOIIpAAAAAMiBYAoAAAAAciCYAgAAAIAcCKYAAAAAIAeCKQAAAADIgWAKAAAAAHIgmAIAAACAHAimAAAAACAHgikAAAAAWJrI/wOka6w0DtB3TAAAAABJRU5ErkJggg==" alt="1548182396033"></p><table><thead><tr><th>Name</th><th>Comment</th></tr></thead><tbody><tr><td><code>torch.nn.Linear</code></td><td>Simple Linear Layer in the neural network <a href="https://pytorch.org/docs/stable/nn.html#linear" target="_blank" title="https://pytorch.org/docs/stable/nn.html#linear" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>torch.nn.Sigmoid</code></td><td>Sigmoid activation function  <a href="https://pytorch.org/docs/stable/nn.html#sigmoid" target="_blank" title="https://pytorch.org/docs/stable/nn.html#sigmoid" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>torch.nn.BCELoss</code></td><td>Binary classification logistic loss <a href="https://pytorch.org/docs/stable/nn.html#bceloss" target="_blank" title="https://pytorch.org/docs/stable/nn.html#bceloss" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>torch.optim.SGD</code></td><td>stochastic gradient descent <a href="https://pytorch.org/docs/stable/optim.html#torch.optim.SGD" target="_blank" title="https://pytorch.org/docs/stable/optim.html#torch.optim.SGD" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr></tbody></table><div class="warning custom-block"><p class="custom-block-title">What’s the difference between stochastic gradient descent adn gradient descent?</p><p>Stochastic gradient descent (often shortened to <strong>SGD</strong>) means that you update set parameters in an iterative for each sample one by one. In Gradient Descent you get your whole data to calculate the loss and update your weights. <a href="https://www.quora.com/Whats-the-difference-between-gradient-descent-and-stochastic-gradient-descent" target="_blank" title="https://www.quora.com/Whats-the-difference-between-gradient-descent-and-stochastic-gradient-descent" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>Quora Question</span></a><a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent" target="_blank" title="https://en.wikipedia.org/wiki/Stochastic_gradient_descent" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p></div><h4 id="using-sequential"><a href="#using-sequential" aria-hidden="true" class="header-anchor">#</a> Using Sequential</h4><div class="language-python extra-class"><pre class="language-python"><code>inputSize <span class="token operator">=</span> <span class="token number">2</span>
outputSize <span class="token operator">=</span> <span class="token number">1</span>
hiddenSize <span class="token operator">=</span> <span class="token number">3</span>

model <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
          torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>inputSize<span class="token punctuation">,</span> hiddenSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
          torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Sigmoid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hiddenSize<span class="token punctuation">,</span> outputSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
    	  torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Sigmoid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

<span class="token comment"># define loss function, sinble Binary </span>
loss_fn <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>BCELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

inputSize  <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span>
outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span>
hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span>

<span class="token comment" data-v-54601d22>#define model</span>
model <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Sequential<span class="token punctuation" data-v-54601d22>(</span>
          torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>inputSize<span class="token punctuation" data-v-54601d22>,</span> hiddenSize<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
          torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Sigmoid<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
          torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>hiddenSize<span class="token punctuation" data-v-54601d22>,</span> outputSize<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    	  torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Sigmoid<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
        <span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># function for predict</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

<span class="token comment" data-v-54601d22># X, and Y</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span>  torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> X<span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (1 x m)</span>


<span class="token comment" data-v-54601d22># define loss function, sinble Binary </span>
loss_fn <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>BCELoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># define optimizer</span>
<span class="token comment" data-v-54601d22># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>optim<span class="token punctuation" data-v-54601d22>.</span>SGD<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>.</span>parameters<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss:'</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># print(loss_fn(YHat,Y))</span>
<span class="token keyword" data-v-54601d22>for</span> epoch <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  y_pred <span class="token operator" data-v-54601d22>=</span> model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
  
  L <span class="token operator" data-v-54601d22>=</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>y_pred<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>)</span>
  <span class="token comment" data-v-54601d22># Before the backward pass, use the optimizer object to zero all of the</span>
  <span class="token comment" data-v-54601d22># gradients for the Tensors it will update (which are the learnable weights</span>
  <span class="token comment" data-v-54601d22># of the model)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>zero_grad<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  L<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>step<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss #'</span><span class="token punctuation" data-v-54601d22>,</span>epoch<span class="token punctuation" data-v-54601d22>,</span><span class="token string" data-v-54601d22>': '</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h4 id="using-nn-model"><a href="#using-nn-model" aria-hidden="true" class="header-anchor">#</a> Using nn.Model</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">TwoLayerNet</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>inputSize <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> outputSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> hiddenSize <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">super</span><span class="token punctuation">(</span>TwoLayerNet<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment"># define first layer and second layer</span>
    self<span class="token punctuation">.</span>linear1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>inputSize<span class="token punctuation">,</span> hiddenSize<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>linear2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hiddenSize<span class="token punctuation">,</span> outputSize<span class="token punctuation">)</span>

  <span class="token comment"># calculate the output  </span>
  <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    h <span class="token operator">=</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>linear1<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>linear2<span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#define model</span>
model <span class="token operator">=</span> TwoLayerNet<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># define loss function, sinble Binary </span>
loss_fn <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>BCELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>TwoLayerNet</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>TwoLayerNet<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    <span class="token comment" data-v-54601d22># define first layer and second layer</span>
    self<span class="token punctuation" data-v-54601d22>.</span>linear1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>inputSize<span class="token punctuation" data-v-54601d22>,</span> hiddenSize<span class="token punctuation" data-v-54601d22>)</span>
    self<span class="token punctuation" data-v-54601d22>.</span>linear2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>hiddenSize<span class="token punctuation" data-v-54601d22>,</span> outputSize<span class="token punctuation" data-v-54601d22>)</span>

  <span class="token comment" data-v-54601d22># calculate the output  </span>
  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    h <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>linear1<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>linear2<span class="token punctuation" data-v-54601d22>(</span>h<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>

<span class="token comment" data-v-54601d22># function for predict</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

<span class="token comment" data-v-54601d22># X, and Y</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span>  torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> X<span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (1 x m)</span>

<span class="token comment" data-v-54601d22>#define model</span>
model <span class="token operator" data-v-54601d22>=</span> TwoLayerNet<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># define loss function, sinble Binary </span>
loss_fn <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>BCELoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># define optimizer</span>
<span class="token comment" data-v-54601d22># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>optim<span class="token punctuation" data-v-54601d22>.</span>SGD<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>.</span>parameters<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss:'</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>


<span class="token comment" data-v-54601d22># print(loss_fn(YHat,Y))</span>
<span class="token keyword" data-v-54601d22>for</span> epoch <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  y_pred <span class="token operator" data-v-54601d22>=</span> model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
  
  L <span class="token operator" data-v-54601d22>=</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>y_pred<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>)</span>
  <span class="token comment" data-v-54601d22># Before the backward pass, use the optimizer object to zero all of the</span>
  <span class="token comment" data-v-54601d22># gradients for the Tensors it will update (which are the learnable weights</span>
  <span class="token comment" data-v-54601d22># of the model)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>zero_grad<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  L<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>step<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss after #'</span><span class="token punctuation" data-v-54601d22>,</span>epoch<span class="token punctuation" data-v-54601d22>,</span><span class="token string" data-v-54601d22>' epochs: '</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h3 id="example-of-sgd-for-linear-function"><a href="#example-of-sgd-for-linear-function" aria-hidden="true" class="header-anchor">#</a> Example of SGD for linear function</h3><p>example of updating weights for linear function from the fast.ai course.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">%</span>matplotlib inline
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>basics <span class="token keyword">import</span> <span class="token operator">*</span>

n <span class="token operator">=</span> <span class="token number">100</span>
x <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 
x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>uniform_<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># (m x 2) (2 is a number of input parameters)</span>

a <span class="token operator">=</span> tensor<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># The parameters that we should find</span>
y <span class="token operator">=</span> x@a <span class="token operator">+</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># (m x 1)</span>

<span class="token keyword">def</span> <span class="token function">mse</span><span class="token punctuation">(</span>y_hat<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y_hat<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># mean square error</span>
a <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>tensor<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># unknown parameter for function y=x@a, (n x 1) = (n x 2) x (2 x 1)</span>

<span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y_hat <span class="token operator">=</span> x@a <span class="token comment"># uour testing, forward function</span>
    loss <span class="token operator">=</span> mse<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_hat<span class="token punctuation">)</span> <span class="token comment">#loss</span>
    <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>loss<span class="token punctuation">)</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># backward functions</span>
    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># with gradient we g</span>
        a<span class="token punctuation">.</span>sub_<span class="token punctuation">(</span>lr <span class="token operator">*</span> a<span class="token punctuation">.</span>grad<span class="token punctuation">)</span> <span class="token comment"># a.grad - gives information about gration, it will update a, i need to go oposite.</span>
        a<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>zero_<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># zero gradient</span>

lr <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span>
        
<span class="token comment"># ANIMATE</span>
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> animation<span class="token punctuation">,</span> rc
rc<span class="token punctuation">(</span><span class="token string">'animation'</span><span class="token punctuation">,</span> html<span class="token operator">=</span><span class="token string">'html5'</span><span class="token punctuation">)</span>

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">)</span>
line<span class="token punctuation">,</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x@a<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">animate</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
    update<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    line<span class="token punctuation">.</span>set_ydata<span class="token punctuation">(</span>x@a<span class="token punctuation">)</span>
    <span class="token keyword">return</span> line<span class="token punctuation">,</span>

animation<span class="token punctuation">.</span>FuncAnimation<span class="token punctuation">(</span>fig<span class="token punctuation">,</span> animate<span class="token punctuation">,</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> interval<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550262060215.5fbf0d44.png" alt="1550262060215"></p><h2 id="data-source"><a href="#data-source" aria-hidden="true" class="header-anchor">#</a> Data / Source</h2><p>In this chapter I want to brink some information how to get any data to learn, and how to convert them to be helpfull in the learning process.</p><h3 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h3><p>List of free resources for your own use.</p><p>How to get data and other sources of data for Data-Science and Machine Learning</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Medical Data <a href="https://github.com/beamandrew/medical-data" target="_blank" title="https://github.com/beamandrew/medical-data" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>link</span></a></td><td>List of a lot of medical data that can be used for Machine Learning</td></tr><tr><td>Kaggle Datasets <a href="https://www.kaggle.com/datasets" target="_blank" title="https://www.kaggle.com/datasets" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>link</span></a></td><td>List a lot of datasets for Kaggle competitions.</td></tr><tr><td>Archive DataSet from Wisconsin<a href="https://archive.ics.uci.edu/ml/datasets.html" target="_blank" title="https://archive.ics.uci.edu/ml/datasets.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>link</span></a></td><td>Archive Data-Set that help you to get data from Wisconsin Library.</td></tr><tr><td>fast.ai Datasets <a href="https://course.fast.ai/datasets" target="_blank" title="https://course.fast.ai/datasets" t-link="" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>List of datatsets for image classification/NLP processing</td></tr><tr><td>BelgiumTS DataSet <a href="https://btsd.ethz.ch/shareddata/" target="_blank" title="https://btsd.ethz.ch/shareddata/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>link</span></a></td><td>BelgiumTS DataSet with road signs classification.</td></tr></tbody></table><h3 id="data-download-google-drive"><a href="#data-download-google-drive" aria-hidden="true" class="header-anchor">#</a> Data Download / Google Drive</h3><p>If you use <strong>Google Colab</strong> you can easly mount your Gdrive in the filesystem. I also create a link for “My Drive”(<code>ln</code>), because it is easier to go to a folder without a space in the name.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Load the Drive helper and mount</span>
<span class="token keyword">from</span> google<span class="token punctuation">.</span>colab <span class="token keyword">import</span> drive
drive<span class="token punctuation">.</span>mount<span class="token punctuation">(</span><span class="token string">'/content/drive'</span><span class="token punctuation">)</span>
!ln <span class="token operator">-</span>s <span class="token string">&quot;/content/drive/My Drive/&quot;</span> <span class="token operator">/</span>content<span class="token operator">/</span>gdrive
</code></pre></div><p><img src="/assets/img/1550258836263.015bf78a.png" alt="1550258836263"></p><h3 id="data-download-google-images"><a href="#data-download-google-images" aria-hidden="true" class="header-anchor">#</a> Data Download / Google Images</h3><p>You can also download using google images search engine.  For this,</p><ol><li>Prepare folder structure for your classes.</li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

folder <span class="token operator">=</span> <span class="token string">'teddys'</span>

path <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">'data/bears'</span><span class="token punctuation">)</span>
dest <span class="token operator">=</span> path<span class="token operator">/</span>folder
dest<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1550259522813"></p><ol start="2"><li>Go to google images, find interesting search images, go to the developer console<code>ctrl+shift+j</code> and type:</li></ol><div class="language-python extra-class"><pre class="language-python"><code>urls <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>querySelectorAll<span class="token punctuation">(</span><span class="token string">'.rg_di .rg_meta'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>el<span class="token operator">=</span><span class="token operator">&gt;</span>JSON<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>el<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span><span class="token punctuation">.</span>ou<span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'data:text/csv;charset=utf-8,'</span> <span class="token operator">+</span> escape<span class="token punctuation">(</span>urls<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/1550259689567.acfd6857.png" alt="1550259689567"></p><p>This wll download you the file <code>download</code>, rename the file to <code>urls_teddys.txt</code> and upload to your path in the <code>jupyter</code> or <code>colab</code></p><p><img src="/assets/img/1550259797554.8541a8f9.png" alt="1550259797554"></p><ol start="3"><li>Download your files using <code>download_images</code></li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">'url_teddys.txt'</span>
folder <span class="token operator">=</span> <span class="token string">'teddys'</span>
dest <span class="token operator">=</span> path<span class="token operator">/</span>folder

download_images<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token builtin">file</span><span class="token punctuation">,</span> dest<span class="token punctuation">,</span> max_pics<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550259892436.c5ff2319.png" alt="1550259892436"></p><ol start="4"><li>The last step is to verify images. This will remove images that are corrupted or doesn’t have 3 channels.</li></ol><div class="language-python extra-class"><pre class="language-python"><code>verify_images<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'teddys'</span><span class="token punctuation">,</span> delete<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> max_size<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550260036514.03a398f5.png" alt="1550260036514"></p><h3 id="data-download-wget"><a href="#data-download-wget" aria-hidden="true" class="header-anchor">#</a> Data Download / wget</h3><a href="https://chrome.google.com/webstore/detail/curlwget/jmocjfidanebdlinpbcdkcmgdifblncg" target="_blank" title="https://chrome.google.com/webstore/detail/curlwget/jmocjfidanebdlinpbcdkcmgdifblncg" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>CurlWget</span></a><p>There is an extension for the chrome that you can get to generate wget command for your Linux command line. Just add the extension and after start downloading cancel this and copy the command to your console.  (or in the Jupyter Notebook with exclamation character “!”).</p><p><img src="/assets/img/1549318371426.cc27e832.png" alt="1549318371426"></p><div class="language-python extra-class"><pre class="language-python"><code>!wget <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span><span class="token string">&quot;Host: archive.ics.uci.edu&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span><span class="token string">&quot;User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.81 Safari/537.36&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span><span class="token string">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&quot;</span> <span class="token string">&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/00436/Container_Crane_Controller_Data_Set.csv&quot;</span> <span class="token operator">-</span>O <span class="token string">&quot;Container_Crane_Controller_Data_Set.csv&quot;</span> <span class="token operator">-</span>c
</code></pre></div><p><img src="/assets/img/1549482301055.62028812.png" alt="1549482301055"></p><h3 id="data-download-kaggle"><a href="#data-download-kaggle" aria-hidden="true" class="header-anchor">#</a> Data Download / kaggle</h3><div class="language-python extra-class"><pre class="language-python"><code>!pip install kaggle
</code></pre></div><p>Sign  to the profile on the Kaggle page:</p><p><img src="data:image/png;base64,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" alt="1549317920891"></p><p>Next, download new API key. Upload</p><p><img src="/assets/img/1549317857572.976a2ee0.png" alt="1549317857572"></p><p>And upload to your page: (On Colab you can upload your page)</p><p><img src="/assets/img/1549317981152.9d945f45.png" alt="1549317981152"></p><p>Copy the <strong>kaggle</strong> configuration to the home folder.</p><div class="language-python extra-class"><pre class="language-python"><code>!mkdir <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>kaggle
!cp <span class="token operator">/</span>content<span class="token operator">/</span>kaggle<span class="token punctuation">.</span>json <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>kaggle<span class="token operator">/</span>kaggle<span class="token punctuation">.</span>json
!chmod <span class="token number">600</span> <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>kaggle<span class="token operator">/</span>kaggle<span class="token punctuation">.</span>json
</code></pre></div><p>Now you can download any competion that you are in: (kaggle will create folders by themself)</p><div class="language-python extra-class"><pre class="language-python"><code>!kaggle competitions download <span class="token operator">-</span>c home<span class="token operator">-</span>credit<span class="token operator">-</span>default<span class="token operator">-</span>risk <span class="token operator">-</span>p <span class="token operator">/</span>content<span class="token operator">/</span>titanic
</code></pre></div><p><strong>Errors</strong>:</p><ul><li><code>Error 401</code> - means that you have wrong <code>.json</code> file. Generate again and check if exists.</li><li><code>Error 403</code> - You don’t accept terms and condition for the competition. Go to the webpage and join to the competition.</li></ul><h3 id="data-download-linux-commands"><a href="#data-download-linux-commands" aria-hidden="true" class="header-anchor">#</a> Data Download / linux commands</h3><p>Useful commands to operate on files.</p><table><thead><tr><th>Command</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td><code>Create Directory</code></td><td><code>mkdir folder</code></td><td>Create directory named <code>folder</code></td></tr><tr><td><code>Remove files</code></td><td><code>rm content/*.zip</code></td><td>Remove all files with extension ``.zip`</td></tr><tr><td><code>Unizip files</code></td><td><code>unzip -o -q isic-images.zip -d isd/bening</code></td><td>Unzip the files <code>isic-images.zip</code>, <br>the <code>-o</code> option is used to suppress the query, <br>the <code>-q</code> is used to not show list of extracted files,<br><code>-d</code> is a destination folder</td></tr><tr><td><code>Move files</code></td><td><code>mv isd/benign/ISIC-images/**/*.jpg isd/benign</code></td><td>Move all files with the extension <code>.jpg</code> from the folder <code>isd/benign/ISIC-images</code> , the double start <code>**</code> means to tro find files in the folder and subfolder recseively., Destination folder is <code>isd/benign</code></td></tr><tr><td><code>Copy files</code></td><td><code>cp isd/benign/ISIC-images/**/*.jpg isd/benign</code></td><td>The same as above without remove original files.</td></tr></tbody></table><h2 id="activation-functions"><a href="#activation-functions" aria-hidden="true" class="header-anchor">#</a> Activation Functions <a href="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" target="_blank" title="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Instead of using perceptron with output <code>0 or 1</code>, better is use activation function that return values <code>between 0 and 1</code>. In Deep learning there are couple functions to use as an activation.</p><h3 id="sigmoid-function"><a href="#sigmoid-function" aria-hidden="true" class="header-anchor">#</a> Sigmoid function</h3><p>In sigmoid function the difference is in the activation function.</p><p>Logistic function is:</p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6f42e36c949c94189976ae00853af9a1b618e099" alt="{\displaystyle f(./assets/6f42e36c949c94189976ae00853af9a1b618e099.svg)={\frac {L}{1+e^{-k(x-x_{0})}}}}"></p><p>Sigmoid is a special case when <code>L=1, k=1, and x0 = 0</code>.</p><p><img src="/assets/img/1_Xu7B5y9gp0iL5ooBj7LtWw.07066668.png" alt="img"></p><p><img src="data:image/png;base64,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" alt="1543948420834"></p><div class="sigmoid"><input placeholder="x1" size="mini" value="0.2" class="x1 red"><input placeholder="x2" size="mini" value="0.3" class="x2 green"><input placeholder="x3" size="mini" value="0.8" class="x3 blue"><input placeholder="w1" size="mini" value="0.2" class="w1 red"><input placeholder="w2" size="mini" value="0.3" class="w2 green"><input placeholder="w3" size="mini" value="0.5" class="w3 blue"><input placeholder="b" size="mini" value="0.1" class="b"><input placeholder="w1" size="mini" value="0.2" class="w1a red"><input placeholder="w2" size="mini" value="0.3" class="w2a green"><input placeholder="w3" size="mini" value="0.5" class="w3a blue"><input placeholder="x1" size="mini" value="0.2" class="x1a red"><input placeholder="x2" size="mini" value="0.3" class="x2a green"><input placeholder="x3" size="mini" value="0.8" class="x3a blue"><input readonly="readonly" size="mini" value="0.04" class="m1 red"><input readonly="readonly" size="mini" value="0.09" class="m2 green"><input readonly="readonly" size="mini" value="0.4" class="m3 blue"><input placeholder="b" size="mini" value="0.1" class="mb"><input readonly="readonly" size="mini" value="0.63" class="msum" style="color:green;"><img src="/deepnn/sigmoid.png" alt="Card image cap" width="740" height="578" class="image"><span class="answer">σ = 0.652 </span></div><h4 id="when-use-2"><a href="#when-use-2" aria-hidden="true" class="header-anchor">#</a> When Use?</h4><ul><li>predict the probability of the output. (simple classification for example: ‘dog/cat’).</li></ul><h2 id="pytorch"><a href="#pytorch" aria-hidden="true" class="header-anchor">#</a> PyTorch <a href="https://pytorch.org/" target="_blank" title="https://pytorch.org/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>WebPage</span></a></h2><p>PyTorch is an optimized tensor library for deep learning using GPUs and CPUs.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
</code></pre></div><table><thead><tr><th>Command</th><th>Info</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.cuda.is_available()</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543956014633" data-v-336f4fea></code></span></td><td>Is CUDA Available (<code>On CPU returns False</code>)</td></tr><tr><td><code>torch.backends.cudnn.enabled</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543956000527" data-v-336f4fea></code></span></td><td>Is CUDA® Deep Neural Network library Available (used by fast.ai, <code>On CPU returns False</code>)</td></tr><tr><td><code>torch.cuda.device_count()</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955982482" data-v-336f4fea></code></span></td><td>Number of GPUs</td></tr><tr><td><code>torch.cuda.get_device_name(device)</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955759448" data-v-336f4fea></code></span></td><td>Gets the name of a device number</td></tr><tr><td><code>torch.cuda.set_device(device)</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955961561" data-v-336f4fea></code></span></td><td>Set the current GPU device</td></tr><tr><td><code>defaults.device = torch.device('cpu')</code></td><td></td><td>Set default device to CPU</td></tr></tbody></table><h2 id="fast-ai"><a href="#fast-ai" aria-hidden="true" class="header-anchor">#</a> fast.ai <a href="https://github.com/fastai/fastai" target="_blank" title="https://github.com/fastai/fastai" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>github</span></a></h2><p>Fast.ai is a very popular library for deep learning based on the PyTorch. The library simplifies training fast and accurate neural nets using modern best practices. fast.ai doesn’t replace any base functionality from the PyTorch. It adds a lot of functions that can help you build a model faster.</p><p><span class="red" data-v-9e33b382>Requires Python &gt;=3.6</span> (<code>python --version</code>)</p><h3 id="installation-google-colab-v-1-0"><a href="#installation-google-colab-v-1-0" aria-hidden="true" class="header-anchor">#</a> Installation / Google Colab (v 1.0) <a href="https://course.fast.ai/start_colab.html" target="_blank" title="https://course.fast.ai/start_colab.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>source</span></a></h3><p>On Google Colab you don’t have to install fast.ai. It is installed already. Google Colab gives you Tesla K80 machine with 12GB of GPU RAM.</p><ol><li>Go to a page: <a href="https://colab.research.google.com" target="_blank" rel="noopener noreferrer">https://colab.research.google.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>Create new Python 3 notebook</li></ol><p><img src="/assets/img/1548781198400.677f18c7.png" alt="1548781198400"></p><ol start="3"><li>Make sure that you have setup GPU mode</li></ol><p><img src="/assets/img/1548781236103.599ac401.png" alt="1548781236103"></p><p><img src="/assets/img/1548781252590.79972f93.png" alt="1548781252590"></p><ol start="4"><li>Check version</li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> fastai
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'fastai: version: '</span><span class="token punctuation">,</span> fastai<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2MAAABlCAYAAADAgDuJAAAetklEQVR4nO3dfVRU5d438O8wvLjV8cAMpA0qQryolJh4RCTTu8xTmi9peoPmc3zpOScf84HKND1lK5fd3JDnLMhc5knT55DgiUKF7O5QGmqKaBBQ1gERg2BScwZzzK3AzDx/4N7ODG8DDA7i97MWK5lr9jXXHsYWX3+/fW2FxWKxwI70kEKhsB8iIiIiIiIiB7WVrRTWYcxisTCAERERERERdQP7vOXW2gARERERERE5j0KhgHVjojvQchBroXuRiIiIiIiIOkmhUMiBTKFQ2LYpAi2HMAYzIiIiIiKijmvxWrGbjynMZrPFvlzW2p+JiIiIiIioY6wDmfWf5TZFicVikb+3/y8RERERERE5zrot0f4xd+uqmBTEWvqSxomIiIiIiKhtcivizevEpC/rcXf7IGY2m+X/mkwm+XsGMiIiIiIiovbZBzE3NzcolUq4ubnJ3wNWbYrWAayxsREXL1503eodoNVqXb0EIiIiIiIih9XX18Pd3R0A4Obm1hTGJFIYq6+vd8niiIiIiIiIeqv6+nqbapkcxqR2xIaGBoii6Mo1EhERERER9TqiKMoti2azGW7ArTZFqSp27do1V6+TiIiIiIioV7l27Rrq6+thMplgsVjgZr0xh3S9GCtjREREREREziWKIhobG2+FMcB2S/vGxkZeM0ZERERERORk9fX1aGxslLOXm/Wg2WyWv4iIiIiIiMh57POWW0tP4r3EiIiIiIiInMs+ZzGMERERERER3QbthjEGMSIiIiIiou5hnbfc23hepzU2NqK4uBilpaWoqanBxYsX4ebmBo1GgyFDhmDUqFEYPXq0fPdpIiIiIiKiu43T09Dp06eRlpYGvV7fbKympgY1NTXIz8+HRqPBokWLEB4e7uwlEBERERER9XhODWMHDhzAvn37HHquXq9HamoqZs2ahenTp3f5ta82etp876dS4hejqcvzEhERERHRna2/e+dv3WU0GqHX6zFs2DAnrqiJ08JYR4KYxGKxyMc4I5ARERERERE5y6FDh5CVlQWz2YzZs2dj6tSpTp2/xd0UO+r777/H/v37O338/v378f333ztjKc3oy/R4L3wbvkv7tlvmv53+mrQRfiol/FRK/DVpo0vXcvLEMfiplDh54phL10FERERE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kYiIiIiIqCdhmyIREREREVEPwDBGRERERETkAgxjRERERERELsAwRkRERERE5AIMY0RERERERC7AMEZEREREROQCDGNEREREREQuwDBGRERERETkAgxjRERERERELsAwRkRERERE5AIMY0RERERERC7AMEZEREREROQC7q0NBAUF3c51EBERERER3VVYGSMiIiIiInIBhjEiIiIiIiIXYBgjIiIiIiJyAYYxIiIiIiIiF2AYIyIiIiIicgGGMSIiIiIiIhdgGCMiIiIiInIBhjEiIiIiIiIXYBgjIiIiIiJygV4bxgoKChAUFISgoCBMnDgRFRUVrl4SACAzMxNBQUEoKChw9VKcKjk5uUe9z0REREREPZ27syc8ceJEu0EjKioK48ePd/ZLy+rq6pCUlISMjAxERUU5de7k5GQEBgZi3rx5Tp2XXCMzMxNr1qzp8GdFFEWsXbsW2dnZAIDnnnsOq1ev7tBrS3MUFhZi586dCA4Olsfq6uqwbNkyDB06FImJiRAEoUNzExEREVHP5/QwVlBQgNTU1DafEx8f361hTK/Xw9vbG6Ghod32Gp01b968XhnkVq9e3eEw4kpSEAoNDcXo0aM7fPzmzZuh1WpRWVkpB6fMzMwO/Ww/+eQTAEBISIjN4wUFBUhKSsKUKVNQXl7e4bURERER0Z2h29oUKysrW/y6HfR6PS5fvtziWF1dHebMmSO3MCYnJ9uMW7c3BgUFITMzE8Ct9sJ3330Xa9asafH4tua2HmurnS85ORlz5sxBXV2dQ+cqiiISEhLkdbb2mLT+oKCgZvMnJycjMzPT5jnW1U3780pISIAoigCAiooKTJw4scV52zu2rq4OCQkJKCgokOewHrdeu7NbID/55BPExcUhLi6uw8dWVFQgPz8fc+bMAQD4+PggLi4Ox44da7b2tuZIT09v9vp1dXU4fPgwdu/eDT8/vw6vjYiIiIjuHLf9mrH4+Hintw5KpDARFxeH4uJiREZGNgtF2dnZ2LFjByorK1FYWGjTVllXV4dt27YhNzdXDo9SpWPevHmorKzEc889h6SkJHncuhrU1tw+Pj7IyspCYWFhs0pIVwiCgJiYGJsgcP36dVy5cgUPPvgggKaAmZGRgcLCQlRWViIuLg5vvPGGTXBYs2YNzp07h8rKSrnFUxp/7733EBcXJ59zSkqK3DYXHByMo0eP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" alt="1548787769768"></p><ol start="5"><li>Test some code from the fast.ai course:</li></ol><div class="language-python extra-class"><pre class="language-python"><code>
<span class="token operator">%</span>reload_ext autoreload
<span class="token operator">%</span>autoreload <span class="token number">2</span>
<span class="token operator">%</span>matplotlib inline

<span class="token keyword">from</span> fastai <span class="token keyword">import</span><span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

bs <span class="token operator">=</span> <span class="token number">64</span>
<span class="token comment"># bs = 16   # uncomment this line if you run out of memory even after clicking Kernel-&gt;Restart</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>PETS<span class="token punctuation">)</span><span class="token punctuation">;</span> path
path_anno <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'annotations'</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span>


fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pat <span class="token operator">=</span> r<span class="token string">'/([^/]+)_\d+.jpg$'</span>


data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>path_img<span class="token punctuation">,</span> 
                                   fnames<span class="token punctuation">,</span> pat<span class="token punctuation">,</span> 
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> 
                                   bs<span class="token operator">=</span>bs
                                  <span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1548781400369"></p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">)</span>
<span class="token comment">#len(data.classes),data.c</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1548781504899.ca2ae27a.png" alt="1548781504899"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
interp <span class="token operator">=</span> ClassificationInterpretation<span class="token punctuation">.</span>from_learner<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
losses<span class="token punctuation">,</span>idxs <span class="token operator">=</span> interp<span class="token punctuation">.</span>top_losses<span class="token punctuation">(</span><span class="token punctuation">)</span>


interp<span class="token punctuation">.</span>plot_top_losses<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiUAAABpCAYAAADlaFPVAAAbAElEQVR4nO3dQWgb6f038K9K4bX4EzdaNYdKoMVCmIJbYeODHLSu92AM29erlwi8oOxhyZoSH5KsoancFLLGPTSRyMEkSzEEk+5hd6hVBCsHAsaHFcZEOhgLg2lxhEwEUmGDopDw3/Gpeg/meTojjTSSLduy/f2AaVeamef3PDPR85vneUayVCqVCqqIlywWS/VbLUun01AUBffu3YPVaj308YiIiOj0apRj/KTehu1ISAAgmUzC7/czISEiIiJdjlE9LiKTkkql0rZERMhms/jXv/6F0dHRth6XiIiITj+LxaJLTH4CHE1CUi6XEQ6Hcf36ddhstrYem4iIiM4GbWJiMVpT0g6xWAwAMDExcRSHJyIiojPG8p///KfS7lESIiIiolZUKhX9QlciIiKik3Jk0zdEREREreBICREREXWEuklJuVzG9PQ0yuXyccZDRERE51TdpMRms8Hv92Nubg6qqh5nTERERHQONZy+mZiYgMPhwNOnT48rHiIiIjqnTNeUBINBPHv2jNM4REREdKRMkxKn04nu7m7s7OwcRzxERER0TpkmJVarFQ6HA/l8/jjiISIionOqqUeCe3p6sLu7e9SxEBER0TnWVFKyu7uLnp6eo46FiIiIzjHTpERVVRSLRbhcruOIh4iIiM4p06SkUCjg7du36O3tPY54iIiI6JwyTUri8Tg++ugj2Gy244iHiIiIzqmGSUksFkOxWMT4+PhxxUNERETnVMPfvllfX8fs7CysVutxxkRERETnkKVSqVROOggiIiKinxq9uLS0dNxxEBEdyCeffHLSIRBRmxgmJcDB/6G/fv0a77333oEDOs37n+bYT3r/0xz7Se9/mmM/7P68gSI6W5r68jQiIiKio8akhIiIiDoCkxIiOnNUVcX09DTcbjfcbjei0WjD7dPptNx2eHgY2WxW934sFpPvB4NBlMtlw/disZguhrt379Ycq1o0Gq05bqPy6h1b1DmdTjcsr1wuIxgMGsbcTFtUaxRrq+ehmtn+ZnVpJdZG7xudIzoaTEqI6Mx59OgRHA4Hcrkctre3USwW63ZY2WwW9+/fx8rKCnK5HB48eIBwOCw7n3Q6DUVRsLGxgVwuh1AohLm5OaiqinK5jGfPnmFlZQUrKyv49ttvZSe+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" alt="1548781518290"></p><p><img src="/assets/img/1548791676403.1dd96b0f.png" alt="1548791676403"></p><ol start="6"><li>You can open the github repo directly from the course <code>https://github.com/fastai/course-v3.git</code></li></ol><p><img src="/assets/img/1548782192774.57159cf9.png" alt="1548782192774"></p><p><img src="/assets/img/1548782244713.bcf9e5ea.png" alt="1548782244713"></p><ol start="7"><li>Or Upload from your computer</li></ol><p><img src="/assets/img/1548782293026.e5de64dc.png" alt="1548782293026"></p><p><img src="/assets/img/1548788564305.daffe66e.png" alt="1548788564305"></p><h3 id="installion-aws-v-1-0"><a href="#installion-aws-v-1-0" aria-hidden="true" class="header-anchor">#</a> installion / AWS (v 1.0)</h3><div class="warning custom-block"><p class="custom-block-title">AWS Free Tier doesn’t include GPU computer</p><p>The instance called <code>p2.xlarge</code> that is dedicated for the deep learning cost about <code>0.9$ per hour.</code> . First you need request to increase the service limit.</p></div><ci i="https://aws.amazon.com/blogs/aws/new-p2-instance-type-for-amazon-ec2-up-to-16-gpus/" t="source"></ci><p><code>p2.xlarge</code> has the NVIDIA GK210 Tesla K80 GPU Machine</p><p><img src="/assets/img/1548792962650.3a2a88ad.png" alt="1548792962650"></p><ol><li>When you login for your AWS as a Free Tier you don’t have acces to create instance called <code>p2.xlarge</code>. First go to the dashboard and request for new limit for this instance.</li></ol><p><img src="/assets/img/1548782638507.1df5737c.png" alt="1548782638507"></p><p><img src="data:image/png;base64,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" alt="1548782656757"></p><p><img src="data:image/png;base64,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" alt="1548782674826"></p><p>In your request form choose the best <strong>Region</strong>, <strong>Instance Type</strong>, and <strong>New Limit Value</strong>.</p><p><img src="/assets/img/1548782883630.a6df1336.png" alt="1548782883630"></p><p>In the description you can type: <code>‘[FastAI] Limit Increase Request’</code></p><p><img src="/assets/img/1548782954025.7d8d29f8.png" alt="1548782954025"></p><p>After couple of days (usually one) you will get new limit for your Free Tier (<code>This will still charge you for this computer</code>)</p><ol start="2"><li>After you have ability to create new <code>p2.xlarge instance</code>, you can create new one.</li></ol><p>In the services click <strong>EC2</strong>, and next <strong>instances</strong></p><p><img src="/assets/img/1548783181553.ead28183.png" alt="1548783181553"></p><p><img src="/assets/img/1548783218231.f384270d.png" alt="1548783218231"></p><p>and click <strong>Launch instance</strong></p><p><img src="data:image/png;base64,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" alt="1548783245159"></p><ol start="2"><li>In a list find <strong>deep learning</strong> instances</li></ol><p><img src="/assets/img/1548783307267.28268b3d.png" alt="1548783307267"></p><p>And select newest one:</p><p><img src="/assets/img/1548783324760.016db6ce.png" alt="1548783324760"></p><ol start="3"><li>In the <strong>Instance type</strong> choose <code>p2.xlarge</code> and click <strong>Next: Configure Instance details</strong></li></ol><p><img src="/assets/img/1548783390814.2ea01f74.png" alt="1548783390814"></p><ol start="4"><li>We don’t change anything in <strong>Instance Details</strong>, just click <strong>next</strong></li></ol><p><img src="/assets/img/1548783484833.a707c2dc.png" alt="1548783484833"></p><ol start="5"><li>In the storage we stay as it is ( 75 GB).</li></ol><p><img src="/assets/img/1548783505382.ab3d9ed1.png" alt="1548783505382"></p><ol start="6"><li>We don’t add any tags.</li><li>In <strong>Configure securiity Group</strong>, add your IP to allow from your IP allow to connect (it can be only <strong>SSH</strong> or <strong>All traffic</strong> if you want), and click <strong>next</strong></li></ol><p><img src="/assets/img/1548792681361.03345f30.png" alt="1548792681361"></p><ol start="8"><li>You will see that your network is not eligible for the free usage tier, click <strong>Launch</strong>.</li></ol><p><img src="/assets/img/1548792728048.4262a83e.png" alt="1548792728048"></p><ol start="9"><li>Now you need to create your key pair to login into your instance. If you create one you can use the same, but first:</li></ol><p>Choose name, and click <strong>Download Key Pair</strong>, and store the key in the safe place.</p><p><img src="/assets/img/1548783776548.173ff113.png" alt="1548783776548"></p><p>If you are using <code>putty.exe</code>, you need to divide your key into private and public key.</p><ul><li>Download the <code>puttygen.exe</code> from the <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank" rel="noopener noreferrer">https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>Click load to load your private/public key: (choose All Files *.*)</li></ul><p><img src="/assets/img/1548783977245.654d4de7.png" alt="1548783977245"></p><p><img src="/assets/img/1548783995980.ed1ebf4a.png" alt="1548783995980"></p><ul><li>Click <strong>Save private key</strong></li></ul><p><img src="data:image/png;base64,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" alt="1548784064758"></p><ul><li>This will generate your private key  (<code>.ppk</code>) to use in the <code>putty.exe</code></li></ul><div class="warning custom-block"><p class="custom-block-title">If you loose your key</p><p>You will loose your access to the server</p></div><ol start="10"><li>Click view Instances</li></ol><p><img src="/assets/img/1548792807620.58003b0d.png" alt="1548792807620"></p><ol start="11"><li>On the instance you can now login with the <code>putty.exe</code></li></ol><ul><li>In a connection\SSH\Auth browse your private key (<code>.ppk</code>)</li></ul><p><img src="/assets/img/1548784332519.9ab91b5c.png" alt="1548784332519"></p><ul><li>In the session write your IP</li></ul><p><img src="/assets/img/1548792569401.c549fb29.png" alt="1548792569401"></p><ol start="12"><li><p>Login as <strong>ubuntu</strong></p></li><li><p>update your libralies</p></li></ol><div class="language-python extra-class"><pre class="language-python"><code>conda install <span class="token operator">-</span>c fastai fastai
</code></pre></div><ol start="14"><li>Setup password for your notebook</li></ol><div class="language-python extra-class"><pre class="language-python"><code> jupyter notebook password
</code></pre></div><p><img src="/assets/img/1548784862543.149fa9ee.png" alt="1548784862543"></p><ol start="15"><li>Run jupyter notebook</li></ol><div class="language-python extra-class"><pre class="language-python"><code>ipython notebook <span class="token operator">-</span><span class="token operator">-</span>no<span class="token operator">-</span>browser <span class="token operator">-</span><span class="token operator">-</span>port<span class="token operator">=</span><span class="token number">8002</span>
</code></pre></div><ol start="16"><li>Start tunneling to get to your notebook from the local webbrowser (<code>-i</code> is your downloaded .pem file from the Amazon AWS instance)</li></ol><div class="language-python extra-class"><pre class="language-python"><code>ssh <span class="token operator">-</span>N <span class="token operator">-</span>f <span class="token operator">-</span>L localhost<span class="token punctuation">:</span><span class="token number">8002</span><span class="token punctuation">:</span>localhost<span class="token punctuation">:</span><span class="token number">8002</span> ubuntu@__IP__ADRESS__ <span class="token operator">-</span>i fastai<span class="token operator">-</span><span class="token number">01.</span>pem
</code></pre></div><ol start="17"><li>got to the webpage: http://localhost:8002</li></ol><p><img src="/assets/img/1548785475325.3cdb779a.png" alt="1548785475325"></p><ol start="18"><li>Verify you choose kernel: <code>pytorch36</code></li></ol><p><img src="/assets/img/1548786200488.a209af56.png" alt="1548786200488"></p><ol start="18"><li>Verify library for <code>fastai</code></li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai <span class="token keyword">import</span><span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
</code></pre></div><ul><li>You will get the error about <code>dataclasses</code>. You need to install them</li></ul><p><img src="/assets/img/1548785884823.01fde125.png" alt="1548785884823"></p><div class="language-python extra-class"><pre class="language-python"><code>!pip install dataclasses
</code></pre></div><ol start="19"><li>Verify download data:</li></ol><div class="language-python extra-class"><pre class="language-python"><code>bs <span class="token operator">=</span> <span class="token number">64</span>
<span class="token comment"># bs = 16   # uncomment this line if you run out of memory even after clicking Kernel-&gt;Restart</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>PETS<span class="token punctuation">)</span><span class="token punctuation">;</span> path
path_anno <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'annotations'</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span>


fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pat <span class="token operator">=</span> r<span class="token string">'/([^/]+)_\d+.jpg$'</span>


data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>path_img<span class="token punctuation">,</span> 
                                   fnames<span class="token punctuation">,</span> pat<span class="token punctuation">,</span> 
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> 
                                   bs<span class="token operator">=</span>bs
                                  <span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1548786238799.7d3f1fe2.png" alt="1548786238799"></p><div class="warning custom-block"><p class="custom-block-title">Error while loading data</p><p>Sometimes you will get the error:</p><p><code>RecursionError: maximum recursion depth exceeded while calling a Python object</code></p><p>You need  to increase limit of the recursion:</p><p><code>import sys; sys.setrecursionlimit(10000) lub więcej, 100k</code></p></div><ol start="20"><li>Verify creating model</li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">)</span>
<span class="token comment">#len(data.classes),data.c</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">)</span>
</code></pre></div><ol start="21"><li>Verify calculating epochs.</li></ol><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
interp <span class="token operator">=</span> ClassificationInterpretation<span class="token punctuation">.</span>from_learner<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
losses<span class="token punctuation">,</span>idxs <span class="token operator">=</span> interp<span class="token punctuation">.</span>top_losses<span class="token punctuation">(</span><span class="token punctuation">)</span>


interp<span class="token punctuation">.</span>plot_top_losses<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1548786340529"></p><p><img src="/assets/img/1548786462857.2b0c772e.png" alt="1548786462857"></p><ol start="22"><li>Stop your instance after you finish working (or <strong>Terminate</strong> to remove the whole instance)</li></ol><p><img src="/assets/img/1548792872371.d68602cd.png" alt="1548792872371"></p><div class="warning custom-block"><p class="custom-block-title">Remember to stop your instance</p><p>If you don’t do this Amazon will charge you for every hour of using your instance. If You only <strong>Stop</strong> your instance, Amazon will charge you for <code>ELASTIC BLOCK STORE</code> (Free Tier allow you to have maximum 30GB and <code>p2.xlarge</code> has 75GB) but the cost is much less than running machine (about 5 dollars per month).</p></div><h2 id="fast-ai-help-functions"><a href="#fast-ai-help-functions" aria-hidden="true" class="header-anchor">#</a> fast.ai / Help functions</h2><h3 id="open-image"><a href="#open-image" aria-hidden="true" class="header-anchor">#</a> open_image()</h3><p>Open single image,</p><div class="language-python extra-class"><pre class="language-python"><code>im <span class="token operator">=</span> open_image<span class="token punctuation">(</span><span class="token string">'images/Maine_Coon_97.jpg'</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
im<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549698053830.8ad8dea0.png" alt="1549698053830"></p><h3 id="open-mask-fn"><a href="#open-mask-fn" aria-hidden="true" class="header-anchor">#</a> open_mask(fn)</h3><p>Open mask by the function <code>fn</code>., that returns mask image file.</p><div class="language-python extra-class"><pre class="language-python"><code>mask <span class="token operator">=</span> open_mask<span class="token punctuation">(</span>get_y_fn<span class="token punctuation">(</span>img_f<span class="token punctuation">)</span><span class="token punctuation">)</span>
mask<span class="token punctuation">.</span>show<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22>!git clone https<span class="token punctuation" data-v-54601d22>:</span><span class="token operator" data-v-54601d22>//</span>github<span class="token punctuation" data-v-54601d22>.</span>com<span class="token operator" data-v-54601d22>/</span>alexgkendall<span class="token operator" data-v-54601d22>/</span>SegNet<span class="token operator" data-v-54601d22>-</span>Tutorial<span class="token punctuation" data-v-54601d22>.</span>git

    
<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>callbacks<span class="token punctuation" data-v-54601d22>.</span>hooks <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
    
path <span class="token operator" data-v-54601d22>=</span> Path<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'./SegNet-Tutorial/CamVid'</span><span class="token punctuation" data-v-54601d22>)</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'val'</span><span class="token punctuation" data-v-54601d22>)</span>
lbl_names <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'valannot'</span><span class="token punctuation" data-v-54601d22>)</span>

img_f <span class="token operator" data-v-54601d22>=</span> fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span>
img <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>img_f<span class="token punctuation" data-v-54601d22>)</span>
img<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_y_fn</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> Path<span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>.</span>parent<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>+</span><span class="token string" data-v-54601d22>'annot'</span><span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span>x<span class="token punctuation" data-v-54601d22>.</span>name

mask <span class="token operator" data-v-54601d22>=</span> open_mask<span class="token punctuation" data-v-54601d22>(</span>get_y_fn<span class="token punctuation" data-v-54601d22>(</span>img_f<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
mask<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> alpha<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1550779832997.2a0a5632.png" alt="1550779832997"></p><h3 id="show"><a href="#show" aria-hidden="true" class="header-anchor">#</a> .show()</h3><p>Show image in the output.</p><div class="language-python extra-class"><pre class="language-python"><code>im <span class="token operator">=</span> open_image<span class="token punctuation">(</span><span class="token string">'images/Maine_Coon_97.jpg'</span><span class="token punctuation">)</span>
im<span class="token punctuation">.</span>show<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'Title of the image'</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
im<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

fig<span class="token punctuation" data-v-54601d22>,</span> axs <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
i <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>180</span>
<span class="token keyword" data-v-54601d22>for</span> ax <span class="token keyword" data-v-54601d22>in</span> axs<span class="token punctuation" data-v-54601d22>:</span>
    im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
    im<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>,</span> title<span class="token operator" data-v-54601d22>=</span>f<span class="token string" data-v-54601d22>'{i}'</span><span class="token punctuation" data-v-54601d22>)</span>
    i<span class="token operator" data-v-54601d22>+=</span><span class="token number" data-v-54601d22>1</span>
</code></pre></div></div></div><p><img src="/assets/img/1549698531867.7757609f.png" alt="1549698531867"></p><h3 id="apply-tfms"><a href="#apply-tfms" aria-hidden="true" class="header-anchor">#</a> .apply_tfms()</h3><p>Apply transformation for the image and return new image.</p><div class="language-python extra-class"><pre class="language-python"><code>im<span class="token punctuation">.</span>apply_tfms<span class="token punctuation">(</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
im<span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
im<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549736278158.7c5496d9.png" alt="1549736278158"></p><h3 id="imagecleaner"><a href="#imagecleaner" aria-hidden="true" class="header-anchor">#</a> ImageCleaner</h3><p>Displays images for relabeling or deletion and saves changes in path.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>widgets <span class="token keyword">import</span> <span class="token operator">*</span>

ds<span class="token punctuation">,</span> idxs <span class="token operator">=</span> DatasetFormatter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>from_toplosses<span class="token punctuation">(</span>learn<span class="token punctuation">,</span> ds_type<span class="token operator">=</span>DatasetType<span class="token punctuation">.</span>Valid<span class="token punctuation">)</span>
ImageCleaner<span class="token punctuation">(</span>ds<span class="token punctuation">,</span> idxs<span class="token punctuation">,</span> path<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>DOGS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>


bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                   ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   bs<span class="token operator" data-v-54601d22>=</span>bs
                                  <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>
learn <span class="token operator" data-v-54601d22>=</span> create_cnn<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> metrics<span class="token operator" data-v-54601d22>=</span>error_rate<span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit_one_cycle<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> max_lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>widgets <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>


ds<span class="token punctuation" data-v-54601d22>,</span> idxs <span class="token operator" data-v-54601d22>=</span> DatasetFormatter<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>from_toplosses<span class="token punctuation" data-v-54601d22>(</span>learn<span class="token punctuation" data-v-54601d22>,</span> ds_type<span class="token operator" data-v-54601d22>=</span>DatasetType<span class="token punctuation" data-v-54601d22>.</span>Valid<span class="token punctuation" data-v-54601d22>)</span>
ImageCleaner<span class="token punctuation" data-v-54601d22>(</span>ds<span class="token punctuation" data-v-54601d22>,</span> idxs<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1550257534536.5d57aa21.png" alt="1550257534536"></p><div class="warning custom-block"><p class="custom-block-title">ImageCleaner doesn’t work on Google Colab</p><p>For this situation you need to delete files by yourself, or use Jupyter Notebook.</p></div><h2 id="fast-ai-data"><a href="#fast-ai-data" aria-hidden="true" class="header-anchor">#</a> fast.ai / Data</h2><p>Before we put our data into learner we need to load them, and <code>fast.ai</code> gat a whole class that will divide your data into <code>train</code>, <code>test</code> , and <code>validation</code>, prepare some data augmentation so you don’t have to do it by yoursef</p><h3 id="imagedatabunch"><a href="#imagedatabunch" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch</h3><p>Class that as an input have images.</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><code>path</code></td><td>folder path to the directory of images</td></tr><tr><td><code>ds_tfms</code></td><td>List of transformation for images</td></tr><tr><td><code>size</code></td><td>The size of the image as input for data (<code>width</code>and <code>height</code>for the image are the same). If the image is greater than will be cropped.</td></tr></tbody></table><h4 id="imagedatabunch-from-folder"><a href="#imagedatabunch-from-folder" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_folder</h4><p>Load data that are prepared in the folder structure. <strong>train</strong>, <strong>test</strong> , <strong>valid</strong></p><p><img src="data:image/png;base64,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" alt="1549650957873"></p><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path<span class="token punctuation">,</span> ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>

data<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,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MQoxADgWuIXhkfwaNmyouUmTJpobNDhy3bF37964nhNQHa6IAcAxCjEAOEZrAjGXkpKiuVOnTpr79eunuVmzZprT0tJqlc8991zN3bt3FxGR1157TY/Zfc7s57zzzjuaBw4cqLm0tLTavw9Q37giBgDHKMQA4FggWhMnnXSS5htuuEFERC655BI9Zp+y2yfrJSUlmqdMmaL51Vdf1Xz48OHYnmwSyMjI0HzLLbdoHjZsmOZGjRpptq2M1NTUSrN93/+7777T7M1+6NGjhx5r3LixZruGwoknnqi5efPmmouLi6v9+yA+vA1C7Y4c2dnZmu338dChQ5rLy8s1b9++XfP69es12/9mEhFXxADgGIUYABxL2taEbUeMGjXqqNyuXTs9VtUSgBUVFZoPHjyoedWqVZoLCwujP9kkU1ZWptneEubn52v+4IMPNNvbTNvqsT+noKBAs73l9P58t27d9Njzzz+vuWvXrprfffddzbQj3LEtJzsD5qabbhIRkV69eukx2+ay30fbzsrMzNT87bffan7ggQc0P/7449Gedr3iihgAHKMQA4BjoXActxKI5y4A9snruHHjNPfs2VNEIm9t7K/AnqOdTWFvi1566SXNt912m+avv/66zufrtx0dRGo2nnYGQ1Vth9qyt7annHKKiIhMnTpVj51//vmaV6xYofm+++7TvGjRojp/fk34bTzj+d1s06aN5kceeUTz0KFDRSRy5pI9r40bN2p+7733NHfs2FGzbWvMmzdP85AhQ+p8vuzQAQABQCEGAMeSdtbEunXrNI8fP16zd1tr2wg222UT7a3sT37yE812BgWbLlbvwIEDMfk5tk10xhlnaP7DH/4gIiLnnHOOHlu9erXm3//+95rtWhNwZ/fu3ZqfffZZza1atRIRkeOPP16PLV++XPOjjz6qeefOnZq92RYikS/27Nu3L0ZnXP+4IgYAxyjEAOBY0rYm7A4Mb7/9drV/tm3btponT56s2d7mfPbZZ5r/85//aP7qq6+iOk9UzVt7QCRyJsSNN96ouW/fviIisnnzZj324IMParZP15EY7As8tl3kLUdq21BLly7VbNcKueuuuzTbl3bsbKhoZjHFG1fEAOAYhRgAHEva1kRVvB0bWrRooccee+wxzb1796703zvuuOM0d+nSRfPatWs1f/nllzE7z6CyO2pcdtllmr3l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" alt="1549650578727"></p><h4 id="imagedatabunch-from-csv"><a href="#imagedatabunch-from-csv" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_csv</h4><p>When you’ve got a .csv file with filenmaes and classes</p><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span> ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_csv<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>

data<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549651318454.4f9a3f2f.png" alt="1549651318454"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVQAAAFZCAYAAADHDNdrAAAeTklEQVR4nO3deXBW9fXH8RPCGlZFCGtYJcoqe0FgKCAFa7UKWiuoIDgMiyCtMlMUfggthSKdai1TxYXFFjqIiKhAQSwWAWWRHQSRTSBg2HcC5PeH8xxOaiIJnGe7eb/+6Weu9MmVb57j/d7vlpCZmZkp/yN0KSEh4X//EQDkaz9WHxNsQc3MzKSIAkAu/W/NLJDTPwAA/LiEhASxnfwCIhRTALhetqgmZPcOFQCQdwWopwBw4zIzM6++QwUA3Bi6/ADgJJBPqBkZGTJu3DhJTU2VtLS0aN8ObhDtGRxBb8tAFtQBAwZIUlJStG8DTmjP4Ah6Wwa2oA4ePDjatwEntGdwBL0tA1lQGzduHO1bgCPaMziC3paBLKgAEA0UVABwQkEFACcUVABwEriJ/enp6dKzZ08REdm1a5ekpKRIYmKiTJ06VZKTk6N8d8gr2jM48kNbBq6gAkC00OUHACcUVABwQkEFACcUVABwQkEFACcFPT+Mc6lyFo+TKWjPnMVbe9KWOfNsS55QAcAJBRUAnFBQAcAJBRUAnFBQAcAJBRUAnFBQAcAJBRUAnFBQAcAJBRUAnLguPY0FoSV2BQpc/W/F5cuXo3U7APIRnlABwAkFFQCcxG2X33bpy5Urp7l69eoiIvKTn/xEr919992aExMTNdtdZmbPnq158eLFmg8cOKD57NmzN3rbAAKMJ1QAcEJBBQAnrsdIh3sTW/v5tWrV0tyjRw/NDz74oIiIFC1aVK+dPn1a8+7duzWHXg+IiNx2222aN2/erHns2LGa582bp/nixYt5uvd425BYJHftWapUKc1NmjTRbF+tHD58WHNSUpLm4sWLX/P60aNHRURk9erVes2+erly5YrmjIyMa96vl3hrzxv5bg4cOFCzbe+VK1dq/uabbzSnpaVpvnDhwnX/3Ehhg2kAiEEUVABwElej/CVLltT88MMPax46dKjmdevWiYjIlClT9Jodqd+/f79m2+Vv1aqV5k6dOmm+6667NM+fP19zXrv8QVKkSBHNvXv31jxy5EjNZ86c0bx3717Ntstos23bEiVKaL506ZKIiHz11Vd67d1339W8Z88ezRs2bMg2x1v3PNY8+eSTmuvWrat5165dmm37/Oc//8n2+tKlS0Uk6yu4oOEJFQCcUFABwElcdfm7deumuV+/fpo3btyoeeLEiSIismTJEr1mu5/W1q1bNa9du1bzwYMHNW/fvl3zuXPnrue2A6dKlSqaO3furLl06dKay5Qpo7ly5crX/Ew7Wp+enq459HqhUaNGes3m48ePa96xY4fmPn36aLazNpB39u+1YcOGmm+++WbNzZo102xfk9nXLaHPsa9ptmzZovmTTz7RfOjQIc32ldH58+c1x+JCG55QAcAJBRUAnMRVl79ChQrZZtu9D00Az6mbb9lu5pEjRzR/9NFHmr/77jvNjBZ/z3bJ7YT7du3aabYT9e2ft3sm2L/zb7/9VvPChQs1d+3aVUREevbsqdfq1aun2b5aaN68ueaXXnpJs/3/2knnyJ0XXnhBs33FY2dSzJw5U3OlSpU0t2zZUnPjxo1FRKRixYp6rU2bNpo7duyo2Xb5169frzklJUWz/b1atWqV5gULFmg+duyY5kh8f3lCBQAnFFQAcBJXXf7atWtrtpOD7ai8HQXMCztR305Yxg+dOHFCs13PbUddbZffduft3gj2ek5ee+01Ebk6KVwk6wyP7t27ay5fvrxm+/rh448/1my7oEGeYO7JrtO3i2TsFpr2NY0dlbdC+2/YVzNdunTRXK1aNc12AUH79u0120Ultv2aNm2qecWKFZptlz8SeEIFACcUVABwEvNdfrtNnx2t3blzp2Y7yh/pR/z8zo6anzx5UvMtt9yiuU6dOprt4oxQd14k50UToQMW7SKMMWPGaP788881270Ebr31Vs12a8ZBgwZpfuuttzTbUWVkZbfgs137++67T7M9NSOnLn/oO2sn9tt1/3YPh9TUVM01atTQbBeV2GxnAtjfw0jPzOEJFQCcxPwTaoMGDTSHdh4SESlcuLBmu2sRIssu63zmmWc023mgVatW1fz4449rXrZsmWa79De7pwp7zc4/nDVrlmY7YPH8889rtnMX7dOtnQ85ZMiQH/xMfM8ew24HfB577DHNdn7qmjVrfvTz7Pc4p3nBX3/9dbbXbRvbXpAdEI1mL5UnVABwQkEFACcx3+W3c+BsV8FuSGy7bogsO3/3008/1fzee+9pfuqppzTb+YX2LDB71pddknot9hypt99+W7N9JWR/vh2seuCBBzT/+c9/1mwHTZCVfTVz6tQpzb169dI8adIkzXbOsgc7QGY3i48VPKEC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" alt="1549651350934"></p><h4 id="imagedatabunch-from-df"><a href="#imagedatabunch-from-df" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_df</h4><p>Get data from loaded DataFrame</p><div class="language-python extra-class"><pre class="language-python"><code>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'labels.csv'</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_df<span class="token punctuation">(</span>path<span class="token punctuation">,</span> df<span class="token punctuation">,</span> ds_tfms<span class="token operator">=</span>tfms<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> pandas <span class="token keyword" data-v-54601d22>as</span> pd

<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
df <span class="token operator" data-v-54601d22>=</span> pd<span class="token punctuation" data-v-54601d22>.</span>read_csv<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'labels.csv'</span><span class="token punctuation" data-v-54601d22>)</span>

data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_df<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> df<span class="token punctuation" data-v-54601d22>,</span> ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>classes
</code></pre></div></div></div><p><code>[0,1]</code></p><h4 id="imagedatabunch-from-name-re"><a href="#imagedatabunch-from-name-re" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_name_re</h4><p>Get data from regular expression in the file name. <a href="https://regexr.com/" target="_blank" title="https://regexr.com/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>regexr</span></a></p><p><img src="data:image/png;base64,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" alt="1549652416468"></p><div class="language-python extra-class"><pre class="language-python"><code>pat <span class="token operator">=</span> r<span class="token string">&quot;/(\d)/\d+\.png$&quot;</span>
data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>path<span class="token punctuation">,</span> fnames<span class="token punctuation">,</span> pat<span class="token operator">=</span>pat<span class="token punctuation">,</span> ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> pandas <span class="token keyword" data-v-54601d22>as</span> pd

<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> recurse<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>

pat <span class="token operator" data-v-54601d22>=</span> r<span class="token string" data-v-54601d22>&quot;/(\d)/\d+\.png$&quot;</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_name_re<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> fnames<span class="token punctuation" data-v-54601d22>,</span> pat<span class="token operator" data-v-54601d22>=</span>pat<span class="token punctuation" data-v-54601d22>,</span> ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>

data<span class="token punctuation" data-v-54601d22>.</span>classes
</code></pre></div></div></div><p><code>['3', '7']</code></p><h4 id="imagedatabunch-from-name-func"><a href="#imagedatabunch-from-name-func" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_name_func</h4><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_func<span class="token punctuation">(</span>
    path<span class="token punctuation">,</span> 
    fnames<span class="token punctuation">,</span> 
    ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span>
    label_func <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">'3'</span> <span class="token keyword">if</span> <span class="token string">'/3/'</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'7'</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> recurse<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>


data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_name_func<span class="token punctuation" data-v-54601d22>(</span>
    path<span class="token punctuation" data-v-54601d22>,</span> 
    fnames<span class="token punctuation" data-v-54601d22>,</span> 
    ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
    size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>,</span>
    label_func <span class="token operator" data-v-54601d22>=</span> <span class="token keyword" data-v-54601d22>lambda</span> x<span class="token punctuation" data-v-54601d22>:</span> <span class="token string" data-v-54601d22>'3'</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token string" data-v-54601d22>'/3/'</span> <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token string" data-v-54601d22>'7'</span><span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>classes
</code></pre></div></div></div><p><code>['3', '7']</code></p><h4 id="imagedatabunch-from-list"><a href="#imagedatabunch-from-list" aria-hidden="true" class="header-anchor">#</a> ImageDataBunch / from_list</h4><p>Get Image data from the list that contains list of classes for each file in fnames.</p><div class="language-python extra-class"><pre class="language-python"><code>labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'3'</span> <span class="token keyword">if</span> <span class="token string">'/3/'</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'7'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> fnames<span class="token punctuation">]</span>


data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_lists<span class="token punctuation">(</span>path<span class="token punctuation">,</span>
                                 fnames<span class="token punctuation">,</span> 
                                 labels<span class="token operator">=</span>labels<span class="token punctuation">,</span> 
                                 ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                 size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>MNIST_SAMPLE<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span> recurse<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
labels <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'3'</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token string" data-v-54601d22>'/3/'</span> <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token string" data-v-54601d22>'7'</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> fnames<span class="token punctuation" data-v-54601d22>]</span>


data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_lists<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                 fnames<span class="token punctuation" data-v-54601d22>,</span> 
                                 labels<span class="token operator" data-v-54601d22>=</span>labels<span class="token punctuation" data-v-54601d22>,</span> 
                                 ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                 size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>24</span><span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>classes
</code></pre></div></div></div><p><code>['3', '7']</code></p><h3 id="databunch-own-item-list"><a href="#databunch-own-item-list" aria-hidden="true" class="header-anchor">#</a> DataBunch / Own Item List</h3><p>Usually you have a lot of datasets with a lot of different type of data, folder structure, etc… It is impossible to write all possible combinations to write your own DataBunch for calculation, that’s why you can step by step put different function on each step of your dataset.</p><table><thead><tr><th>No</th><th>Step</th><th>Description</th></tr></thead><tbody><tr><td>1.</td><td><code>DataType</code></td><td>Define what is your  DataSource, and what is the output</td></tr><tr><td>2.</td><td><code>from_*</code></td><td>Define how to get the input data (files, dataframes, csv)</td></tr><tr><td>3.</td><td><code>*split*</code></td><td>How to split  your data for training, validation and test</td></tr><tr><td>4.</td><td><code>label_*</code></td><td>How to label your data, output y. Returns DataSet.</td></tr><tr><td>5.</td><td><code>Transforms</code></td><td>List of transformations for your input data</td></tr><tr><td>6.</td><td><code>databunch(bs=*)</code></td><td>Convert to <code>DataBunch</code>class</td></tr><tr><td>7.</td><td><code>normalize()</code></td><td>Optional step for DataBunch to normalize input.</td></tr></tbody></table><h4 id="examples-1-planet-data"><a href="#examples-1-planet-data" aria-hidden="true" class="header-anchor">#</a> Examples 1/ Planet Data</h4><p>We’ve got all files in one folder, without dividing into <code>train</code> and <code>validation</code>.</p><p><img src="/assets/img/1550778286094.55beabbc.png" alt="1550778286094"></p><p><img src="/assets/img/1550778228993.b2862b51.png" alt="1550778228993"></p><div class="language-python extra-class"><pre class="language-python"><code>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> <span class="token punctuation">(</span>ImageItemList
       <span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span>
                 <span class="token string">'train_v2.csv'</span><span class="token punctuation">,</span> 
                 folder<span class="token operator">=</span><span class="token string">'train-jpg'</span><span class="token punctuation">,</span> 
                 suffix<span class="token operator">=</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>random_split_by_pct<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>label_from_df<span class="token punctuation">(</span>label_delim<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	   <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> Config<span class="token punctuation" data-v-54601d22>.</span>data_path<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'planet'</span>
path<span class="token punctuation" data-v-54601d22>.</span>mkdir<span class="token punctuation" data-v-54601d22>(</span>parents<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>,</span> exist_ok<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22>#Download and install planet competition from kaggle, extract all files</span>
!kaggle competitions download <span class="token operator" data-v-54601d22>-</span>c planet<span class="token operator" data-v-54601d22>-</span>understanding<span class="token operator" data-v-54601d22>-</span>the<span class="token operator" data-v-54601d22>-</span>amazon<span class="token operator" data-v-54601d22>-</span><span class="token keyword" data-v-54601d22>from</span><span class="token operator" data-v-54601d22>-</span>space <span class="token operator" data-v-54601d22>-</span>f train<span class="token operator" data-v-54601d22>-</span>jpg<span class="token punctuation" data-v-54601d22>.</span>tar<span class="token punctuation" data-v-54601d22>.</span>7z <span class="token operator" data-v-54601d22>-</span>p <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span> 
!kaggle competitions download <span class="token operator" data-v-54601d22>-</span>c planet<span class="token operator" data-v-54601d22>-</span>understanding<span class="token operator" data-v-54601d22>-</span>the<span class="token operator" data-v-54601d22>-</span>amazon<span class="token operator" data-v-54601d22>-</span><span class="token keyword" data-v-54601d22>from</span><span class="token operator" data-v-54601d22>-</span>space <span class="token operator" data-v-54601d22>-</span>f train_v2<span class="token punctuation" data-v-54601d22>.</span>csv <span class="token operator" data-v-54601d22>-</span>p <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span>  
!unzip <span class="token operator" data-v-54601d22>-</span>q <span class="token operator" data-v-54601d22>-</span>n <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span><span class="token operator" data-v-54601d22>/</span>train_v2<span class="token punctuation" data-v-54601d22>.</span>csv<span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>zip</span> <span class="token operator" data-v-54601d22>-</span>d <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span>
!7za <span class="token operator" data-v-54601d22>-</span>bd <span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>-</span>so x <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span><span class="token operator" data-v-54601d22>/</span>train<span class="token operator" data-v-54601d22>-</span>jpg<span class="token punctuation" data-v-54601d22>.</span>tar<span class="token punctuation" data-v-54601d22>.</span>7z <span class="token operator" data-v-54601d22>|</span> tar xf <span class="token operator" data-v-54601d22>-</span> <span class="token operator" data-v-54601d22>-</span>C <span class="token punctuation" data-v-54601d22>{</span>path<span class="token punctuation" data-v-54601d22>}</span>


tfms <span class="token operator" data-v-54601d22>=</span> get_transforms<span class="token punctuation" data-v-54601d22>(</span>flip_vert<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>,</span> max_lighting<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span> max_zoom<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1.05</span><span class="token punctuation" data-v-54601d22>,</span> max_warp<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>.</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><ol><li>We setup random value in the begining to get the same <code>validation</code>, and <code>training</code> set each time.</li><li>The Input is Image and output is list of categories, that’s why we use <code>ImageItemList</code></li><li>The labels are form <code>.csv</code> file, the first column has image filename (default <code>cols=0</code>), and the file is <code>train_v2.csv</code> in the <code>path</code>. Folder for images is <code>train-jpg</code>, and after read the image name add suffix <code>.jpg</code>.</li><li>Because there is no split, we add random split <code>0.2</code></li><li>Labels are in the 1st column (default <code>cols=1</code>), with space delimeter <code>label_delim</code></li><li>We add default transforms <code>tfms</code>, with <code>flip_vert=True</code>, because this are satelite images.</li><li>Create <code>DataBunch</code>, with <code>bs=16</code>.</li><li>We normalize images with <code>imagenet_stats</code></li></ol><h4 id="example-2-imdb-database"><a href="#example-2-imdb-database" aria-hidden="true" class="header-anchor">#</a> Example 2 / IMDB DataBase</h4><p><img src="/assets/img/1550778883858.533d5087.png" alt="1550778883858"></p><div class="language-python extra-class"><pre class="language-python"><code>data_lm <span class="token operator">=</span> <span class="token punctuation">(</span>TextList<span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
           <span class="token comment">#Inputs: all the text files in path</span>
            <span class="token punctuation">.</span>filter_by_folder<span class="token punctuation">(</span>include<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token string">'unsup'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
           <span class="token comment">#We may have other temp folders that contain text files so we only keep what's in train and test</span>
            <span class="token punctuation">.</span>random_split_by_pct<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
           <span class="token comment">#We randomly split and keep 10% (10,000 reviews) for validation</span>
            <span class="token punctuation">.</span>label_for_lm<span class="token punctuation">(</span><span class="token punctuation">)</span>           
           <span class="token comment">#We want to do a language model so we label accordingly</span>
            <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span>bs<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>text <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>


path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>IMDB<span class="token punctuation" data-v-54601d22>)</span>

data_lm <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span>TextList<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>)</span>
           <span class="token comment" data-v-54601d22>#Inputs: all the text files in path</span>
            <span class="token punctuation" data-v-54601d22>.</span>filter_by_folder<span class="token punctuation" data-v-54601d22>(</span>include<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>[</span><span class="token string" data-v-54601d22>'train'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'test'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'unsup'</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span> 
           <span class="token comment" data-v-54601d22>#We may have other temp folders that contain text files so we only keep what's in train and test</span>
            <span class="token punctuation" data-v-54601d22>.</span>random_split_by_pct<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span>
           <span class="token comment" data-v-54601d22>#We randomly split and keep 10% (10,000 reviews) for validation</span>
            <span class="token punctuation" data-v-54601d22>.</span>label_for_lm<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>           
           <span class="token comment" data-v-54601d22>#We want to do a language model so we label accordingly</span>
            <span class="token punctuation" data-v-54601d22>.</span>databunch<span class="token punctuation" data-v-54601d22>(</span>bs<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>64</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

data_lm<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1550779135552.f3f72283.png" alt="1550779135552"></p><h3 id="databunch-1-datatype"><a href="#databunch-1-datatype" aria-hidden="true" class="header-anchor">#</a> DataBunch / 1. DataType <a href="https://docs.fast.ai/data_block.html#ItemList" target="_blank" title="https://docs.fast.ai/data_block.html#ItemList" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><table><thead><tr><th>Class</th><th>Description</th></tr></thead><tbody><tr><td><code>CategoryList</code></td><td>for labels and classification</td></tr><tr><td><code>MultiCategoryList</code></td><td>for labels in a multi classification problem</td></tr><tr><td><code>FloatList</code></td><td>for float labels in a regression problem</td></tr><tr><td><code>ImageItemList</code></td><td>for data that are images</td></tr><tr><td><code>SegmentationItemList</code></td><td>like <code>ImageItemList</code>but will default labels to <code>SegmentationLabelList</code></td></tr><tr><td><code>SegmentationLabelList</code></td><td>for segmentation mask</td></tr><tr><td><code>ObjectItemlist</code></td><td>like <code>ImageItemList</code>but will default labels to <code>ObjectLabelList</code></td></tr><tr><td><code>PointsItemList</code></td><td>for points (of the type <code>ImagePoints</code>)</td></tr><tr><td><code>ImageImageList</code></td><td>for image to image tasks</td></tr><tr><td><code>TextList</code></td><td>for text date</td></tr><tr><td><code>TabularList</code></td><td>for tabular data</td></tr><tr><td><code>CollabList</code></td><td>for collaborative filtering</td></tr></tbody></table><h3 id="databunch-2-from"><a href="#databunch-2-from" aria-hidden="true" class="header-anchor">#</a> DataBunch / 2. from_</h3><table><thead><tr><th>function</th><th>Description</th></tr></thead><tbody><tr><td><code>from_folder(path)</code></td><td>From folder defined in <code>path</code><a href="https://docs.fast.ai/data_block.html#ItemList.from_folder" target="_blank" title="https://docs.fast.ai/data_block.html#ItemList.from_folder" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>from_df(df)</code></td><td>From DataFrame (<code>df</code>)</td></tr><tr><td><code>from_csv(path,csv_name)</code></td><td>Create ItemList from <code>.csv</code> file,</td></tr></tbody></table><h3 id="databunch-3-split"><a href="#databunch-3-split" aria-hidden="true" class="header-anchor">#</a> DataBunch / 3. split</h3><p>How to split  your data for training, validation and test.</p><table><thead><tr><th>function</th><th>Description</th></tr></thead><tbody><tr><td><code>no_split</code></td><td>No split data between <code>train</code> and <code>val</code> (empty <code>validation set</code>)</td></tr><tr><td><code>random_split_by_pct(valid_pct=0.2)</code></td><td>Split by random value</td></tr><tr><td><code>split_by_files(valid_names)</code></td><td>Split by list of files for validation</td></tr><tr><td><code>split_by_fname_file(fname,path)</code></td><td>Split by list of files in the <code>fname</code>file.</td></tr><tr><td><code>split_by_folder(train='train', valid='valid')</code></td><td>Split by the folder name</td></tr><tr><td><code>split_by_idx(valid_idx)</code></td><td>Split by list of indexes of <code>valid_idx</code></td></tr><tr><td><code>split_by_idxs(train_idx,valid_idx)</code></td><td>Split by list of indexes of <code>train_idx</code>, <code>valid_idx</code></td></tr><tr><td><code>split_by_list(train,valid)</code></td><td>Split by list for <code>train</code>, and <code>valid</code></td></tr><tr><td><code>split_by_vavlid_func(func)</code></td><td>Split by the function that return True if it is for <code>valido .</code></td></tr><tr><td><code>split_from_df(col)</code></td><td>Split the data from <code>col</code> in the DataFrom</td></tr></tbody></table><h3 id="databunch-4-label"><a href="#databunch-4-label" aria-hidden="true" class="header-anchor">#</a> DataBunch / 4.label</h3><p>Define the output for items (grand truth)</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>label_empty()</code></td><td><code>EmptyLabel</code> for each item</td></tr><tr><td><code>label_from_list(labels)</code></td><td>Label from the list of labels</td></tr><tr><td><code>label_from_df(cols=1)</code></td><td>Set label as column in the dataframe</td></tr><tr><td><code>label_const(const=0)</code></td><td>Set label as value</td></tr><tr><td><code>label_from_folder()</code></td><td>Get label from the parent folder of the file (e.g. <code>cars\train\porshe\img_001.jpg</code>, tha label will be <code>porche</code>)</td></tr><tr><td><code>label_from_func(func)</code></td><td>Get label from the function</td></tr><tr><td><code>label_from_re(pat)</code></td><td>Get label from pattern</td></tr><tr><td><code>label_for_lm()</code></td><td>Labers are from Language Model</td></tr></tbody></table><h3 id="databunch-5-transforms"><a href="#databunch-5-transforms" aria-hidden="true" class="header-anchor">#</a> DataBunch / 5. Transforms</h3><p>Add list of transforms like Data augmentation</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token punctuation">)</span>
</code></pre></div><h3 id="databunch-6-databunch"><a href="#databunch-6-databunch" aria-hidden="true" class="header-anchor">#</a> DataBunch / 6. DataBunch</h3><p>Convert to DataBunch. The difference from DataSet is that DataBunch divide data into <code>train</code>, <code>valid</code>, and <code>test</code> DataSet.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>
</code></pre></div><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>.show_batch(rows=5,ds_type=DatasetType.Train)</code></td><td>Show in the result example images<br><code>ds_type=[DatasetType.Train, DatasetType.Test, DatasetType.Valid,Single, DatasetType.Fix]</code></td></tr><tr><td><code>.dl(ds_type)</code></td><td>Returns <code>DeviceDataLoader</code></td></tr><tr><td><code>.c</code></td><td>Return count of classes</td></tr><tr><td><code>.classes</code></td><td>List of classes</td></tr><tr><td><code>.train_ds</code>, <code>train_dl</code></td><td>Return train DataSet, or train DataLoader. First value is input, and second value is output.(e.g. <code>data.train_ds[0]</code>):<br><code>(Image (3, 128, 128), MultiCategory haze;primary)</code></td></tr><tr><td><code>valid_ds</code>, <code>valid_dl</code></td><td>Valid DataSet, Valid DataLoader</td></tr><tr><td><code>test_ds</code>, <code>test_dl</code></td><td>Test DataSet, Test DataLoader</td></tr></tbody></table><h3 id="normalize"><a href="#normalize" aria-hidden="true" class="header-anchor">#</a> .normalize()</h3><p>Normalize data based on the mean and standard devation of the image using the Standard Score (<code>(x-mean)/std</code>). For the image you  normalize value for each channel separetely (R,G,B).  If you download images from standard sources you can use predefined statistics. Otherwise use <code>batch_stats()</code> that returns statistics for your images.</p><div class="language-python extra-class"><pre class="language-python"><code>cifar_stats <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.491</span><span class="token punctuation">,</span> <span class="token number">0.482</span><span class="token punctuation">,</span> <span class="token number">0.447</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.247</span><span class="token punctuation">,</span> <span class="token number">0.243</span><span class="token punctuation">,</span> <span class="token number">0.261</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
imagenet_stats <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
mnist_stats <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.15</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.15</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>
    path_img<span class="token punctuation">,</span> 
    fnames<span class="token punctuation">,</span> 
    pat<span class="token punctuation">,</span> 
    ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> bs<span class="token operator">=</span>bs
<span class="token punctuation">)</span>

data <span class="token operator">=</span> data<span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>data<span class="token punctuation">.</span>batch_stats<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#or data = data.normalize(imagenet_stats)</span>
</code></pre></div><h2 id="fast-ai-data-augmentation"><a href="#fast-ai-data-augmentation" aria-hidden="true" class="header-anchor">#</a> fast.ai   / Data augmentation <a href="https://becominghuman.ai/data-augmentation-using-fastai-aefa88ca03f1" target="_blank" title="https://becominghuman.ai/data-augmentation-using-fastai-aefa88ca03f1" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Group of functions that changes your data without changing the meaning of the data. Usefull to test your model when you want to add some data augmentation. For example little zoom on the image, flip the image,  rotate in a small range).</p><h3 id="get-transforms"><a href="#get-transforms" aria-hidden="true" class="header-anchor">#</a> get_transforms()  <a href="https://github.com/fastai/fastai/blob/master/fastai/vision/transform.py#L288" target="_blank" title="https://github.com/fastai/fastai/blob/master/fastai/vision/transform.py#L288" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>source</span></a></h3><p>Return list of transforms for the image that can be used in the <code>ImageDataBunch</code> as a <code>df_tfms</code> parameter. The list is divided into transformation for <code>train</code> and <code>validation</code></p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><code>do_flip</code></td><td>Image can be flipped</td></tr><tr><td><code>flip_vert</code></td><td>Image can be flipped vertically (like satelite images or images from top)</td></tr><tr><td><code>max_rotate</code></td><td>maximum rotation of the image (default: <code>10</code>)</td></tr><tr><td><code>max_zoom</code></td><td>maximum zoom of the image (default: <code>1.1</code>)</td></tr><tr><td><code>max_lighting</code></td><td>maximum lighting of the image (default: <code>0.2</code>)</td></tr><tr><td><code>max_warp</code></td><td>maximum warp of the image (default: <code>0.2</code>)</td></tr><tr><td><code>p_affine</code></td><td>the probability that each affine transform and symmetric warp is applied</td></tr><tr><td><code>p_lighting</code></td><td>the probability that each lighting transform is applied</td></tr><tr><td><code>xtra_tfms</code></td><td>a list of additional transforms</td></tr></tbody></table><p><img src="/assets/img/1549719418642.013380dd.png" alt="1549719418642"></p><h3 id="zoom-crop"><a href="#zoom-crop" aria-hidden="true" class="header-anchor">#</a> zoom crop() <a href="https://docs.fast.ai/vision.transform.html#zoom_crop" target="_blank" title="https://docs.fast.ai/vision.transform.html#zoom_crop" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Randomly zoom and/or crop</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><code>scale</code></td><td>Decimal or range of decimals to zoom the image</td></tr><tr><td><code>do_rand</code></td><td>if true, transform is randomized</td></tr><tr><td><code>p</code></td><td>probability to apply the zzom</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>tsfms <span class="token operator">=</span> zoom_crop<span class="token punctuation">(</span>scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> do_rand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tsfms <span class="token operator" data-v-54601d22>=</span> zoom_crop<span class="token punctuation" data-v-54601d22>(</span>scale<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.75</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> do_rand<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tsfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tsfms
</code></pre></div></div></div><p><img src="/assets/img/1549721099158.49d6b36e.png" alt="1549721099158"></p><h3 id="rand-resize-crop"><a href="#rand-resize-crop" aria-hidden="true" class="header-anchor">#</a> rand_resize_crop()</h3><p>Randomly resize and crop the image.</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><code>size</code></td><td>Final size of the image</td></tr><tr><td><code>max_scale</code></td><td>Zoom the image to a arandom scal up to this</td></tr><tr><td><code>ratios</code></td><td>Range of rations in which a new one will be randomly picked</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>rand_resize_crop<span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>rand_resize_crop<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549721362837.7e0f2c8b.png" alt="1549721362837"></p><h3 id="list-of-transforms"><a href="#list-of-transforms" aria-hidden="true" class="header-anchor">#</a> List of transforms</h3><h4 id="brightness"><a href="#brightness" aria-hidden="true" class="header-anchor">#</a> brightness() <a href="https://docs.fast.ai/vision.transform.html#_brightness" target="_blank" title="https://docs.fast.ai/vision.transform.html#_brightness" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply <code>change</code> in brightness of image. (<code>0</code> - black, <code>0.5</code> no change, <code>0.9</code> - bright)</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>brightness<span class="token punctuation">(</span>change<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>brightness<span class="token punctuation" data-v-54601d22>(</span>change<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549722249727.a3245d04.png" alt="1549722249727"></p><h4 id="contrast"><a href="#contrast" aria-hidden="true" class="header-anchor">#</a> contrast <a href="https://docs.fast.ai/vision.transform.html#_contrast" target="_blank" title="https://docs.fast.ai/vision.transform.html#_contrast" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply <code>scale</code> to contrast of the image. (<code>0</code> - grey, <code>&gt;1</code> - super contrast, <code>1.0</code> - original image)</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>contrast<span class="token punctuation">(</span>scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>contrast<span class="token punctuation" data-v-54601d22>(</span>scale<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>2.0</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549722744720.6c7f8e82.png" alt="1549722744720"></p><h4 id="crop"><a href="#crop" aria-hidden="true" class="header-anchor">#</a> crop <a href="https://docs.fast.ai/vision.transform.html#_crop" target="_blank" title="https://docs.fast.ai/vision.transform.html#_crop" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Crop the image with the <code>size</code> and return image with the new size.<code>row_pct</code> and <code>col_pct</code> are the position of the left/top corner.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>crop<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> row_pct<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>col_pct<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>crop<span class="token punctuation" data-v-54601d22>(</span>size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>250</span><span class="token punctuation" data-v-54601d22>,</span> row_pct<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span>col_pct<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549723001104.799099d0.png" alt="1549723001104"></p><h4 id="crop-pad"><a href="#crop-pad" aria-hidden="true" class="header-anchor">#</a> crop pad <a href="https://docs.fast.ai/vision.transform.html#_crop_pad" target="_blank" title="https://docs.fast.ai/vision.transform.html#_crop_pad" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Like <code>crop</code>, but if the final image is biggar it will also add padding to the image.</p><div class="language-python extra-class"><pre class="language-python"><code>crop_pad<span class="token punctuation">(</span>im<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'zeros'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>


path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

fig<span class="token punctuation" data-v-54601d22>,</span> axs <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>for</span> size<span class="token punctuation" data-v-54601d22>,</span> ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>zip</span><span class="token punctuation" data-v-54601d22>(</span>np<span class="token punctuation" data-v-54601d22>.</span>linspace<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>200</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>600</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> axs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    crop_pad<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span> <span class="token builtin" data-v-54601d22>int</span><span class="token punctuation" data-v-54601d22>(</span>size<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'zeros'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>.</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>.</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>,</span> title<span class="token operator" data-v-54601d22>=</span>f<span class="token string" data-v-54601d22>'size = {int(size)}'</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549730189408.ae194e54.png" alt="1549730189408"></p><div class="warning custom-block"><p class="custom-block-title">Why there is no effect in crop_pad on `apply_tfms`</p><p><code>crop_pad</code> is used but on an image that was resized so that its lower dimension is equal to the size you pass.* <a href="https://forums.fast.ai/t/crop-pad-doesnt-seem-to-work-properly-with-apply-tfms/34096" target="_blank" title="https://forums.fast.ai/t/crop-pad-doesnt-seem-to-work-properly-with-apply-tfms/34096" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>source</span></a></p></div><h4 id="dihedral"><a href="#dihedral" aria-hidden="true" class="header-anchor">#</a> dihedral<a href="https://docs.fast.ai/vision.transform.html#_dihedral" target="_blank" title="https://docs.fast.ai/vision.transform.html#_dihedral" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Randomly flip  and apply rotation of a multiple of 90 degrees.</p><p>If the target is an <code>ImagePoints</code>, or an <code>ImageBBox</code> use <code>dihedral_affine</code> function.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>dihedral<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>dihedral<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549731670616.259435c4.png" alt="1549731670616"></p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">for</span> k<span class="token punctuation">,</span> ax <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>axs<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dihedral<span class="token punctuation">(</span>im<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span>ax<span class="token operator">=</span>ax<span class="token punctuation">,</span> title<span class="token operator">=</span>f<span class="token string">'k={k}'</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

fig<span class="token punctuation" data-v-54601d22>,</span> axs <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>,</span>figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>8</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>for</span> k<span class="token punctuation" data-v-54601d22>,</span> ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>axs<span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    dihedral<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span> k<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>,</span> title<span class="token operator" data-v-54601d22>=</span>f<span class="token string" data-v-54601d22>'k={k}'</span><span class="token punctuation" data-v-54601d22>)</span>
plt<span class="token punctuation" data-v-54601d22>.</span>tight_layout<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1549731840065.6ea70d7c.png" alt="1549731840065"></p><h4 id="flip-lr"><a href="#flip-lr" aria-hidden="true" class="header-anchor">#</a> flip lr<a href="https://docs.fast.ai/vision.transform.html#_flip_lr" target="_blank" title="https://docs.fast.ai/vision.transform.html#_flip_lr" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Randomly flip  horizontaly.</p><p>If the target is an <code>ImagePoints</code>, or an <code>ImageBBox</code> use ``flip_affine`function.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>flip_lr<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>flip_lr<span class="token punctuation" data-v-54601d22>(</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549732187896.f10b0505.png" alt="1549732187896"></p><h4 id="jitter"><a href="#jitter" aria-hidden="true" class="header-anchor">#</a> jitter <a href="https://docs.fast.ai/vision.transform.html#_jitter" target="_blank" title="https://docs.fast.ai/vision.transform.html#_jitter" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Changes pixels randomly replacing them with pixels from the neighorbhood. <code>magnitude</code> parameter is used to get information how far the neighborhood extends.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>jitter<span class="token punctuation">(</span>magnitude<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.05</span><span class="token punctuation">,</span><span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>jitter<span class="token punctuation" data-v-54601d22>(</span>magnitude<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>0.05</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.05</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549732538184.46a99401.png" alt="1549732538184"></p><h4 id="pad"><a href="#pad" aria-hidden="true" class="header-anchor">#</a> pad <a href="https://docs.fast.ai/vision.transform.html#_pad" target="_blank" title="https://docs.fast.ai/vision.transform.html#_pad" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply padding to the image: (<code>padding</code> - size of padding )</p><ul><li><code>mode=zeros</code> : pads with zeros</li><li><code>mode=border</code>: repeats the pixels at the border</li><li><code>mode=reflection</code>: pads by taking the pixels symmetric to the border</li></ul><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>pad<span class="token punctuation">(</span>padding<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>mode<span class="token operator">=</span><span class="token string">'zeros'</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>pad<span class="token punctuation" data-v-54601d22>(</span>padding<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>30</span><span class="token punctuation" data-v-54601d22>,</span>mode<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'zeros'</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549732802157.5d448562.png" alt="1549732802157"></p><h4 id="perspective-warp"><a href="#perspective-warp" aria-hidden="true" class="header-anchor">#</a> perspective warp  <a href="https://docs.fast.ai/vision.transform.html#_perspective_warp" target="_blank" title="https://docs.fast.ai/vision.transform.html#_perspective_warp" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply perspective warping that show a different 3D perspective of the image.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>perspective_warp<span class="token punctuation">(</span>magnitude<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>perspective_warp<span class="token punctuation" data-v-54601d22>(</span>magnitude<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549733306310.61d60245.png" alt="1549733306310"></p><h4 id="symmetric-warp"><a href="#symmetric-warp" aria-hidden="true" class="header-anchor">#</a> symmetric_warp  <a href="https://docs.fast.ai/vision.transform.html#_symmetric_warp" target="_blank" title="https://docs.fast.ai/vision.transform.html#_symmetric_warp" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Apply symetric warp of  <code>magnitude</code>.</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>symmetric_warp<span class="token punctuation">(</span>magnitude<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>symmetric_warp<span class="token punctuation" data-v-54601d22>(</span>magnitude<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549733878458.4fe1a147.png" alt="1549733878458"></p><h4 id="cutout"><a href="#cutout" aria-hidden="true" class="header-anchor">#</a> cutout  <a href="https://docs.fast.ai/vision.transform.html#_cutout" target="_blank" title="https://docs.fast.ai/vision.transform.html#_cutout" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>Cut out <code>n_holes</code> number of square holes at random location</p><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> <span class="token punctuation">[</span>cutout<span class="token punctuation">(</span>n_holes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots_f</span><span class="token punctuation" data-v-54601d22>(</span>image<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> cols<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span> width<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span>height<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token punctuation" data-v-54601d22>[</span>image<span class="token punctuation" data-v-54601d22>.</span>apply_tfms<span class="token punctuation" data-v-54601d22>(</span>tfms<span class="token punctuation" data-v-54601d22>,</span><span class="token operator" data-v-54601d22>**</span>kwargs<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>show<span class="token punctuation" data-v-54601d22>(</span>ax<span class="token operator" data-v-54601d22>=</span>ax<span class="token punctuation" data-v-54601d22>)</span> 
     <span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>
         plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> cols<span class="token punctuation" data-v-54601d22>,</span>
                      figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span>width<span class="token punctuation" data-v-54601d22>,</span>height<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>.</span>flatten<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
    
im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

tfms <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>cutout<span class="token punctuation" data-v-54601d22>(</span>n_holes<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>20</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
plots_f<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>,</span>tfms<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
tfms
</code></pre></div></div></div><p><img src="/assets/img/1549734050015.f645d853.png" alt="1549734050015"></p><h2 id="fast-ai-learner"><a href="#fast-ai-learner" aria-hidden="true" class="header-anchor">#</a> fast.ai / Learner</h2><h3 id="save-load"><a href="#save-load" aria-hidden="true" class="header-anchor">#</a> save/load</h3><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>learn.save('filename')</code></td><td>Save learner</td></tr><tr><td><code>learn.load('filename')</code></td><td>Load learner from the file</td></tr><tr><td><code>learn.export()</code></td><td>Export the learner as pickle file <code>export.pkl</code></td></tr><tr><td><code>learn = load_learner(path)</code></td><td>load learner from the folder whith the exported file <code>export.pkl</code></td></tr></tbody></table><h3 id="partial"><a href="#partial" aria-hidden="true" class="header-anchor">#</a> partial()</h3><p>Partial is help function from Python, that can create a new function with different parameters. Normally accuracy_tresh get <code>tresh=0.5</code>, but with partial we can use this function with default <code>tresh=0.2</code></p><div class="language-python extra-class"><pre class="language-python"><code>acc_02 <span class="token operator">=</span> partial<span class="token punctuation">(</span>accuracy_thresh<span class="token punctuation">,</span> thresh<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
f_score <span class="token operator">=</span> partial<span class="token punctuation">(</span>fbeta<span class="token punctuation">,</span> thresh<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> arch<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span>acc_02<span class="token punctuation">,</span> f_score<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550780654267.1af9ec27.png" alt="1550780654267"></p><h3 id="create-cnn"><a href="#create-cnn" aria-hidden="true" class="header-anchor">#</a> create_cnn()</h3><p>Create a <code>Learner</code> object from the <code>data</code> object and model from the architecture.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td>DataBunch</td></tr><tr><td><code>arch</code></td><td>Architecture of the model</td></tr><tr><td><code>metrics</code></td><td>additional metrics to show during learning</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                   ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   bs<span class="token operator" data-v-54601d22>=</span>bs
                                  <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>

learn <span class="token operator" data-v-54601d22>=</span> create_cnn<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> metrics<span class="token operator" data-v-54601d22>=</span>error_rate<span class="token punctuation" data-v-54601d22>)</span>
learn
</code></pre></div></div></div><p><img src="/assets/img/1549734500237.510f38b9.png" alt="1549734500237"></p><h3 id="create-unet"><a href="#create-unet" aria-hidden="true" class="header-anchor">#</a> create_unet() <a href="https://docs.fast.ai/vision.models.unet.html#DynamicUnet" target="_blank" title="https://docs.fast.ai/vision.models.unet.html#DynamicUnet" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Create Unet architecture learner that converts image to image (mask).</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td>DataBunch</td></tr><tr><td><code>arch</code></td><td>Architecture</td></tr><tr><td><code>metrics</code></td><td>List of metrics</td></tr><tr><td><code>wd</code></td><td>From Learner class <code>weight-decay</code> for regularization in Adam optimalization <a href="https://arxiv.org/abs/1711.05101" target="_blank" title="https://arxiv.org/abs/1711.05101" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>bottle</code></td><td>bottle flags if we use a bottleneck or not for that skip connection</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> unet_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>metrics<span class="token punctuation">,</span> wd<span class="token operator">=</span>wd<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>callbacks<span class="token punctuation" data-v-54601d22>.</span>hooks <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22>#!git clone https://github.com/alexgkendall/SegNet-Tutorial.git</span>
    
path <span class="token operator" data-v-54601d22>=</span> Path<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'./SegNet-Tutorial/CamVid'</span><span class="token punctuation" data-v-54601d22>)</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'val'</span><span class="token punctuation" data-v-54601d22>)</span>
lbl_names <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'valannot'</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_y_fn</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> Path<span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>.</span>parent<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>+</span><span class="token string" data-v-54601d22>'annot'</span><span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span>x<span class="token punctuation" data-v-54601d22>.</span>name

codes <span class="token operator" data-v-54601d22>=</span> array<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token string" data-v-54601d22>'Sky'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Building'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Pole'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Road'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Sidewalk'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Tree'</span><span class="token punctuation" data-v-54601d22>,</span>
    <span class="token string" data-v-54601d22>'Sign'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Fence'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Car'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Pedestrian'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Cyclist'</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>'Void'</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

img_f <span class="token operator" data-v-54601d22>=</span> fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span>
mask <span class="token operator" data-v-54601d22>=</span> open_mask<span class="token punctuation" data-v-54601d22>(</span>get_y_fn<span class="token punctuation" data-v-54601d22>(</span>img_f<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
src_size <span class="token operator" data-v-54601d22>=</span> np<span class="token punctuation" data-v-54601d22>.</span>array<span class="token punctuation" data-v-54601d22>(</span>mask<span class="token punctuation" data-v-54601d22>.</span>shape<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>:</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

bs<span class="token punctuation" data-v-54601d22>,</span>size <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>8</span><span class="token punctuation" data-v-54601d22>,</span>src_size<span class="token operator" data-v-54601d22>//</span><span class="token number" data-v-54601d22>2</span>

src <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span>SegmentationItemList<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>)</span>
       <span class="token punctuation" data-v-54601d22>.</span>split_by_folder<span class="token punctuation" data-v-54601d22>(</span>valid<span class="token operator" data-v-54601d22>=</span><span class="token string" data-v-54601d22>'val'</span><span class="token punctuation" data-v-54601d22>)</span>
       <span class="token punctuation" data-v-54601d22>.</span>label_from_func<span class="token punctuation" data-v-54601d22>(</span>get_y_fn<span class="token punctuation" data-v-54601d22>,</span> classes<span class="token operator" data-v-54601d22>=</span>codes<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

data <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>(</span>src<span class="token punctuation" data-v-54601d22>.</span>transform<span class="token punctuation" data-v-54601d22>(</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> tfm_y<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token punctuation" data-v-54601d22>.</span>databunch<span class="token punctuation" data-v-54601d22>(</span>bs<span class="token operator" data-v-54601d22>=</span>bs<span class="token punctuation" data-v-54601d22>)</span>
        <span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>


name2id <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>{</span>v<span class="token punctuation" data-v-54601d22>:</span>k <span class="token keyword" data-v-54601d22>for</span> k<span class="token punctuation" data-v-54601d22>,</span>v <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span>codes<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>}</span>
void_code <span class="token operator" data-v-54601d22>=</span> name2id<span class="token punctuation" data-v-54601d22>[</span><span class="token string" data-v-54601d22>'Void'</span><span class="token punctuation" data-v-54601d22>]</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>acc_camvid</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>input</span><span class="token punctuation" data-v-54601d22>,</span> target<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    target <span class="token operator" data-v-54601d22>=</span> target<span class="token punctuation" data-v-54601d22>.</span>squeeze<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
    mask <span class="token operator" data-v-54601d22>=</span> target <span class="token operator" data-v-54601d22>!=</span> void_code
    <span class="token keyword" data-v-54601d22>return</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>input</span><span class="token punctuation" data-v-54601d22>.</span>argmax<span class="token punctuation" data-v-54601d22>(</span>dim<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span>mask<span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>==</span>target<span class="token punctuation" data-v-54601d22>[</span>mask<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>float</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

metrics<span class="token operator" data-v-54601d22>=</span>acc_camvid
wd<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span>

learn <span class="token operator" data-v-54601d22>=</span> unet_learner<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> 
                     models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> 
                     metrics<span class="token operator" data-v-54601d22>=</span>metrics<span class="token punctuation" data-v-54601d22>,</span> 
                     wd<span class="token operator" data-v-54601d22>=</span>wd<span class="token punctuation" data-v-54601d22>,</span> 
                     bottle<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token comment" data-v-54601d22># bottle flags if we use a bottleneck or not for that skip connection.</span>

learn
</code></pre></div></div></div><p><img src="/assets/img/1550781130901.4862e43a.png" alt="1550781130901"></p><h3 id="fit"><a href="#fit" aria-hidden="true" class="header-anchor">#</a> .fit()</h3><p>function that train the model based on the train dataset.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>epochs</strong></td><td>Number of epochs</td></tr><tr><td><strong>lr</strong></td><td>Learning rate</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAU0AAACYCAYAAABgdLvsAAAcWElEQVR4nO3df2wT990H8HcQe4hb2mC5IC3eArEiui0TmKVdoAG16mjWtcSPki2bvKx9xELXaKJAVRqv29I+lLbIaaqVH+3SQWBqnyxrsobN0DKltBpKszkqaR3WPA+EzBSvTieoMUE8dhCUe/7I8z3uzmf7znESAu+XFCmxz9/73vfuPv5+v3e5T44kSRIULl68iMuXL+Pzzz/HpUuXkEogEEj5PhHRdDRnzhzMnj0bN9xwA+bNm4cZM2bI78m/SZKEWCyGeDyOCxcu4NKlS/D5fFNSYSKiqXT27Fl88sknGBwcxAcffIBYLCa/NwMALl++jPPnz6t6lgyYRERALBbDBx98gHPnzgH4/6A5OjoK5SidAZOI6IrLly9jcHAQly9fxoyLFy+yh0lElEYsFsMnn3yCGZ9//rnqDZfLNUVVIiK6up07dy4xaAIMnEREepIGTYCBk4hI69KlS8gZGRmR0i+qj/dpEtH1Zkb6RYiISGDQJCIyYVzDcyKi6w17mkREJuRoH9hBRETJsadJRGTCTHY0iYiMY0+TiMgE9jSJiEyYefny5amuAxHRtMGeJhGRCTOTPbCDiIgSzbx48eJU14GIaNqY+YUvfGGq60BENG3wliMiIhMYNImITGDQJCIygUGTiMgEBk0iIhMYNImITGDQJCIygUGTiMgEBk0iIhMYNImITGDQJCIyYWaqNwcGcierHkQAgOLi0amuAlFK7GkSEZnAoElEZELaoHny5DH88IdO3HZbDh555F6MjEQmo15ZdeFCHM89V4fbbsvBbbflYNeuzar3d+3ajB/+0ImTJ49lvI7+/h4891wdLlyIj7e6AICRkQgeeeRe3HZbzrjrdjU6cKAVBw60TnU1iExLGzTnz78Vv/tdAG+8cRQ33WSdjDpl3bvvdgIAenpiOHxYwpo1DYY/ayQYnjx5DDt3Po2amkcxa5ZF9V4wEsT3Xv0etr631VSd8/Js2L79z3jnnc+wYMFXTX3WjK3vbcX3Xv0egpFgVss9/Mlh3PObe3DPb+7RLf+OO+7FW2+9hv7+nqyul2iiXRfD83A4iCVLViQENGHNmgb87ncBzJ9/q+myL1yIo7X1V7j//gcTPr/3o71oeb8F3/jSNzKq90SKxqP4cfuPMffGubg59+asl733o71of6Adb//kbdR8owbPvPMMovGovExeng0bN27F66/vmJajF7p+ZSVoHjjQKg99tUN47dBY2WsT7/X392DXrs0JQ9GRkYj8vpgiMDsEvnAhjlOnwrrvpZp6EO/V1i5HZ+crKCu7QXe5o0c/AADcfXeVquxgJIjI/0bw7L3P4sZ/u9FwfY06efIYfv5zN0KhQXkYb6Zt3jjyBn75rV9iacFS3fdHL43iF3/+hdxbNNNTtlqsePbeZ2G1jI1MFn9xMQAgGouqlps//1Y4HF/DX//6Z8NlE021cQfN/v4evPXWa3jnnc9w+LCE++57AC+99Av55PX7u1BT8ygOH5bQ0xMDcGW4LNTWLofd7sDhwxLuvvu7ePvtdvm9Tz/9GLt2bcavf/0O3nnnM3z66cdyoEpFzAmWld2Azs5X0NDwo4SgnGrqQbzX0vIeqqoelof227f/GXl5Nnm5999/V7cX67A5sKZ0jYmWNO/jj/8HP/vZ97Fx41ZTbQMAa0rXwGFzJH3/Ff8rmDd7Ht7+ydvY9+N9OHX+FPZ+tDdbVZfdfvvd+PDD7qzNBRNNtHEHzffffxdr1jTIgeSOO+7F+fMj+Ne/QgCAO+/8d3nYOmuWBUuWrEA4rJ7fqqt7Gt/5Tg2AsZPo1KmwfBLddJMVGzduRV6eDXl5NixeXIbh4Y/T1kvMCfb0xFBV9TA2b/4vHD4sZTwM1yN6sfn5C7JSXiY8npcwf/6tCW0jeu7KH6MXlKLxKE6dP4UHSx4EAOTOzEXl1ytx+JPDGL1k7j7K0UujaHm/BYvzF+sG6TlzbsH58yMYHY2ZKpdoqqS8uT0dETRqa5erXl+4cLH8+8mTx/DEEz/A4GC//Fpd3dOq5W+//W7598WLy7B4cRkAXPUn0uhoDJ9+mj6AT5QFC76KBQu+Iv+tvMC1Zk2DqQteStFYFMdOHcP3X/u+6vVvFnxT/j0YCaL+zXqMjI4AAL4858t4oeIFeUguvOJ/BQDw8NKHddc1Z84tAICzZz9T9eCJrlbjCppCS8t7cqBTGhmJoKlpPR544HG5J3ngQGtCT3O6ys29AV/84tT1MlPZtWszmpufVL22cOFibNnyuqGe9pfyvoSd1TsTgqDgsDnwhwf/kLKMre9tRf9wP16oeAG5M/X/u+zs2c8AXAmeRFe7cQ3PxXB7167NKa+AiuHryZPH8Nprz49nlbrEUHQibl+ZM+cWDA+fkKcblGbNsmDePLuh6YJk+vt7dO8dHa81axpw+LCk+jE6NZGfl48bZ92IV/tezXj9yoCZLPACY0Fz9uw85ObekPG6iCZT2p7mgQOtaGj4kfx3V9fvsWzZt/HMM63Iy7PJPchvfetKT6Gq6mE89tivkJdnw333PSAP35ct+zZWrfoPxGLns70dGUm3bcDYBaH7738Q3/3u2DBY+/7tt9+NXbs244477lUNL6PxKB7b9xj+efaf8mv7/3s/Vn1tFdYvXy+/tmDBV7Bs2bfleVxxQam/v0c17dHV9XtTPcV09n60Fy//9WX574ffeBh5uXlovL8RDpsDDSsbsPngZtzzm3vkZX56x09R+fXKtGUHI0F0B7sxMjqiGuJrtx1IfiGN6GqVE4/HpWRv8oEd6V24EMcLLzyKJUtWyF8gmXx+3jx7xnOQ09XJk8fwyiv/CY9nh/yFwwd20NXuuri5fSLNmmVBTc2jePPNV03/q+OBA60oK7vhugyYYr77Bz9YywtANK2wp5kl/f09ePPN1/DYY7/iUNMA8X/n2t45e5p0tWPQpKsKgyZd7VIGTSIiUuOcJhGRCQyaREQmMGgSEZnAoElEZAKDJhGRCQyaREQmMGgSEZnAoElEZAKDJhGRCQyaREQmMGgSEZnAoElEZAKDJhGRCTmSJPEpR0REBrGnSURkAoMmEZEJDJpERCYwaBIRmcCgSURkAoMmEZEJDJpERCYwaBIRmcCgSURkAoMmEZEJDJpERCaogubQ0BBWrFgBh8OR9Ke3tzdtodFoFP/4xz8MV6KjowMbNmxAPB5Puszf//53+X0jy0+WxsZGuW2qqqoQjUaTvi9+GhsbU5bZ29srL7tixQoMDQ2lXO/V0hZE1wUpBa/XK3m93lSLJDhz5oxUWVkp+f1+w59pb2+X1q9fL8VisYzenyrt7e1SZWWldObMGUmSxtpLWc9YLCatX79eam9vN1ym3++Xli9fLh0/flz+W7kOvfVksp+IKDMcnmcoGo2ira0NHo8HVqsVAPDQQw8hFArhyJEjAIDR0VGEQiEUFBQYLvfQoUNYt24dioqKAACLFi1CQUEBBgcH5fUePXoUa9euhcViAQBUVVXh6NGjCb1cIsq+jIKmcvjocDjQ0dEBYOyErq2tRSAQgNvtloehesP+dENUoaOjAx6PBz6fD+Xl5RgaGlINz6PRKKqqqvDb3/5WXocY0nZ0dCQdwsbjcWzYsCHp0HpoaAiVlZW6Q2MAiEQikCQJNptNfs1qtWLp0qUIhUJJl9FqbGxUtUV9fT2qq6sTlhNlWq1W7N69Ww6qQjQaRSQSSdWURJQFpoNmR0cHNm7ciK6uLgSDQXR1dWHbtm3o6OiA1WpFS0sLnE4n2traUF9fj2g0ivr6ejQ1NSEYDCIYDKKtrQ3Nzc2G5kerq6vh9XrhcrnQ1dWVECwEn88Hn8+HYDCIiooKlJeXAwCCwSD6+voQCoWwf/9+AGMBpqamBmVlZXKd3G43amtr5cBZVFSEvXv3Jl1fJBJBTk6ObkA8ceKEvEx/fz/Ky8uTflnU19ejvr4+6fbv378foVAIK1eu1H0/Ho9jx44dWLZsWdK6ElH2mAqa8XgcPT09quFjUVER1q1bh56eHt2LEVarFZ2dnSgtLZVfW7hwIZxO5zirruZ2u+Vh8p133gmn0ykHmtzcXNUQeXBwEAUFBVi1apX82qpVq1BQUICDBw9mrU6hUAh2u13+ghkYGMDw8LChXrbozXs8HtW2KTU2NqK4uBh9fX2oqqrKWr2JKDlTQTPZHN2SJUtw7tw5jI6OJv2scjhcUlKCQCCQWY2TMDNvGAqF4PP5UFxcLPcAi4uL4fP5slqn6upqdHd3y18wFosFbrcb+/btSzrsF0pLS+VA29PToxto6+vrEQwGsWfPHqxevdpQz52IxicrF4IikQjOnj2r+56YcywuLkZ+fr48XM52T9OMEydOwOVyYWBgQB6eix+9+UQ9NpsNkiTpziMWFham/Nwtt9xiuK4i0Pr9/qQXeoqKilBRUYFDhw4ZLpeIMmMqaIphrrgoIYjeZ25ubsJnxFXfvr4+ee4uEong9OnTmdZ53AoLCxEKhVL2jNOx2WzIyclRBc1oNAq/3y/3erUXeYDUc6GiNy4urOlJd4GKiCaWqaBpsVhQVlaGbdu2ySft0NAQtm3bhrKyMlgsFt3Aevr0aTm4iAtD4XDY8HpFeeMJckpirnPnzp3ya+IKv9EhrtVqhdvthtfrlXuAO3fuREFBARYtWgRgbG5VORSPRqPwer1J5yj12lf7Gbvdjvnz52PHjh3yHHJvby/27dvHeU2iSTDT7Aeqq6tRUFAgX50GAK/XKw9rxYnv8XjQ09ODLVu2YN26darld+/ejT/+8Y84dOiQ6gJRMgsXLgQAlJSUoK2tzWyVE4ir/LW1tXA4HPLrbW1tcn2Ghobw+OOP4/nnn096Vbq6uhonTpxASUkJAMDpdKKlpUW+f7K0tBRNTU1J2wqA3BMVvXDxXqr23bJlC5544gkUFxcDAOx2O/bs2cOr50STgCl8iYhM4H8EERGZwKBJRGQCgyYRkQkMmkREJjBoEhGZwKBJRGQCgyYRkQkMmkREJjBoEhGZwKBJRGQCgyYRkQkMmkREJjBoEhGZwKBJRGQCgyYRkQkMmkREJkzroNnY2AiHwzEtsjBOVF07OjrgcDhS5hW61mnbQKQu2bBhg25aaeBKPqYVK1YYzrckkgRWVVUlTXJH175pHTQnWjweR0NDA5OYEU1Tvb29uumvx4NBM4loNIqamhr85S9/yUp5Ike5kZxIND5FRUXo7u7Giy++KOdroutPR0cH3G531ss1HTTFUEj8KIebyuHLW2+9JS+jN5wRQ6hUy4ghlFgm1VBKDH+zMVSNRqOora1FIBBAOBxGeXk5GhsbVcO+hoYGOBwOeQjY29urahdt22iH58ohpbLuqYaUZijL1GsTbds6HI6Eb2TtNpkZyhohyleuVxxDynWla1stveG5dntff/31rG2HkWNZuz+0+9nI/sgG7Xq0dU12jA8MDCQ99vW2T3m8KePCyy+/nLSN9Ijz5OWXX0ZVVZWqbO06lWV2dHTA4/EAAJqbm1XHU6oYZoSpoKmsiOB2uxNWGggEsHbtWtXftbW18gb19vaivLxclcY3EAjA5XLJGxaPx/HEE0/A5/PJy4TDYaxevTrhxG1ubkZzc7P8t8fjmdB5Tp/Ph9bWVgBAfn4+wuEwNm7cmLCcMr1vMh6PR1V3n8+H/fv3Z1w3cVIoyxTrESehXtsCY+0oDsje3t6Eb+lwOIz6+vqszectXLgQTqcTfr9fLnNwcBCBQAAVFRUoKirC0NBQxm0r6G3v008/nbD9mTByLDc2NibsD5/Ph+3btyetH6DeH9mgtx7tuamsn/IYnzVrlu7rANIeb8p1NTU1ARhLy52bm2u47k1NTQgEAvJnOzo6EtYZCARUabn1GI1hqRgOmtFoFG1tbbDb7ejq6kIwGERXVxfsdjva2toSekderxfBYBB9fX1wOp0IBAI4ePAg4vG4nIa3rq4OwWAQwWAQdXV1CIfD6OzsBAAcOXIEPp8PTqcTfX19CAaD8Hq9CIfD+PDDD1XrysvLw8DAgFwOAFXedbNEil+n0ylvr0ixK7S1tSEYDKK+vl4eDoptEduszPeejHL7RN1PnDiRcd1Fu+ntJ2UOdgCqZcSPMr0woN5HwWAQnZ2dujnbM2G1WrF06VIEAgEMDg4CAA4dOgRgLGc8gHG1rRAOh9HX16fa3mykgjZ6LAvimBE/2mPKyP4YD3FsuFwu+Xzxer3yuamlPMaTvW7meAOuxAWzUyfK86S0tBTV1dWqdhL7YXh4GPF4HNXV1fB6vQDG9k13dzdsNpupGJaM4aAZiURw+vRpebjqcDjkb9hQKITR0VHVBq5cuRLA2IkheiwnTpzA6OgoQqEQnE4nHnroIfkzVVVVsNvtcq9DBD232y2fpKKhtAdSWVmZvAMKCwuNblLGnE6nnItdSQxDSkpK5G/FdJYuXSpvnwgU4yHabd26dXIe9KKiIlRUVMhfOCI3vXJfaofeohfY3Nw8ocNFsd8PHTqEaDQKv9+v276ZtK0QiUQQDofl3isALFq0CC6Xa1x1N3osi/3qdrt1h4RG9kc2iGPD5/OhuLgYDodD7nVpv6iTHePa140cb4LdbseSJUsyqrvyPFESUzdG5i7NxLBUrokLQQUFBZO+PuXQQswDbdq0Ca2trXJvyIjJCPJ6xBeQ+DZWzt0CY192nZ2dqm3Rzg1lg91uR0lJCfx+P/72t78hEAioTpDxtO3VorS0NKF363a7VXOC6fbHZEs2fDY7rFaaO3cubDZbRp/VnidiXjIUCmVt5GCU4aBps9kwd+5c3SGEdsim7O7H43H09PQAGNvw3NxcFBQUJMw/dHZ2IhwOyyeMCIRtbW2qyd2J6vFoiXoaIeouerziG20qiDpv27ZNDm5DQ0PYt2+f7je9OFnFMEU5vwhcCZ7KYad2emQ8RC9LzIPb7XZUVVXJ72ejbW02W8JwUQwrx8PosSyI4CkCf19fn2ouFEi/P8ZDHBvK4XmyqQKzZRo93rJBOVUoytebjtOev2ZiWCozjVZUDLM9Hg/Ky8tV79XV1SU0usfjUU24iiG7xWKB2+2Gz+dLuICjPGHE8Mnn86GkpERVdjaGsUaJb/y6ujrVyawkvgW122y32yeljkrKdtPbT0VFRaq7A7QqKipgtVp1J8yB8Q2xklmyZAnsdjvC4TBKSkpU7ZaNthW9Wb02GQ8jx3KyizzAWPCy2+2G9kc2KI8NbX3a2toyuh3O6PGWTcovKyP7s7m5Gfv27cOePXtMxbBkTA3PlZOrqVbmdDrlbwLxd0tLi7zzS0tL5W9S5Wd8Pp88L2KxWLBly5aEeadMd65ZogckDA8P48KFC7rLrlq1SlVPr9eb9KLVRLNYLHjxxRfli0rKOon9ZLVa0dramtC2LpcLjzzyCICxfa035GlqapL3UbaIOTBAPT8NZKdt9Y6lJ598ctxzmkD6YznZ/nA6nXjqqadgsVgM7Y9smIhzysjxlm0Wi0UelQBjX1B/+tOf4HK5VL13MS8PjHV+IpGI4RiWSo4kSVKWtkX+xgSgCpJERNcKw8NzmlxDQ0NYvXp1wpyXktfrzeotKderVENoweVyYcuWLfwPoyyZzsf3NXH1nIhosmR1eE5EdK1jT5OIyAQGTSIiExg0iYhMYNAkIjKBQZOIyAQGTSIiExg0iYhMYNAkIjJhyoOmkXSrVxNlXhIjeU60OVn0tlOZs0T7vEptPpNkeVi0eXT0Ht+vXEbvuZhGypgs2rw7RtI+pKu/eJBxqocqmy1DbzntPtOux0gZk+lqbWsg/flmpO5mz9l0pjRoxuNx7NixI+X/n15NtHlJAoEANm3alDLYb9++XfU/zcrcMKJM5SPPkuVBSkUvn48274k2M58234+RMiZLNBpFfX296rhIl/dJL5fQxo0b5XbUe/xac3Oz6mROVwaAtM/z7O3tTXiknnY9U/m8Va2JaOt4PI5NmzaNu63TnW9G6p7JOZuWNEXOnDkjVVZWSoWFhVJhYaG0fv16KRaLTVV10hL1Xb58uXT8+HEpFotJ69evlwoLCyW/36/7mePHj0vLly+XKisrpTNnziSUoWwDUUZ7e7tUWFgoeb1eQ2Uq69He3i5JkiT5/X5Vm6aru5EyJpO2DYzUxev1quqvLUP8naxNjJShrEuy/aMtQ7u/jJQxmSairbXbrNcG6cowcr6lq3sm56wRU9LTVH7rT+YDhcdD9A7EQ3KVz9tMlsRN5KYRT/AWicTEs/0EZd6VlStXwul0ygmilJQ9c4/Ho3r0nvLhwOLBsCLviai7yJEjnoGozcOeqozJJPLViGNDPBcxWV3i8TiGh4dV9RcPNta2o3hep3iottgXRssQid+UuZOUPRttWgZxDCjTRKQrYzJNRFuLZHjap6GLNjBShpHzLV3dMzlnjZiy4fmcOXPQ1dWV8PDSq5U4+PPz8+XHg4nH6SfLHil2jPJEEr8rd5oyG6NIYat30O7fvx8+nw91dXUJD41VPpRXZF8UGRtF3WfPni3PM+nNaaYqY7IoTyiRT0Y8qTtZXUSCM2UOGpHaQNuOPT09iMfjqjQsYpl0ZYi6aSmHleKhyR6PR074ZbfbsXbtWlgsFkNlTJaJbmtgbHgsnpIu2sBIGenONyN1z+ScNWJKgqbVasXu3buz/gTw6UaZqVNkKkyWVU+c5NocOiLlAgD5RNXm4RaUuaOVc6dmypiuRA9eZGIsLi42nSNInOzKHDPadL1iGSXlyMJIGdcSEZyupe2b8qvn1zvt4/ddLpdutkWRCEybQwcYS7mgTE1x11134a677kooQ5tjXXkgGy1julLmsgfGpiJqampMl9HZ2Ynu7m75C18MDcWwcufOnQgEAnJ+b5EKw+v1IhqNGirjWlJfX4+BgQG4XC40NzdP6R0Z2cKgaZDIaKg8sPWG30p6QwHxuzJTnjLx/VNPPSW/r0yVKubBtDl0BJHpMBgM4qWXXsLNN98sD39E3dPlWE9VxmSxWCzIz8/X7Z0lq4vekFLMZynbUZlZs7u7G4sWLQJwpa3TlSFukUl2e9zo6GjCXJ1I6ibKTVfGZJqottZmjdXOJRopI935ZqTumZyzRjBoGiTmXETiJuWcWLJUv2KniTSs0WgUfr9fNQ8j7iET95cdPHgQgUBANQ+jN3GupD1IRa9UeQDOnTtXlQ5WBGFx8KQrYzKJOok6inneZHVRnkBiTvbDDz9UzWeJ+/nEfXrKNLA2m81QGeJCg8/nw5EjR1R1LCsrk+umNzcspCtjstNpTERbi/NBHG/ac8VIGUbOt3R1z+ScNSTj6+5ZMpW3tpglbpNQ/ijrrb0FQnmLg/JH7xYW5Y/yNhhJunL7hfKWDSVxS4e2HOVtFaJuydZjpIzJkq4uercLpWvHbO0LvXbUu50o1XrSlTGZJrOtleeKkbZOd74ZOWbTlZEJBk2TlDtBe6Dr3denPYD0tlN5EumdPOLgSNVGyoNQe/DprUdvGSNlTBbtCSHu55Mk/RNZkhJPRG3A194brCzTaBmSlPoY0CtD737MdGVMpoloayPHfTbaOlXdjZZhFnMEERGZwDlNIiITGDSJiExg0CQiMoFBk4jIBAZNIiITZvDiORGRMZIksadJRGTGjJycnKmuAxHRtDEDGOtyEhFRcpIkIScnB/yPICIiE1RzmoyfRERq2rg4U/lHTk6OvADnOonoepYsFv4f7DRQyZ3mah0AAAAASUVORK5CYII=" alt="1549735202902"></p><h3 id="fit-one-cycle"><a href="#fit-one-cycle" aria-hidden="true" class="header-anchor">#</a> .fit_one_cycle()</h3><p>A better function to fit, that used 1cycle policy <a href="https://sgugger.github.io/the-1cycle-policy.html" target="_blank" title="https://sgugger.github.io/the-1cycle-policy.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></p><p><strong>What’s the difference?:</strong></p><p>In the fit you always go with the same learning rate through all epoch. In the fit_one_cycle you define maximum learnig rate. On each cycle the learning rate go through half of the iterations from the minimum learning rate to the defined maximum, and next half of the iterations go down to the minimum.  On last couple of iterations the learning rate small decreasing.</p><p><img src="/assets/img/art5_lr_schedule.6871203a.png" alt="Learning rates to use in a cycle"></p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>cyc_len</strong></td><td>number of cycles</td></tr><tr><td><strong>max_lr</strong></td><td>maximum learning rate. We can use <code>slice(3e-5,3e-3)</code> to distribute learning rate between initial layers (first smaller value <code>3e-5</code>) to later layers (second higher value <code>3e-3</code>)</td></tr></tbody></table><p><img src="/assets/img/1549735023401.c6dab121.png" alt="1549735023401"></p><h3 id="recorder-plot-losses"><a href="#recorder-plot-losses" aria-hidden="true" class="header-anchor">#</a> .recorder.plot_losses() <a href="" target="_blank" title="" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Plot losses for the train and vaildation set. (after you call fit(), or fit_one_cycle())</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot_losses<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550170847911.459926b8.png" alt="1550170847911"></p><h3 id="show-results"><a href="#show-results" aria-hidden="true" class="header-anchor">#</a> .show_results()</h3><p>Show the output of the learning with Ground Truth, and Predictions.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>show_results<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783391484.08e04e39.png" alt="1550783391484"></p><h3 id="predict"><a href="#predict" aria-hidden="true" class="header-anchor">#</a> predict()</h3><p>predict the data</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>item</strong></td><td>The item to predict</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>im <span class="token operator">=</span> open_image<span class="token punctuation">(</span>fnames<span class="token punctuation">[</span><span class="token number">184</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>im<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token comment" data-v-54601d22># learner</span>
<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>DOGS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>  <span class="token comment" data-v-54601d22># http://files.fast.ai/data/examples/dogscats</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                   ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   bs<span class="token operator" data-v-54601d22>=</span>bs
                                  <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span>lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>save<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dog-cat'</span><span class="token punctuation" data-v-54601d22>)</span>


<span class="token comment" data-v-54601d22># Part that could be done separate</span>
<span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

learn<span class="token punctuation" data-v-54601d22>.</span>load<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dog-cat'</span><span class="token punctuation" data-v-54601d22>)</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>PETS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
path_img <span class="token operator" data-v-54601d22>=</span> path<span class="token operator" data-v-54601d22>/</span><span class="token string" data-v-54601d22>'images'</span>
fnames <span class="token operator" data-v-54601d22>=</span> get_image_files<span class="token punctuation" data-v-54601d22>(</span>path_img<span class="token punctuation" data-v-54601d22>)</span>

im <span class="token operator" data-v-54601d22>=</span> open_image<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>184</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>learn<span class="token punctuation" data-v-54601d22>.</span>predict<span class="token punctuation" data-v-54601d22>(</span>im<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
im
</code></pre></div></div></div><p><img src="/assets/img/1549735528945.54158fe8.png" alt="1549735528945"></p><h3 id="lr-find"><a href="#lr-find" aria-hidden="true" class="header-anchor">#</a> lr_find() <a href="https://arxiv.org/abs/1506.01186" target="_blank" title="https://arxiv.org/abs/1506.01186" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Find best learning rate for a model. Determines how you update the weights or parameters.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong><code>start_lr</code></strong></td><td>start learning rate <code>float</code> number or <code>numpy array</code> (for example <code>learn.lr_find(np.array([1e-4,1e-3,1e-2]))</code>)</td></tr><tr><td><strong><code>end_lr</code></strong></td><td>The maximum learning rate to try.</td></tr><tr><td><code>num_it</code></td><td>Maximum number of iterations</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Plot learning rate and losses.</p><p><img src="/assets/img/1550170981108.9959431a.png" alt="1550170981108"></p><h3 id="how-to-choose-learning-rate"><a href="#how-to-choose-learning-rate" aria-hidden="true" class="header-anchor">#</a> How to choose learning rate?</h3><p>for learning rate you choose usualy two values that are  distribute learning rate between layers. The first value <code>3e-5</code> you can find in the <code>recorder.plot()</code> and it is he strongest downward slope that's kind of sticking around for quite a while. <a href="https://github.com/hiromis/notes/blob/master/Lesson2.md" target="_blank" title="https://github.com/hiromis/notes/blob/master/Lesson2.md" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a> and for the top learning rate usualy choose <code>1e-4</code> or <code>3e-4</code>, and it depends on you.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">3e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3e</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="learning-rate-lr-too-high"><a href="#learning-rate-lr-too-high" aria-hidden="true" class="header-anchor">#</a> Learning rate (LR) too high</h4><p>What you get is much higher valid_loss than train_loss.  You have to go back and create your neural net again and fit from scratch with a lower learning rate.</p><div class="language- extra-class"><pre class="language-text"><code>Total time: 00:13
epoch  train_loss  valid_loss  error_rate       
1      12.220007   1144188288.000000  0.765957    (00:13)
</code></pre></div><h4 id="learning-rate-lr-too-low"><a href="#learning-rate-lr-too-low" aria-hidden="true" class="header-anchor">#</a> Learning rate (LR) too low</h4><p>When your learning rate is too low your valid_loss will go down very slow, our error_rate go down but very slow. Try first show plot losses.  If you have a model like that, train it some more or train it with a higher learning rate.</p><p><img src="/assets/img/1550256445505.43176a2f.png" alt="1550256445505"></p><div class="language- extra-class"><pre class="language-text"><code>Total time: 00:57
epoch  train_loss  valid_loss  error_rate
1      1.030236    0.179226    0.028369    (00:14)
2      0.561508    0.055464    0.014184    (00:13)
3      0.396103    0.053801    0.014184    (00:13)
4      0.316883    0.050197    0.021277    (00:15)
</code></pre></div><h4 id="too-few-epochs"><a href="#too-few-epochs" aria-hidden="true" class="header-anchor">#</a> Too few epochs</h4><p>When you train in too few epochs, your train_loss is much higher than valid_loss. You can try more epochs, if it goes down very slow like in previous example, try highger learning rate.</p><div class="language- extra-class"><pre class="language-text"><code>Total time: 00:14
epoch  train_loss  valid_loss  error_rate
1      0.602823    0.119616    0.049645    (00:14)
</code></pre></div><h4 id="too-many-epochs"><a href="#too-many-epochs" aria-hidden="true" class="header-anchor">#</a> Too many epochs</h4><p>Too many epochs create something called &quot;overfitting&quot;.  Your error rate improves for a while and then starts getting worse again.</p><blockquote><p>Any model that is trained correctly will always have <strong>train loss lower than validation loss</strong>.</p></blockquote><div class="language- extra-class"><pre class="language-text"><code>33     0.189988    0.210684    0.065934    (00:09)
34     0.181293    0.214666    0.073260    (00:09)
35     0.184095    0.222575    0.073260    (00:09)
36     0.194615    0.229198    0.076923    (00:10)
37     0.186165    0.218206    0.075092    (00:09)
38     0.176623    0.207198    0.062271    (00:10)
39     0.166854    0.207256    0.065934    (00:10)
40     0.162692    0.206044    0.062271    (00:09)
</code></pre></div><h2 id="fast-ai-examples"><a href="#fast-ai-examples" aria-hidden="true" class="header-anchor">#</a> fast.ai  / Examples</h2><h3 id="dog-cat-example"><a href="#dog-cat-example" aria-hidden="true" class="header-anchor">#</a> dog-cat example</h3><h4 id="download"><a href="#download" aria-hidden="true" class="header-anchor">#</a> download</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai <span class="token keyword">import</span><span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>DOGS<span class="token punctuation">)</span><span class="token punctuation">;</span>

!ls <span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>fastai<span class="token operator">/</span>data<span class="token operator">/</span>dogscats
!ls <span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>fastai<span class="token operator">/</span>data<span class="token operator">/</span>dogscats<span class="token operator">/</span>train
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549483689248"></p><h4 id="train-model"><a href="#train-model" aria-hidden="true" class="header-anchor">#</a> Train model</h4><p>Train the model based on the previous learned model: <em>resnet34</em> with <em>learning reate=0.01</em> and <em>2 cycles</em></p><div class="language-python extra-class"><pre class="language-python"><code>bs <span class="token operator">=</span> <span class="token number">64</span>
data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path<span class="token punctuation">,</span>
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> 
                                   bs<span class="token operator">=</span>bs
                                  <span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>
learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>from</span> fastai <span class="token keyword" data-v-54601d22>import</span><span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>vision <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

path <span class="token operator" data-v-54601d22>=</span> untar_data<span class="token punctuation" data-v-54601d22>(</span>URLs<span class="token punctuation" data-v-54601d22>.</span>DOGS<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>


bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>
data <span class="token operator" data-v-54601d22>=</span> ImageDataBunch<span class="token punctuation" data-v-54601d22>.</span>from_folder<span class="token punctuation" data-v-54601d22>(</span>path<span class="token punctuation" data-v-54601d22>,</span>
                                   ds_tfms<span class="token operator" data-v-54601d22>=</span>get_transforms<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   size<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>224</span><span class="token punctuation" data-v-54601d22>,</span> 
                                   bs<span class="token operator" data-v-54601d22>=</span>bs
                                  <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>normalize<span class="token punctuation" data-v-54601d22>(</span>imagenet_stats<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>.</span>classes<span class="token punctuation" data-v-54601d22>)</span>
data<span class="token punctuation" data-v-54601d22>.</span>show_batch<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>7</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

learn <span class="token operator" data-v-54601d22>=</span> create_cnn<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>,</span> models<span class="token punctuation" data-v-54601d22>.</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> metrics<span class="token operator" data-v-54601d22>=</span>error_rate<span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit_one_cycle<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> max_lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,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" alt="1549630231237"></p><h4 id="most-incorrect-data"><a href="#most-incorrect-data" aria-hidden="true" class="header-anchor">#</a> Most incorrect data</h4><div class="language-python extra-class"><pre class="language-python"><code>interp <span class="token operator">=</span> ClassificationInterpretation<span class="token punctuation">.</span>from_learner<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
<span class="token comment"># losses,idxs = interp.top_losses()</span>
interp<span class="token punctuation">.</span>plot_top_losses<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549630263523.8628fc97.png" alt="1549630263523"></p><div class="language-python extra-class"><pre class="language-python"><code>interp<span class="token punctuation">.</span>plot_confusion_matrix<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARoAAAEtCAYAAADXzK+vAAAdRElEQVR4nO3de1xUdf7H8ffMoFzEIYXwklIZWkTkCopp9hAUkZulGUkJpqEpCaRo6920CPPhY2srVGxFJTawVsTUAK+Z6aqBQYrprvdQvKEit0Fmhu/vD3/OSkFg8Z2D4/v5F+fM5XxG6+U5Z84wKiGEwK/cXqVSqX59ExFRvX6vG6o7QyOEYFyI6E/7dUvUDd1ARPRHqVQq3HmwpAYYGSJqfnfGRlXfORoiouakZmeISCYhxP/O0RARycJDJyKSjns0RCQdQ0NE0jE0RCQdQ0NE0jE0FkgIgdWrVyMkJARDhw6Fn58fFixYgPLy8j/1vNOnT8fAgQOxZ8+eu37soUOHEBkZ+ae239yysrJQUVFR721/+9vfkJ6ebuaJLBffdbJAS5YswQ8//IDExER06NABOp0O8fHxOH36NL744os/fBW4m5sbtmzZAhcXl2aeWBkBAQFYs2YNOnbsqPQolk+QRSktLRUeHh7i5MmTddZXV1eLHTt2CKPRKKqrq8X8+fOFv7+/CAgIEIsWLRIGg0EIIYSPj49IT08XI0eOFP379xeLFi0SQggRHh4uevToIfz8/MSuXbuEj4+PyMvLMz3/7WWDwSBmz54t/P39hZ+fn5g8ebIoLy8XBw4cEH5+fqZZ7nb7vxYeHi5WrFghXn75ZdG3b1/xz3/+UyxdulQMHTpUBAYGiqKiIiGEEKdOnRJhYWEiICBA+Pn5iU2bNgkhhJg1a5bp9eTl5YkZM2aIhIQEERISIrKzs8WMGTPE0qVLxaFDh8TAgQNFZWWlEEKI5cuXi5iYmOb667pv8NDJwhQUFKBjx47o1q1bnfXW1tYYNGgQ1Go1UlJScOHCBWRlZSEzMxN5eXn45ptvTPfNy8vDl19+iczMTKSmpuLixYtITU0FAKSmpmLgwIENbv/777/HuXPnkJOTg61bt6J79+4oKCioc58/sv365ObmIi0tDYsWLcKSJUvQsWNH5OTkwNXVFRkZGQCAxYsXw9fXF9nZ2UhISMCcOXNgMBiQkJBgej1eXl4AgH379mHdunUICAgwbcPDwwNDhgxBUlISLl26hLS0NMybN6/Rvweqi6GxMDdu3ICjo+Pv3mfXrl0YNWoUNBoNbGxs8Pzzz9c57xISEgKNRgNnZ2c4OTnhwoULTd5++/btceLECWzbtg3V1dV46623MGDAACnbHzRoEDQaDR5//HHodDpTIHr06IFLly4BAJYtW2Y6N+Tl5YWbN2/i8uXL9T5fv379YG1t/Zv1U6dORU5ODmbNmoU333wTDz74YJP/POgWhsbCtGvXzvQ/WUOuXbsGrVZrWtZqtbh69appuW3btqaf1Wo1amtrm7z9p59+GvPnz0dqair69++PadOmoaysTMr227RpY7oPANjZ2f3mMXv27MHo0aPh7++PoKAgCCHq/PqCOzk4ONS73s7ODoGBgTh48CCef/753339VD+GxsL07NkTV69exZEjR+qsNxgM+Oijj6DT6eDk5ITS0lLTbaWlpXBycrqr7Wg0GhiNRtPynTEZOnQoUlNTsWvXLuh0OiQnJ9d5bHNsvykMBgNiY2MRFRWFrVu3YuPGjX/oRPjly5exadMmBAcHIzExsdnnvB8wNBZGq9Vi/PjxmDFjBs6ePQsA0Ol0mDdvHn7++WfY2trCx8cH69atg9FohE6nw9dffw0fH5+72s6DDz6IY8eOAbj1NvHNmzcBABkZGVi2bBmAW3sI3bp1+83/3M2x/aaoqqqCTqfDU089BQD4/PPP0apVK1RVVQG4FcumvOUfHx+PCRMmYM6cOcjKysLRo0ebfVZLx9BYoJiYGLz88suIiorC0KFD8eKLL8LR0dH0r3FERAQ6deqE4OBgvPjii/Dx8alzArQpJk+ebLpW5+TJk3B1dQUA+Pn5obCwEP7+/ggMDMTJkycxbty4Oo9tju03xe3oDh8+HMOHD0fXrl3h5+eHN954AzqdDkFBQRg1ahSys7MbfI5du3bh3LlzGDVqFNq0aYO4uDjMnTu3zt4cNY7X0RCRdNyjISLpGBoiko6hISLpGBoiks5K6QGai22vaKVHkCbvX7PROzRB6TGkuZ5r2demtNYANRb8JpVNEyrCPZp7gLtrZ6VHoD9Bza9MY2iISD6GhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iISDqGhoikY2iI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" alt="1549630283099"></p><h4 id="improve-model"><a href="#improve-model" aria-hidden="true" class="header-anchor">#</a> Improve model</h4><ul><li>find better learn_fs</li></ul><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>sched<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549630308144.3b797b6f.png" alt="1549630308144"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549630351231.9874b287.png" alt="1549630351231"></p><p>Our model val improve from <code>0.0100</code> to <code>0.007</code></p><div class="language-python extra-class"><pre class="language-python"><code>interp<span class="token punctuation">.</span>plot_confusion_matrix<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549630404325"></p><h3 id="dogs-cats-breeds-example"><a href="#dogs-cats-breeds-example" aria-hidden="true" class="header-anchor">#</a> dogs/cats breeds example</h3><p>This examples is more complicated that recognizing dogs and cats. It can also recognize  12 cat breeds and 25 dogs breeds. The whole core functions are the same as previous. The only difference is that now we use <code>URLS.PETS</code> to download data  and <code>ImageDataBunch.from_name_re</code>.</p><h4 id="get-data"><a href="#get-data" aria-hidden="true" class="header-anchor">#</a> Get data</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> error_rate

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>PETS<span class="token punctuation">)</span><span class="token punctuation">;</span>
path<span class="token punctuation">.</span>ls<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'images'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ls<span class="token punctuation">(</span><span class="token punctuation">)</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549484272998"></p><p><img src="/assets/img/1549484431215.31bb6b73.png" alt="1549484431215"></p><h4 id="get-data-2"><a href="#get-data-2" aria-hidden="true" class="header-anchor">#</a> Get Data</h4><div class="language-python extra-class"><pre class="language-python"><code>fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
pat <span class="token operator">=</span> r<span class="token string">'/([^/]+)_\d+.jpg$'</span>

data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>
    path_img<span class="token punctuation">,</span> 
    fnames<span class="token punctuation">,</span> 
    pat<span class="token punctuation">,</span> 
    ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">,</span> bs<span class="token operator">=</span>bs
<span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">)</span>
data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><code>['Abyssinian', 'Bengal', 'Birman', 'Bombay', 'British_Shorthair', 'Egyptian_Mau', 'Maine_Coon', 'Persian', 'Ragdoll', 'Russian_Blue', 'Siamese', 'Sphynx', 'american_bulldog', 'american_pit_bull_terrier', 'basset_hound', 'beagle', 'boxer', 'chihuahua', 'english_cocker_spaniel', 'english_setter', 'german_shorthaired', 'great_pyrenees', 'havanese', 'japanese_chin', 'keeshond', 'leonberger', 'miniature_pinscher', 'newfoundland', 'pomeranian', 'pug', 'saint_bernard', 'samoyed', 'scottish_terrier', 'shiba_inu', 'staffordshire_bull_terrier', 'wheaten_terrier', 'yorkshire_terrier']</code></p><p><img src="/assets/img/1549630449518.8e2fd393.png" alt="1549630449518"></p><h4 id="learn-using-resnet34"><a href="#learn-using-resnet34" aria-hidden="true" class="header-anchor">#</a> Learn using resnet34</h4><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-1'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549630532549"></p><div class="language-python extra-class"><pre class="language-python"><code>interp<span class="token punctuation">.</span>plot_top_losses<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p><img src="/assets/img/1549630635258.abc02566.png" alt="1549630635258"></p><h4 id="most-confused-breeds"><a href="#most-confused-breeds" aria-hidden="true" class="header-anchor">#</a> Most confused breeds</h4><div class="language-python extra-class"><pre class="language-python"><code>interp<span class="token punctuation">.</span>most_confused<span class="token punctuation">(</span>min_val<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p><code>[('Egyptian_Mau', 'Bengal', 11), ('american_pit_bull_terrier', 'staffordshire_bull_terrier', 7), ('British_Shorthair', 'Russian_Blue', 5), ('Persian', 'Ragdoll', 4), ('staffordshire_bull_terrier', 'american_pit_bull_terrier', 4), ('american_bulldog', 'staffordshire_bull_terrier', 3), ('beagle', 'basset_hound', 3), ('miniature_pinscher', 'chihuahua', 3)]</code></p><h4 id="find-better-learning-rate"><a href="#find-better-learning-rate" aria-hidden="true" class="header-anchor">#</a> Find better learning rate</h4><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549631049501.d316faf7.png" alt="1549631049501"></p><p>There is no point to train the whole network with a small value. Better is to define a small learning layer on the first layers and higher learning rate on the last layer and distribute other layers with values between.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549630793542"></p><p>After we define the error rate drop to 0.06 which is a good value (better than human).</p><h4 id="resnet50"><a href="#resnet50" aria-hidden="true" class="header-anchor">#</a> Resnet50</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> error_rate

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>PETS<span class="token punctuation">)</span><span class="token punctuation">;</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span>
fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
pat <span class="token operator">=</span> r<span class="token string">'/([^/]+)_\d+.jpg$'</span>

bs <span class="token operator">=</span> <span class="token number">64</span>

data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>
    path_img<span class="token punctuation">,</span> 
    fnames<span class="token punctuation">,</span> pat<span class="token punctuation">,</span> 
    ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    size<span class="token operator">=</span><span class="token number">299</span><span class="token punctuation">,</span> bs<span class="token operator">=</span>bs<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet50<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-1-50'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549631790524.4f5969d3.png" alt="1549631790524"></p><p><img src="/assets/img/1549631798510.fdf30da7.png" alt="1549631798510"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549631818381"></p><h3 id="isic-archive-skin-melanoma-recognition"><a href="#isic-archive-skin-melanoma-recognition" aria-hidden="true" class="header-anchor">#</a> ISIC - Archive (Skin melanoma recognition)</h3><p>ISIC archive contains plenty of skin images categorised and available for download from the webpage <a href="https://www.isic-archive.com" target="_blank" rel="noopener noreferrer">https://www.isic-archive.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. This is a good point to test fast.ai and verify the first fast.ai lesson for this list of images.</p><p>I’ve used the <a href="https://chrome.google.com/webstore/detail/curlwget/jmocjfidanebdlinpbcdkcmgdifblncg" target="_blank" title="https://chrome.google.com/webstore/detail/curlwget/jmocjfidanebdlinpbcdkcmgdifblncg" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>CurlWget</span></a>  to generate <strong>wget</strong> command that can be copied to the jupyter notebook and download the whole archive.</p><p><img src="/assets/img/1549633920675.e97f9730.png" alt="1549633920675"></p><p><img src="/assets/img/1549633967565.fe42a7cb.png" alt="1549633967565"></p><p><img src="/assets/img/1549634016294.03c8372d.png" alt="1549634016294"></p><p>After you download first selected 240 images, and next selected 240 images for the bening.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#part 1 (240 images 1-3 pages)</span>
!rm ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span>
!wget <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
!unzip <span class="token operator">-</span>o <span class="token operator">-</span>q ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d isd<span class="token operator">/</span>benign
!cp isd<span class="token operator">/</span>benign<span class="token operator">/</span>ISIC<span class="token operator">-</span>images<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>jpg isd<span class="token operator">/</span>benign

<span class="token comment">#part 2 (240 images 4-6 pages)</span>
!rm ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span>
!wget <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
!unzip <span class="token operator">-</span>o <span class="token operator">-</span>q ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d isd<span class="token operator">/</span>benign
!mv isd<span class="token operator">/</span>benign<span class="token operator">/</span>ISIC<span class="token operator">-</span>images<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>jpg isd<span class="token operator">/</span>benign


<span class="token comment">#part 1 malignant</span>
!rm ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span>
!wget <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
!unzip <span class="token operator">-</span>o <span class="token operator">-</span>q ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d isd<span class="token operator">/</span>malignant
!mv isd<span class="token operator">/</span>malignant<span class="token operator">/</span>ISIC<span class="token operator">-</span>images<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>jpg isd<span class="token operator">/</span>malignant

<span class="token comment">#part 2 (page 4-6 - 240 images)</span>
!rm ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span>
!wget <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
!unzip <span class="token operator">-</span>o <span class="token operator">-</span>q ISIC<span class="token operator">-</span>images<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d isd<span class="token operator">/</span>malignant
!mv isd<span class="token operator">/</span>malignant<span class="token operator">/</span>ISIC<span class="token operator">-</span>images<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>jpg isd<span class="token operator">/</span>malignant
</code></pre></div><h4 id="second-option-to-download-data"><a href="#second-option-to-download-data" aria-hidden="true" class="header-anchor">#</a> Second option to download data</h4><p>You can use a python library to download images <a href="https://github.com/GalAvineri/ISIC-Archive-Downloader" target="_blank" rel="noopener noreferrer">https://github.com/GalAvineri/ISIC-Archive-Downloader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> .</p><div class="language-python extra-class"><pre class="language-python"><code>!git clone https<span class="token punctuation">:</span><span class="token operator">//</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>GalAvineri<span class="token operator">/</span>ISIC<span class="token operator">-</span>Archive<span class="token operator">-</span>Downloader<span class="token punctuation">.</span>git
  
!mkdir isic
!mkdir isic<span class="token operator">/</span>bening
!mkdir isic<span class="token operator">/</span>malignant

!python <span class="token string">&quot;ISIC-Archive-Downloader/download_archive.py&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>num<span class="token operator">-</span>images <span class="token number">500</span>  <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">filter</span> benign <span class="token operator">-</span><span class="token operator">-</span>images<span class="token operator">-</span><span class="token builtin">dir</span> isic<span class="token operator">/</span>bening
!python <span class="token string">&quot;ISIC-Archive-Downloader/download_archive.py&quot;</span> <span class="token operator">-</span><span class="token operator">-</span>num<span class="token operator">-</span>images <span class="token number">500</span>  <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">filter</span> malignant <span class="token operator">-</span><span class="token operator">-</span>images<span class="token operator">-</span><span class="token builtin">dir</span> isic<span class="token operator">/</span>malignant
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549636028509"></p><p><img src="data:image/png;base64,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" alt="1549636128365"></p><h4 id="import-libraries"><a href="#import-libraries" aria-hidden="true" class="header-anchor">#</a> Import libraries</h4><p>I’ve used the <code>recurse</code> option to get also filenames from the subfolder.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> error_rate
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path


bs <span class="token operator">=</span> <span class="token number">64</span>
<span class="token comment">#bs = 32   # uncomment this line if you run out of memory even after clicking Kernel-&gt;Restart</span>

path <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">'./isic/'</span><span class="token punctuation">)</span>
fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path<span class="token punctuation">,</span> recurse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><p>Then I can create the <code>ImageDataBunch</code> to prepare data to learn.  I can filp vertical the images (<code>get_transforms(filp_vert=True)</code> ) because the image is not done from front but from the above. (like satelite images) and for recognition it doesn’t matter.</p><p>The example path is:</p><p><code>isic/bening/ISIC_000001.jpg</code></p><p>The regular expresssion is try to find regular expression.</p><ul><li><code>r</code> - means that text is regular expression</li><li><code>([a-zA-Z]+)</code> - the name contains text and because they are in the first bracket they are used as a class for image recognition(<code>bening</code> or <code>malignant</code>)</li><li><code>ISIC_\d+.jpg</code> - any file with the extension <code>.jpg</code> and name started as <code>ISIC_</code> with the number <code>\d+</code> after underline.</li><li><code>$</code> - this means that this that whole regex should be in the on of the name (like <code>.jpg.jpg</code> wouldn’t match the experession)</li></ul><p>You can verify your regex on the page <a href="https://regexr.com/" target="_blank" title="https://regexr.com/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>regexr</span></a>.</p><p><img src="/assets/img/1549645995061.aaccfbb5.png" alt="1549645995061"></p><div class="language-python extra-class"><pre class="language-python"><code>pat <span class="token operator">=</span> r<span class="token string">&quot;([a-zA-Z]+)/ISIC_\d+\.jpg$&quot;</span>

data <span class="token operator">=</span> ImageDataBunch<span class="token punctuation">.</span>from_name_re<span class="token punctuation">(</span>path<span class="token punctuation">,</span> 
                                   fnames<span class="token punctuation">,</span> 
                                   pat<span class="token operator">=</span>pat<span class="token punctuation">,</span> 
                                   ds_tfms<span class="token operator">=</span>get_transforms<span class="token punctuation">(</span>flip_vert<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#FLIP VERTICAL </span>
                                   size<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">)</span>
data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549635940232.22b0c8f8.png" alt="1549635940232"></p><p>Now we can try our first learn</p><div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>error_rate<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-1'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549636165565"></p><p>This is not a very good result but we can try to find better learning rate. It shws that propably <code>1e-2</code> is the best to learn. This is one magnifi</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549636207163.93a9756e.png" alt="1549636207163"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> max_lr<span class="token operator">=</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1549646496183.4b945fb0.png" alt="1549646496183"></p><div class="language-python extra-class"><pre class="language-python"><code>interp<span class="token punctuation">.</span>plot_confusion_matrix<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1549646581287"></p><p>I go down with the <code>14%</code> of error rate. This is not yet a good result, but for now enough to improvement in the future. Mostly the problem is with the skin that is consider as <code>bening</code>, but in real they are <code>malignant</code>.</p><h3 id="planet-amazon-dataset"><a href="#planet-amazon-dataset" aria-hidden="true" class="header-anchor">#</a> Planet Amazon dataset</h3><p>Planet Amazon DataSet is the DataSet of satellite images, that we can categorize with multiple labes for each image.</p><p><a href="https://www.kaggle.com/c/planet-understanding-the-amazon-from-space" target="_blank" rel="noopener noreferrer">https://www.kaggle.com/c/planet-understanding-the-amazon-from-space<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h4 id="download-data"><a href="#download-data" aria-hidden="true" class="header-anchor">#</a> Download Data</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> Config<span class="token punctuation">.</span>data_path<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">'planet'</span>
path<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

!kaggle competitions download <span class="token operator">-</span>c planet<span class="token operator">-</span>understanding<span class="token operator">-</span>the<span class="token operator">-</span>amazon<span class="token operator">-</span><span class="token keyword">from</span><span class="token operator">-</span>space <span class="token operator">-</span>f train<span class="token operator">-</span>jpg<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>7z <span class="token operator">-</span>p <span class="token punctuation">{</span>path<span class="token punctuation">}</span> !kaggle competitions download <span class="token operator">-</span>c planet<span class="token operator">-</span>understanding<span class="token operator">-</span>the<span class="token operator">-</span>amazon<span class="token operator">-</span><span class="token keyword">from</span><span class="token operator">-</span>space <span class="token operator">-</span>f train_v2<span class="token punctuation">.</span>csv <span class="token operator">-</span>p <span class="token punctuation">{</span>path<span class="token punctuation">}</span>  

!conda install <span class="token operator">-</span>y <span class="token operator">-</span>c haasad eidl7zip <span class="token comment">#install 7zip if not exist</span>

!unzip <span class="token operator">-</span>q <span class="token operator">-</span>n <span class="token punctuation">{</span>path<span class="token punctuation">}</span><span class="token operator">/</span>train_v2<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d <span class="token punctuation">{</span>path<span class="token punctuation">}</span>
!7za <span class="token operator">-</span>bd <span class="token operator">-</span>y <span class="token operator">-</span>so x <span class="token punctuation">{</span>path<span class="token punctuation">}</span><span class="token operator">/</span>train<span class="token operator">-</span>jpg<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>7z <span class="token operator">|</span> tar xf <span class="token operator">-</span> <span class="token operator">-</span>C <span class="token punctuation">{</span>path<span class="token punctuation">}</span>
</code></pre></div><h4 id="load-data"><a href="#load-data" aria-hidden="true" class="header-anchor">#</a> Load Data</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> Config<span class="token punctuation">.</span>data_path<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">'planet'</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'train_v2.csv'</span><span class="token punctuation">)</span>

tfms <span class="token operator">=</span> get_transforms<span class="token punctuation">(</span>flip_vert<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> max_lighting<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> max_zoom<span class="token operator">=</span><span class="token number">1.05</span><span class="token punctuation">,</span> max_warp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">)</span>


np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
src <span class="token operator">=</span> <span class="token punctuation">(</span>ImageItemList
       <span class="token punctuation">.</span>from_csv<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'train_v2.csv'</span><span class="token punctuation">,</span> folder<span class="token operator">=</span><span class="token string">'train-jpg'</span><span class="token punctuation">,</span> suffix<span class="token operator">=</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>random_split_by_pct<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>label_from_df<span class="token punctuation">(</span>label_delim<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>src
        <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550781434208.6ef889aa.png" alt="1550781434208"></p><h4 id="load-learner"><a href="#load-learner" aria-hidden="true" class="header-anchor">#</a> Load Learner</h4><p>F-score is helpful for Kaggle competitions. Submission is for the F2-score, with <code>betha</code>equal=2. (this is default for <code>fbeta</code> function)</p><p><img src="/assets/img/1550781708755.e62123c6.png" alt="1550781708755"></p><p><img src="/assets/img/1550781531925.2fdd6ff5.png" alt="1550781531925"></p><div class="language-python extra-class"><pre class="language-python"><code>arch <span class="token operator">=</span> models<span class="token punctuation">.</span>resnet50

acc_02 <span class="token operator">=</span> partial<span class="token punctuation">(</span>accuracy_thresh<span class="token punctuation">,</span> thresh<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
f_score <span class="token operator">=</span> partial<span class="token punctuation">(</span>fbeta<span class="token punctuation">,</span> thresh<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>

learn <span class="token operator">=</span> create_cnn<span class="token punctuation">(</span>data<span class="token punctuation">,</span> arch<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span>acc_02<span class="token punctuation">,</span> f_score<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="find-learning-rate"><a href="#find-learning-rate" aria-hidden="true" class="header-anchor">#</a> Find learning rate</h4><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550781750813.732f9141.png" alt="1550781750813"></p><h4 id="learn-model"><a href="#learn-model" aria-hidden="true" class="header-anchor">#</a> Learn Model</h4><div class="language-python extra-class"><pre class="language-python"><code>lr <span class="token operator">=</span> <span class="token number">0.01</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550781783734.3ab29938.png" alt="1550781783734"></p><h4 id="tune-model"><a href="#tune-model" aria-hidden="true" class="header-anchor">#</a> Tune model</h4><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782018201.ed21dd59.png" alt="1550782018201"></p><div class="language-python extra-class"><pre class="language-python"><code>lr <span class="token operator">=</span> <span class="token number">0.01</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> lr<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-2-rn50'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1550781829671"></p><p>We can resize the model to smaller images and retrain again.</p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'stage-2-rn50'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>src
        <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>tfms<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>data <span class="token operator">=</span> data
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>freeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782136754.10ff030c.png" alt="1550782136754"></p><div class="language-python extra-class"><pre class="language-python"><code>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782161671.ab59884b.png" alt="1550782161671"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> lr<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot_losses<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-2-256-rn50'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782237657.646b6494.png" alt="1550782237657"></p><p><img src="/assets/img/1550782247706.65559f86.png" alt="1550782247706"></p><h3 id="camvid-mask-images"><a href="#camvid-mask-images" aria-hidden="true" class="header-anchor">#</a> CamVid / mask Images</h3><p>CamVid DataSet is huge dataset with images from camera in the car and mask that each pixel give some class. This is a classification for each pixel. The inptu is image, and the output is also image with classes instead of RGB.</p><p><a href="http://mi.eng.cam.ac.uk/research/projects/VideoRec/CamVid/" target="_blank" rel="noopener noreferrer">http://mi.eng.cam.ac.uk/research/projects/VideoRec/CamVid/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h4 id="load-data-2"><a href="#load-data-2" aria-hidden="true" class="header-anchor">#</a> Load Data</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>hooks <span class="token keyword">import</span> <span class="token operator">*</span>

path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>CAMVID<span class="token punctuation">)</span>
path_lbl <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'labels'</span>
path_img <span class="token operator">=</span> path<span class="token operator">/</span><span class="token string">'images'</span>

fnames <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
lbl_names <span class="token operator">=</span> get_image_files<span class="token punctuation">(</span>path_lbl<span class="token punctuation">)</span>

path<span class="token punctuation">.</span>ls<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1550782441540"></p><p>We can load the image by <code>open_image</code>, and mask by <code>open_mask</code>. (<code>x.stem</code> is filename without extenstion, <code>x.suffix</code> is the extension). We can combine input file with the output by adding <code>_P</code> in the file name for <code>path_lbl o</code> directory.</p><p><img src="data:image/png;base64,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" alt="1550782825543"></p><div class="language-python extra-class"><pre class="language-python"><code>img_f <span class="token operator">=</span> fnames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
img <span class="token operator">=</span> open_image<span class="token punctuation">(</span>img_f<span class="token punctuation">)</span>
img<span class="token punctuation">.</span>show<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

get_y_fn <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> path_lbl<span class="token operator">/</span>f<span class="token string">'{x.stem}_P{x.suffix}'</span>
mask <span class="token operator">=</span> open_mask<span class="token punctuation">(</span>get_y_fn<span class="token punctuation">(</span>img_f<span class="token punctuation">)</span><span class="token punctuation">)</span>
mask<span class="token punctuation">.</span>show<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550782654727.093e61f7.png" alt="1550782654727"></p><p><img src="data:image/png;base64,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" alt="1550782661576"></p><div class="language-python extra-class"><pre class="language-python"><code>src_size <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>mask<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
codes <span class="token operator">=</span> np<span class="token punctuation">.</span>loadtxt<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'codes.txt'</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Codes give us list of codes in the order. When in valudation set if pixel on the position <code>x,y</code>  has value 0, this means that this is <code>Animal</code>,</p><p><img src="/assets/img/1550782526202.67103a78.png" alt="1550782526202"></p><h4 id="create-dataset"><a href="#create-dataset" aria-hidden="true" class="header-anchor">#</a> Create DataSet</h4><p>First size of the DataSet is twice smaller than regular. This is called: &quot;progressive resizing&quot;. The dataset learn faster and generalized better.</p><div class="language-python extra-class"><pre class="language-python"><code>size <span class="token operator">=</span> src_size<span class="token operator">//</span><span class="token number">2</span>
bs<span class="token operator">=</span><span class="token number">4</span>

src <span class="token operator">=</span> <span class="token punctuation">(</span>SegmentationItemList
       <span class="token punctuation">.</span>from_folder<span class="token punctuation">(</span>path_img<span class="token punctuation">)</span>
       <span class="token punctuation">.</span>split_by_fname_file<span class="token punctuation">(</span><span class="token string">'../valid.txt'</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>label_from_func<span class="token punctuation">(</span>get_y_fn<span class="token punctuation">,</span> classes<span class="token operator">=</span>codes<span class="token punctuation">)</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>src
        <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span>size<span class="token punctuation">,</span> tfm_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span>bs<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>

data<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
</code></pre></div><p>For mask DataBunch, you can define <code>alpha</code> to set <code>opacity</code> for the mask.  (<code>1.0</code> - means you will not see image)</p><p><img src="/assets/img/1550783072226.e290e8f1.png" alt="1550783072226"></p><h4 id="create-model"><a href="#create-model" aria-hidden="true" class="header-anchor">#</a> Create Model</h4><p>We create our own accuracy, without <code>void</code> class for the image.</p><div class="language-python extra-class"><pre class="language-python"><code>name2id <span class="token operator">=</span> <span class="token punctuation">{</span>v<span class="token punctuation">:</span>k <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>codes<span class="token punctuation">)</span><span class="token punctuation">}</span>
void_code <span class="token operator">=</span> name2id<span class="token punctuation">[</span><span class="token string">'Void'</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">acc_camvid</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">:</span>
    target <span class="token operator">=</span> target<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    mask <span class="token operator">=</span> target <span class="token operator">!=</span> void_code
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token operator">==</span>target<span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

metrics<span class="token operator">=</span>acc_camvid
wd<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span>
learn <span class="token operator">=</span> unet_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> 
                     models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> 
                     metrics<span class="token operator">=</span>metrics<span class="token punctuation">,</span> 
                     wd<span class="token operator">=</span>wd<span class="token punctuation">)</span>
</code></pre></div><h4 id="find-lr"><a href="#find-lr" aria-hidden="true" class="header-anchor">#</a> Find LR</h4><div class="language-python extra-class"><pre class="language-python"><code>lr_find<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783275635.2bd57907.png" alt="1550783275635"></p><div class="language-python extra-class"><pre class="language-python"><code>lr<span class="token operator">=</span><span class="token number">3e</span><span class="token operator">-</span><span class="token number">3</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token punctuation">)</span><span class="token punctuation">,</span> pct_start<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-1'</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>show_results<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783296270.c0c89214.png" alt="1550783296270"></p><p><img src="/assets/img/1550783514365.0c4cc0a1.png" alt="1550783514365"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
lrs <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token operator">/</span><span class="token number">400</span><span class="token punctuation">,</span>lr<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> lrs<span class="token punctuation">,</span> pct_start<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/1550783555937.cb1856e7.png" alt="1550783555937"></p><h4 id="go-to-the-normal-size"><a href="#go-to-the-normal-size" aria-hidden="true" class="header-anchor">#</a> Go to the normal size</h4><div class="language-python extra-class"><pre class="language-python"><code>size <span class="token operator">=</span> src_size
bs<span class="token operator">=</span><span class="token number">3</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>src
        <span class="token punctuation">.</span>transform<span class="token punctuation">(</span>get_transforms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span>size<span class="token punctuation">,</span> tfm_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>databunch<span class="token punctuation">(</span>bs<span class="token operator">=</span>bs<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>imagenet_stats<span class="token punctuation">)</span><span class="token punctuation">)</span>

learn <span class="token operator">=</span> unet_learner<span class="token punctuation">(</span>data<span class="token punctuation">,</span> models<span class="token punctuation">.</span>resnet34<span class="token punctuation">,</span> metrics<span class="token operator">=</span>metrics<span class="token punctuation">,</span> wd<span class="token operator">=</span>wd<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'stage-2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

lr_find<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783772526.1bdc6fd7.png" alt="1550783772526"></p><div class="language-python extra-class"><pre class="language-python"><code>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token builtin">slice</span><span class="token punctuation">(</span>lr<span class="token punctuation">)</span><span class="token punctuation">,</span> pct_start<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783798472.9cbac060.png" alt="1550783798472"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>unfreeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
lrs <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span>lr<span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit_one_cycle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> lrs<span class="token punctuation">)</span>

learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'stage-2-big'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783824462.fe3bff5d.png" alt="1550783824462"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'stage-2-big'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
learn<span class="token punctuation">.</span>show_results<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/1550783851169.f7115eee.png" alt="1550783851169"></p></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/37.7772b5b4.js" defer></script><script src="/assets/js/70.347f2c09.js" defer></script><script src="/assets/js/58.7dba1b4b.js" defer></script><script src="/assets/js/62.53a2512a.js" defer></script><script src="/assets/js/60.eb7f75de.js" defer></script><script src="/assets/js/69.9af65d65.js" defer></script><script src="/assets/js/68.4d0e3cbf.js" defer></script><script src="/assets/js/67.d88188d3.js" defer></script><script src="/assets/js/66.d1ca85ac.js" defer></script><script src="/assets/js/65.c56daf15.js" defer></script><script src="/assets/js/64.f6ad6fd8.js" defer></script><script src="/assets/js/63.63ab144f.js" defer></script><script src="/assets/js/54.6c678409.js" defer></script><script src="/assets/js/73.fb7d948d.js" defer></script><script src="/assets/js/56.ff5f34ac.js" defer></script><script src="/assets/js/app.620103ab.js" defer></script>
  </body>
</html>
