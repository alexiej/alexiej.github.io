<!DOCTYPE html>
<html lang="en-EN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deep Learning | One Page Knowledge</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.0d7fdf74.css" as="style"><link rel="preload" href="/assets/js/app.90502cb8.js" as="script"><link rel="preload" href="/assets/js/36.8763a9aa.js" as="script"><link rel="preload" href="/assets/js/65.3edea211.js" as="script"><link rel="preload" href="/assets/js/53.36b7f8bc.js" as="script"><link rel="preload" href="/assets/js/57.3021bea5.js" as="script"><link rel="preload" href="/assets/js/55.15e44483.js" as="script"><link rel="preload" href="/assets/js/64.cea9ba65.js" as="script"><link rel="preload" href="/assets/js/63.d0f98b80.js" as="script"><link rel="preload" href="/assets/js/62.7376bc82.js" as="script"><link rel="preload" href="/assets/js/61.f89a0558.js" as="script"><link rel="preload" href="/assets/js/60.a834c108.js" as="script"><link rel="preload" href="/assets/js/59.3e053494.js" as="script"><link rel="preload" href="/assets/js/58.15f1fadc.js" as="script"><link rel="preload" href="/assets/js/50.b44f5c9b.js" as="script"><link rel="preload" href="/assets/js/68.2dc7a61f.js" as="script"><link rel="preload" href="/assets/js/52.843a3c03.js" as="script"><link rel="prefetch" href="/assets/js/1.d9c23e63.js"><link rel="prefetch" href="/assets/js/2.218a9531.js"><link rel="prefetch" href="/assets/js/3.d55b65a3.js"><link rel="prefetch" href="/assets/js/4.ca9d9ec6.js"><link rel="prefetch" href="/assets/js/5.9ca23c71.js"><link rel="prefetch" href="/assets/js/6.54556f26.js"><link rel="prefetch" href="/assets/js/7.4992efdd.js"><link rel="prefetch" href="/assets/js/8.8bf2626d.js"><link rel="prefetch" href="/assets/js/9.c933db5e.js"><link rel="prefetch" href="/assets/js/10.e5d74965.js"><link rel="prefetch" href="/assets/js/11.b5fb55b0.js"><link rel="prefetch" href="/assets/js/12.67271d1c.js"><link rel="prefetch" href="/assets/js/13.3145950e.js"><link rel="prefetch" href="/assets/js/14.5943441d.js"><link rel="prefetch" href="/assets/js/15.a40843c5.js"><link rel="prefetch" href="/assets/js/16.f6710d02.js"><link rel="prefetch" href="/assets/js/17.71f0020b.js"><link rel="prefetch" href="/assets/js/18.9718e24f.js"><link rel="prefetch" href="/assets/js/19.4ca15935.js"><link rel="prefetch" href="/assets/js/20.140cea3e.js"><link rel="prefetch" href="/assets/js/21.014747e4.js"><link rel="prefetch" href="/assets/js/22.852d8821.js"><link rel="prefetch" href="/assets/js/23.0ada5134.js"><link rel="prefetch" href="/assets/js/24.283eac17.js"><link rel="prefetch" href="/assets/js/25.4e66f298.js"><link rel="prefetch" href="/assets/js/26.da23fbd5.js"><link rel="prefetch" href="/assets/js/27.cd165438.js"><link rel="prefetch" href="/assets/js/28.4e9e629a.js"><link rel="prefetch" href="/assets/js/29.98b1df4f.js"><link rel="prefetch" href="/assets/js/30.db3555ea.js"><link rel="prefetch" href="/assets/js/31.65b59953.js"><link rel="prefetch" href="/assets/js/32.da1b80db.js"><link rel="prefetch" href="/assets/js/33.3f083bad.js"><link rel="prefetch" href="/assets/js/34.ff9f93dd.js"><link rel="prefetch" href="/assets/js/35.9c9f1be8.js"><link rel="prefetch" href="/assets/js/37.4a15ba2e.js"><link rel="prefetch" href="/assets/js/38.13a0432a.js"><link rel="prefetch" href="/assets/js/39.1d8c0100.js"><link rel="prefetch" href="/assets/js/40.c5b4136b.js"><link rel="prefetch" href="/assets/js/41.da4e8f54.js"><link rel="prefetch" href="/assets/js/42.f70a040b.js"><link rel="prefetch" href="/assets/js/43.f66c2c42.js"><link rel="prefetch" href="/assets/js/44.8e9e5a0a.js"><link rel="prefetch" href="/assets/js/45.f5ce684b.js"><link rel="prefetch" href="/assets/js/46.e3868f7e.js"><link rel="prefetch" href="/assets/js/47.3545345a.js"><link rel="prefetch" href="/assets/js/48.6f4c8416.js"><link rel="prefetch" href="/assets/js/49.99cdec31.js"><link rel="prefetch" href="/assets/js/51.bea04d7a.js"><link rel="prefetch" href="/assets/js/54.1d7bdc6a.js"><link rel="prefetch" href="/assets/js/56.578346d7.js"><link rel="prefetch" href="/assets/js/66.23a1d5df.js"><link rel="prefetch" href="/assets/js/67.1a6ef62f.js"><link rel="prefetch" href="/assets/js/69.677cd0ef.js"><link rel="prefetch" href="/assets/js/70.3fc052e1.js"><link rel="prefetch" href="/assets/js/71.486b112e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0d7fdf74.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      One Page Knowledge
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Deep Learning</span><!----></p><ul class="sidebar-group-items"><li><a href="/deepnn/#gpu-servers" class="sidebar-link">GPU Servers</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/deepnn/#artificial-neural-network" class="sidebar-link">Artificial Neural Network</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#single-layer-perceptron" class="sidebar-link">Single Layer Perceptron</a></li><li class="sidebar-sub-header"><a href="/deepnn/#modern-neural-network" class="sidebar-link">Modern Neural Network</a></li><li class="sidebar-sub-header"><a href="/deepnn/#forward-function" class="sidebar-link">Forward Function</a></li><li class="sidebar-sub-header"><a href="/deepnn/#gradient-descent" class="sidebar-link">Gradient Descent</a></li><li class="sidebar-sub-header"><a href="/deepnn/#backpropagation" class="sidebar-link">Backpropagation</a></li><li class="sidebar-sub-header"><a href="/deepnn/#do-i-have-to-implement-all-these-functions" class="sidebar-link">Do I have to implement all these functions?</a></li></ul></li><li><a href="/deepnn/#activation-functions" class="sidebar-link">Activation Functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#sigmoid-function" class="sidebar-link">Sigmoid function</a></li></ul></li><li><a href="/deepnn/#pytorch" class="sidebar-link">PyTorch</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/deepnn/#fast-ai" class="sidebar-link">fast.ai</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#installation-v-0-7" class="sidebar-link">installation (v 0.7)</a></li><li class="sidebar-sub-header"><a href="/deepnn/#libraries" class="sidebar-link">Libraries</a></li></ul></li><li><a href="/deepnn/#fast-ai-help-functions" class="sidebar-link">fast.ai / Help functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#show-img" class="sidebar-link">show_img</a></li></ul></li><li><a href="/deepnn/#fast-ai-transforms-data" class="sidebar-link">fast.ai / Transforms Data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#tfms-from-model" class="sidebar-link">tfms_from_model</a></li><li class="sidebar-sub-header"><a href="/deepnn/#tfmtype" class="sidebar-link">TfmType</a></li><li class="sidebar-sub-header"><a href="/deepnn/#randomrotate" class="sidebar-link">RandomRotate</a></li><li class="sidebar-sub-header"><a href="/deepnn/#randomlighting" class="sidebar-link">RandomLighting</a></li><li class="sidebar-sub-header"><a href="/deepnn/#randomflip" class="sidebar-link">RandomFlip</a></li><li class="sidebar-sub-header"><a href="/deepnn/#transforms-basic" class="sidebar-link">transforms_basic</a></li><li class="sidebar-sub-header"><a href="/deepnn/#transforms-side-on" class="sidebar-link">transforms_side_on</a></li></ul></li><li><a href="/deepnn/#fast-ai-import-data" class="sidebar-link">fast.ai / Import Data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#imageclassifierdata" class="sidebar-link">ImageClassifierData</a></li></ul></li><li><a href="/deepnn/#fast-ai-learner" class="sidebar-link">fast.ai / Learner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#basic-functions" class="sidebar-link">Basic Functions</a></li><li class="sidebar-sub-header"><a href="/deepnn/#convlearner-pretrained" class="sidebar-link">ConvLearner.pretrained()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#fit" class="sidebar-link">fit()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#predict" class="sidebar-link">predict()</a></li><li class="sidebar-sub-header"><a href="/deepnn/#lr-find" class="sidebar-link">lr_find()</a></li></ul></li><li><a href="/deepnn/#fast-ai-examples" class="sidebar-link">fast.ai / Examples</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deepnn/#dog-cat-example" class="sidebar-link">dog-cat example</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"><div class="warning custom-block"><p class="custom-block-title">Source</p><p>The material based mostly on the free deep learning course and library <strong>fast.ai</strong> (from 2017)</p><p><a href="https://course.fast.ai/index.html" target="_blank" rel="noopener noreferrer">https://course.fast.ai/index.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div><h2 id="gpu-servers"><a href="#gpu-servers" aria-hidden="true" class="header-anchor">#</a> GPU Servers</h2><p>This is a short list of GPU Servers that can be used for fast.ai.</p><table><thead><tr><th>Server</th><th>Free</th><th>Description</th><th>Limitation</th></tr></thead><tbody><tr><td><a href="https://colab.research.google.com/" target="_blank" rel="noopener noreferrer">Google Colab<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>Yes</td><td>Free notebook for use (required setup a GPU)</td><td>12 continuus hours per session</td></tr><tr><td><a href="https://www.kaggle.com/" target="_blank" rel="noopener noreferrer">Kaggle Notebook<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>Yes</td><td>Free kaggle notebook <a href="https://www.kaggle.com/dansbecker/running-kaggle-kernels-with-a-gpu" target="_blank" title="https://www.kaggle.com/dansbecker/running-kaggle-kernels-with-a-gpu" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td>60 continuus minutes per session.</td></tr><tr><td><a href="https://www.paperspace.com/" target="_blank" rel="noopener noreferrer">Paperspace<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No</td><td>Pay as you go consoles to run machines</td><td></td></tr><tr><td><a href="https://azure.microsoft.com/" target="_blank" rel="noopener noreferrer">Microsoft Azure ML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No/200$ for start</td><td>Free 200$ for machines that can have GPU inside</td><td></td></tr><tr><td><a href="https://cloud.google.com/" target="_blank" rel="noopener noreferrer">Google Cloud<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No/300$ for start</td><td>Free Tier to use $300 dolars <a href="https://cloud.google.com/free/docs/gcp-free-tier" target="_blank" title="https://cloud.google.com/free/docs/gcp-free-tier" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td><td></td></tr><tr><td><a href="https://aws.amazon.com/free/" target="_blank" rel="noopener noreferrer">Amazon AWS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>No</td><td>Free Tier doesn’t have GPU machines.</td><td></td></tr></tbody></table><h2 id="artificial-neural-network"><a href="#artificial-neural-network" aria-hidden="true" class="header-anchor">#</a> Artificial Neural Network <a href="https://towardsdatascience.com/multi-layer-neural-networks-with-sigmoid-function-deep-learning-for-rookies-2-bf464f09eb7f" target="_blank" title="https://towardsdatascience.com/multi-layer-neural-networks-with-sigmoid-function-deep-learning-for-rookies-2-bf464f09eb7f" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Artificial Neural Network (ANN) is an paradigm for the deep learning method based on how the natural nervous system works.  They can be used in the ImageRecognition, SpeechRecognition,  natural language processing, desease recognition etc…</p><p>The simplest architecture of the Artifical Neural Network is a Single-layer Perceptron that was introduced in the 1957 by Frank Rosenblatt. <a href="https://en.wikipedia.org/wiki/Perceptron" target="_blank" title="https://en.wikipedia.org/wiki/Perceptron" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><h3 id="single-layer-perceptron"><a href="#single-layer-perceptron" aria-hidden="true" class="header-anchor">#</a> Single Layer Perceptron</h3><p>This architecture contains:</p><ul><li>Input <code>x</code> as a vector</li><li>Weights for each <code>x</code> input (<code>w</code>)</li><li>bias (<code>b</code>)</li><li>and Activation function that on output has been activated or not (<code>0</code> or <code>1</code>)</li></ul><div class="perceptron"><input placeholder="x1" size="mini" value="0.2" class="x1 red"><input placeholder="x2" size="mini" value="0.3" class="x2 green"><input placeholder="x3" size="mini" value="0.8" class="x3 blue"><input placeholder="w1" size="mini" value="0.2" class="w1 red"><input placeholder="w2" size="mini" value="0.3" class="w2 green"><input placeholder="w3" size="mini" value="0.5" class="w3 blue"><input placeholder="b" size="mini" value="0.1" class="b"><input placeholder="w1" size="mini" value="0.2" class="w1a red"><input placeholder="w2" size="mini" value="0.3" class="w2a green"><input placeholder="w3" size="mini" value="0.5" class="w3a blue"><input placeholder="x1" size="mini" value="0.2" class="x1a red"><input placeholder="x2" size="mini" value="0.3" class="x2a green"><input placeholder="x3" size="mini" value="0.8" class="x3a blue"><input readonly="readonly" size="mini" value="0.04" class="m1 red"><input readonly="readonly" size="mini" value="0.09" class="m2 green"><input readonly="readonly" size="mini" value="0.4" class="m3 blue"><input placeholder="b" size="mini" value="0.1" class="mb"><input readonly="readonly" size="mini" value="0.63" class="msum" style="color:green;"><img src="/deepnn/perceptron.png" alt="Card image cap" width="740" height="578" class="image"><span class="answer" style="background-color:green;">σ = 1 </span></div><h4 id="when-use"><a href="#when-use" aria-hidden="true" class="header-anchor">#</a> When Use?</h4><ul><li>Can only classify linearly separable cases with the binary output (0 or 1)</li><li>Single Layer perceptron cannot  solve non-linear problem.</li><li><strong>Not used in modern Deep Learning architecture</strong></li></ul><h3 id="modern-neural-network"><a href="#modern-neural-network" aria-hidden="true" class="header-anchor">#</a> Modern Neural Network</h3><p>Modern Neural Networks has something more than only one layer. In previous architecture, you wouldn’t find any better calculation than some simple linear functions.  To create more complicated functions we need hidden layers.  With this first input goes to the activation function in the first layer, and the following output if the hidden layer can go to the next layer with the activation function or to the final output. More dense Neural Network gives us the opportunity to define more parameters on weights and biases in the network and next recognise more complicated tasks. Each layer can have some special functions. For example in the image recognition first layer is used to extract features (like edges) on the image.</p><p>For example, we define a neural network with one hidden layer with three neurons, two input values, and one output. For the moment we don’t set our activation function yet.</p><p><img src="/assets/img/1547391156214.3d92b6e8.png" alt="1547391156214"></p><p>Let’s explain all parameters defined in the network:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAUCAYAAADskT9PAAABtUlEQVRIie2VIY/qQBSFz2xCSRgFCbYJCkQDAhSOkBoSkkp0+Qd1KGw9GlMDAoEEhcARDAIDCQIECQZBCgSanFU02+V1u2+f2JfsXnnmztxvzr2TESSJb4yX7yz+/wOMx2OUSiUIIVAsFnE+n309lUpBCIF8Po/ZbAYA2O12qFQqEEIgHo+j3+9HEzAkHMehaZp0XZfdbpcA6DgOW60WHcchSV83DIOj0cjP32w2TCaTlFLycDiElSBJhgK8DcuyqCgKy+Uye72er0+nUwIgAJqm6euXy4Wqqn4KIHIGPM/Der3G7XaDrutoNBpPOVJK2LYdbffftOAzt7EsiwDYbrcD+sMZwzAi3Y10YL/f43Q6Qdd1pNPpJ2cURUGtVgvsWa1WAIBCoRBpQCTAZDLB8Xh8OszzPCwWC2iaBk3TAvpwOPwj2JcAlsslACCXywX0+XyO7XYLVVWRSCSewGKxGDKZzL8BXK9XDAYDSClRrVYDa2E2P8Det+xLAI/+Z7NZSCkDa2HOvA3P89DpdNBsNsOLfDShYdP80cu43++s1+sEQEVRaNs2XdcNrSHI39/wF+CHA7wCzQYaadGCWGIAAAAASUVORK5CYII=" alt="1547390335050"></td><td>Number of the examples.</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAnCAIAAAAU41arAAAABnRSTlMA/wD/AP83WBt9AAABIklEQVRYhe2Yu5ECMQxA5avlSG6uAlEC+ZVgp1eKaYP85A6ogAi7F12A96MBFsvsDAR6ode23lifYB0zwxvw8WqBinlIzENiHhLzkJiHxDwk5iHReJR92DrnnNvu07SYLoshLZxsgBvJETFm5hwRADBmZmYmX6/x1HrRbZo95kI1bo44GT2J3mMIHyPelSCvfaIOjyEZeDcQedA+VI/HlJn16K2PtUWU86OksPn9JvIAcDqX6w0puNraNz4+3bfkwRPnqfwWKqAva00eYyrG0LMpMgwWsVndzU0elwZBP7+cqptcrZv1Q6WnXxbRjw5mVtfpQ8r5BIBfG+25lT3K3+EI+LP7fLHHSElB17orl0dtravqfYRj+/8xxzwk5iF5F49/cIBei6jEs00AAAAASUVORK5CYII=" alt="1547389815746"></td><td>Input on the <strong>i</strong> position. Sometimes it shows as a zero activation layer. <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAAAtCAIAAADEABlTAAAABnRSTlMA/wD/AP83WBt9AAAEZ0lEQVRoge2bP0jrXhTHTx+1gtVBUHBpoIJSKKUQ0EEKVmlxqrSgOFVQZysUF/+ADg6CuHRQl+ok0inFQZy00C6KSyAOVkggoYsOTmnVBPobLi/kpTGJmvS9n8ln8+R6e/jmnHvPOVVXs9kEh+/x62878BNwRDQBR0QTcEQ0AXuJKIri0dFRPB5/fn7WWHZ8fDw/P39/f29036ZtEAQhkUhsbGzwPK+7mKbpsbGxs7MzIzvbRUSk4NbWlsK4traGgikQCBAEIX9K0/TAwMDNzY3u5nYRsVwue73ep6cnuTGbzXq9XoqiBEHIZrMAoAi9fD6P47hu5NpCRBSGyWRSbqRpure3V1Kt0WhgGKaQzGAw2uJi4TiuUqnMzc3JjdfX1zzPDw4Ooh/dbnc4HH54eOB5Xlrj8/lGRkYuLi6097eFiLVaTa4XQnH5ut3uoaEhQRAYhlEYSZLU3t8WIn5ER0eH3+/XXcaybL1e11hgCxGr1aqqXoq4+zK2EHF4eFhXL1EUHx8fDcamAluIqEoqlXp/f5cuDVEUSZKMx+P9/f2KlRiGdXV1ae1lej3xD6KoZhCo7pHqxFwu5/F4FNUMqnsUJXorthBRtU5E9uXlZRRMoVCotR40WCfaQsTmBx2LLk7H8geqvbM2JvTONE1Ho1EAwHFceoEsyyKjwfFGe2BZdmpqCmWlx+PZ3d3N5XKxWEwRQe2e4tA0jZzI5/MAgF4gOmUB4At5IVEulw3enq3HvCqXl5foTVMU1fx9h0g+KxAE4fDwMBaLafufz+fT6TTa0Ag66Yx8SiaT6DUaOSDaCXJP7hXys8254tYOB5/PF4lEWJbd29ur1WrlclmnYmojoiiurKy8vLwcHBwovPJ4PIpO2Vp0ZUaDtlAo9OUUtgh0MiiSQ3WiZTX6HUswGASA9fX11lIewXHcxMTE9va2me/WANVqFQASiYQ8DO/u7liW1e8xTEVHRIZhVldXAaBQKLQ+5Tguk8lgGFYqlQx+XqVScRmjs7Pz9vZWYys0ywoEAnIjQRAAoBgdWo2WiBzHRaPR/f19DMNax0EMw6TT6cnJSeMXLgBEIhGDOfL29jY6OvrRPmheoDAyDHNyctLuA1FVxEqlkkqlOI6LRCI4ji8sLMzMzFAURVGUfJnf7y+VSslksl2u/gEal8otr6+vmUwmHA6rTmIsPXNURKxWq8ViEcOwvr6+09NTAAgGg2jgIYri7Oysdpa1jVQqBQCFQqFer3Mct7m5ubOz09PTg55eXV3F43H06LNnzqdpzSN0HafTaemCazQaqPhS7dJROn+qozIL6QtPydtcLocsi4uLPM/TND0+Pk4QhKVOmtA7/0URjWOpk/YdypqII6IJmCAiKnpJktT+SuwH83URRVGcnp52uVxLS0sAUCwWvV5vd3e39h9c/Uh0BhBav+l2n5+fm+jK/xe7nInWnjlWXPn/DtJ4Uc53hsqquJrOv2B8G7uks6U4IpqAI6IJOCKagCOiCfwHCnjQetP2MvkAAAAASUVORK5CYII=" alt="1547389977628"></td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAcCAYAAACZOmSXAAABUUlEQVRIie2WMY6CQBiFH1uMxdDAAbgBDV6AC5hYcwxLGk5CY2PrHWjEmhoTSqElFpC8LTbDLioug25MNryE6g/vm3+G9w8GSeJN+ngXeIaPUtu2CMMQhmF0j2maKMsSAHA6nWDbdldbLBY4Ho+PTampzWZDAJRSMsuyXi1JEgKgEILb7fZXL224Aniex7que7U4jgmAu91ulJc2/HK50HEcSil5Pp9vFhVF0WgvbTh522Ge57Qsi+v1WstnElzBPM9jVVV0HEcbPBneNA1XqxWFEFwul3fP/8/g5PfWX5+9jiYNmbZtsd/vp7z6XM7Jr6xLKRkEgVa0rqUNj+OYQgimadrFa8rHpg1XMNXpUOZfDh/Kshq3U7Z+FFx1eC9Sj8bt03CV6aHufl4maZq+Dl4UBX3fJwACoOu6vZvscDjQsqyurrsAg5z/4Wb4DP/n8E+2KzNgiEfCMwAAAABJRU5ErkJggg==" alt="1547390011533"></td><td>Input vector. The size of the input vector is <em>(input_layer x m)</em> . <br>Where <em>m</em> is a number of examples  (In this example 1).</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA0CAIAAAC2D6d2AAAABnRSTlMA/wD/AP83WBt9AAAD+klEQVRoge1ZMUjzThR//VNvMFNBJSBGKlSFVoSCDq7aRVB0EJVSwdlBEC2WDDpbJxcdjItDHYRuUhcd0qGKS6EBtRChEgQFHSQ2NIF+w/HlH9Omre0l8kF/2z3ucr+7e/d7711c5XIZ/kH899sEmkSbt7No866ApmlHR0ehUOjt7a1u55OTk5WVFUEQGv162R6oqjozM8OyrCzLDQ4RRXFiYiKRSDTS2RbemPTOzs5PB4qiSNP0zc1N3Z628OZ5nqKo19fXJsZyHBcMBuueEnneeLPn5uaMxlQq5fF4EEKJREJV1VgsBgC4aRre4JaTv5fPz8/pdHpxcVG3nJ6e8jyfz+dpms7lctvb2+FwuFgs0jQdj8e/vr6Mw/v6+sbGxi4uLmrP4ibOW5IkWZYHBgZ0SyQSAQBFUQAgHo/zPO/3+3GTYZjOzs5vhNxun8+XzWZrz+Kcft/d3RUKhVgsNj4+DgAvLy+fn5+jo6NVOxcKBdM5mECe9+PjY0dHh9frrbQjhKanp3FTkqSPj4/h4eHmZiHPe3BwUFXVp6cnk10QBON6kskkQsjoTj+CQ36iKMr5+XkoFOru7gYATdPy+XwgEAgEAlX7V/q9CeR59/b2UhQliqLRaPJmTdOy2SzDMAihhYWF29tbvSdeoZXf/w/C6m2h3zzPA4BRrTmOA4CRkRGTVDeo3+14acDv5Cf4TAHAtG58sjqbYrHIMAzuWRmufycfTKVSAGA6642NDSNvPBPDMFYuoarq4eHh1NRUIw7DcVwkEsnlco2QtuSN99JISN9d44UTRdHj8TThD62jlg4awweO0qYOkiSVSqW1tbU6mmUDqvN2u91GBdU0bW9vLxqNMgyjZw7YuLm5iUOJw7Dk7fP5SqUSDh+ZTObq6mp9fd24mEwmI0lSNBp1iOl31I+XiqKEw+Hj4+Oenh4AeHh4kGUZG7e2tozROJ1Ou1yus7Ozyi/09/fPz887wdvv9wPA/f09y7JdXV2zs7P4ELDTsywbDAaXlpaMQ6xSJXw36ofuH8HqwmIVX15eNgYCjuMQQqurq42ENFtRhzd8F2wcehBCjYQ0W2HJG2uzaV/xYioFu+oiywbVJ34+xPITfBRV63OGYUzpYesgmX9b1S816simQYy3IAhV65cW60grkOGNi5SqxVUymaQoanJykshEOsjwtnpUwHXk0NAQRVFEJtJBhvf19bUsy/obgw69jqxd5DYBwnXx5eXl7u6u3qz9uNMSiKgSFnuE0P7+vtFuJY6tg8z7oNfrfX9/r7QLgmDHpQSw7X9D+W+wJB5xMGz8T3JwcGBfJmMLb1xBV77pEISr3P7P7STavJ1Fm7ezaPN2Fv8q7z+lOQlPqm9RLQAAAABJRU5ErkJggg==" alt="1547389753231"></td><td>the weight on the layer <em>n</em>, from the input from the previous layer position (<em>i</em>) to the activation layer position (<em>j</em>)</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAjCAYAAAAg/NwXAAADx0lEQVRoge2ZPUjzXBTH/32IFYxLBEEsLUSwiwVBUUQEP7AghUo3p7o4SpcgBe2grq4WKmJ1swoOfoCjFaLix1SsS4cEWlSwOFaLLdx3eJpiniT1to/Pa4b8oEN7zr3n3H9Obs5NbYQQAgv8+ukEzIIlRAVLiAqWEBVMKUS5XMbGxga8Xi/y+TzVmO3tbczOzuLh4aGxoMRklEol4vf7SSQSIYVCoa6xkiSR4eFhkkgk6o5rKiEUEZaXlw19stksGRsbM/SRJIl0dHSQm5ubumKbSghRFAnLsuTl5UVjy2azJBQKEQAEQE2x4vE46evrq6uiTLNHlMtlrK2twev1or29XWWTZRnBYBATExMQRfHLucbHx/H09IR0Ok0d3zRC5HI5XFxcYGZmRmPjeR7n5+cIBAJUczmdTgwMDOD09JQ6PpUQ6+vrsNls1U9zczNub29VPuVyGdPT07DZbNjb21PZZFlGW1ubao6VlRWVz+PjIwqFArq6uqiTN4JhGHR3dyOVSlGPoRIiFApBEAQAgN1uhyiKGBwcVPlcX1/j5OREdzzP80gkEtXvkUgE4XCYOslGyWazeHt7o/JlaCft6ekBAHg8Hng8HpVNub9r4Xa7wXEceJ7H0tISWlpaVPZMJoOmpibwPE+b0rdCvUe43W5DWy6Xw93dHfr7+w19kskkCoUCYrGYRgRl/lKpBFmWaVP6Vr5ls4xGoxgaGsLo6KiuvVgsYnV1FT6fT3NL/UtcLpeu6Hr8tRCyLGN3dxeLi4uGPpFIBK+vr9jc3DT0cTgcYFkWkiTVjJfJZAAAqVTK8P4vFos4ODhAb28vxQp+Qy2Ew+EAx3Ga35VqMLrSsixjZ2cHCwsLmv7gM06nEyMjI9jf39fYPj+R5ubmAACHh4dgWRatra2a88jz8zM+Pj7g8/lol0e/WeqhVMPR0ZGhTzQaBc/zXz4lGIZBOBzG1NQU8vm8SjSGYXB8fEydVzKZRGdnp2ZTrwltCypJEuE4TtW6CoJAAoFA1UcQBGK326t9vjKG9hBEc9agyfOfnjX+FEIv4GchlEXV2/Ob/vT5/v5OXC5XdWF/VgMhaiFEUVRVRz2USiUSi8XI5OSk7gFMj3g8ToLBIEmn03XHI6RBIe7v73XLTxHi8vKS+P1+jVBmpqHN8qsnxdXVFc7Ozn6sOWoIWsWUigBgWPKCIFC9LzAj1H0EwzDVBuWrDpFlWczPz//lJfp/aaiz1Htn8Jmtra2azZMZsRFi/eUHmOgN1U9jCVHBEqKCJUQFS4gKlhAVLCEq/AdXuokfEVKMaAAAAABJRU5ErkJggg==" alt="1547390155358"></td><td>The matrix on the layer <em>n</em>. The size of the matrix is (<em>current_layer</em> x <em>previous_layer</em>). In the example <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAjCAYAAAAg/NwXAAADx0lEQVRoge2ZPUjzXBTH/32IFYxLBEEsLUSwiwVBUUQEP7AghUo3p7o4SpcgBe2grq4WKmJ1swoOfoCjFaLix1SsS4cEWlSwOFaLLdx3eJpiniT1to/Pa4b8oEN7zr3n3H9Obs5NbYQQAgv8+ukEzIIlRAVLiAqWEBVMKUS5XMbGxga8Xi/y+TzVmO3tbczOzuLh4aGxoMRklEol4vf7SSQSIYVCoa6xkiSR4eFhkkgk6o5rKiEUEZaXlw19stksGRsbM/SRJIl0dHSQm5ubumKbSghRFAnLsuTl5UVjy2azJBQKEQAEQE2x4vE46evrq6uiTLNHlMtlrK2twev1or29XWWTZRnBYBATExMQRfHLucbHx/H09IR0Ok0d3zRC5HI5XFxcYGZmRmPjeR7n5+cIBAJUczmdTgwMDOD09JQ6PpUQ6+vrsNls1U9zczNub29VPuVyGdPT07DZbNjb21PZZFlGW1ubao6VlRWVz+PjIwqFArq6uqiTN4JhGHR3dyOVSlGPoRIiFApBEAQAgN1uhyiKGBwcVPlcX1/j5OREdzzP80gkEtXvkUgE4XCYOslGyWazeHt7o/JlaCft6ekBAHg8Hng8HpVNub9r4Xa7wXEceJ7H0tISWlpaVPZMJoOmpibwPE+b0rdCvUe43W5DWy6Xw93dHfr7+w19kskkCoUCYrGYRgRl/lKpBFmWaVP6Vr5ls4xGoxgaGsLo6KiuvVgsYnV1FT6fT3NL/UtcLpeu6Hr8tRCyLGN3dxeLi4uGPpFIBK+vr9jc3DT0cTgcYFkWkiTVjJfJZAAAqVTK8P4vFos4ODhAb28vxQp+Qy2Ew+EAx3Ga35VqMLrSsixjZ2cHCwsLmv7gM06nEyMjI9jf39fYPj+R5ubmAACHh4dgWRatra2a88jz8zM+Pj7g8/lol0e/WeqhVMPR0ZGhTzQaBc/zXz4lGIZBOBzG1NQU8vm8SjSGYXB8fEydVzKZRGdnp2ZTrwltCypJEuE4TtW6CoJAAoFA1UcQBGK326t9vjKG9hBEc9agyfOfnjX+FEIv4GchlEXV2/Ob/vT5/v5OXC5XdWF/VgMhaiFEUVRVRz2USiUSi8XI5OSk7gFMj3g8ToLBIEmn03XHI6RBIe7v73XLTxHi8vKS+P1+jVBmpqHN8qsnxdXVFc7Ozn6sOWoIWsWUigBgWPKCIFC9LzAj1H0EwzDVBuWrDpFlWczPz//lJfp/aaiz1Htn8Jmtra2azZMZsRFi/eUHmOgN1U9jCVHBEqKCJUQFS4gKlhAVLCEq/AdXuokfEVKMaAAAAABJRU5ErkJggg==" alt="1547390155358"> (<em>3 x 2</em>)</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAAjCAYAAAAqoHJFAAADJUlEQVRoge2ZP0vrUBjGHy/Xg5ipgxAQAzqIQ0UI6ODkYBdBcBEF0Q9RRKwZ+gEE14p4ujh0EbpJ97goLkILkkIKERF06CC1hQTeO1xSbJsmObm297a3P8hyTt435znvn3NKx4iI8J/w428voJ+MxA4rI7G9wnEcnJ+fI5FI4P39Xdg+m83i4OAApVIp2gKoT9i2TZubm6RpGtVqtch+TNOk1dVVyuVywrZ9EesKTafT3+LPNE2SZZnu7u6E7PoiVtd1kiSJ3t7evs0n55xUVRXKkp6LdaO6tbXlOV8oFCgWixFjjHK5HNm2TalUigA0x7yIEt2eN6jn52fc3t5iZ2enY+7q6gq6rqNcLkOWZRSLRRwfH2Nvbw/1eh2yLOP09BSfn58dtjMzM1heXsbNzU34xYhESdd1AhD4fI2iruvEGPONQL1eJ0VRWt5zx7plBBFRMpn0nW9HKLL5fB4AoGkaarUa6HcZgIjAOQcASJKEi4sLEbd4eHiAZVlIpVJYWVkBALy+vuLj4wNLS0u+tpZleUbei9BiHcdBuVyGqqo4OTnB5ORkc65SqeDw8BAAcHl5iampqeacYRgYHx/H7OxsV9+GYYAxho2NjebYy8sLqtUqFhYWwi4xECGxT09PyGQyLUIbjQbW1tZQrVaRTqexu7vbYjc/Pw/btlGpVLr6LpVKHRuSz+fBGMPc3JyIHl9+hn1xYmIChmF0jGuaBsuyoKoqjo6OhBfQaDRwfX2NRCLRzAg3i+LxOOLxuK+9oigtm+/HH3XjbDaLs7MzMMY6Iu4yPT0NSZJgmqanD6/adBwHj4+PUBQFjDFsb2/j/v6+xc7dpKCabiF0K2vDNE2KxWIEwPfqFnTOuh2+3QfnnADQ4uKiZyePcs5GEuseC2g7Zrox0DeoZDJJAEJ/bGDvxm7aBV0U2hm4Xz1h67Qbtm1TJpOh9fX1SCnNOaf9/X0qFovCtkQCYt3IhK3Tf5HQYt069Wo0bsOKEu1+EkpsUJ1yzr+92/aCQLFf69SrmxYKBaHO/DfxFfu1ToOeQajjMaLR3x9DyUjssDISO6yMxA4rvwCixYf6hR0JhgAAAABJRU5ErkJggg==" alt="1547587884160"></td><td>The Z value on the layer (n). The product on output from the previous layer (or input) and weights on the current layer. The size of the matrix is (<em>current_layer</em> x <em>m</em>)</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEMAAAA3CAIAAADYG2DzAAAABnRSTlMA/wD/AP83WBt9AAACcklEQVRoge2aP7KbMBDGP+csfi48PsFyAk8aV2lfJ8qXJl3KHECUoXttKppIJ3icwENhcRelEPgPyG+EQDLx8HUIGO+PXe2udrzSWuMp9OXRBkymhWR+Wkjmp4VkfopGUsssTZJMujyaJUmayXrgL+gYUpxAXKhBbxAxMeA3IpAYjAEUfu+FJxEMGPRxLxrEEppEceqCKMEIAEzwtFewxdIQlMAkPRDFGXGhtGAAccEZE0obx9lsHoASmMQYbLFEMFzbLhjsMegemw+qJ7LIAeLvb2sAQH06ArR9sT98PLkk5LAk9ekI7DZr6zp9+9reUFVpfW6IwpKsNzvrJ+1Ybjx0zyWOekh0ySIH2GHfXHY91JWbswKTvGwJZaVuF7u74uyhOkuS7MaBssidnTUmMznIUk/6iUrxpsB0s9yM6ol+nhqv/5O+SwlG1MYpMS4EJ7pbqufaC6u2TDcGNsF+7zMqwRkRd7FNcSI2iFtrfxJj943VDYrnnhgtvyxcZ6/fS4D9fOtl+rEFzl8++J3273rVZ2tPIx+f1Kcj+kVZFjlGN08j5EOiqhI9mw3IpQW5upOuVqvUZRQxSh4kxiWdtexXDvsmmaQ9dJAHyXqz66zI9LXaEeyxtf+ttf7op4ap5RNd+wMDkBeyhpljFYf3H9v2bi17fWAc+SWKdoxw6foEP6+ca5rJcZESWvCJxL0D+uQKftL67IA+qQKTTHFAd1RYks4xN6iCknw+/JlYQUkixlZYkqguCUlS//0T0SUhSVRVRtvuCEkSM28BCDXvUoJT5GPX9CRNs9UfwwXWSi//JZqbFpL5aSGZnxaS+el5SP4BTR7r3k81pagAAAAASUVORK5CYII=" alt="1547390538540"></td><td>The value on the activation function on the layer <em>n</em> and position <em>j</em>. Activation on the last layer is the output on the neural network:  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAwCAIAAABVDSmEAAAABnRSTlMA/wD/AP83WBt9AAADQElEQVR4nO2bMbbiIBRAH3NmKYmFxxU8VqDT/Gra6Uipzd8HKX+6aaeyGViBrMBjIewlU2A0JkQjPxL/hFtiPMEbeDwekZRlCZHn823sDkyFKDoQUXQgouhARNGBiKIDEUUHIooGACPzjNJc3r4opzTLpfG9STl1NEdALnTPaxGZ8LnNxEVby3XJWgvOEKtxiIzrO9/ox7RFCwZwNUA1R4DzANecATSu8FU9ZdGaY9NiU6IVP4TpCYt2eG4hGEBbqo/pCWcd+qAA5+mtS+S2AMCfP5Lr5mS2AHXQD91twqLvYXK6KpCJ3Tpxfbw/PpTpfUK0zCghhNDcO7UcFXPcAyxmTokAJqfpRjGx+1gOcztf0TKjq0IBAKhN+iVdJ7NF17CsLJdDWQZP0Sanq0Ih41prwRDUJs1ub6u+EH0td06GDh5dq+1ijay2ldKCOZKgl8eZddhfV88oNMdmhiGYIxW5w6OiNccryed20e7Pq9M2bdPmFjGP/iytnWEf4s7Qg8elhah1nGIxNAOUYB1zbFS0uK4NCcHRFd1ernonmA3OVmuj5GVjm7fny6O6S6/RpKtOnvxVsbfjy7Zgx2/3XnNE1vOBOPAIHaJd0nLWXkajKsHpZtOYPfSJ0W3TPvnOs3A6dbgPjI/oZq/7lMGC4YpsXVW4kPjsDJPZAuBSvjJ//yjk7419lJEZHaEOYo57aBfc5LaAx/dyw+LzdOpD2nEYJLg7O+lmuMXQsYB0NAbGL4++LH7NlP+8No8zWV0B+tQ28hriV72zwWO/zeiqYKJefUnWu93HejnWHLUdqyOzX4cFgjtwBIxvnmXSdI4AqijUtebxWb4xACi20oB9X2P79vt9Xn1qZE6tVyPzjJL0VOoNgedMuBv2xlvnL/vX6lUBwc8t4rSuBI9vn4jRtzs4fkLVg4Cd/O4xCWSWbhRy7T5LizjpG6PNKbiZnJJVgVx3HFlGOug7ovVBqSIlGwDoPhiuYTcO6qANJPGJQO8Rbb3Z1eT2wbDJKSGEpBsFAFCsUkII+X9OFL3pOaKT9a5cD3zltJj0CzS1+PZ8AmQ2r4fzEPa5tRBSxn/OBmHSoSMkUXQgouhARNGBiKID8Q+YYksmp31qhAAAAABJRU5ErkJggg==" alt="1547390776342"></td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAAjCAYAAAAqoHJFAAADI0lEQVRoge1ZsUvzUBD/+aFvaHHIIATEgA7iUBEERZztIggu4iA6+A8ImQwZxNk/QB3ioGAXwUEQOz+HKiIILWgLKaSIoIOD1BYSuG96xbZpmqS2fvbrDzLk3bvL/XL37i6kj4gI/wn+/LQDnUSPbLeiR7ZdcBwHBwcHiMfjeHt7C6x/dHSEjY0NZDKZcA5Qh2DbNi0tLZGu61QsFkPbMU2T5ufnKZFIBNbtCFlBdGdn51vsmaZJsizTzc1NIL2OkOWcUzQapdfX12+zaRgGTU9PB8qStpMVUV1eXnaVX11dkSRJxBijRCJBtm2TpmkEoLLmhjDRbXuBKhQKuL6+xurqap3s5OQEnHPkcjnIsox0Oo3t7W2sra2hVCpBlmXs7e3h8/OzTndkZAQzMzO4vLz070yocNXAMAwC4Bo9zjkxxjwjUCqVSFGUqn1irVFGEBGpquopr0XLkS2Xy9jd3QUAWJblGoVmuLu7g2VZ0DQNs7OzAICXlxd8fHxgamrKUzfIM1smq+s6IpEIJElylWezWQwMDGB0dLShjWw2C8YYFhcXK2vPz894f3/HxMREqy5W0BLZfD6P09NTHB4eYnBw0HXP+Pg4bNtGPp9vaCeTydS9kPPzczDGMDY21oqLVQhN1nEcbG1tYW5urpJ6T09PKBaLgeyUy2WcnZ0hHo9jaGioYjuXyyEWiyEWi3nqK4qCSCTi61mhyaZSKSSTSWia5rlveHgY0WgUpmm6yt3OpuM4eHh4gKIoYIxhZWUFt7e3VXriJTU701XwXcpcqqeYiMS92+DQrM9yzglAXT8VFX5yctK1kofps6HIGoZRRUwQatRifu0EZZomSZJUNec2I/trZ2NVVeuiJMi4pWPtnl/z1SPOl9fl5YRt27S/v08LCwuhUtowDFpfX6d0Oh1YlygAWRGZRudEVdWmZH8a/X6r9vHxMZLJJDjnnn3t8fHRfyvoMHz1WTH/+mny/zJ8kdV1HZZlNZxWCoUC7u/vAQAXFxehPgY6Aq8c/1plxVXbPsRA8XXP5uZmSxW3Xegj6v3+6Er0yHYremS7FT2y3Yq/4zbnNyZuKqgAAAAASUVORK5CYII=" alt="1547587796103"></td><td>Activation matrix on the layer (n). The size is the same as</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAcCAYAAAB2+A+pAAABkklEQVRIie2WMYvCQBSEJ8exhVsp2FoLFoKFrQE7IZD/YGkhBBsr/4aNCDY2QgR/hWCpjUUCNoKNhWiEXZgrjhwcMbI5BDnIwDb7kvdlJrxNLJLEG/TxDmgONpbWGuPxGKVSCZZlwbIsdLtd3G438ybMqCiKaNs2hRD0fZ8kGQQBi8UiXdc17pMJrJSi4zgUQnC9Xif2pZQ8nU5GvTJFPZvNsFqtMBwO0Ww2E3WlFMIwfG3UURSxUqk8dJWWxDMZgyeTCQFwNBpleqg0GUWttcZyuYQQAp1OJ1E/Ho+4XC5mEWeJOnYE4OlqNBq8Xq+vc7zZbHA4HOC6Lvj9en4tz/MAAI7joFAoGBk2Au/3ewBAvV5P1O73OxaLBQCgWq0aQY3BsR41jtOQUqLdbr8WvNvtUmu+7wMABoMByuXya8FpCsMQ0+kUUkr0er1M936aXFSr1RJ7Wmv0+32cz2fM5/NMbgGYjVP8EYjHRSlFz/NSDxQTGZ9cQRDQtu2fmW21Wtxut3+CkqRF5v9cOTgH/3PwF+DfR2VLzcqfAAAAAElFTkSuQmCC" alt="1547390298914"></td><td>Set of parameters of the model. In the example two matricies: <img src="data:image/png;base64,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" alt="1547390430000"></td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFUAAAAuCAIAAADWcsIPAAAABnRSTlMA/wD/AP83WBt9AAADwklEQVRoge1aPUvzUBS+ealXsS4RnMRABT+gDUIHcXBIBxdRUQi49yd0cXCov0FEUQiFInSs4uISHBIHxaWQgB9QIUVERRwkVppA3uFCCElzc5NaHZJn6/14znnuOTn3g1KWZYEY499fO/DHSPTHG4n+eCPRH28k+uONRH+88Rv6ZVkeHR0dHBy8vr7+BXPhYAWh3W4zDIMGr6+v+w0TRZHjuHK57GqXJImmaTQdQnh1dRVoMRQEQWBZtl6vR5serN+yLMMwVldXAQC1Ws2vF0LodaLZbNI0zbLs5eXl+fk5TdPpdPr19TWar35AS5/P53VdDzuXSL9lWaVSqWv0UHZ0tY3EF4tFu0vTNI7j+rEEKAYRmIn0I5FedoxVwzB4nq9Wq9723d1d72fSOzCRwIBIP4qkl1qSJABAP8REgyAIfh+pH4j0d9UZOeX6hwgpQLT/1et1AMDs7KyzsdVqybK8tLQ0NjbmGt9qtQqFAkVRrj1PlmWKoiiKGhkZeXt7wxuNQDI0NMTzvKIoiqKQ6AKAYP+zy7ur+KFk8yZ/u91eWVlRFAVljSsaaBZmH+2RxM8rP6QCF8g0zUajkcvlcrmcs11VVeBJChSEs7MzAMD39zfDMHd3d7quDw8PO8dsbm7ijUYmmZ6eBgA0Go1AXQjB+X9zc6NpGsMwTvOmaT48PEAIJycnMRp4ntd1XRRFu1FV1Xw+v7a2RuhfWJLx8XGapjVN+/r6IuEPjv/9/T0AYG5ujtBjJ7LZLADg9vYW/Xx8fKxUKvv7+65I/gKJHwLib5rmyckJhHB5eTkCuysbLy4uMpkMefB/kMQPAfFHH//AwEAmk4nA7szGl5eX7e3t09PTsHH7ERI/BMT/+fn58/NzZmYmnU4721Op1NTUVKfTaTabmOkTExOLi4uoeu3t7S0sLMzPz4d1MRTJ09PTx8eHq1phEKAfQ+f6LLsCLZNhGFtbW4eHh0dHR64BaDPf2NjohcSJsNUquP4hmKZ5cHDw/v6+s7ODWgqFAk3TgTtNNpvtdDqVSqVWq3lPSoQgJ1FVNVy1wh8P7JsvhLBarToPIYTnX3SA8Tvw4HvDDotw/iW9/2Lcwhy20BphHCK5sQSShGJzoSf9gSng92qAgMJVLBbxVvAkLra+3H9DWRUEoVwu+90anEAjMV0kJAj9ff8gsW2/f5VKJVRZIIShUtGJUCSiKKJXtgg38R/QbzvBcdzx8TGqlyzLKooSjcouuiQkkiT18v5JWcn/X+KMRH+8keiPNxL98UaiP96Iu/7/szOcW2SqxwgAAAAASUVORK5CYII=" alt="1547391042187"></td><td>Loss function on the one example.</td></tr><tr><td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAAjCAYAAAA0aUL2AAAD50lEQVRYhe1YMUgzWRD+/uNcgttsCnGrkFgFDChpLA3YCcHtTCm2FsZgkS6WdgGbVJJoYSyE2KWMYhEEIS4oMQoa0mSx2YCEDSbwXfHfhkR312y88/Dwg23emzcz38yb9+btL5LE/wx//NcO/Bv4IfVZdDod5HI5HB8ff0rP9fU1dnd30Wq1LOe/jNTOzg4CgQAODg4QDAY/pUuSJKiqikAggK2tLXQ6nWEBjoGLiwsCGPpSqZStfDKZpMfjYT6fd9Tb7XaZyWTo9Xr7etfX19luty3lK5UKZVlmLBYbGh+LFDlMzIlQJpMhAKbTaUd9hmEwEolQEAQWCgWS5OPjI71eLxVFsV1XKpUIgPF4vD82NinToCiKfH5+tpRpNpsE4OgU+TtD0WiUgiDw8vLy3biTDZJMpVIEwGKxSPIfyJSTw6axUqnkqGt/f98y43Zk3+Jt8MYmlUgkHLeeYRiUZZmyLDvqMQyDPp/PMhujkiLJSCRCAGw2mxzr9Ov1enh4eAAA25Ps7OwMmqZBURRHXUdHR2g0Gtje3sbU1NQ7O6qqYmJiAoFAwFHPysoKACCXy413pJvGRFHE0tKSpczd3R0AYHp62lHP6ekpBEHA8vLyu/lms4mXl5eRfDKDW6vV8OdIK97g6uoKjUYD4XAYoihaytRqNQCA3++31WMG5/X1FQsLC7ZyTnZMSJIEAKjX6+Nl6v7+HgAQjUYxOTlpKVOv14eMWcEMjqIo4O/6HvoSicSHdkzIsgwA0DTNPSlzywD29QSgf8s7kTKDMzc3Z7n+5OTkQztW68YipaoqBEHAzMyMrdzgdvgIVk6bWXSq20EMBtE1KbN4Q6EQQqGQrZxZS3ZNJwDc3t7azhUKBQCwPBWtoGla365rUqVSCbquw+fzOe5z89RzImWHp6cnZLNZiKKIjY2NkdaYpGRZdn/6mdFdXV11lJufnwcAnJ+f28rMzs6+G+v1etjc3ISu68jn8yNlCQBUVQXwd32O3EK4vOFJMhgM9m95K5j9YzgcZrvdZrfb/bBTsYPf76ckSTQMw12bNEoTO4h0Ok0AzGQyjjrNFgcAFxcXeXNz48YtlsvloU7dFalRmthB6LpOSZLo9/up67orR90gEonQ4/GwWq2SdEHK3HoAPnzsDaJSqdDj8YwcCLdIJpNDzw5yRFLdbpd7e3uusjSIYrFIj8fDWCxmW19uoes64/E4ATCbzQ7NOZIynwUAGAwGeXh4OLYT1WqVa2trlCSp/7IdF+VymbIsU1EUy7faL/Jrf2ZqmoZWq/Wpny+apqHT6dg2y19O6ivw8zPzu+CH1HfBD6nvgh9S3wV/Acpe75TyoElqAAAAAElFTkSuQmCC" alt="1547391083924"></td><td>Cost function on all examples in the one batch. (Very often show as C or E)</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F

<span class="token keyword">class</span> <span class="token class-name">Neural_Network</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputSize <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> outputSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> hiddenSize <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>Neural_Network<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># parameters</span>
        self<span class="token punctuation">.</span>inputSize <span class="token operator">=</span> inputSize
        self<span class="token punctuation">.</span>outputSize <span class="token operator">=</span> outputSize
        self<span class="token punctuation">.</span>hiddenSize <span class="token operator">=</span> hiddenSize
        
        <span class="token comment"># weights</span>
        <span class="token comment">#self.W1 = torch.randn(self.hiddenSize, self.inputSize) # 3 X 2 tensor</span>
        <span class="token comment">#self.W2 = torch.randn(self.outputSize, self.hiddenSize) # 1 X 3 tensor</span>
        self<span class="token punctuation">.</span>W1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>W2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="forward-function"><a href="#forward-function" aria-hidden="true" class="header-anchor">#</a> Forward Function</h3><p>To calculate the output we need to go from the input to the output with all calculations. For example, we define all activation as sigmoid functions, and our loss function as binary cross entropy (the loss function if we have binary output).</p><p>For example you have a function to predict that is:</p><p><img src="data:image/png;base64,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" alt="1547485837571"></p><p>This is a simple function with the binary output (like when you predict if on the image is dog or cat)</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">fun_to_predict</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token number">1.0</span> <span class="token keyword">if</span> <span class="token number">3</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0.0</span> <span class="token comment">#must be float</span>
</code></pre></div><p>To calculate the output you need to go through your defined neural network and calculate all the layers.</p><ol><li>calculate the first layer by multiply the input with the first layer weights.</li></ol><p><img src="data:image/png;base64,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" alt="1547586657031"></p><ol start="2"><li>Caclulate activation function on the weights.</li></ol><p><img src="data:image/png;base64,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" alt="1547586732170"></p><ol start="3"><li>Calulate the second layer by multiplying the output on the first layer with weights on the second layer.</li></ol><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANAAAAAoCAYAAACPZXQAAAAFZElEQVR4nO2cvVLrOhSFV+6cRyEUDE8gPwHcnpZOKUlzO8rTpZFL0tGe6jTIT4CfgKFAfpd9C9mJcSTbsoyxw/5mUmTiv720l362DCsiIjAMM4h/vvsBGGbJsIEYJgI2EMNEwAZimAjYQAwTwTcZqECWbpAkKbKQs9IEySZFVnzZgy2McB3PQ8MZ5Q9NjiElQEJpMoNOVySEIKnHfq6lEaHjojWcV/5MbKAqeFfohoxWJIUgAOVHkHQdaxQJCHJe5kfg0/HcNWzLn/phmmTbcSPGPq2BtCRAksv8RtlGP/YshpS0SeDqLYwSBKGG9UJLx6Pj2WvYkj9ERGQ0KXnsPNqMNlbsExrI9h7wjJ3OgIwiAc85i+xBx8Cv43lr2J4/dmomSWlTGq1jpBop9ukMVDZk0NyzVYiew/m5EarjuWgYEncfA40U+7AqXLbBarXq/mxqNRLzjhwCV+uA2/zdAxC4+/fC8esFLq+B/N0MCuEryNKkoUGC9KTiUyBN7O+bZgmpSJE0NEyaFwjUcUkaFpV+J8JgUP60M07sgwxkGwUQSsPYUezwMUqUR0nop5vBD1akCW73AlK/4sHV9hVvH5hLRfbm4RVaVt8ElHE8e7bDNvdc4OIBz8cLQCiN59bg21mWhhl2lTBTPk/kvQYYqMDHGwCh8Pxwg0/tUqS4L0WQ+gl1+xQfbwCucdkjH4o0wXqbQ+pXRHjwW1hflR2IuMNpp18g/b1vPf9ifQUBuPVFfx2XpmG2ucVeCAjP7yH5MyUDDGTwnguo54dG42bYrLfIAQhlThrt4vIawBs+Oux+bHhaRMM3sXF6KF7wJxcQviwBULz8QQ6XvvXrt+u4OA2LFL/3Aur5ET71+ubP1Aww0A2e6HRKkG1usQfKnnNYNzGo4a8vnYk2R7LdFrl8xKPXY+U0Rj62T7lamE7DDBvXGi2YAum91eUQc/6OyVZlkfkzyqs8dq4NoKXnxPoKAjm8a7Zy+ncyehUpkiR1zFMz/N0DYrxV5ddS9bL/+bPadkIda8c2HSfVcI2rlpG0N9kO27xdF3u7jvypYad7tkDgt/dI+RNVwyM67jN0lhjb6vjlb/B8xtrDKMub4Z+A+1R6NPZjtDzGoV2bm+V53WVVn44TaFjttZjj/exlDWkpSMjQ12s0yU8x2+/uzdKOfaDW+B3Xm8c+UBVwW2D1wzt2kgOY7S66y0CNxnIZSMtT03kZScdBGpa7/UJqUhIkpLTGl4p0YGPYNyfqcVQm8CT2DPMnykBVIvR/kJE27ua8g+4wUH30OXyvP3/wJvMIOkZqWL02BAi7+z/o/s0YOgw0w/wZbqDDdCj0Qeb1Nu3oNA3kaKzPBiqTJrg3/J63sU31oqZUpCRIKvvyqtQm6DmsBs3R5DgN8z/bvPJnmIF6r3u8FyCtJAmhgoZjo8SgqcK0lNPa0hDN0YeoYSAtB3RCFeE6RmlYf9+MbByHNZCS/ddAPdaiXevpueTPAAPVFmuzHQY8TFFEqBvIM1U4GqhrYTxnhk6n2kdcZ4FlxvwKrdplm3X5Koqr3Jphs7oF5rqBd/MEoqfJbvey2yKXGq++jYaXHba5hH6do1hdGLznAO7CzirSe1u2Np7tjpK3jwK4WcAOX5DdOtY9p1WVn0itMunR6VB86VW2Pic+T2+dR8hl6dLfQLV1jys4U5lrjqXlSeme4h4N9LM6m0Pc3r/psQWKJeVRTwN1bNJ1bdj9KLorSUub58dzmj+nnXB95C6PCd6YnZ4VEf9vbIYZCv9fOIaJgA3EMBGwgRgmAjYQw0TABmKYCNhADBMBG4hhImADMUwEbCCGiYANxDARsIEYJoL/AcboBoss8ru2AAAAAElFTkSuQmCC" alt="1547586904341"></p><ol start="3"><li>Calculate the output by activation function in the previous output.</li></ol><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN0AAAAsCAYAAADhCr2mAAAIXklEQVR4nO2dP2zaWhTGP57ewFZGtjKQCj1loBu6DKUb0CVTS6ekixnD8qQOlbo8qZU6xEwRLFGmVJ3oULsbXYB2okPUVLGlZiOd0o1s5w32NRD8FxubpvcnIVWKuff4+nz3nnvONU0REUEgEMTGX0kbIBD8aQjRCQQxI0QnEMSMEJ1AEDNCdAJBzAjRCQQxI0QnEMTMhohOh9puolxuQw3yrXYZ5WYbqr42wwQRcX19vYZW1+c367HXhBJHI5mBmKyQttLXZWKMkaREbZcgCq6urqjValGhUIi45fX5zXg8pmw2S0dHR2GNtCVh0fGBsxs2jTRFJokxAmB+GEl212oyMTCybUaQGAcHB5TJZKhUKtHZ2VmELbv5zfxlCklu17n4zdHREWUyGSoWizQej8ObPEeyolMkAiSyW6Q02RDbbCbTSJYM8dnNTprMCExebdYTRM7h4SEBoFarFX3jLn5DRESaQrI0m6zdxOnmN5PJhEqlEmUymUiFl6DojNkKDnGh7WBoMjE4fOd3We0UybiH38HWFRmPxwSACoUCTafTiFt39xsjbJRIVjRTnB4rooffjMdjSqfTVCwWI7uX5ERnCijQXsx1EH2GHEliCW4WLm+yuTO0hZUDYMQk571UpVIhAKSq6hpMCeA3fkTnw29arRYBoIODg8Dm2rFW0fEQ0XZWUqTATqdI7o6qSC4zYNLwVZpJJGsaaZYAXcKkjcBcWSCRYo67psjWan1zuM/OzggAVatV76ZNUXh+5jsJ4je+ROftN9PplNLpNOVyOR+derPGkoGKN62h8c/Tc4TN6uvtMupdBkkZYD/vcmEEfUWO3kZ5qwVICrRBB/v5PPK1DgaaAol1UU81A6W8Y0X/gHdDANIOaua452v7GCgSgCG6vUXL3759CwB48uSJZ9NqrwsAYLICzVgArI8mM/MqCUqnFtHNuODiN+l0GtVqFRcXF/j8+XPortYmOrVZR5cxMIe/6+enALZxz01A/Np2GVutISRlgDjGP1p0tHffYVvRMOjUsHC7+Ro6Aw2KfIr/2hs3VRjk72EbALq9xYmh9i9kBrB/thYuPz4+BgBUKhWPhnWcnwJgMo73b4yL3sauOWFLSgfzjzyI30TJgwcPAADv378P31gk6+VNrM2pQhJgnx3yGSbwENVP1KhIDn0JwsHDQI+HMBqNrASKj0ZJsn3+ps84hYXrCi89/ObHjx8EIJIQcw0rnY72bgtD6cUsDBx+g7ZKS9YKR/5XuO17iHkSvP3UOlAkAN06yi4r8qdPnwAA1WrVT6Po0PJWQW3W0QXMFTDGJ+nhN7lcDtlsFhcXF/j+/XuorqIXnfoGrSGD/K+HSrb+AcMQ35zUaIYYTNYWBae3US63beJvFb3ucriTKLqKZjmFVCqFVKqMJX9Vm+bfUkht7L5Oh9o09tOMAcPWFpoOhv78+RMAcOfOndV6apdRNxQH+XjfXgRefjPf3vkpAGD4TXPZ5/v3m2w2CwC4vLz07tyN0GvlAkZoMFvOeahgl6Fzq7fwjJmPbJb1lRXqdH6zZ0sfP/0oJDEz48f7sQlhXDO8sdu8ZJxVF9X4PblkXBuNBgFY7fgU78tzK+FRp3P1HRu7A/gNL4WEPR4WqegMB5q/MT4ADjfldbIgaN8bu59zdtYge9ZYsUoci2M6Oym0PNLcKU9OTgJ2NtvH+Zp8EvKbnZ2dSOp10YnOfEiLD8NDdFEVtH+D0yiKwxG2zUz+uDw3BzESEeVyOQJA/X4/UG98bPyPQzJ+s7e3RwDo+fPnobqNTHTGwN2cfWZLvfME9me8ZWC7QqxyKicO3LKVVhi4vNJw0Y1Go+B9BZ404/cbLrq9vb1VerSIJpGiNs0NcBd1KzGQQiq1BV4fdyaP/YGGF+hhd5X3ot4AL443v36Xv7cNwNjUc/QP7zBkMrxyTnFjFa3tkgu8bodTnN/ITmQyGQAB3kXT2ygbjuN96GHZkMT85u7du8G/NE8oyRKRtZo5hAZOYdVGkERSgo/TqiHx2m32iE5cVrpgiYa5hMdGOscy1WqVANDh4WGodv4OJ1lAb+8aJQLNIcVrcnquwzpHtCnUOiDqxNNX/hEesxaGZs1Se9PCUFIwCDoksdnMYLfQ6R/eYQgYx8Ju/C2XywEAfv365dm62uRRkN0xLxXNVB0IUp+NAb6C89LBqoQML83zlewxHm2YnjaPPIwI8xS9Zhn1bkxnCgPD7bSrhfHztPZ1WO6MnqKztiMMstZZEq/e/g9dSNjZsOHh9bmwogsVXlpZJ8d3m4w3dxEoM3V7sWpymxpuc+ZDSP7QNMXKaDrZzl9cdU00zNXj7LKPmktNM0mm0yllMhkCQJPJJFRbK4puuQC5PIBztRd+jcs7WH8EPs8wbgSacuOnMkBMkmcitGEymRAAymQyTo26H3rwOgCRIP1+nwBQqVQK3dYG/DDRn4J7wum2wJMpUf+uSNK8fPkyksI40VrfpxPMYyQOXM4U3hL4e3S9Xi9hS6KFv9LTaDTCNxbBJCCwQZOZGXJ7ncq5XfAQM8rfFEka/psvlUolkvaE6NaElWSCe/LhNsJ/U+TVq1dJmxIJPGQOerzNCSG6tTCXMGCSa/LhNnJ1dUXZbJbS6XToTF/SnJycEABqNBqRtZkiEv/9sSB6vn79iocPHyKXy+Hk5ASFQiFpkwLz8eNHPH36FIVCAf1+H+l0OpJ2RSJFsBaKxSJUVcX19TXu37+P169fJ22Sby4vL/Hs2TPUajXs7OxAVdXIBAcAoY+BCQROlEoljMdj9Ho9fPnyJWlzfMOPe41GI5RKpcjbF+GlQBAzIrwUCGJGiE4giBkhOoEgZoToBIKYEaITCGLmf5K08kl+ftmhAAAAAElFTkSuQmCC" alt="1547586933870"></p><ol start="4"><li>Calculate the cost and lost function.</li></ol><p><img src="data:image/png;base64,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" alt="1547587606618"></p><p><img src="data:image/png;base64,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" alt="1547587697072"></p><div class="warning custom-block"><p class="custom-block-title">What’s the difference between cost and loss function?</p><p>Usually, they are used interchangeably. But in this case, I thought a cost function as an error on the whole data set as a scalar, but loss function as a single function on one example.</p><p><a href="https://www.coursera.org/learn/neural-networks-deep-learning/lecture/yWaRd/logistic-regression-cost-function" target="_blank" title="https://www.coursera.org/learn/neural-networks-deep-learning/lecture/yWaRd/logistic-regression-cost-function" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><a href="https://stats.stackexchange.com/questions/179026/objective-function-cost-function-loss-function-are-they-the-same-thing" target="_blank" title="https://stats.stackexchange.com/questions/179026/objective-function-cost-function-loss-function-are-they-the-same-thing" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>stackoverflow</span></a></p></div><p>Below you can find the example of calculating the output of the 2 layers neural network defined before. You can change values and play with weights on the network.</p><div class="deepnn"><div class="mw"><div class="mx-row"><input title="0.5" size="mini" value="0.5" class="mb"><input title="0.5" size="mini" value="0.5" class="mb"></div><div class="mx-row"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"></div><div class="mx-row"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"></div></div><div class="mx"><div class="mx-row"><input title="0.1" size="mini" value="0.1" class="mb"><input title="0.2" size="mini" value="0.2" class="mb"><input title="0.3" size="mini" value="0.3" class="mb"><input title="0.4" size="mini" value="0.4" class="mb"></div><div class="mx-row"><input title="0.5" size="mini" value="0.5" class="mb"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"><input title="0.8" size="mini" value="0.8" class="mb"></div></div><div class="mz1"><div class="mx-row"><input readonly="readonly" title="0.3" size="mini" value="0.3" class="mb"><input readonly="readonly" title="0.4" size="mini" value="0.4" class="mb"><input readonly="readonly" title="0.5" size="mini" value="0.5" class="mb"><input readonly="readonly" title="0.6000000000000001" size="mini" value="0.6000000000000001" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.41" size="mini" value="0.41" class="mb"><input readonly="readonly" title="0.54" size="mini" value="0.54" class="mb"><input readonly="readonly" title="0.6699999999999999" size="mini" value="0.6699999999999999" class="mb"><input readonly="readonly" title="0.7999999999999999" size="mini" value="0.7999999999999999" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.41" size="mini" value="0.41" class="mb"><input readonly="readonly" title="0.54" size="mini" value="0.54" class="mb"><input readonly="readonly" title="0.6699999999999999" size="mini" value="0.6699999999999999" class="mb"><input readonly="readonly" title="0.7999999999999999" size="mini" value="0.7999999999999999" class="mb"></div></div><div class="mw2"><div class="mx-row"><input size="mini" title="0.1" value="0.1" class="mb"><input size="mini" title="0.2" value="0.2" class="mb"><input size="mini" title="0.3" value="0.3" class="mb"></div></div><div class="ma1"><div class="mx-row"><input readonly="readonly" size="mini" title="0.574442516811659" value="0.574442516811659" class="mb"><input readonly="readonly" size="mini" title="0.598687660112452" value="0.598687660112452" class="mb"><input readonly="readonly" size="mini" title="0.6224593312018546" value="0.6224593312018546" class="mb"><input readonly="readonly" size="mini" title="0.6456563062257954" value="0.6456563062257954" class="mb"></div><div class="mx-row"><input readonly="readonly" size="mini" title="0.6010878788483698" value="0.6010878788483698" class="mb"><input readonly="readonly" size="mini" title="0.6318124177361016" value="0.6318124177361016" class="mb"><input readonly="readonly" size="mini" title="0.6615031592029523" value="0.6615031592029523" class="mb"><input readonly="readonly" size="mini" title="0.6899744811276125" value="0.6899744811276125" class="mb"></div><div class="mx-row"><input readonly="readonly" size="mini" title="0.6010878788483698" value="0.6010878788483698" class="mb"><input readonly="readonly" size="mini" title="0.6318124177361016" value="0.6318124177361016" class="mb"><input readonly="readonly" size="mini" title="0.6615031592029523" value="0.6615031592029523" class="mb"><input readonly="readonly" size="mini" title="0.6899744811276125" value="0.6899744811276125" class="mb"></div></div><div class="mz2"><div class="mx-row"><input readonly="readonly" size="mini" title="0.3579881911053508" value="0.3579881911053508" class="mb"><input readonly="readonly" size="mini" title="0.375774974879296" value="0.375774974879296" class="mb"><input readonly="readonly" size="mini" title="0.3929975127216616" value="0.3929975127216616" class="mb"><input readonly="readonly" size="mini" title="0.40955287118638584" value="0.40955287118638584" class="mb"></div></div><div class="ma2"><div class="mx-row"><input readonly="readonly" size="mini" title="0.5885533447669059" value="0.5885533447669059" class="mb"><input readonly="readonly" size="mini" title="0.592853675444023" value="0.592853675444023" class="mb"><input readonly="readonly" size="mini" title="0.5970040807235782" value="0.5970040807235782" class="mb"><input readonly="readonly" size="mini" title="0.6009806609022761" value="0.6009806609022761" class="mb"></div></div><div class="my"><div class="mx-row"><input readonly="readonly" size="mini" title="0" value="0" class="mb"><input readonly="readonly" size="mini" title="0" value="0" class="mb"><input readonly="readonly" size="mini" title="1" value="1" class="mb"><input readonly="readonly" size="mini" title="1" value="1" class="mb"></div></div><div class="ml"><div class="mx-row"><input readonly="readonly" size="mini" title="0.8880759021818458" value="0.8880759021818458" class="mb"><input readonly="readonly" size="mini" title="0.8985826383577421" value="0.8985826383577421" class="mb"><input readonly="readonly" size="mini" title="0.5158313302300179" value="0.5158313302300179" class="mb"><input readonly="readonly" size="mini" title="0.5091925231638667" value="0.5091925231638667" class="mb"></div></div><input readonly="readonly" size="mini" title="0.7029205984833681" value="0.7029205984833681" class="mj mb"><img src="/deepnn/deepn.png" alt="Deepn Network" width="780" height="475" class="image"></div><div class="language-python extra-class"><pre class="language-python"><code>    <span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> torch<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>        
      
    <span class="token keyword">def</span> <span class="token function">loss_function</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>yhat<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token operator">-</span>y <span class="token operator">*</span> torch<span class="token punctuation">.</span>log<span class="token punctuation">(</span>yhat<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token operator">*</span> torch<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>yhat<span class="token punctuation">)</span><span class="token punctuation">;</span>
   
    <span class="token keyword">def</span> <span class="token function">loss</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> yhat<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Binary classification logistic loss </span>
        <span class="token keyword">return</span> torch<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>self<span class="token punctuation">.</span>loss_function<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># m - number of examples</span>
        <span class="token comment"># (3 X 2) * (2 x m) = (3 x m)  </span>
        self<span class="token punctuation">.</span>z1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>self<span class="token punctuation">.</span>W1 <span class="token punctuation">,</span> X<span class="token punctuation">)</span> 
        <span class="token comment"># (3 X m) activation function</span>
        self<span class="token punctuation">.</span>a1 <span class="token operator">=</span> self<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>z1<span class="token punctuation">)</span> 
        <span class="token comment"># (1 x 3) * (3 x m) = (1 x m)</span>
        self<span class="token punctuation">.</span>z2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>self<span class="token punctuation">.</span>W2<span class="token punctuation">,</span> self<span class="token punctuation">.</span>a1<span class="token punctuation">)</span> 
        <span class="token comment"># (1 x m) final activation function</span>
        yhat <span class="token operator">=</span> self<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>z2<span class="token punctuation">)</span> 
        <span class="token keyword">return</span> yhat    
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Neural_Network</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>Neural_Network<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># parameters</span>
        self<span class="token punctuation" data-v-54601d22>.</span>inputSize <span class="token operator" data-v-54601d22>=</span> inputSize
        self<span class="token punctuation" data-v-54601d22>.</span>outputSize <span class="token operator" data-v-54601d22>=</span> outputSize
        self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize <span class="token operator" data-v-54601d22>=</span> hiddenSize
        
        <span class="token comment" data-v-54601d22># weights</span>
        <span class="token comment" data-v-54601d22>#self.W1 = torch.randn(self.hiddenSize, self.inputSize) # 3 X 2 tensor</span>
        <span class="token comment" data-v-54601d22>#self.W2 = torch.randn(self.outputSize, self.hiddenSize) # 1 X 3 tensor</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.3</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>/</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>+</span> torch<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>        
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_function</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>-</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
   
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># Binary classification logistic loss </span>
        <span class="token comment" data-v-54601d22># Special case of cross entropy </span>
        <span class="token comment" data-v-54601d22># (http://wiki.fast.ai/index.php/Log_Loss)</span>
        <span class="token comment" data-v-54601d22># nn.BCELoss()</span>
        <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># m - number of examples</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X 2) * (2 x m) = (3 x m)  &quot;.dot&quot; does not broadcast in PyTorch</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>a1 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X m) activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>z2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x 3) * (3 x m) = (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z2'</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span>
        
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m) final activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A2'</span><span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>return</span> yhat    
    
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

NN <span class="token operator" data-v-54601d22>=</span> Neural_Network<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.4</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.7</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.8</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'X:'</span><span class="token punctuation" data-v-54601d22>,</span>X<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Y:'</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span>

Yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#or NN(X)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'L:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'J:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h3 id="gradient-descent"><a href="#gradient-descent" aria-hidden="true" class="header-anchor">#</a> Gradient Descent <a href="https://towardsdatascience.com/gradient-descent-algorithm-and-its-variants-10f652806a3" target="_blank" title="https://towardsdatascience.com/gradient-descent-algorithm-and-its-variants-10f652806a3" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>When you know how to calculate your result is time to update weights to get the best result in your neural network. For this you need to use Gradient Descent. This algorithm is use the fact that if you want find the minimimum of the cost function you can use derivative of the cost function to recognize the direction how to update weights and the value shows how much to update.</p><p>Let’s assume that you have only one weight (w), so the cost function J(θ) you can present in a 2D plot. (on the x axis weight, and on the y axis J(θ)).</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANkAAAAtCAYAAAAjvc55AAAFrklEQVR4nO2cMVLrPBDH//nmHQUoMjmBfAKgoaKlk8rQvI4yXRq7JB1tKhqsE5ATMBTPust+hazYSWTLluMxQ/Y3k4JYXmt3tStZqzAjIgLDMKPx39QdYJjfDgcZw4wMBxnDjAwHGcOMDAcZw4wMBxnDjAwHGcOMDAcZw4wMBxnDjAwHGcOMzIUFmYaazTBzH6Wn7hBzAVxYkN3ilQqkwv4lH26n7Q5zEVxYkAHAFW4WACAwv566L+OilZ2xk8xM3ZWL5gKDTON9AwAL3FxN3ZcxMfj3BQACj/e/WtEgNtkkmCrX/JnmsRNi/sGOvTl+90R2heUnYTl1NyanTKriEVPlmsubyYpv7ACIx3tcdn6/BAy0WsEuXG4m8/f5gsxoZCqpdu4SVU3PWpXfZZj67UDbtSIWrWtFA50pJMnsQB/d1HmjoZKa7rMEKtPQWYKkprPRCsleXs0WJoPaP0tBu7bJadtDGbbtkYYHO6jH72PxchtsVH9WoqC1tUVoadbHFlG2zhLMZte42+zsF5u72j0+/Xr6vA90DnJJAiCIlPLCflWkggBJORWUChAgKC3O8rQBdOhLkZa6yEqXXBIAgsxPm7trNd33MgAS5YOKVJKQORXkbAOSOVW2cx+ZN7bNpSCZO3misU9EOUmc6jlc7qkdZaU05dLpIan17h62iLG1r5+tY6+nz/syPMj2HUyp8HwvpayMODnl4DvuqyOgS+fv9871620Ho6A0T0kINwBs344HimsrhDiU1ToIXJA1D/Y4uQHdakHQNZ92tkWUrcN26O/b/gwMsi4K+jLMRLQOoOas57LtoR5turdl0Oo+iNDsXmt7/JA2XYIDJFJu6Hp5rbu/u9oi0tbODsGE0dXncQwLslZnBmYNH86BvT/dlqKthjtxSEFFkVMqy3vkkR6tWbtN9yr5hGf35kzslmb+iSw02CPlBmbog6VfJzraItLWwUDp6/NIBgVZl0H7M5aJRKH1+f5dpPYRQpCUtfW/p71X90GzjKftiZx2XdoDJV5u+/Ir4t27oy1ibR2yQ1+fxzKoTlZ8250b306dXj9jB2Ax5AFnpYDtrr8I7XSROeG1w2mrVt3LHUzfsS3zsYXtRnhL2bUVx0dTzAe2tg7hqf24IrRE06mxOLlorzGG7m3pR8gWcbZ2hw6a7dDX57EM2MJ3zvRdyrDaAD/q6FJrEbo6HdGtv/G67x3b4dxk4+Aqa33ewbkf7M3F9ii59eseXFLtU4/qZotIWwcPHfT1eTwDgsydATzGIFsDL+4U7k+hdQA5XXb4Lk5vNZmCOij8NOmuoZ6+sRCAf8Z02bWLY5szcdtMGQyUWLkAcD2Hz6smS7D6sldOZsdGutoi1tY+DDKVlTWyvj6PZ1Ax+vZBAgA279oWAY2GSta4eV2W2aNUwGiocxX2zoKxxcuaEW//phAANqt6YdQW2K+3wMPRGsine6be8fD2F/P6k3RWFUn32bXDkqrr8S+jkSUJ/L/aOdVzkNyrG7v8323xUYo0mcIab3h7tH+3F/nr8rvbIsrWjt03CuP0ecJ2fg+XQvr6PJqhL3W5rF4eXYGRiIiKtNrCrxX5pqO2XVwWUU92o/KUpKi9CAt/O8eh7tXLe5422KRPgbPL5klZQE0PjBvQM1pu1UaKQ/tYseEidGf9vM172prKonddH586PX0ew4yI/xc+E0arBKv5Cz6XvqWkhprdYSNSFJ9LPhN6xOUdEGZ6Y7IEd5sdFjf+dzWT2UO48oUDzAcHGRPE7gI2bVBorJ93aNsqv3Q4yJggduNhh+e1PthUMCaDSu6wgUBavIJjzA8HGRPm9hVFnkJ+rXBd+2nL9dMWeMxR0CeWvE5shDc+GGZkeCZjmJHhIGOYkeEgY5iR4SBjmJHhIGOYkeEgY5iR4SBjmJHhIGOYkeEgY5iR4SBjmJHhIGOYkfkf0+97iY4M+OIAAAAASUVORK5CYII=" alt="1548179188819"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAAtCAYAAAByBT9fAAADjElEQVR4nO2bsbKiMBSG/+zso6DFHZ8gPAF3m1tte7tYarPdlnY2oYRu261us+EJLk/AWBjeJVtAEBVUSMRrJt+MMw4hITk/OZxzRKKUUvA8Pd8ePQGPHbyQjuCFdAQvpCN4IR3BC+kIXkhH8EI6ghfSEbyQjuCFPKNEFi8RhgSEEJBlZnf4bFmNS0KEyxhZWdoZV1lDKsGZooBC/aFMKGnvAvdH8nr+VDFx55lLoTit7cTNr2VJSKEYrQzAtQG0UZiwc4m7IxvDTjdlfU2qTLW0IGTfZPRxpp5CymY3TjtfyamVXWn8jCzjd6xzgPI/WAVdZxTYW3oMTAJ9wezRcxiBoZAZtuscAMPvbhWfj3wH+eg5jMBIyDLeIAVA+S9EZ60SuxwAFpg/g8bBHAsAnR6kiTQJSBjjtLmMQxBCEMbtlgxL3YcQ9AW/sjISFoZGMhCyxL+/OQCKnz86JlHuUYwf/EDbiIM+IeJBLj3CGwOAHLvTLRklkIJV3zt2rBbjdLxEclS9GN7O73QAJfYFAFC8GPrz7+O76h2XYz0jWPedZvrMiRIolZiMYIUgegNDivSsJcNHfTDfSQDHN3WBPo/VxoLXGh0mCVbliz2xumD2cqQpkOJauiQUQ0d0ru3Q1Vew61Fw3Z9ys5x7tJCXw2a96ClzsrHIGxPzrjSrOkY5r9ZLeUsM3XaDPE3qM95exkJ2Xri5S58kh1SHHUkvWFJ7meaUZsfVIreFFOxE2N5BG0/wkB15tqiONitute26Bn2GV0uqeff3O15z5XWq76fFj3bbJewVTQyCnR7KGJsUsJZbTh7s1FFrx9RnLxRAjmJfIvt4RUo5ZAQAAeYLAHmdumxfkTIBdTnCwSFgNGd0+lEt6pQS8fsaOQAmkiuR2lfjeioQzKtME7stNikF/7Nq9Nb22G1DvBYcMrll9TNU3VJ8mP7IMnov6wd08xyQTxepHqMDtAturuXmT9eoY4ahLt2WzcyK5pLXv3rUk6FM3fvXn7txdmMOPKdJI4YZwFbR3OwZGayQfK7w+HR9IoIVPtWqu+3BhQv/hoBG11onLpp/gVqra+haq4XA42Z0ea+vFjsAI8fsHIcy3BSvejCLbyT4HXlEhERJCL5AsZnd9+Wr2QbFgkNIhZsylSsQpfwfXV3A70hH8EI6ghfSEbyQjuCFdAQvpCN4IR3BC+kIXkhH8EI6ghfSEf4Dd1cE1syEVzsAAAAASUVORK5CYII=" alt="1548137149402"></p><p><img src="data:image/png;base64,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" alt="1548137409720"></p><p>Where your whole function to calculate the final cost <strong>J(θ)</strong> is:</p><p><img src="data:image/png;base64,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" alt="1548137505581"></p><p>Your gradient will be a derivative cost function on your weight.</p><p><img src="data:image/png;base64,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" alt="1548137519406"></p><p><img src="/assets/img/1548138648303.18d18150.png" alt="1548138648303"></p><p>If your gradient is positive, this means that the plot is increasing, so we have to subtract the value of the gradient (go to the left). If your gradient is negative, this means that you need to add the value to your weight (go to the right).</p><p>In your final neural network, you have more dimensions, and it is impossible to show it on the single plot.</p><h3 id="backpropagation"><a href="#backpropagation" aria-hidden="true" class="header-anchor">#</a> Backpropagation</h3><p>When you know how to update weights, it is time to calculate the gradient for your neural network. You need to find the gradient on your weight, but the problem might be your equation that is little more complicated.</p><p>Let’s look how you calculate your final cost.</p><p><img src="data:image/png;base64,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ynxjfLMV+3qQ3GZ5SicrAEaariKbNlc4BopTWaj1Abe62dEDaMin0rC5oCSR55599lkAwIULFwJOiXtmZmYAAM8991zAKSEiok6dPHkSGxsbOHbsWNBJccXZs2exvLyMiYkJxOPxoJMTeoODgzhx4gSWl5ehKErQyfGAjtvGau+QZJQqZTh9ucfi4iLOnTuHoaEh5PN511NYr09chcCTwtOdEHW1N/sQtmvo818u49t/mg46GT1tY2MDjz32GO7fv49bt25teeVZFC0vL2P//v3o7+/H9evXbfcS+3YuhvA6JIocH64j1k/hcODAASwuLuLKlSs4ePBg0Mnp2OrqKp544gnEYjHcvXvX0QhmmM7FY68O4/QXX/N1n88//zwuXLiAEydO4OTJk76/rjSszp07h2PHjqG/vx9Xrlxx3MHjtCz9f884EVEPiMViOH36dNeMPhw7dgwbGxs4ffo0K2wioohTVRX9/f04evQoFhcXg05OR1ZXV/H8888DqB4P6yZnzp8/j1OnTkFRFBw4cKD9++d7wPPPP4+jR49idHS0o0C8EwzGiYg8cvjwYZw8eRILCwu1YDZqzM6E1157DadPn8bw8HDQSSIioh2Kx+O4du0aEokEDhw4gJdeeilSddS5c+fwxBNPYHV1FVeuXMHg4GDQSYqkEydO4O7duxgfH2dnBoAnn3wSt27dwuzsrG+PPDAYJyLy0Msvv4zZ2VksLCxg//79kRqBWFxcxP79+7GwsIBLly55/twUERH5J5FI4Nq1a5idncXVq1cjNTJ68eJFnDp1CtevX2cgvkOJRAL5fJ7BOICJiQkMDAz4us9dvu6NiKgHHTlyBIcPH8bZs2exsrKCoaGhoJNky40bN5DL5TAxMRF0UoiIyCNHjhzBkSNHgk6GI6qqBp0EIlcwGCci8kEsFovcyDKDcCIiIiLvcJo6ERERERERkc8YjBMRERERERH5jME4ERERERERkc/4zDgRERER+eKhB3fh818uB50MIjz0IMMgCh7PQiIiir5dceDNvqBTQRRtu7x/r+6lqX/o+T6IoubBDz+EY68OB50McsGDH37I0fcZjBN1IY48UFj4NvKQXvNnP0RERC779//svwSdBApIn/huXOCD+0Gngyi6dsUZCBARERERkSP/HxgTuqUH4LmFAAAAAElFTkSuQmCC" alt="1548183708290"></p><p>In backpropagation, you need to go back from right to left and on each step calculate derivative to update the previous layer.   For this you use the <strong>chain rule</strong>: <a href="https://en.wikipedia.org/wiki/Chain_rule" target="_blank" title="https://en.wikipedia.org/wiki/Chain_rule" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><p>In the <strong>chain rule</strong>, you can calculate the partial derivative of the composition of two or more functions.</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhIAAACACAYAAABeDIDeAAAcB0lEQVR4nO3dO2zbWLoH8L8vbqFS3Wqq1QJ2oA0CrNM5VONuHadYTePxVM40lKeKphggCxjwFgFcpDDV3MRqMq6yk8aeIuR22SbydElh2IFJwO6creSt5O67BUW9rAffOpL+P8DATCSRPOfw8fE8F0REQERERBTC/0z6AIiIiGh6MZAgIiKi0BhIEBERUWgMJIiIiCg0BhJEREQUGgMJIiIiCo2BBBEREYXGQIKIiIhCYyBBU+H29ha///57pG1E/T2l4+bmJvRvb29vYzyS6RMl71Qz72U5TRhIkNK+fv2Kf/zjH/jmm2/w66+/ht7Ozc0NfvzxRzx8+BC//PJLjEdIcfn8+TO+/fZbfP/996F+f3Nzg2+++QY//fQTvn79GvPRqS1q3qlmnstyGjGQIGVdXV3h0aNH+PXXX2FZFvb390NvK5vN4tOnT9ja2sJPP/2EH374IcYjpX6OVUaxuICFhdZfsQpnxPd//PFHPHr0CH/5y1/w9u3bUPv0yvjq6gp/+tOfpjZgnETe+TuuKsrFBRSro45mzDaqRSwUy6hao7cxK2U5N4RIQY1GQwqFguTzeWk0GrFu27IsASDPnz+PdbvkMnUIoIthi4jY7v/r5tDvVyoVyWQycnJyEtsx7O/vCwCxLCu2baZBhby7yxZDgwCaGKYdfWumIboGgWaIn61Na1nOEwYSpKTV1VXJZDLy6dOnRLa/t7cnAOTNmzeJbH9e2YYmAEQz/D1wkiyHUqkkmUxGzs/PY992ElTKuw5TdPh/6PvnBSe6DA+TOqatLOcNAwlSzqdPnwSAPH36NLF9NJtNyWazsry8nNg+5k/roePz4dBsNiWTycja2loiR3N9fS2ZTEZKpVIi24+XWnnnCvawD85/kDJdZTl/2EeClHNwcAAA+O677xLbRyaTQalUwufPnzmaIy7WMWoAoN3Hko+vv379Gre3t4mVcy6Xw+rqKo6Pj/H58+dE9hEbxfLOPaaXqNQBzfgZjxPZwWP8bGhAvYKX1uhvTlVZziEGEqpyLJTbHa6KuNO/ySp3OmMtlDHmOpwgB1a1jOJCp/NYsViGZVkoF++m6+bmBr/88guy2SxWV1dHbLbayZ9itTf9XXlXHpEx3k24Wq2GTh15HFSPa+5/PriHRR+/ODg4aAd0SfHK+PDwMLF9RKdi3jmovqgB0LHzzM8RhbP4bAc6gNqL0R1KgWkpyzk16SoRGsQUXdPFtEXE1AVDqv+8NtVRnbF6N9vaVuA/TXw22/YfYbuTlt7upNXqQDakGvfk5EQAyOrq6ojNGqK18uNuu7JXRTy+Svb6+loASKFQCJO45Iwtp7DlkYxOed79G3ZqXl5eCgBZWVkZvmHbdDvlDUtzTz4NLmtvP/l8PmzyEpVY3t1hi2noonVtX9N0MU1TdG1A3tqG+91x9xbb6JSRZvSWQVf5jdqMmwfjz2nVy3KeMZBQ3vC2U+8h6jeOSJcXRAw4vhHB0dHRkQDw3xbac8Nr7TNAxzAAks1mfX47He0ba18Pee+h47czXrqBY1fPfh+//fDhgwAY0cYfXzANQDKZjN+EtHY/zXk3fPt+A3pfHT9jCuiDdDINVZaUOAYSU8C74PvvlaaeRG/qmHg34kE3+NZng24c3lCv7e1tnzvqBA+GoQXOj3w+LwBiH2IanpuegWUNiKZm1ChBe/e/ffs2QIfaaMF0LpcTAHJ9fe1jX5OQZN6FC+iH3XOG7yZCQD/qXtFH/bKcT+wjMQWW7msAgNOLrlZEp4oXNUDfeearTTVdXvsqoJfudtNyLk4BAA/u3T1yb4rfP/zhDz73tYh7DwDUK6i8ewDzY7j8UGdq4UU8+yg46Mo2p1rEeg2AbuLjQTLd3iLzOgv6bOO/uroCAPzxj3/08e3HKOkAUMNxX58X+6wOaAZ+HpEtmUwGANSdITHJvGt1mIRuYtipo2086duvA/cS1XDfT89PAFh8gg0NwOkFqtUtVGDA9nstLt2HBve34/pJKF+Wc4qBxBRYvPcAAFA/s9v/5rx/h/qYG+jk2DirA4COu3GEg/fv6hh2k/JuFP/5z398780LtPSdg9C9y739qsapFrHkdp2HrWoQgU5wqPl88nj5/d///tfX96cvmPYvubwLH9AHF09AT9OJgcQ06I/YnSq2KoBxGPBi7RnpEeRvwKiRUZwLuC80A4ayOe/hxhEbeDLg4HO5HIAANQROFVuVOgCg1v+66oP3duftVylWuRNEKH5jtt3I0fdDKWg5RwmmvbfXfD7va19pSy7vwgf0YcQR0I+jelnOKwYS08CrNqyfwQZgvaygru8g8KisxwcQt19MwL+PwfZln6E+5CPrZcX9bEg1rneD8FV16VgoL1XwwDShA76qRrt5N2Ilb0pOFUW3PSP8211agSMsuKMXBz2wBvPy3AvkxgoZTN/e3uL29haZTAbZbNbfvoDZyLsIAX1gEQN6P0KXJSWOgcRUaFUb4hTH5SLWazpMhau52zf9Pk61iBen7ifDqnELhQKAETdJq4yFstUKItZR000cPG61odff4X2Am/iXL1969qkMp4riUgV1aDDsCG93aQWOox5YQwSueQoZTHvnUeBgcRbyLnRA791v6uiqABouYkDfPs4xfURClyUljoHElHCrDeuo1erQzeSqDmOxeA/ufajzYHeqZbzEIQ433P8fVo2by+WwtraGq6urgTNOOhenQG0dC0vrqHX1G/Dy5917B4CD6oDJrvr99ttvAICtra3gaUyMe1N2g4jeh5JVXnCDKMU479/5ehB0y+fzWF5exufPn33WSoQLpo+PjwEAa2trPo8sXYnmXYSAfmCflG4xBvR++4ioXpZzLcERIRSnAEOklNAzUU1n/Lq3uuGoVHhzSQxanbMzDLJ/aJnZHuYGTfc1Hj+Xy0kul5NmsxkkZQnqHu/f90mr/FUs/sBDBVtevXolAGRvb8/X99tzRgTY18rKigBQdrGnZPPOGzbbmZ/CNnTRDXv8sNkxE1J1l0X3MM/eOSFsMQZNdtV/lD4npFK9LOcZA4mpEHyipUkxdU00Y9jdyf94ee8hn9T8Dt5YfJWWEu+5OU/BjJauYJMpdQu8cFrAYPr8/DzgxE1pSyHvQgf0oxfsii+g93dPUL8s5xsDiSngN2KftHFvOUFm4jw5OUlstb/Ly0vJZrOysrKiUG3ElPLeXEOuEPnmzRsBILu7u+N2FCiYbjabsrKyItlsNrGl6CNLMO9iCehHTBwXFz/3hKkoyznHQEJBtqF1VQ1ORxAhMi7gCbZMsoiIZVntWoO4HviXl5eyvLwshUJBodksp1gMTW67u7sCQCzLGrGbYNfB8+fPJZPJjNzmxCWUd/EF9GosIz4VZTnnGEgoqHchn7vt5crqujF23xjsdvVq8IDo6OhICoWC5PP5SDeSRqPRviFtbm7K5eVl6G1RR1y1Zbu7u+2yub6+Dh1Mn5ycyMrKiuRyOeUfPEnlXbwBfbDpu/0bH6RMU1nOOwYSyrF72hjNKaiJ6GabhuhaX1u/polumJFuRJZlyf7+fujfN5tNqVQqDCBiZMfcAfj6+loqlYqsra2FCqabzaYUCgV59eqV8k1WSeZd/AF9VzAXww3JNltNOtrwIGKaypIYSBBRYJ3RAHoibW7THUyPlnTeuZII6N1tRhw5ZOpuJ8zZKtS5tyAiEss4UiIiIpo7nJCKiIiIQmMgQURERKExkCAiIqLQGEgQERFRaAwkiIiIKDQGEkRERBQaAwkiIiIKjYEEERERhcZAgoiIiEJjIEFEREShMZAgIiKi0BhIEBERUWgMJIiIiCg0BhJEREQUGgMJIiIiCo2BBBEREYXGQIKIiIhCYyBBREREoTGQICIiotAYSBAREVFoDCSIiIgoNAYSREREFBoDCSIiIgqNgQQRERGFxkCCiIiIQmMgQURERKExkCAiIqLQGEgQERFRaAwkiIiIKLT4AwnHQrlYxMLCgvtXLKPqxL6XyZuFdM5CGoiIaKJiDSScahELW8coHX6EiEBsE3q9hspScaYeULOQzllIAxERTd6CiEgsW3KqKC6dYUcO8Lj7360yFtZrgG5CDh4P+/X0mIV0zkIaiIhICfHVSCw+w8f+BxMAPC5BB4DTC8zEi+4spHMW0kBEREpIr7Nl/Qx2ajuboFlI5yykgYiIUsFRG0RERBRavIHEoFEA1sXg71rlzvcG/inc6W8W0uk3DY6FcnHEsfakrwwrlYMnIiJVxBZIONUiFpbWUcMGTFvckQCH93G2XkENALT7WOr6vnVcA6DBMG33u60/U3c/14xDPFuM6+jiMwvp9J8GC+WtY5QOBWLqAOqobFV7+088PoBtaO5/66W7/S6IiGi2SRxMXQAINEPsOx/B/Uw3u/7VFkOD9PxT13e1/g9UMQvpDJyG9qeiAwLo0v+pbWgC3E0nERHNvhgCCfdhOexB4j1kNKP/sTX4e4MfYiqYhXRGS4MXaAwMjAYEJkRENPuiN21YL1GpA9AM/DygXts+qwMAHtwbXn/vVItYqtQBzYCt6vwFs5DOiGlYuu82YZxedDVuOFW8qAH6zjMo2BJFREQJixxIOBenAABt48mAB4mF4xoA6CgNe25a5c7D9aO6D6NZSGfUNCzeewAAqJ91Boc679+hPiQwISKi2Rc5kBj5Fmsdu533hnXCc6oortcA6DAVDiKA2UhnpDQAwNJ9aEBnwiqniq0KYByqXXZERJScROeRaI9YGPS66lRRXKqgDg2GPWCWxSkyC+kcmQbP4hNsaGhPWGW9rKCu7yg5uoaIiNIROZAY2G4OAFYZ7kv4oAeNhXL74fqx53OrvICFsnqzEcxCOsOlodsi3NaNUxyXi1iv6TBV7dNCRHj9+jX+/Oc/4/Xr15M+lNj88MMPePToEf71r39N+lDIE72/ZmtYYFevfds0RBsyxLAzckC70/vfbg1NVHPgxiykM2ga7mqPOlG2nIio0WjI2tqaZDIZ2dvbm/ThxKrRaMjTp08FgGxvb0/6cEhiGf4pIrYpemtYIQCBpolumAMfTN0PosF/mowZQTk5s5DOAGkYyJuHYtajCLsVYDFgCob5lhyfedtsNmV1dVVyuZycn5+nd3wpOzo6EgDy9OnTSR/K3IsnkKA50aplmYc5I7yAacAEXMNcXl5Gevvb3d2Vy8vL0L9XwgTyTWRG8m4cn3m7vb0tAGR/fz+1Q5tUGW5ubgoAefPmTaR9pyrENaI6LtpFvlnlJVTq2tSP0nCsMorFrvVOitU7y6a3h8oaP4/tIPvlyxd8++23ePjwYeRje/jwIb7//nt8+fIl8rYmYVL5Bkx33sV1Tv7+++94/fo1lpeXUalUEj1mYPJluL+/j0wmg7///e+4vb2N5RiS5pWjnyUFHKuKcnEBxZALMjnVYmsdpYQXdJp0JEPqsg2tNctlp7+Hss1OPrmzc+qtdNju/9+pJ/af3svLS8nlclIqlaTRaEQ+vuvraymVSpLL5abwDXty+SYyvXkX5znp9R04OjpK8IhdqpTh3t6eAJBXr17FcgxJGzZDcK+u8jaj3XRt03CbsxOsSWYgQUO1197A4E6j08bvNObtTqljEtxoNCSfz0uhUJBmsxnbcTabTSkUClIoFGK7QadjsvkmMn15F+c52Ww2JZvNSjabjT1f+6lUhufn5wJAVldXYz2OZAxfs+jOd2J98HuBSTLNKQwkaIjOuhzQdIkYFCvAzwXc0urUNi5wKpVKkslkEnn7PT8/l0wmI5ubm7FvOzEK5JvINOVdvOekZVkCQEqlUpwHOZBqZZjP5wWAXF9fJ3I8sfE6zA4tyCQf+EkEKC4GEjQfRqx62s99Sxx9IV9fXwuARB9W3vA95W+OLarkm8iU5F3M56TXrJF0Fb+KZeh1MFW+ecPURzdPtc6J8TVU4SS1UjM7W04lC+WF8B1w5o+DqruQCPDg3tiOojbGdxasVqsAgL/97W9xHOBA3333HW5vb0NOJpT+OaJKvgFR8y4N8Z+T//73vwEAq6urcRzgUCqW4V//+lcAwG+//RZgD+lfI87FKaBt4MnAAndQfeEupbCT0HTBi892oAOovbjbmTeSeOMSSodb/ZVU1DpLevt59P5Ficpzudzotuie+ToGvIG0h4ANr8ZsNBoCQHK5XIgjjOscscU09Pb8BQBE03QxTVN0LXjn27H5JiJiG52804zevOnK11HlFy3vkpXUOeltI1ifheDlq2IZfvjwQQDI8vLy2O92HUjq14ipj9jf2GaPzvei5K17/sXbcX42Aomem3KQvykahWAbommdnt2G5p0otpi6JpoeYFKpSUu9vOIddeLd4PL5/JBvmKJ7/UpGVF+3Jy0bcePI5XL+Hw6xnyPds7O250LtehAGa8cdn29eGty8utsR0etT4G/fgfJuys9Jr7kh2Lth8PJVtQw/ffrkL+hQ+Brx1fE2hrz138HXv9kIJOaFbYrROtkNHaLpbhSs6cYMdIZMUrydjIL1Eh/eoc5Pe2WhUBAA/mcojO0c6XS2vXN8Adr2uwXuXd/zhhZ8MrTAeZeqeM9J70E68gHfI1z5qlqGl5eX/gMpRa8Rf8NCu3cfMm8TmJ2YgcQU6ky/HX2M8VyI+cIJ2jt+2A3C1Mdf+KurqwJAPnz4EOgYI58jo/IsZIew4KMKOjdHw9ACP3TD5l0qEjonfVfthyxfVcvQqykB4HskiVrXSJgaqpB5awdbX8mP0J0t2zOwpfA3SSql03EslIsL2DrbgKEDurGBsxdbKFvO2I4zKqUjbe0ZAe8vxbK9r1+/AgCy2ayv7w9cddWp4kUN0Hf8zRJ6dXXla19RzpGurbQ6fQF66W73Pi8/H9wL1iEsaL61V5utV1B59wDmx3AzqvrNuzRN9pwMX76qlqH/41H7GgkmnryNQ+hAQtzajFT+JkmZdDpVbG0d4/6OjY8Hz3APAO49w8HHQ5QuXmKrbI28CJRJxwTYZ3UA8V3U+XwegP8H1KK79jrqZ3b735z371DXDPw8Zo5cb9pfb58jRTxHOmy4Wabj7j3Swft3dQAagj4Dg+Yb0AnC9J2DsdMJ9wuUdylL6pz0HvRj9h66fFUtw+50ZzKZ4V9U/BoJKkrexipwHYaK5qGzZY8pH7WRankFmPTHJ6891nc1cn9Vom2I5jMt3kQ7wSf+iXCOjKr6jFAtGjrfQjYBBMq7KT8nvb4LvkapRChfVcswUB+JzsEpdI2EaNoIm7cqNW0o5fFByLfnj0houG7CvGh4SqVZXs4FTgFAu4+4Xg5yuRwA4Obmxt8PFp9gQwNQP4MNwHpZQV3f8ZUW703L26d/Ec4R+wzDfmq9rLif+Zj7oF+gfHMslJcqeGCa0AHg9CLwuPdAeTcj56SvGokI5atqGXrfC1b7pNI10mqmQB1dFZfDRclb79hDXMNDxRSQECnJzxDLMLze5H5nTvTGbuv6+BkKPd5bZqFQiHawQQ15Y7ENTTQt2tCxkflm6m452b3rSoQZ9z6xvPMhqXMyk8kIgPHrU0QsXxXL0JtHYmVlxf8OokjgGhk7LDOmvE1i+Ods1EgQDeG1RQ/qEBVFuVwGABwfH/v6vtuWWUetVodu+mvP/Oc//9mzr9Qs3oP7cvQO71uvOU61jJc4xOGG+/9h2/ZH5ZtzcQrU1rGwtI6aZsA+cHPJy7t37x0ADqrFIsZNRjixvPMhqXPSd/+FiOWrYhl6aU6tP0wC18jikw24FZeDqyTiylv3/NOwMXh6zXBiC0lEWrNqaZ32w/bEHzNmVtI5K+kYKrnlzxuNhmQyGf/j6UMM9ysUCqms5DhQz+x5ncl2vCWvw75Lj8o3b5ispve33Zo9C8j5KcuJ5t1IyZ2Tz58/FwCyu7vr4zDCl6+KZbi5uSkA5O3bt+M3HJfYr5HRC3bFk7fJLNwVWyBhG1rvKpFe9cvUdmgcbFbSOSvpGKndGSmZpXO9hYIsyxp3IIEn4jk6OhIA8vz586iHGYipa6IZw3IrnpuQ/3wLZ1J550uC5+TJyYkAoyeLiqt8VSvDbDYrmUwmlcAx0WtkShftiieQsA3RBl0YCcygNVGzks5ZScc4Caen2WzK6uqqZLPZkb3Kg7ZhXl5eSjablbW1tZiO1J9xN5m4bkJ+8y2MSeWdbwmfk/l8XjKZzMB+EnGWr0pl6PWPSGPZ+OSvES4jPkByB66WWUnnrKTDlcTiNP0ajYYsLy9LoVBoz75nG1rrjSJ4NfaHDx+kUCjI8vJy6tXyo/Mr3iGLg/ItqknmnV9Jn5OVSkUAyP7+fsB9By9fVcrQqx05OjqK5RhGSecaSeI+nGSAklYgkdDBq2NW0jkr6RCxU6xdub6+lt3dXcnlcrK5udm3uqPm++1kc3NTcrmc7O7uju95n4SuPOvpid5uC473Adifb1FMPO98SOOcvL6+lkwmI7lc7u6oigTKd9Jl6DXnBFv1M4LUrpGul5CIyyDYpjfCJLn7OgOJWMxKOmchHZ2+HnrKnT2azaYcHf1fT8enIPcAy7Im/iZtm0ZvB1yvI5mR3Oqybr5Fe5tUIe+GS/ecfPXqlQCQ7e3tO58lVb6TKsPl5WUBICcnJ5H2HUSa14i7rwhNJabudsBMeE2m+AKJQSMATGPwgymGteonxm86u9IxMErtmUlvAg/ueSkvojnkNXHs7e1N+lAS0Wg02iM13rx5M+nDmXuxBBLtCVa0rmVYbe+h1NfWE+Na9Wnzn05TdO9tdMRysklNTDPOvJQX0Tzb29sTwJ2kSc2l1MOxLEtyuZxks9l0h3vSUNEDiREPynZb8fAurpHWqk9V6HQOby5IaijOSPNSXkQk5+fnsr29reZS6iHt7+/L8+fPfc8qS8mLGEjY7fbgQc+e8VNxRlurPj3R0uk9oPt/a+ppP4jnpbyIiCgt0abItl6iUgcwZDnk8UvlqrOe+kgR0+kt9Xp60TVvqVPFixqg76SY5nkpLyIiSk2kQMK5OAUAaBtPBjxQLBzXgMHrtXcos576CFHTuegu69Yzh7rz/h3qQx7oSZmX8iIiovRECiRGvsFax3CfS6XhDxyniq2Ku43asRXlUBIVOZ1L96EBnaVenSq2KoBxmO4b/byUFxERpSex1T+t4xoADcawV+4Y1qpXwdh0AsDiE2y4y7rBRmu9en0HzxRqF5iX8iIionhFCiQGtv0DgFXGeg1A/8PSKmOhbLUeSuuo6SYOHj9GSUfPcqyqCZzOO1p9C3CK43IR6zUd5kH6DQPzUl5ERJSiaH01784J3pmOc8S8Cf2/6RktYIuhqbYCZbB0DtKd9slN3DQv5UVERGmJPo9EzwyOo6cKjXOt+tQFSOdAqqysOS/lRUREqVgQEUm5EmQOOagWl1CBAZtDJomIaIb876QPYB5Y5SVU6hoMm0EEERHNlsRGbcwzp1pEserArYlYwHpNg2F/VGqUBhERURzYtJEAq7zgjoIAAGjQzY+YwCANIiKixLFGInYOWhNIApoO02YQQUREs4s1EkRERBQaaySIiIgoNAYSREREFBoDCSIiIgqNgQQRERGFxkCCiIiIQmMgQURERKExkCAiIqLQGEgQERFRaP8Poc/8Yr6tToUAAAAASUVORK5CYII=" alt="1548140736187"></p><p>For example in your neural network you if you want to calculate new weights on your first layer and the second layer according to the <strong>gradient descent</strong> you have to calculate partial derivative on your cost function.</p><p><img src="data:image/png;base64,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" alt="1548193684435"></p><p><img src="data:image/png;base64,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" alt="1548193713633"></p><p>By using <strong>chain rule</strong>, you can calculate partial derivative based on the partial derivative on each function.</p><p><img src="/assets/img/1548194181907.8e75351c.png" alt="1548194181907"></p><p>You can go from the right to the left and calculate the error on each step, and next propagate this to the previous layer and update your weights.</p><div class="warning custom-block"><p class="custom-block-title">Hadamard product <a href="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)" target="_blank" title="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p><p>Sometimes you will see ∘ instead of ∗ in the multiplication between matrices. This sign is a Hadamard product, and by this, you multiply two matrices with the same dimension by multiply each part of matrix themselves. For example if your f(x)=x*(x-1). The matrix calculation wouldn’t be multiple two matrices but Hamarad product of this.</p><p><img src="data:image/png;base64,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" alt="1548182006468"></p></div><p>Below you can find an algorithm for a matrix with <strong>m</strong> examples .</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA1MAAABlCAYAAACoc7mxAAAaSklEQVR4nO3dP2zb2B0H8C+LAtVWb/XoQTJSw0O6GdTiMVIWT75szi3kbdIS4AoYOBQwEBQeQk530pLz6iW+weQYdJDSLR0MpzAJJJ2cTk4ne/t1ICmREilR1B+S8vcDaEgkPz3yPZHv9/5REREBERERERERzeR3eWeAiIiIiIiojBhMERERERERZcBgioiIiIiIKAMGU0RERERERBkwmCIiIiIiIsqAwRQREREREVEGDKaIiIiIiIgyYDBFRERERESUAYMpIsrIhW3qqCs67LyzQkRERJQDBlNENDPXNqHXa2i2u+jnnRkiIiKinDCYIqL0XBumXkft5BzYVfPODREREVGufp93BoioPOzTE1wfnEE6VQA20G2im3emiIiIiHLCYIqIUmt0emjknQkiIiKiguA0PyIiIiIiogwYTBEREREREWXAYIqIiIiIiCgDBlNEREREREQZMJgiIiIiIiLKgMEUERERERFRBgymiIiIiIiIMmAwRURERERElAGDKSIiGvjy5UveWYhV1HxRMcxTP8pct8qc97QewzFSuTGYIqJMXPMEXQBAFxe2m3NuaF5fvnzB999/j7/85S+TGy+2jrqiQFHqMFdY7H/961/x5z//Gb/++uvqvpQKbxH1tox1K/Vxr4Eylg9lkNO9ZSGEiCgtSxMAyS9VE8PJO5PksUQLl41mJX7y559/FgDyww8/yO3t7YQkNVEjZa6utLzfvXsnW1tb8vTpU7m7u1vdF5MvWqfUnH/si6y3ZapbqY97jeRfPsWq+2GOZYimFitPM0vxG3UM1WtjWMU7TgZTa8LSvAo4ob20du7v7+Xnn3+Wra2tTDeUFy9eyMuXL+XTp09LyB1REThiqJOvDe/evRMA8ubNmylJGd7NTtXEcBxxBjc/TVZ52bm7u5OtrS159uyZ3N/fr/CbKRDcb/JsvC2j3pahbqU+bhERccQyNFFX/BtdliKUTxHq/lBwfVenBBgFrwcz/EaDwBGqIUUogQCDqXUQGi0oZzDliKGpkR4JVbMm/lBs25bNzU15+vSpvH//PtO33t3dSbvdlkqlIi9evMiWdaKC827+8SNIHz58kEqlIgcHB5MT8W92Y79Lx/JubCu+SQf5/uGHH1b4rRRwDDXXBuUy622R61bq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" alt="1548182396033"></p><ol><li>Calculate the error on the cost function</li></ol><div class="deepnn-01"><div class="ma2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="0.5970040807235782" size="mini" value="0.5970040807235782" class="mb"><input readonly="readonly" title="0.6009806609022761" size="mini" value="0.6009806609022761" class="mb"></div></div><div class="my"><div class="mx-row"><input readonly="readonly" title="0" size="mini" value="0" class="mb"><input readonly="readonly" title="0" size="mini" value="0" class="mb"><input readonly="readonly" title="1" size="mini" value="1" class="mb"><input readonly="readonly" title="1" size="mini" value="1" class="mb"></div></div><div class="mdL"><div class="mx-row"><input readonly="readonly" title="2.4304487283618257" size="mini" value="2.4304487283618257" class="mb"><input readonly="readonly" title="2.456119433450796" size="mini" value="2.456119433450796" class="mb"><input readonly="readonly" title="-1.675030426572603" size="mini" value="-1.675030426572603" class="mb"><input readonly="readonly" title="-1.663947053635071" size="mini" value="-1.663947053635071" class="mb"></div></div><img src="/deepnn/deepn01.png" alt="Deepn Network" width="740" height="225" class="image"></div><ol start="2"><li>Backpropagate this to calculate the loss on the <strong>dJ/Z[2]</strong> layer.</li></ol><div class="deepnn-02"><div class="ma2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="0.5970040807235782" size="mini" value="0.5970040807235782" class="mb"><input readonly="readonly" title="0.6009806609022761" size="mini" value="0.6009806609022761" class="mb"></div></div><div class="mdL"><div class="mx-row"><input readonly="readonly" title="2.4304487283618257" size="mini" value="2.4304487283618257" class="mb"><input readonly="readonly" title="2.456119433450796" size="mini" value="2.456119433450796" class="mb"><input readonly="readonly" title="-1.675030426572603" size="mini" value="-1.675030426572603" class="mb"><input readonly="readonly" title="-1.663947053635071" size="mini" value="-1.663947053635071" class="mb"></div></div><div class="mda2"><div class="mx-row"><input readonly="readonly" title="0.2421583051305935" size="mini" value="0.2421583051305935" class="mb"><input readonly="readonly" title="0.24137819495653604" size="mini" value="0.24137819495653604" class="mb"><input readonly="readonly" title="0.2405902083229735" size="mini" value="0.2405902083229735" class="mb"><input readonly="readonly" title="0.23980290612373953" size="mini" value="0.23980290612373953" class="mb"></div></div><div class="mdz2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="-0.40299591927642175" size="mini" value="-0.40299591927642175" class="mb"><input readonly="readonly" title="-0.3990193390977239" size="mini" value="-0.3990193390977239" class="mb"></div></div><img src="/deepnn/deepn02.png" alt="Deepn Network" width="740" height="434" class="image"></div><ol start="3"><li>Backpropagate to get update for the second Layer <strong>W[2]</strong></li></ol><div class="deepnn-03"><div class="ma1"><div class="mx-row"><input readonly="readonly" title="0.574442516811659" size="mini" value="0.574442516811659" class="mb"><input readonly="readonly" title="0.598687660112452" size="mini" value="0.598687660112452" class="mb"><input readonly="readonly" title="0.6224593312018546" size="mini" value="0.6224593312018546" class="mb"><input readonly="readonly" title="0.6456563062257954" size="mini" value="0.6456563062257954" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div></div><div class="mdz2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="-0.40299591927642175" size="mini" value="-0.40299591927642175" class="mb"><input readonly="readonly" title="-0.3990193390977239" size="mini" value="-0.3990193390977239" class="mb"></div></div><div class="ma1t"><div class="mx-row"><input readonly="readonly" title="0.574442516811659" size="mini" value="0.574442516811659" class="mb"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input readonly="readonly" title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.598687660112452" size="mini" value="0.598687660112452" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input readonly="readonly" title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6224593312018546" size="mini" value="0.6224593312018546" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input readonly="readonly" title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6456563062257954" size="mini" value="0.6456563062257954" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"><input readonly="readonly" title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div></div><div class="mdw2"><div class="mx-row"><input readonly="readonly" title="0.1845463214020981" size="mini" value="0.1845463214020981" class="mb"><input readonly="readonly" title="0.18644836043998914" size="mini" value="0.18644836043998914" class="mb"><input readonly="readonly" title="0.18644836043998914" size="mini" value="0.18644836043998914" class="mb"></div></div><img src="/deepnn/deepn03.png" alt="Deepn Network" width="692" height="595" class="image"></div><ol start="4"><li>We go further to update <strong>W[1]</strong>. First calculate <strong>dJ/dA[1]</strong></li></ol><div class="deepnn-04"><div class="mw2"><div class="mx-row"><input title="0.1" size="mini" value="0.1" class="mb"><input title="0.2" size="mini" value="0.2" class="mb"><input title="0.3" size="mini" value="0.3" class="mb"></div></div><div class="mw2t"><div class="mx-row"><input readonly="readonly" title="0.1" size="mini" value="0.1" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2" size="mini" value="0.2" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.3" size="mini" value="0.3" class="mb"></div></div><div class="mdz2"><div class="mx-row"><input readonly="readonly" title="0.5885533447669059" size="mini" value="0.5885533447669059" class="mb"><input readonly="readonly" title="0.592853675444023" size="mini" value="0.592853675444023" class="mb"><input readonly="readonly" title="-0.40299591927642175" size="mini" value="-0.40299591927642175" class="mb"><input readonly="readonly" title="-0.3990193390977239" size="mini" value="-0.3990193390977239" class="mb"></div></div><div class="mda1"><div class="mx-row"><input readonly="readonly" title="0.05885533447669059" size="mini" value="0.05885533447669059" class="mb"><input readonly="readonly" title="0.059285367544402306" size="mini" value="0.059285367544402306" class="mb"><input readonly="readonly" title="-0.04029959192764218" size="mini" value="-0.04029959192764218" class="mb"><input readonly="readonly" title="-0.0399019339097724" size="mini" value="-0.0399019339097724" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.11771066895338118" size="mini" value="0.11771066895338118" class="mb"><input readonly="readonly" title="0.11857073508880461" size="mini" value="0.11857073508880461" class="mb"><input readonly="readonly" title="-0.08059918385528436" size="mini" value="-0.08059918385528436" class="mb"><input readonly="readonly" title="-0.0798038678195448" size="mini" value="-0.0798038678195448" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.17656600343007176" size="mini" value="0.17656600343007176" class="mb"><input readonly="readonly" title="0.1778561026332069" size="mini" value="0.1778561026332069" class="mb"><input readonly="readonly" title="-0.12089877578292652" size="mini" value="-0.12089877578292652" class="mb"><input readonly="readonly" title="-0.11970580172931716" size="mini" value="-0.11970580172931716" class="mb"></div></div><img src="/deepnn/deepn04.png" alt="Deepn Network" width="736" height="501" class="image"></div><ol start="5"><li>Next we calculate <strong>dJ/dZ[1]</strong></li></ol><div class="deepnn-05"><div class="ma1"><div class="mx-row"><input title="0.574442516811659" size="mini" value="0.574442516811659" class="mb"><input title="0.598687660112452" size="mini" value="0.598687660112452" class="mb"><input title="0.6224593312018546" size="mini" value="0.6224593312018546" class="mb"><input title="0.6456563062257954" size="mini" value="0.6456563062257954" class="mb"></div><div class="mx-row"><input title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div><div class="mx-row"><input title="0.6010878788483698" size="mini" value="0.6010878788483698" class="mb"><input title="0.6318124177361016" size="mini" value="0.6318124177361016" class="mb"><input title="0.6615031592029523" size="mini" value="0.6615031592029523" class="mb"><input title="0.6899744811276125" size="mini" value="0.6899744811276125" class="mb"></div></div><div class="mda1"><div class="mx-row"><input readonly="readonly" title="0.05885533447669059" size="mini" value="0.05885533447669059" class="mb"><input readonly="readonly" title="0.059285367544402306" size="mini" value="0.059285367544402306" class="mb"><input readonly="readonly" title="-0.04029959192764218" size="mini" value="-0.04029959192764218" class="mb"><input readonly="readonly" title="-0.0399019339097724" size="mini" value="-0.0399019339097724" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.11771066895338118" size="mini" value="0.11771066895338118" class="mb"><input readonly="readonly" title="0.11857073508880461" size="mini" value="0.11857073508880461" class="mb"><input readonly="readonly" title="-0.08059918385528436" size="mini" value="-0.08059918385528436" class="mb"><input readonly="readonly" title="-0.0798038678195448" size="mini" value="-0.0798038678195448" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.17656600343007176" size="mini" value="0.17656600343007176" class="mb"><input readonly="readonly" title="0.1778561026332069" size="mini" value="0.1778561026332069" class="mb"><input readonly="readonly" title="-0.12089877578292652" size="mini" value="-0.12089877578292652" class="mb"><input readonly="readonly" title="-0.11970580172931716" size="mini" value="-0.11970580172931716" class="mb"></div></div><div class="mdz1s"><div class="mx-row"><input readonly="readonly" title="0.24445831169074586" size="mini" value="0.24445831169074586" class="mb"><input readonly="readonly" title="0.24026074574152914" size="mini" value="0.24026074574152914" class="mb"><input readonly="readonly" title="0.2350037122015945" size="mini" value="0.2350037122015945" class="mb"><input readonly="readonly" title="0.22878424045665732" size="mini" value="0.22878424045665732" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2397812407499373" size="mini" value="0.2397812407499373" class="mb"><input readonly="readonly" title="0.23262548653056345" size="mini" value="0.23262548653056345" class="mb"><input readonly="readonly" title="0.22391672956746583" size="mini" value="0.22391672956746583" class="mb"><input readonly="readonly" title="0.2139096965202944" size="mini" value="0.2139096965202944" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2397812407499373" size="mini" value="0.2397812407499373" class="mb"><input readonly="readonly" title="0.23262548653056345" size="mini" value="0.23262548653056345" class="mb"><input readonly="readonly" title="0.22391672956746583" size="mini" value="0.22391672956746583" class="mb"><input readonly="readonly" title="0.2139096965202944" size="mini" value="0.2139096965202944" class="mb"></div></div><div class="mdz1"><div class="mx-row"><input readonly="readonly" title="0.01438767570016593" size="mini" value="0.01438767570016593" class="mb"><input readonly="readonly" title="0.014243946617778747" size="mini" value="0.014243946617778747" class="mb"><input readonly="readonly" title="-0.009470553703205323" size="mini" value="-0.009470553703205323" class="mb"><input readonly="readonly" title="-0.009128933642299017" size="mini" value="-0.009128933642299017" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.028224810251146867" size="mini" value="0.028224810251146867" class="mb"><input readonly="readonly" title="0.027582574938319723" size="mini" value="0.027582574938319723" class="mb"><input readonly="readonly" title="-0.018047505654682168" size="mini" value="-0.018047505654682168" class="mb"><input readonly="readonly" title="-0.017070821146424515" size="mini" value="-0.017070821146424515" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.04233721537672029" size="mini" value="0.04233721537672029" class="mb"><input readonly="readonly" title="0.04137386240747958" size="mini" value="0.04137386240747958" class="mb"><input readonly="readonly" title="-0.027071258482023245" size="mini" value="-0.027071258482023245" class="mb"><input readonly="readonly" title="-0.025606231719636767" size="mini" value="-0.025606231719636767" class="mb"></div></div><img src="/deepnn/deepn05.png" alt="Deepn Network" width="641" height="660" class="image"></div><ol start="6"><li>The last step before update is to find the <strong>dJ/dW[1]</strong></li></ol><div class="deepnn-06"><div class="mx"><div class="mx-row"><input title="0.1" size="mini" value="0.1" class="mb"><input title="0.2" size="mini" value="0.2" class="mb"><input title="0.3" size="mini" value="0.3" class="mb"><input title="0.4" size="mini" value="0.4" class="mb"></div><div class="mx-row"><input title="0.5" size="mini" value="0.5" class="mb"><input title="0.6" size="mini" value="0.6" class="mb"><input title="0.7" size="mini" value="0.7" class="mb"><input title="0.8" size="mini" value="0.8" class="mb"></div></div><div class="mdz1"><div class="mx-row"><input readonly="readonly" title="0.01438767570016593" size="mini" value="0.01438767570016593" class="mb"><input readonly="readonly" title="0.014243946617778747" size="mini" value="0.014243946617778747" class="mb"><input readonly="readonly" title="-0.009470553703205323" size="mini" value="-0.009470553703205323" class="mb"><input readonly="readonly" title="-0.009128933642299017" size="mini" value="-0.009128933642299017" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.028224810251146867" size="mini" value="0.028224810251146867" class="mb"><input readonly="readonly" title="0.027582574938319723" size="mini" value="0.027582574938319723" class="mb"><input readonly="readonly" title="-0.018047505654682168" size="mini" value="-0.018047505654682168" class="mb"><input readonly="readonly" title="-0.017070821146424515" size="mini" value="-0.017070821146424515" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.04233721537672029" size="mini" value="0.04233721537672029" class="mb"><input readonly="readonly" title="0.04137386240747958" size="mini" value="0.04137386240747958" class="mb"><input readonly="readonly" title="-0.027071258482023245" size="mini" value="-0.027071258482023245" class="mb"><input readonly="readonly" title="-0.025606231719636767" size="mini" value="-0.025606231719636767" class="mb"></div></div><div class="mdxt"><div class="mx-row"><input readonly="readonly" title="0.1" size="mini" value="0.1" class="mb"><input readonly="readonly" title="0.5" size="mini" value="0.5" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.2" size="mini" value="0.2" class="mb"><input readonly="readonly" title="0.6" size="mini" value="0.6" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.3" size="mini" value="0.3" class="mb"><input readonly="readonly" title="0.7" size="mini" value="0.7" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.4" size="mini" value="0.4" class="mb"><input readonly="readonly" title="0.8" size="mini" value="0.8" class="mb"></div></div><div class="mdw"><div class="mx-row"><input readonly="readonly" title="-0.0022051826743088613" size="mini" value="-0.0022051826743088613" class="mb"><input readonly="readonly" title="0.0018076713146672708" size="mini" value="0.0018076713146672708" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.0039035841421958244" size="mini" value="-0.0039035841421958244" class="mb"><input readonly="readonly" title="0.0043720392131481375" size="mini" value="0.0043720392131481375" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.005855376213293734" size="mini" value="-0.005855376213293734" class="mb"><input readonly="readonly" title="0.006558058819722202" size="mini" value="0.006558058819722202" class="mb"></div></div><img src="/deepnn/deepn06.png" alt="Deepn Network" width="651" height="607" class="image"></div><ol start="7"><li>The final step is to update your weights with new values, and calculate new loss and cost.</li></ol><div class="deepnn-07"><input title="0.1" size="mini" value="0.1" class="malpha"><div class="madw1"><div class="mx-row"><input readonly="readonly" title="-0.00022051826743088614" size="mini" value="-0.00022051826743088614" class="mb"><input readonly="readonly" title="0.0001807671314667271" size="mini" value="0.0001807671314667271" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.00039035841421958245" size="mini" value="-0.00039035841421958245" class="mb"><input readonly="readonly" title="0.00043720392131481377" size="mini" value="0.00043720392131481377" class="mb"></div><div class="mx-row"><input readonly="readonly" title="-0.0005855376213293734" size="mini" value="-0.0005855376213293734" class="mb"><input readonly="readonly" title="0.0006558058819722203" size="mini" value="0.0006558058819722203" class="mb"></div></div><div class="mw1p"><div class="mx-row"><input readonly="readonly" title="0.5002205182674309" size="mini" value="0.5002205182674309" class="mb"><input readonly="readonly" title="0.49981923286853325" size="mini" value="0.49981923286853325" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6003903584142195" size="mini" value="0.6003903584142195" class="mb"><input readonly="readonly" title="0.6995627960786851" size="mini" value="0.6995627960786851" class="mb"></div><div class="mx-row"><input readonly="readonly" title="0.6005855376213294" size="mini" value="0.6005855376213294" class="mb"><input readonly="readonly" title="0.6993441941180277" size="mini" value="0.6993441941180277" class="mb"></div></div><div class="madw2"><div class="mx-row"><input readonly="readonly" title="0.01845463214020981" size="mini" value="0.01845463214020981" class="mb"><input readonly="readonly" title="0.018644836043998914" size="mini" value="0.018644836043998914" class="mb"><input readonly="readonly" title="0.018644836043998914" size="mini" value="0.018644836043998914" class="mb"></div></div><div class="mw2p"><div class="mx-row"><input readonly="readonly" title="0.08154536785979019" size="mini" value="0.08154536785979019" class="mb"><input readonly="readonly" title="0.1813551639560011" size="mini" value="0.1813551639560011" class="mb"><input readonly="readonly" title="0.2813551639560011" size="mini" value="0.2813551639560011" class="mb"></div></div><div class="ml"><div class="mx-row"><input readonly="readonly" title="0.8880759021818458" size="mini" value="0.8880759021818458" class="mb"><input readonly="readonly" title="0.8985826383577421" size="mini" value="0.8985826383577421" class="mb"><input readonly="readonly" title="0.5158313302300179" size="mini" value="0.5158313302300179" class="mb"><input readonly="readonly" title="0.5091925231638667" size="mini" value="0.5091925231638667" class="mb"></div></div><input readonly="readonly" title="0.7029205984833681" size="mini" value="0.7029205984833681" class="mb mj"><div class="mlp"><div class="mx-row"><input readonly="readonly" title="0.8687608795922419" size="mini" value="0.8687608795922419" class="mb"><input readonly="readonly" title="0.8781937863190606" size="mini" value="0.8781937863190606" class="mb"><input readonly="readonly" title="0.5305700340917647" size="mini" value="0.5305700340917647" class="mb"><input readonly="readonly" title="0.5243942768254239" size="mini" value="0.5243942768254239" class="mb"></div></div><input readonly="readonly" title="0.7004797442071229" size="mini" value="0.7004797442071229" class="mb mjp"><button class="btn">Update W1 and W2 weights </button><img src="/deepnn/deepn07.png" alt="Deepn Network" width="661" height="671" class="image"><input size="mini" value="1" class=" mtimes"></div><hr><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Neural_Network</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>Neural_Network<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># parameters</span>
        self<span class="token punctuation" data-v-54601d22>.</span>inputSize <span class="token operator" data-v-54601d22>=</span> inputSize
        self<span class="token punctuation" data-v-54601d22>.</span>outputSize <span class="token operator" data-v-54601d22>=</span> outputSize
        self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize <span class="token operator" data-v-54601d22>=</span> hiddenSize
        
        <span class="token comment" data-v-54601d22># weights</span>
        <span class="token comment" data-v-54601d22>#self.W1 = torch.randn(self.hiddenSize, self.inputSize) # 3 X 2 tensor</span>
        <span class="token comment" data-v-54601d22>#self.W2 = torch.randn(self.outputSize, self.hiddenSize) # 1 X 3 tensor</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.7</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.3</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>/</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>+</span> torch<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>        
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_function</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>-</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
   
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># Binary classification logistic loss </span>
        <span class="token comment" data-v-54601d22># Special case of cross entropy (http://wiki.fast.ai/index.php/Log_Loss)</span>
        <span class="token comment" data-v-54601d22># nn.BCELoss()</span>
        <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># m - number of examples</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X 2) * (2 x m) = (3 x m)  &quot;.dot&quot; does not broadcast in PyTorch</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>a1 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X m) activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A1'</span><span class="token punctuation" data-v-54601d22>,</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>z2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x 3) * (3 x m) = (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Z2'</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span>
        
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m) final activation function</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'A2'</span><span class="token punctuation" data-v-54601d22>,</span>yhat<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>return</span> yhat   
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># derivative of sigmoid</span>
        <span class="token keyword" data-v-54601d22>return</span> s <span class="token operator" data-v-54601d22>*</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>-</span> s<span class="token punctuation" data-v-54601d22>)</span>
      
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token operator" data-v-54601d22>/</span>yhat<span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>      
          
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>backward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22>#lr learning rate</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 1:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># yhat = a2</span>
        dL <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>loss_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># cost function dI/da2  (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dL:'</span><span class="token punctuation" data-v-54601d22>,</span> dL<span class="token punctuation" data-v-54601d22>)</span>

        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 2:'</span><span class="token punctuation" data-v-54601d22>)</span>
        da2 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#  da2/dz2 (1 x m)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dA2:'</span><span class="token punctuation" data-v-54601d22>,</span> da2<span class="token punctuation" data-v-54601d22>)</span>
        
        dz2 <span class="token operator" data-v-54601d22>=</span> dL<span class="token operator" data-v-54601d22>*</span>da2 <span class="token comment" data-v-54601d22># dl/dz2 from the chain rule (1 x m) - the same as a2</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dz2:'</span><span class="token punctuation" data-v-54601d22>,</span> dz2<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 3:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># dL/da2 * da2/dz2 (*) dz2/dW2(T)  [a1]  | (1 x m) * (3 x M)^T = (1 x 3)</span>
        dW2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz2<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> 
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dW2:'</span><span class="token punctuation" data-v-54601d22>,</span> dW2<span class="token punctuation" data-v-54601d22>)</span>
        
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 4:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># dl/da1 = dz2/dW2(T) * dL/dz2 | (1x3)^T * (1 x m) = (3 x 1) * (1 x m) = (3 * m)</span>
        da1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>,</span> dz2 <span class="token punctuation" data-v-54601d22>)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'da1:'</span><span class="token punctuation" data-v-54601d22>,</span> da1<span class="token punctuation" data-v-54601d22>)</span>
        
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 5:'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22>#  dz1 = dL/da1 * da1/dz1  | (3 x m) * (3 x m) = (3 x m)</span>
        dz1 <span class="token operator" data-v-54601d22>=</span> da1 <span class="token operator" data-v-54601d22>*</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'sZ1: '</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dZ1: '</span><span class="token punctuation" data-v-54601d22>,</span> dz1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 6:'</span><span class="token punctuation" data-v-54601d22>)</span>
        dW1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz1<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>  <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (3 * m) * (m x 2) = (3 x 2)</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'dW1: '</span><span class="token punctuation" data-v-54601d22>,</span> dW1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>

        
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Step 7:'</span><span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW1
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'alpha*dW1: '</span><span class="token punctuation" data-v-54601d22>,</span> lr<span class="token operator" data-v-54601d22>*</span>dW1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'W1: '</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW2
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'alpha*dW2: '</span><span class="token punctuation" data-v-54601d22>,</span> lr<span class="token operator" data-v-54601d22>*</span>dW2 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'W2: '</span><span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
        
        <span class="token keyword" data-v-54601d22>return</span>      
    
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

NN <span class="token operator" data-v-54601d22>=</span> Neural_Network<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.3</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.4</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>.5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.6</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.7</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>.8</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'X:'</span><span class="token punctuation" data-v-54601d22>,</span>X<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Y:'</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Forward:'</span><span class="token punctuation" data-v-54601d22>)</span>
Yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#or NN(X)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'L:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'J:'</span><span class="token punctuation" data-v-54601d22>,</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Backward:'</span><span class="token punctuation" data-v-54601d22>)</span>
NN<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>,</span>Yhat<span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span>


Yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#or NN(X)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'L: '</span><span class="token punctuation" data-v-54601d22>,</span> NN<span class="token punctuation" data-v-54601d22>.</span>loss_function<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'J: '</span><span class="token punctuation" data-v-54601d22>,</span> NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>Yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h4 id="pytorch-implementation"><a href="#pytorch-implementation" aria-hidden="true" class="header-anchor">#</a> Pytorch Implementation</h4><div class="language-python extra-class"><pre class="language-python"><code>NN <span class="token operator">=</span> Neural_Network<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># random values from [0,1] (2 x m)</span>

<span class="token keyword">def</span> <span class="token function">fun_to_predict</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token number">1.0</span> <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0.0</span> <span class="token comment">#must be float</span>

Y <span class="token operator">=</span> torch<span class="token punctuation">.</span>t<span class="token punctuation">(</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>fun_to_predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> torch<span class="token punctuation">.</span>t<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">]</span>   <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment"># (1 x m)</span>
yhat <span class="token operator">=</span> NN<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot; Loss: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>NN<span class="token punctuation">.</span>loss<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># trains the NN 100 times</span>
  NN<span class="token punctuation">.</span>train<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span>

yhat <span class="token operator">=</span> NN<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; Loss: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>NN<span class="token punctuation">.</span>loss<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ypred <span class="token operator">=</span> NN<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
     
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Predicted data based on trained weights: &quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Input: \n&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Output: \n&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ypred<span class="token punctuation">)</span><span class="token punctuation">)</span>   
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Real: \n&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>Neural_Network</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span> <span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>Neural_Network<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># parameters</span>
        self<span class="token punctuation" data-v-54601d22>.</span>inputSize <span class="token operator" data-v-54601d22>=</span> inputSize
        self<span class="token punctuation" data-v-54601d22>.</span>outputSize <span class="token operator" data-v-54601d22>=</span> outputSize
        self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize <span class="token operator" data-v-54601d22>=</span> hiddenSize
        
        <span class="token comment" data-v-54601d22># weights</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>inputSize<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># 3 X 2 tensor</span>
        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>outputSize<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>hiddenSize<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># 1 X 3 tensor</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># m - number of examples</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X 2) * (2 x m) = (3 x m)  &quot;.dot&quot; does not broadcast in PyTorch</span>
        self<span class="token punctuation" data-v-54601d22>.</span>a1 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (3 X m) activation function</span>
        self<span class="token punctuation" data-v-54601d22>.</span>z2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x 3) * (3 x m) = (1 x m)</span>
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>z2<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m) final activation function</span>
        <span class="token keyword" data-v-54601d22>return</span> yhat
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>/</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>+</span> torch<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>sigmoid_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> s<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># derivative of sigmoid</span>
        <span class="token keyword" data-v-54601d22>return</span> s <span class="token operator" data-v-54601d22>*</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span> <span class="token operator" data-v-54601d22>-</span> s<span class="token punctuation" data-v-54601d22>)</span>
      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># Binary classification logistic loss </span>
        <span class="token comment" data-v-54601d22># Special case of cross entropy (http://wiki.fast.ai/index.php/Log_Loss)</span>
        <span class="token comment" data-v-54601d22># nn.BCELoss()</span>
        <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>mean<span class="token punctuation" data-v-54601d22>(</span><span class="token operator" data-v-54601d22>-</span>y <span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>-</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>*</span> torch<span class="token punctuation" data-v-54601d22>.</span>log<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>

      
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>loss_derivative</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token keyword" data-v-54601d22>return</span> <span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token operator" data-v-54601d22>/</span>yhat<span class="token operator" data-v-54601d22>-</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>/</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token operator" data-v-54601d22>-</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>      
    
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>backward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22>#lr learning rate</span>
        <span class="token comment" data-v-54601d22># yhat = a2</span>
        dL <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>loss_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># cost function dI/da2  (1 x m)</span>
        
        da2 <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#  da2/dz2 (1 x m)</span>
        dz2 <span class="token operator" data-v-54601d22>=</span> dL<span class="token operator" data-v-54601d22>*</span>da2 <span class="token comment" data-v-54601d22># dl/dz2 from the chain rule (1 x m) - the same as a2</span>
        
        <span class="token comment" data-v-54601d22># dL/da2 * da2/dz2 (*) dz2/dW2(T)  [a1]  | (1 x m) * (3 x M)^T = (1 x 3)</span>
        dW2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz2<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> 
        

        <span class="token comment" data-v-54601d22># dl/da1 = dz2/dW2(T) * dL/dz2 | (1x3)^T * (1 x m) = (3 x 1) * (1 x m) = (3 * m)</span>
        da1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>,</span> dz2 <span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22>#  dz1 = dL/da1 * da1/dz1  | (3 x m) * (3 x m) = (3 x m)</span>
        dz1 <span class="token operator" data-v-54601d22>=</span> da1 <span class="token operator" data-v-54601d22>*</span> self<span class="token punctuation" data-v-54601d22>.</span>sigmoid_derivative<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>a1<span class="token punctuation" data-v-54601d22>)</span>  
        dW1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>matmul<span class="token punctuation" data-v-54601d22>(</span>dz1<span class="token punctuation" data-v-54601d22>,</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>  <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (3 * m) * (m x 2) = (3 x 2)</span>

        self<span class="token punctuation" data-v-54601d22>.</span>W2 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW2
        self<span class="token punctuation" data-v-54601d22>.</span>W1 <span class="token operator" data-v-54601d22>-=</span> lr<span class="token operator" data-v-54601d22>*</span>dW1
        <span class="token keyword" data-v-54601d22>return</span>
     

    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>train</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> lr <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># forward + backward pass for training</span>
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
        self<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> yhat<span class="token punctuation" data-v-54601d22>,</span> lr<span class="token punctuation" data-v-54601d22>)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>saveWeights</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> model<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        <span class="token comment" data-v-54601d22># we will use the PyTorch internal storage functions</span>
        torch<span class="token punctuation" data-v-54601d22>.</span>save<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>,</span> <span class="token string" data-v-54601d22>&quot;NN&quot;</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token comment" data-v-54601d22># you can reload model with all the weights and so forth with:</span>
        <span class="token comment" data-v-54601d22># torch.load(&quot;NN&quot;)</span>
        
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>predict</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>xPredicted<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        yhat <span class="token operator" data-v-54601d22>=</span> self<span class="token punctuation" data-v-54601d22>.</span>forward<span class="token punctuation" data-v-54601d22>(</span>xPredicted<span class="token punctuation" data-v-54601d22>)</span>
        y <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span> <span class="token keyword" data-v-54601d22>if</span> y <span class="token operator" data-v-54601d22>&gt;=</span> <span class="token number" data-v-54601d22>0.5</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>for</span> y <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>
        <span class="token keyword" data-v-54601d22>return</span> y
              

<span class="token comment" data-v-54601d22># torch.manual_seed(123) # set the constant seed for the random (JUST FOR TESTING)</span>

NN <span class="token operator" data-v-54601d22>=</span> Neural_Network<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># random values from [0,1] (2 x m)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>+</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

Y <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span> torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> torch<span class="token punctuation" data-v-54601d22>.</span>t<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span> <span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># (1 x m)</span>
yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot; Loss: &quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>detach<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>  

<span class="token keyword" data-v-54601d22>for</span> i <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>  <span class="token comment" data-v-54601d22># trains the NN 1,000 times</span>
  NN<span class="token punctuation" data-v-54601d22>.</span>train<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>1.0</span><span class="token punctuation" data-v-54601d22>)</span>

yhat <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;#&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>i<span class="token punctuation" data-v-54601d22>)</span> <span class="token operator" data-v-54601d22>+</span> <span class="token string" data-v-54601d22>&quot; Loss: &quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>NN<span class="token punctuation" data-v-54601d22>.</span>loss<span class="token punctuation" data-v-54601d22>(</span>yhat<span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>detach<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>  

ypred <span class="token operator" data-v-54601d22>=</span> NN<span class="token punctuation" data-v-54601d22>.</span>predict<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
     
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Predicted data based on trained weights: &quot;</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Input: \n&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Output: \n&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>ypred<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>   
<span class="token keyword" data-v-54601d22>print</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>&quot;Real: \n&quot;</span> <span class="token operator" data-v-54601d22>+</span> <span class="token builtin" data-v-54601d22>str</span><span class="token punctuation" data-v-54601d22>(</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><div class="language-python extra-class"><pre class="language-python"><code>Loss<span class="token punctuation">:</span> <span class="token number">0.7505306005477905</span>
<span class="token comment">#99 Loss: 0.00372719275765121</span>
Predicted data based on trained weights<span class="token punctuation">:</span> 
Input <span class="token punctuation">(</span>scaled<span class="token punctuation">)</span><span class="token punctuation">:</span> 
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.5810</span><span class="token punctuation">,</span>  <span class="token number">1.3010</span><span class="token punctuation">,</span>  <span class="token number">1.2753</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2010</span><span class="token punctuation">,</span>  <span class="token number">0.9624</span><span class="token punctuation">,</span>  <span class="token number">0.2492</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4845</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0929</span><span class="token punctuation">,</span>
         <span class="token operator">-</span><span class="token number">0.8199</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4210</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.9620</span><span class="token punctuation">,</span>  <span class="token number">1.2825</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3430</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6821</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9887</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.7018</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7498</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.1285</span><span class="token punctuation">,</span>
          <span class="token number">0.4135</span><span class="token punctuation">,</span>  <span class="token number">0.2892</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Output<span class="token punctuation">:</span> 
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
Real<span class="token punctuation">:</span> 
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="do-i-have-to-implement-all-these-functions"><a href="#do-i-have-to-implement-all-these-functions" aria-hidden="true" class="header-anchor">#</a> Do I have to implement all these functions?</h3><p>Fortunately no. All gradient and backpropagation the only think what you have to set up in the Neural Network is:</p><ul><li>architecture of the network - How many hidden layer?, What are the activation functions on each layer?</li><li>Loss Function - How to calculate loss function in the Neural Network</li></ul><ul><li>Optimilization Function  - How to update weights. If you choose wrong you can finish in the local minimum instead of the better result</li><li>Learning Rate - Find learning rate to use in the neural network</li></ul><a href="https://github.com/jcjohnson/pytorch-examples" target="_blank" title="https://github.com/jcjohnson/pytorch-examples" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more examples</span></a><p>Let’s bring again the same neural network that we define in previous chapter. For all activation we want to use sigmoid function and for loss</p><p><img src="/assets/img/1547391156214.3d92b6e8.png" alt="1547391156214"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA1MAAABlCAYAAACoc7mxAAAaSklEQVR4nO3dP2zb2B0H8C+LAtVWb/XoQTJSw0O6GdTiMVIWT75szi3kbdIS4AoYOBQwEBQeQk530pLz6iW+weQYdJDSLR0MpzAJJJ2cTk4ne/t1ICmREilR1B+S8vcDaEgkPz3yPZHv9/5REREBERERERERzeR3eWeAiIiIiIiojBhMERERERERZcBgioiIiIiIKAMGU0RERERERBkwmCIiIiIiIsqAwRQREREREVEGDKaIiIiIiIgyYDBFRERERESUAYMpIsrIhW3qqCs67LyzQkRERJQDBlNENDPXNqHXa2i2u+jnnRkiIiKinDCYIqL0XBumXkft5BzYVfPODREREVGufp93BoioPOzTE1wfnEE6VQA20G2im3emiIiIiHLCYIqIUmt0emjknQkiIiKiguA0PyIiIiIiogwYTBEREREREWXAYIqIiIiIiCgDBlNEREREREQZMJgiIiIiIiLKgMEUERERERFRBgymiIiIiIiIMmAwRURERERElAGDKSIiGvjy5UveWYhV1HxRMcxTP8pct8qc97QewzFSuTGYIqJMXPMEXQBAFxe2m3NuaF5fvnzB999/j7/85S+TGy+2jrqiQFHqMFdY7H/961/x5z//Gb/++uvqvpQKbxH1tox1K/Vxr4Eylg9lkNO9ZSGEiCgtSxMAyS9VE8PJO5PksUQLl41mJX7y559/FgDyww8/yO3t7YQkNVEjZa6utLzfvXsnW1tb8vTpU7m7u1vdF5MvWqfUnH/si6y3ZapbqY97jeRfPsWq+2GOZYimFitPM0vxG3UM1WtjWMU7TgZTa8LSvAo4ob20du7v7+Xnn3+Wra2tTDeUFy9eyMuXL+XTp09LyB1REThiqJOvDe/evRMA8ubNmylJGd7NTtXEcBxxBjc/TVZ52bm7u5OtrS159uyZ3N/fr/CbKRDcb/JsvC2j3pahbqU+bhERccQyNFFX/BtdliKUTxHq/lBwfVenBBgFrwcz/EaDwBGqIUUogQCDqXUQGi0oZzDliKGpkR4JVbMm/lBs25bNzU15+vSpvH//PtO33t3dSbvdlkqlIi9evMiWdaKC827+8SNIHz58kEqlIgcHB5MT8W92Y79Lx/JubCu+SQf5/uGHH1b4rRRwDDXXBuUy622R61bq45ZQozOHDo9lyrt88q77Q/5I2ZSgovD1INO9JQgii3M8DKZKLzr0XL5gKvSj8H9JjuX3UkCNPZ6PHz/KxsbGwgKgjx8/FvbmSTSf4PoQf9M5ODiQSqUyZdqMI4aqipbY8+mIZagrb1y8fPlSAMjnz59X+r2Uf4Ny2fW2qHUr1XE7ltc5qaqiDTopi9PoXIQ8yyfvuu/nYnowUYp6MM+9JV0wuSoMpkrO0rzKZJR1ml8wvDua8WC0beT/P3/+LJubm/LkyZOFDvO/fftWAMjr168XliZR7gbTJ8ZvOLe3t1KpVOTZs2e5ZG1etm0LAGm323ln5dHJs0G5inpbxLqV9rgtLdw4ndyZUlZ5lk8hgim/fTQpD4+hHgRlUYR2L3fzKzNbR7OrwjhrYTvvvGRV3cYuAHQvYIf/v/EKhgqoO7XIx//+97/j69evePfuHSqVysKy8fLlSzx79gx/+9vf8PXr14WlS5Qr5xp9AOrhc1RH3vrll1/w8PCA7777Lo+czW1/fx8bGxuD46BZ2dAVBfWSbZu1inpbxLqV9rgbnR46jdFf+3qZv3zKWfc9LsyTLgANx63kcn4M9aDaOoYGoHtiIu+SXPtgyrV11OsKFEWBUh+ecHewBaMCpa4Pt2F0bejB55U6dDsp5bzZ0JtdqMYZJvyeSqCBjqUB6KIZOdlVtHqCXujgvn37hl9//RV7e3t48uTJwnPy3Xff4eHhgduv0tqwL7zN63e3xy8S//jHPwB4DZNEI9fDsbaHrfvvKVAUHTNdLudMu1KpYG9vDw8PD/jnP/85yzeXxzLPP2rYUReX1QjXhqnXQ3lTUK/rMBMfoeDC1uvDe3Lcy79/r6LeFrFupTrussi9fMpZ972PX+K8D0A7QGNJh7ASC7m2NXCgAeif4zLvaCrvobFlcgxtsKhtOBzoRIY/g/+HZnk7iASL4ILpMbMMi07bNjrxNfv2wt6i8mHeyr6bX5odct68ebPUqXh3d3dSqVRkc3OzsDs5EaUX2ukp5me1tbUlACasv7BEU/21jMG1LWa6YPgamt5i0g7WTrx9+3aG75aVXquzW8L5dwxRB48v8OqH92fefXHaxj+j3xl7vQ524lKNwTrY4WLyuL+J25HMWysRd8yrqreZ69aSTD/uOEWc3pVT+axB3Z/6/YmKVg8Wd20rxLRLeURrpoIdrVR1ZFOD0E1Vjb5RsMoX4uc5nN3yBlPehcwrm8nHsL+/LwCmb2U+taGU3CDa29sTAPLhw4f5Dosod5MX6FYqFUnfn5Z8PZx/3nr2tH/88cdHstZxgeffX5iuapYYGkTVNH83rVADcFoSiQ2YCfdNZ7ixUOTPEtbHJnUGrKreFq1uzXbcgQK3Y0Rk5eVT8rrv/UmWtl6R68Gc17bEc7haaz/Nz+Pi5goA+sDhGTqxY6MajuPfKBhveh80K+E4SsQ1UVdqaOIYjvTQ61ne/Ndm/JBusJZpY2NjYrLe1CYVhuVAvA4DiAgszXt/0tTIYPrgTE+UjwxHz/Iq4VO+qTzsC3QBYHd7bL3U169f8fDwgK2trZSJ+dMp0MXFyI/Tue4DqoFXma9H2dP+wx/+AAD4z3/+k/XLS2KB57/aQKvTw9nOCdpdoN+9wqHloNdpYd4lFq554tW5uClI1RaONQDo4zw0J8f1bs5j62OBKrZ3vc9fO97/rLLeFqluzX7cZbHi8ilx3ff/wm/Lqhj7k9Ka89pW24EKAFc3ua6beiTBlIPrPhC3YC9YU6Aar6I/gKAhUrB5qd4PVoUxsXa5MOsFb6i7Juq1NvqqAafT8Bt7DbwyVABdnMRkPghwNjc3JyWMmytAs3poha6Otq6g2QVUzYqswxoVBGozbULR6ESCtvSvXsnXu1GRJd+oMdi85du3b6nTq/mLDK5uQr9N18RJF9COW2MB2yzmTXtaB8vKLaGDZVHn3/XXKhxdH8LQAM04xPXJEXTbnbsx4ng32tg6BwyPoR9tISb833jDMY96m7puLbFTLctxz21FnYSr/O2Xue7noiR1oAgeRzDl3uAKiAmMhhX28Hl15E+SGyL5sXHa7gPoo12LVt6mFxOi21SgKDW0+7lmdAoX5lEbfXg7EYbPfPX5IVQA/fPLyMXt27dveHh4mBJIAcHGFeFRO9ese+dHs9CbMpz3xz/+EUAxeiOJsnNxed5H3LUN8BogGxsbMzXOql5XaeTG716eoz/XqNR8af/3v/8FAPzpT3+aLwOLtoQOloWcf9fE0dEFdo693vhtANhuodM7w8HNKY50e+W9u8GOXOg2oQ8W6buwzSO0+4CqHQ/OySrr7cx1a4mdalmOe24r6iRcWfmUvO7nouB1oEgeRTDlXp572wOPBUb+iJV6iGh7Y3JDJNHSo/gGOgmVN5jCplklGPWwT71gb9KFon+NcF9N1u1pXbOOWtsbKnZKOi8yW53iS1GUvIsuR8Fo/C5iNvIDMBzhTT2ldXQ6hWviqI2xDpFMMqYdNC5nnv5Uxqm5izj/1RZ6vY4/au91Jnq9wVU0Wh30BrMEVqmBjmNABdBt1vzzXEPzHNAsZ6wDbFX1NnPdWpKZj7ssVlU+a1D319Yy7y0r8iiCqWD4dWx74MQ1BdMbIrE43SuVwdTKuFG/4LlTuEJ4xHdzcxOVSmW26Xe2Pgykeul+lP/73/8AFKunO1ud4ktE8i66/ASj8eoOksbWg0ZI6t9U9TkOVQw6OuzTNvqL6jnNmPa///1vANOm/sYo47V64ec/uM8tzqSpTEDSVCgb+tE5Dp2Rc92Lf07Oqupt5rq1JDMfd1nkUj7lrPvJa6lKbp5rm/8sxbi1wav0CIIpG17bXcPBSJCfOJWvoOul1kMwtTL+2TeDRmBMIBtcNFPdTFwTdW9uH6yUgRSQsTeyjL3ctN5S3GCCh3/+9ttvKRMNbuRXuNDraHY1WEk9p8FvIvWD+mZI2/flyxf861//wpMnT7C3t5fye8ps9nM0mTfTYdIa0lkF07TRPYm5tg3vxeG1y655gm4fQMrG4VLrra+IdWv24y6LPMqnnHUfSFhfVHrZr22FWZIj6y7YkjJme+DELSYjWy16e/6rhd5zPNhGM/+99qeb/OybSc8VSL01etI2pCkEW6O/f/9+tj8kKpK4a9jIj+H+/l42Nzdla2srdbKD3+cStqtNnbbv9evXAkDevHmT+jvKbtZztCzBvTOufAd5DJ4jI+JtSZ3w6IvwMcW+Bs8G8iy13vqKWLfmP+7itg3KVD551n3/j7z2TeZrazHrQdZrW/DYo7ybvusfTCXe1Cftuz8MTgBVNCPdw9zyERxH6FXowG/ScxKCY4n/YQQX0MnPlUhOw9Imnxs+tJfWx8g1zHJir2HtdlsAiG3b6ZJNGyRlefbHDH9zf38vT58+lUql8rh+q7k/UyVcr4IGX8zDNi1DNDXaUFTDDcxpaU55NuDS6q0Uu26lOu5pz1mMa6DnrRTlU4y6P/ybKc+MKls9yHRtm/wsxVVa/2CKimcwchTXe6Mm9krc3t5KpVKRvb29pIQT03BiHnQ86u3btwJA2u32rEdEVEp3d3fy5MkT2dzclNvb2ymf9n9fKW5csz/IN33aIiI//fSTAJC3b9+m/YI1MNs5KguvriT0LDvDzsJwXVpWvRUpdt2a7bjLYn3KZ1ZZ6r6IDAKP4s9ESivbtW3+B8YvDoMpyodjjffepHgK+cuXLyVpqt/UIfMpQ8HPnj2TSqWyRjcpouk+f/4sW1tbsr+/L3d3d4mfSz+dwmsEzDI1epapGu/evUsxQr1+ijKdZaFSTFlKajAtvt6Wo26lPe6yWLfySW2Oup96dKoksl3bijMqJcJgikrm06dPsrGxIXt7ewsd4g9GpX766aeFpblcjliGJuqaXEyzmTRFYs0anUv2+fNn2d/fl83NzcE6BGewzmryOsdRTsz6rOTPpE/706dPcnBwIBsbG4Vay7IsWc9/qaRoUE5qaC2q3patbsUdd1k8hvJJZc66X7RgYhbzX9uKF0wymKLS+fDhg1QqlYVNx/v06ZNUKhV58eLFQtJbNm9OdhA0FOdisnrezUQLXYWDnrz1mf6wWu/fv5f9/X25vb0dLrQerLta3PdkSfvHH3+U169fr0VvfBrLPP/FEd48aXRtsiOWlu73PG+9LWvdCh93WTym8plsEXU/FIwUdGOJOPNc2xwr2FSuWG0fBlNUSrZty8bGhuzv78vHjx8zpXF/fy+vX7+WjY0NOTg4KNxi4zGOJYamClRVNE1lMGVpkV45Z+3mkecpNOqXuHi6iGmvi8d0jvxRdnV0mraaaur3aFqP57yVEcsnajF1P+hgLUeHyxx1wNK8jTMKWHEUkcf8ZEsqs2/fvuGXX36BaZr4+PHjzA/v+/777/Hw8IBWq1WYZ4lMYut1XByc+Q/zs6ErTXShwZJO6Z+H5pp17wHL02gWJO75E7YOpdlNfp+IiIhoCRhMEZXSegVTc3FN1Gtt9DULTqeR61PQiYiI6HH5Xd4ZIKJ15cI2ddTrChTFf9V12It8cHsQSKkGAykiIiJaOQZTRLR4rom6UkPzHDg+E4gIHEsD+l00T+0FfYcNPQikei0vkHJN1BUdC/oGIiIiookYTBHRYoVHi3odNPzhomptByoAXN1g/sEpG3rNn+YYBFJwYZ+20Vd3UJs7fSIiIqLpfp93Bohonbgwj9roQ4Vx1opMu3Mvz9EHoB4+n3s6nq030QUAdNFUupH3VGP+9ImIiIjS4MgU0WNi68P1SzO96jDTDCe5lzjvA9CO0fLm3cF1bZi6t1ufqhk4a80f6jQ63tTBuFdvAekTERERpcGRKaLHpNGBSGdpyQejT+g2EQwYqaqK3d1DWE5vMOWPiIiIaB0wmCKihXGuvWdFaZaAj3siIiKidcdpfkS0IC5urgBAxQ53gCAiIqJHgMEUES1IFdu7ANDHtTP+rmvq0FMtvCIiIiIqBwZTRCXkmieD3ewuFvoU3Pk0XhlQAXRPzOH258EGFOfAwXMumiIiIqL1wWCKqCxCO/HV2v3Bf3ebNe//63q6HfeWqdrCmWVAQxu1YCfAoxNcH5xFnjlFREREtA4UEZG8M0FERERERFQ2HJkiIiIiIiLKgMEUERERERFRBgymiIiIiIiIMmAwRURERERElAGDKSIiIiIiogwYTBEREREREWXAYIqIiIiIiCgDBlNEREREREQZMJgiIiIiIiLKgMEUERERERFRBgymiIiIiIiIMmAwRURERERElAGDKSIiIiIiogwYTBEREREREWXAYIqIiIiIiCgDBlNEREREREQZrFkwZUNXFCiKAt3OOy9F58Ksz3mebB2KoiMxiWnvz8nWFSgs6FJi2REREdE6SBlMeUFK8ds+DXQcAypU7NTyzsuyubBNHXU/eFSUOurmIgvIC7bY4F0S1wyVnQKlbsLNO080E1tXltpZQERERMWXLphyb3CVZ4DimqinbbQ41+irh3heXXam8mXrNZxcH+BMBCICxwD67WYJAl4CXJhH5zh0vLITsaD12zgyVxdOLWNk6PGMNnmdS81u3vkgIiKivKULpqot9KSHVi4Bigv79Bx9dQdpYjn35grY3caax1JodAS9TmNwnNXWMTQAVzeLapBX0eoJpNNYUHo0VEWrF/49NXCgAf1rJ89MUUq23kRXNeBYWt5ZISIiopxNDaa8qSwK6oNecxemXh+uS3Jt6PX5PlMP98hH1tnY0JUamt0+0G+jpkybVuPi8rwPdXQILfT9ilKHbpvQ9eG0KjvIR6hXPTjuaE/7MM/RqVlJx1tH/GCDP4VOmfJaydSv4Tqz0fyOjTREpqbVYd6MHtaU98eOO1yWwRqu5PxMl5y+rY+fT9esR8swMW82dKUO0w6OLyZftp5YjlMHa1wTJ11AO5glcE1zLkfzp8P232t2AXSboTruwqzXYbpJ5z9LmrPIqewylFujI5Bea+07bIiIiCgFmcoSDRDN8v9laGI5IpYGUQ1DDMMSR0QcQxWohjjTPgNNrLHPOINvC6fj/48Y6vD7p+dVlVByIo4hKiCqZvlpescz+E7LEM2K5i0+reDv/HQcQ1T//cixaJpohiWOWKJF0luu8fM29S/EUCEIHaOlIZKGpUEwOPH+5wf/9s7H8JzN+v5onqfnZ1Rc/sL1JPK+pUXSDj7v1YNpeRs9lgXw6yX8V7r6Hc17OL+WNn6uI2laWiT/0XMXSjN0jqK/iSxpJit12Q0zuZx0iYiIqDSmB1OOIepYgyGhMRfTOFOjLaTYRtHwI+FGUvj7RwKkGfI63iBPCM5Gv8cxInmPHJ/jiKWNBl/j52RVHEMVdaZASmTmxnFcOYQ/n+X9SMA6PT+jpjXe44I1dRgpDPMzNW/RDoXF8xv8ab8g9ryE85g9mIpmYd40Jx3CGpQdgykiIqJHb/qaKed6fL2Se4nzvgrjVTAtycXN1cg0Jf8zh6+G/+feXAHYxXY1/BkNwz9zcN0HdrdDE2hm2FDCvRxdW2Xjogtox6EpOWPf6atuYxd9BMtW7NPrUN69dAZTmI6OcLFzDEc6aETSDZ+TiTld2DQ/19ZxdH6Is2VPO3Ku0Q+X3azvAwD6aNfCx9hEN3TO5zayQ16t3Q+9WcXzQxX980u4COpKuF7Nmbd5pvmhgY6lAd2Lx7szXF5lN1e5ERER0WM3fc3URRfq4fNoQ3204RwXoIwFQd56JmgHgwBkNPhxzRN0EU3Hvuim3lDCue5H8xqzC6F92k7YzMLbBKB7YQOuiYudV8MNAvx0jGD3tV4PnVZj8jmZyN/cQaa8pgVIto6jk51QIGVDX1YLsLYDFVdI3N9i2vsAED6HoddC9rhwTdRrbexaw3QdQ418pNo6htZv49T26mIkyJ43b41OYjmWdg+PVe3imWfZrWO5ERER0cpMCaa8EafdbW8EJGin2xfdSFA0HL1yYfobO9gXXQDXcPx0bP0I7b4GK9RCca6Hvc+uaeISu0AkHe/7vQ0lvOcqJT9KKchrNZJXDHqoXdimiQvAC85cE/rILgK1HRW4uoB+CrwKb104GLUabp5h6/VIz/XYOVk210T9BDgOBVyufYHwbs1xC/cz88/B+aU7/P7w3tBT33+OQ7WP9umquvttnEZGN4BBwNysoR0O/ledN9dEPVIuLsyTaP2ZWHaNA2joohnZMMXbYc4bGK1ie9fvGPDehR63j/fVzVj63eZwgwb38jzUQZA9zdkVuOyIiIiIwqbNA/QWtquiDRcTja9rsjRvMb06slhd0waL7FXNEGt0UU/wd5H1D+F0gkXwo3lIm1cRK/h71dskwrE0Pz/W+BqjsTVdQ46hhTYMGM1LzDlZqmCzgJjX6DqvxLVUGdbARDZN0MQaXaM27f3YfKff4GDUaP6GdcWvU4Y2fvx++Y+v15mUt8Wvu/Hqany5Dd6fuA4u2FjBf419Nvz+lLLSLBme//Dfxa1FmiXNKce/LmUXe66IiIjoMVBERBYeobkm6rVzHDp5PZsqG9fUcbrdWZPpPTZ05QQ7JSuDpStF3cyj7FyY9Rqujws8va0UZUdERESPSbqH9s5qhk0jisGFbdZxhFfFbUjOyDVPcGWcsdE5YnzzguJh2cUrQ9kRERHR47KUYMq+6AL9c5zay3/k7HyCXfWOcLF9ht4atV6rrd5aHc9i+A91Ht1QpWBYdnHKUXZERET0uCxnmh8REREREdGaW840PyIiIiIiojXHYIqIiIiIiCgDBlNEREREREQZMJgiIiIiIiLKgMEUERERERFRBgymiIiIiIiIMmAwRURERERElAGDKSIiIiIiogwYTBEREREREWXAYIqIiIiIiCiD/wM7DM1ZF8kJXgAAAABJRU5ErkJggg==" alt="1548182396033"></p><table><thead><tr><th>Name</th><th>Comment</th></tr></thead><tbody><tr><td><code>torch.nn.Linear</code></td><td>Simple Linear Layer in the neural network <a href="https://pytorch.org/docs/stable/nn.html#linear" target="_blank" title="https://pytorch.org/docs/stable/nn.html#linear" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>torch.nn.Sigmoid</code></td><td>Sigmoid activation function  <a href="https://pytorch.org/docs/stable/nn.html#sigmoid" target="_blank" title="https://pytorch.org/docs/stable/nn.html#sigmoid" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>torch.nn.BCELoss</code></td><td>Binary classification logistic loss <a href="https://pytorch.org/docs/stable/nn.html#bceloss" target="_blank" title="https://pytorch.org/docs/stable/nn.html#bceloss" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr><tr><td><code>torch.optim.SGD</code></td><td>stochastic gradient descent <a href="https://pytorch.org/docs/stable/optim.html#torch.optim.SGD" target="_blank" title="https://pytorch.org/docs/stable/optim.html#torch.optim.SGD" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr></tbody></table><div class="warning custom-block"><p class="custom-block-title">What’s the difference between stochastic gradient descent adn gradient descent?</p><p>Stochastic gradient descent (often shortened to <strong>SGD</strong>) means that you update set parameters in an iterative for each sample one by one. In Gradient Descent you get your whole data to calculate the loss and update your weights. <a href="https://www.quora.com/Whats-the-difference-between-gradient-descent-and-stochastic-gradient-descent" target="_blank" title="https://www.quora.com/Whats-the-difference-between-gradient-descent-and-stochastic-gradient-descent" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>Quora Question</span></a><a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent" target="_blank" title="https://en.wikipedia.org/wiki/Stochastic_gradient_descent" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>wiki</span></a></p></div><h4 id="using-sequential"><a href="#using-sequential" aria-hidden="true" class="header-anchor">#</a> Using Sequential</h4><div class="language-python extra-class"><pre class="language-python"><code>inputSize <span class="token operator">=</span> <span class="token number">2</span>
outputSize <span class="token operator">=</span> <span class="token number">1</span>
hiddenSize <span class="token operator">=</span> <span class="token number">3</span>

model <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
          torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>inputSize<span class="token punctuation">,</span> hiddenSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
          torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Sigmoid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hiddenSize<span class="token punctuation">,</span> outputSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
    	  torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Sigmoid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

<span class="token comment"># define loss function, sinble Binary </span>
loss_fn <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>BCELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

inputSize  <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span>
outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span>
hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span>

<span class="token comment" data-v-54601d22>#define model</span>
model <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Sequential<span class="token punctuation" data-v-54601d22>(</span>
          torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>inputSize<span class="token punctuation" data-v-54601d22>,</span> hiddenSize<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
          torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Sigmoid<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
          torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>hiddenSize<span class="token punctuation" data-v-54601d22>,</span> outputSize<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
    	  torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Sigmoid<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>
        <span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># function for predict</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

<span class="token comment" data-v-54601d22># X, and Y</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span>  torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> X<span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (1 x m)</span>


<span class="token comment" data-v-54601d22># define loss function, sinble Binary </span>
loss_fn <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>BCELoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># define optimizer</span>
<span class="token comment" data-v-54601d22># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>optim<span class="token punctuation" data-v-54601d22>.</span>SGD<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>.</span>parameters<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.1</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss:'</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># print(loss_fn(YHat,Y))</span>
<span class="token keyword" data-v-54601d22>for</span> epoch <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  y_pred <span class="token operator" data-v-54601d22>=</span> model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
  
  L <span class="token operator" data-v-54601d22>=</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>y_pred<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>)</span>
  <span class="token comment" data-v-54601d22># Before the backward pass, use the optimizer object to zero all of the</span>
  <span class="token comment" data-v-54601d22># gradients for the Tensors it will update (which are the learnable weights</span>
  <span class="token comment" data-v-54601d22># of the model)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>zero_grad<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  L<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>step<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss #'</span><span class="token punctuation" data-v-54601d22>,</span>epoch<span class="token punctuation" data-v-54601d22>,</span><span class="token string" data-v-54601d22>': '</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h4 id="using-nn-model"><a href="#using-nn-model" aria-hidden="true" class="header-anchor">#</a> Using nn.Model</h4><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">TwoLayerNet</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>inputSize <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> outputSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> hiddenSize <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">super</span><span class="token punctuation">(</span>TwoLayerNet<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment"># define first layer and second layer</span>
    self<span class="token punctuation">.</span>linear1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>inputSize<span class="token punctuation">,</span> hiddenSize<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>linear2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hiddenSize<span class="token punctuation">,</span> outputSize<span class="token punctuation">)</span>

  <span class="token comment"># calculate the output  </span>
  <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    h <span class="token operator">=</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>linear1<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>linear2<span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#define model</span>
model <span class="token operator">=</span> TwoLayerNet<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># define loss function, sinble Binary </span>
loss_fn <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>BCELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token keyword" data-v-54601d22>import</span> torch
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn <span class="token keyword" data-v-54601d22>as</span> nn
<span class="token keyword" data-v-54601d22>import</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>functional <span class="token keyword" data-v-54601d22>as</span> F

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>TwoLayerNet</span><span class="token punctuation" data-v-54601d22>(</span>nn<span class="token punctuation" data-v-54601d22>.</span>Module<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span>inputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>,</span> outputSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> hiddenSize <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>3</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span>TwoLayerNet<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
    
    <span class="token comment" data-v-54601d22># define first layer and second layer</span>
    self<span class="token punctuation" data-v-54601d22>.</span>linear1 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>inputSize<span class="token punctuation" data-v-54601d22>,</span> hiddenSize<span class="token punctuation" data-v-54601d22>)</span>
    self<span class="token punctuation" data-v-54601d22>.</span>linear2 <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>Linear<span class="token punctuation" data-v-54601d22>(</span>hiddenSize<span class="token punctuation" data-v-54601d22>,</span> outputSize<span class="token punctuation" data-v-54601d22>)</span>

  <span class="token comment" data-v-54601d22># calculate the output  </span>
  <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>forward</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    h <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>linear1<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>return</span> torch<span class="token punctuation" data-v-54601d22>.</span>sigmoid<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>linear2<span class="token punctuation" data-v-54601d22>(</span>h<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>

<span class="token comment" data-v-54601d22># function for predict</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>fun_to_predict</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>1.0</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token number" data-v-54601d22>3</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>2</span><span class="token operator" data-v-54601d22>*</span>x<span class="token punctuation" data-v-54601d22>[</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token number" data-v-54601d22>0.0</span> <span class="token comment" data-v-54601d22>#must be float</span>

<span class="token comment" data-v-54601d22># X, and Y</span>
X <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>randn<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>10</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
Y <span class="token operator" data-v-54601d22>=</span>  torch<span class="token punctuation" data-v-54601d22>.</span>tensor<span class="token punctuation" data-v-54601d22>(</span> <span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>[</span>fun_to_predict<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> X<span class="token punctuation" data-v-54601d22>]</span>   <span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22># (1 x m)</span>

<span class="token comment" data-v-54601d22>#define model</span>
model <span class="token operator" data-v-54601d22>=</span> TwoLayerNet<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># define loss function, sinble Binary </span>
loss_fn <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>nn<span class="token punctuation" data-v-54601d22>.</span>BCELoss<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># define optimizer</span>
<span class="token comment" data-v-54601d22># Implements stochastic gradient descent (optionally with momentum).</span>
optimizer <span class="token operator" data-v-54601d22>=</span> torch<span class="token punctuation" data-v-54601d22>.</span>optim<span class="token punctuation" data-v-54601d22>.</span>SGD<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>.</span>parameters<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>lr<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1e</span><span class="token operator" data-v-54601d22>-</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss:'</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>


<span class="token comment" data-v-54601d22># print(loss_fn(YHat,Y))</span>
<span class="token keyword" data-v-54601d22>for</span> epoch <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
  y_pred <span class="token operator" data-v-54601d22>=</span> model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span>
  
  L <span class="token operator" data-v-54601d22>=</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>y_pred<span class="token punctuation" data-v-54601d22>,</span> Y<span class="token punctuation" data-v-54601d22>)</span>
  <span class="token comment" data-v-54601d22># Before the backward pass, use the optimizer object to zero all of the</span>
  <span class="token comment" data-v-54601d22># gradients for the Tensors it will update (which are the learnable weights</span>
  <span class="token comment" data-v-54601d22># of the model)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>zero_grad<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  L<span class="token punctuation" data-v-54601d22>.</span>backward<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  optimizer<span class="token punctuation" data-v-54601d22>.</span>step<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
  
<span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Loss after #'</span><span class="token punctuation" data-v-54601d22>,</span>epoch<span class="token punctuation" data-v-54601d22>,</span><span class="token string" data-v-54601d22>' epochs: '</span><span class="token punctuation" data-v-54601d22>,</span> loss_fn<span class="token punctuation" data-v-54601d22>(</span>model<span class="token punctuation" data-v-54601d22>(</span>X<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span>Y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>item<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><h2 id="activation-functions"><a href="#activation-functions" aria-hidden="true" class="header-anchor">#</a> Activation Functions <a href="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" target="_blank" title="https://towardsdatascience.com/activation-functions-neural-networks-1cbd9f8d91d6" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Instead of using perceptron with output <code>0 or 1</code>, better is use activation function that return values <code>between 0 and 1</code>. In Deep learning there are couple functions to use as an activation.</p><h3 id="sigmoid-function"><a href="#sigmoid-function" aria-hidden="true" class="header-anchor">#</a> Sigmoid function</h3><p>In sigmoid function the difference is in the activation function.</p><p>Logistic function is:</p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6f42e36c949c94189976ae00853af9a1b618e099" alt="{\displaystyle f(./assets/6f42e36c949c94189976ae00853af9a1b618e099.svg)={\frac {L}{1+e^{-k(x-x_{0})}}}}"></p><p>Sigmoid is a special case when <code>L=1, k=1, and x0 = 0</code>.</p><p><img src="/assets/img/1_Xu7B5y9gp0iL5ooBj7LtWw.07066668.png" alt="img"></p><p><img src="data:image/png;base64,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" alt="1543948420834"></p><div class="sigmoid"><input placeholder="x1" size="mini" value="0.2" class="x1 red"><input placeholder="x2" size="mini" value="0.3" class="x2 green"><input placeholder="x3" size="mini" value="0.8" class="x3 blue"><input placeholder="w1" size="mini" value="0.2" class="w1 red"><input placeholder="w2" size="mini" value="0.3" class="w2 green"><input placeholder="w3" size="mini" value="0.5" class="w3 blue"><input placeholder="b" size="mini" value="0.1" class="b"><input placeholder="w1" size="mini" value="0.2" class="w1a red"><input placeholder="w2" size="mini" value="0.3" class="w2a green"><input placeholder="w3" size="mini" value="0.5" class="w3a blue"><input placeholder="x1" size="mini" value="0.2" class="x1a red"><input placeholder="x2" size="mini" value="0.3" class="x2a green"><input placeholder="x3" size="mini" value="0.8" class="x3a blue"><input readonly="readonly" size="mini" value="0.04" class="m1 red"><input readonly="readonly" size="mini" value="0.09" class="m2 green"><input readonly="readonly" size="mini" value="0.4" class="m3 blue"><input placeholder="b" size="mini" value="0.1" class="mb"><input readonly="readonly" size="mini" value="0.63" class="msum" style="color:green;"><img src="/deepnn/sigmoid.png" alt="Card image cap" width="740" height="578" class="image"><span class="answer">σ = 0.652 </span></div><h4 id="when-use-2"><a href="#when-use-2" aria-hidden="true" class="header-anchor">#</a> When Use?</h4><ul><li>predict the probability of the output. (simple classification for example: ‘dog/cat’).</li></ul><h2 id="pytorch"><a href="#pytorch" aria-hidden="true" class="header-anchor">#</a> PyTorch <a href="https://pytorch.org/" target="_blank" title="https://pytorch.org/" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>WebPage</span></a></h2><p>PyTorch is an optimized tensor library for deep learning using GPUs and CPUs.</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
</code></pre></div><table><thead><tr><th>Command</th><th>Info</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.cuda.is_available()</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATMAAABKCAYAAADXArPjAAANqUlEQVR4nO3dfUwUdxoH8O8SG7q5npegAoYt7lkN2KhXzp6LpY2bSr36wqH4Aq16rPdXbSRUa7ohGrtyELKNJyXa6l91iS8HqAjFl9pqs6Yi4uGtJ00rweqoK7ComxxnsyUlzv0xOzuzs+/vzPp8kk3YefnNbwb22ef5/WZZBcuyLCT4RQqFQrqKEEISxl9sUoiDGcuyFMAIIbIgjVcpvlYQQsh4plAoIC4sUwAKZIQQeRIHNIW3MTNCCJGbFIplhBC5Y1lWGDMjhBA5ozKTEJIUKDMjhCQFCmaEkKRAwYwQkhQomBFCkgIFM0JIUpiQ6A486+x2OwYGBjA2NpborhAiaxTMEmxgYAAqlQrPP/98ortCiKxRmZlgY2NjFMgIiQIKZoSQpEDBjBCSFCiYEUKSAk0AEEJi5t69e2Hvm52dHdL2lJkRQpICBTNCSFKQaTCzo01vQp7W+TjQH7cjPz57XDiu/goex+3I8WRD8zoljFcT3Q8gJn150IwypRLKuu4oNhoP3TAqlVCua4ZNuqZOCaWSe5S1SNf6E/j6ht+2lAX7cyrQMSRaNNSBisoOPIqgVV6Mxsz6sUfbiUOSpRv26rB1TvSO4q+9x2ePo9D4xOs2/DrOVDSa/4y5/MqHV1Cx5iYu+TjGpCWrYVkCoPcc8g5H7VR8u2qEskEN5kgpMuJwOCJPmioHHFVc4Kkfl20/QkdlGX74Ryc2ZYoWZxbhbzk5KPhchb738yLqZ4yC2UxsNc/EVmdQQ5SDmH92tOm/xAVtLjbgpufq3nMoNP4WjebVmAvgxgETyvVXcN6Yj0mwo223FYuO6bB3CrdtXsVxTD+2GiumxKv/JOayStHkKE10L8Kggd7hgD7R3QjDo1O7sA270bl8sse6vPc7sbuyAPuv92HTK+EfIzFlZu855B3odyvZKs7ao9L047Pf4vZ6HfYumeRlrR1thwfxuv5Prkxs7qpcvN5txXcPASANK4yiwDVnOjbgCW4PeWnKjxsHTMjTnsONsM8CQim00AC06qBW8qm+Ed3SbfiHuGx60IwypRHdfGnitTwRrQu4XnTcoPhq27OssbWUSUo+8b5q6FolTV81Cu0qQytBA5ZMkrbDKdl8nbN7W57LbC1lomOXofkBvK8LpzwOeM0i+F27te3eb44Fxz4EdlcVwTOUAcBkFG38AJ8ejKzcTNyYWVMnCu/+ARazDpa9U3HJ+K/IXvxOk5as9pMFPsbt7hew6NU05/N+7FlzE5fCCFgxl1WKJocDjosGoMQExuGAw+GAw6GHBgDQDeMMHfIu8svNMFRrJS8YA7TKeqhvOde36mBy/RF3w6jUwtLIOPd3wCEpZQ0L+X0ZmEoMqA/6hR24bd9saF4n3peBqUTS9gWt0O5FAwwLg3/xaaq4/cw7ffR7oQWmWw5X+01rgy/ubS0m4BOH0G/oUNliA5ABbXEx2tvNojcLBkxrMVYWONt/0AwTGlzHZRoB3UfCm0vG2ibn8uKg++N2XgGumfC7dsC80wBtsAHzQTPKxNfsYh50MyS/j+tX8Onbi7Eg01cjAF7JxwdffY2uCF6HiQtmmlycf28m9/Oc6diA/+H2w3gdnJ9A4ErgxjLgjtUzM7xxoBOHNLkoD7FEnvueDhbxOFwM2FrqYSgxQTefX6KB/qJB8oIBDBebUJrFrdfuBCyMzW3/Bj8vVmFf54vxJyakvvlr26erJujgb18N9FUa4el8LQywgPHIBsLVjpOd4Q1yZ6zVO68XIL1mGWu3wNB6Ema+n1fNMOzcImyfVQq96JwzClaiuJVBcFc8kMDXTPhdA5pFBqDaHNQbhK3zJNDYIJzHfB1MJQaYRZnfI+sPQI7KR1bGexGqt7+GVZbBLGGeYNeaL3F7vQ4Wsw5b59hx+w7we1Wa21aPzx5HedNUNBrz4a1gHRdmqwNkOwZo5wvPNFVCpsH81B7E/uGJZduAe6moVGphiFrLGuhvmYBydXjllqTsV5e3u7Wt3SkEyu4LBhgWiQKMtESdoUM7oieka5alRrD5H/NTO9pd18v7sMD9e18H0dJkqHKAH6zhF5rPWDCbhOka4HX9X0SlKFd6ThelwNxsJ/DxsdhmVxH7nnHLwmyMJehd1S+FU64kvm1bSxm01QaYHaLyOpoH4Mt7hwNMowXaoAMaV/ZDVFpLS0LNIj5z7oa52v2NprtODR1Ewwm3TEEHlEBCvmYPGLSXqKEOsv1i8XCC86EXnduL2YuDaOURrH3Ayyr/+Zs/z1gwS8Mb2hdwyfgt2pwl7eOz/8EhjQpvTOGf84Es/BnMqEwA8LLUKBaXJ05cGeI+BmYqb4ehMrixqYyClSiu1kZ2/xY/8CsZXwmmbb7cxVWjewYjOd/uOi8TAKIXWnedtyyDz3K8DUYHL0Md+q0CeWphDKyyXJJbzdfC0MqAuWqGpVEHjXRnVzZrQ/NH0c3MAl8zng3NDQYUF2uD+jvSLDKgvbzS73WerHoZ6LMGGNy/D+tXi6HyN64WQIyCWT/2aLkxqUMADlVwM5Z7emNzNDe955wzpN6PPWnJapzXA7vWcMsLzSrnbRlcvxuNT8CVoqbxcXNsVikaGgHdDMlMU1Ypmm6ZYFkolA6WRsbtHTFQu+77e78ZM9w++247A6WfiEq5BjXM4gxGcr71LzFug/Xc2JMwu1v/kimEzEyYsdNWw1UeuSZNJDN+yoUWmG7pPYOOVxroGoth4M95BoOVHoP1GugaLdAutAgD//yav5pQXK11lWpMsTgzE0pQdXk7wG/nehPxf17BXDNXv5VqnCxmRBMfAa7ZfL1z0F9cxkqy2Vfy8cFX23Dsup/LF8wkQQAy/RJg7l6y2+vjef+aRO855B3+nSgQhuf69evIzc2NWrcIGU/4D5o/OlWBgm8Wo7PB2+0Zj9BRWQDrRvf7zOiD5oSQcWfy8o+xG9uw65RnsWn5vADbcpoiumEWkHkw40vIhHw2s2Iwbsckiec+Gyh9hHpD8bNoMooamvDyh7s8Ppv5Rd9udEb4USZAtmVm8qAykySzeP4/M/rnjISQmAk1IEVC1mUmIYTwKJgRQpICBTNCSFKgYEYISQoUzBJswoQJ+OWXXxLdDUJkj27NSDC73Y6BgQGMjY0luiuEyBoFM0JIUqAykxCSFCiYEUKSAgUzQkhSoGBGCEkKFMwIIUmBghkhJClQMCOEJAUKZoSQpCDTYDYMa0U6+gqdj4aeuB15pG2jcNyKExiJ25EJIf7EMJj1gCkMP+A8bEhHf9uw321SjcPIOT+MnMpXPdbxQYe55rmfW0AqrIfbF6kPnUC/qN/S/SeuOMgd01gV0vkQQmIrRsGsB0zhUoAPNufPILVjacDgFB1c1mbDcqR6W32tHoP75iLtPNe3tKI62F0Z1jCstaegPDzsClij+o0RfWV8eLpQq1BA4eVReyXefSFEHmISzEbaPsNo0Rmo5/FLXoXaWIWnF77jgsa1ekmJ1gOmkAsafNZk7wCe7psdcmY30qbHmG4YM1dM87J2GFZTHVI2rwP//b5TSvcj5cdTGBkCgHSo9h4Uvoh03htIxWmMhfhFsg8bvGR8IVmA7SwLlmUxeLQEWHMEg87n2/PDbpSQpBaTYDZ69zRSpkn+93dWtiho+MaXcWlFQMrm752ZnfdS0tf+QhCVuoexH5dBmZ/ufN4DZv0mPA0jYCXWEI6u5bK0rr/zWdsqHLU6V1+phWLtUQiXugu14vUAhv65SpTx1aIrvidASNTFIJgNY/QW8NyL6e6LM6fhuegfLEz8BAJXCqcVAb/e9yyBHzYsxeis/UjzGRy9m1I5jJzzW1zZX6zsWKDA7hmDYFkWl6tbse5gkCHpSi2mvvtHXHZlf//Ga27BjxD5iUEwS0fqDC/BYegufsVcpEbw9evRcRo/r5+NMR2X8anneQ++I20bYe+oQtreVZiYoJ4GVH0ZJ97hLuiCt2qA3jtBBaSub3agpms7FjifZ76zDTXHTuBbq9/dCBnXYlJmpk5bhqd3Jd+X9+Aens7K9j4oHzfZmDCLK1+FUpQrPSdkCVuNtG3E4D7gN4djn11FouatBcKT/O1gW95F4PeKIdzp5bI6ocx8DTti2E9C4iEmwWxi/nKkdCwV3dbQA0Zfh1SdKMv58R5GAXAl31Lnz4LUacuECYOoScfERcvwdJ/eNUM50vYZRmctx8RM/jkfyEQTASGKfAIg9mq6uBJTeJzAu6pE94qQ8MXmS4AzV2HmYaB/fTr6nItSjcNCNjRvC9KK0mEvrIMdQKrxDFL1n7k1MXGFESMXZmOwcBMGAaDoTHCTANfq0aevE57ruT7wx5+44iCAjRjk+zZrP6a6Sske2PedBgD8LOq7+zYycewO7gDIxBCOrn0NO1CCIwCATLy5sgRTF9TiTVYoNQmRPVaWbOz9zVPYOz0J7ELPHvbm5uPsf2N8mMGjJSzWHGEH3ZeyR9aArenyvd/larAA96jpuszWoIQ9cl/SLoRtPI9BiLzI9DsAhmGt4Abxfd+GEWPX6tFnypZfxkZIkpLpZzM5o/oEfjZTXMoSQhJOppkZIYS4k3VmRgghvBRKzAghcseyLGVmhJDkkKJQKBLdB0IIiVgKwKVohBAiRyzLch/Lo9lMQkgycBszo7hGCJELabxy+2ymQqFwbUBjaYSQ8chXjPo/uQSnxWUWYkgAAAAASUVORK5CYII=" alt="1543956014633" data-v-336f4fea></code></span></td><td>Is CUDA Available (<code>On CPU returns False</code>)</td></tr><tr><td><code>torch.backends.cudnn.enabled</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543956000527" data-v-336f4fea></code></span></td><td>Is CUDA® Deep Neural Network library Available (used by fast.ai, <code>On CPU returns False</code>)</td></tr><tr><td><code>torch.cuda.device_count()</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955982482" data-v-336f4fea></code></span></td><td>Number of GPUs</td></tr><tr><td><code>torch.cuda.get_device_name(device)</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVsAAABCCAYAAAD5YXUKAAAQxklEQVR4nO2df2wTZ5rHv87CBl9byoIgRKQwYZODSrRVuhwmsAiLclot266Ls4CXlIvRaaWrBIqCTmdFsLkpBCGfKqKIVlRardZRSZoECHGrboWUVIMWEpwD3AJSS4HN0PwOh5eycC40x9wf88Mz47Fjh/EYw/ORRornnfd533d+fOd5n+eNbRMEQYAOeZfNZtMXEQRBEAlIpp3T9AfabDYSWQuIRCIYHh7GxMREtrtCEEQGmDFjBhiGwYwZMwCoxFYWWsIahoeHUVRUpFwIgiCePARBwMOHD5GXl4c8eQcJrbVMTEyQ0BLEE47NZsODBw8AQBRbElqCIIjMMTExgTyD/BhBEARhIoIgiJ4tQRAEkTkePnyIPAohEARBZBbybAmCICxi2uSHEE8bP/xfbO3v9B9Ni/tMEET65J5ne+kkypwBaTuGzptWNXwVB5V2Azh4yap2LabPj5n/chyRH01ThHa69LflQtvnh72yDWPWtppxQgfs8LSbO6rQATvsdg/ahkw1mxOMfeOB/ctQWnVCX9rhH8xQhxJgutje+uyYSgylzXcWt8xsxLEUXZwXYe43eHOuvlASRcM2tYK587OIofmLHxgJail2cV6EuV/jPx1mDSQZY2irtMPfZ0VbxOTQ9XgsGfSDGS8D94ruobzsh73RLm0etOnebY5FAYR5D9puW9dV08V2zi9/gzDnRZfv2Zgo+ldijtkNGXHpJMqcf8Vi37MGhRF0+s6g3/drhDkvwkeXAv6P4z3USydR1V+IbZYIKkGYg6M2imi0FVsWZLsnVhKCn2fBMj5oHtexNni6wwh4oohWR8G/Anhb/dD4vrO2oJUpg/cb62ZOFocRIuj0HUPnTbWHeRIXTbF9FQePPI8u7hdYY1R86b/xTqgQv/vlbPHz3JX4nQf48MxVrY2dI9j21j9h8VS6cPMsdibxmFNFnBIy8HYA7Fo77HZxU089xWPkTTt9lKepY+0e5Ri9R6YuMyrnpXIAaU95E9qOCwuE4Nf1XVN3Lau3jLZK1bjTDDFoz5n+nOpsHwjp6iW/HpOcEY1t5964nsGfpE/adnT7htrgUerqBEWmz59gzPqydMIQY2ir9KBtSN13ffvaccXOqVS33a/sl69N7D5MfD2UI75pAPscB1+Rdn+ox4vgwhpsKRA/FzhrwIIFd1lnoMiLALwIWBROyELM9i7e2fQlFh+Vp+Qj+MMjipNIKXYl8aBvDf4d8CzGy/Lnz46hqhVA/y0l3HDxgzP40LMau14yoTuPgOil8Ai4AfZUFNGouLVuFu+esXYPnJcD4KX9fBPgLdHe6MEqBsz1GqncBbYxJkxj7R4wVWXgojHbvhWqyh1eOKW6oq2A8UNswKS2k9Hn19Y9pRXbsfYA8F+yXR4BeFGdquD1+eHcy0q2xXOLOk45p6EDDLzLuJjty05FlCa7HpOhtR0FV6cZFdoqnQg38VI5h7IqRhKdAjhdLgSDnOqlwoPvcGHjaqntBVvQGo0iei0AV4Jx29eGEbhm0O+hNnjUZafK4u6j5AThLWkAc00+PywaNA4BB6dyH3Bg9zpVYhqEN8iAvxaAa68TDT/lxfu0O2RwzrTXQz5v3O0g2Dn6KegY+NsAW+pQPrf9yQkWQPh/9PdKAZyzXGBvpRfvnSpZSZBtOyTHWmdjjfNZnL5hakQ3OVKCbT1XhK6jS/Hz0HcYAoCbZ/GH1kI0/Vvp1G3PXYlDnBeHZO85I4QQqAqCrd4C+VEv2NyIgJsFp/ZO3QHwteINV7B6I1wdPHh1/VO6qReM6wIAizD4lDyeFGwnZAxtjWzSugWbfappsiRE1/mUrIe6WaDOKdkW6+IyL4lYCNxeFpwy5gJsqWZ1IjdFhtrQoLGtL+dwAgE0KsLtgFclOgWba8B2nAAnn/8+DmxdTYrhAvGcupoaDY8fO3MCUJet8MbfR5PAnpJDF/HXw1GrvpYOOOuAMB87o7F7mEWN5sWVyvXgwT9wgTGKGMpWTthhb2RwopgH/4oLwb/F3ysF/1AG3OctCSXk3mqER6H1DMqOPB+LI49+h9OO57EAEXS++zWKD/1C8Xwfb1xgJnnYXC6nIsai9yPd+EM8winUnxKZtA3opsx2MFXBlKsyP3UBeznJaxsDFwzGztEQjzBYONVT3rgQRoYY4hHs8IJJOC4HnHVBnDgjvRa6WbCvpfoq48F3AGWMsQfOXw8iWMWowghiqMQ0dOGL+PBJAlK5Hrd5hJOYYLvtaPgJj2h1FK3OAvB/C8L1Eyb+wGcZuB7IjkhmeWoWTc4peg7Ac2hShRpuDf4dKF6MOTe/QXcIOB0K4EN1pVAAHzqWosuqBF/KBEVPUxE18aFCdQpVFzAoy1S3MmkbIfhLvEATj6gqnMJcT612AVMGgIXTLj207gB4jTfFgotOxSM3AXcAfHNspqLH8RqLYCOHsc0MuL0snLWpGmbAuJFUSFxNfMrhkLQYaoNnLQv2VCyMFDpgR0PKBia5HrMS3WsFYGYBmMWh1SmPSwwtlJUajPMuj+CPGTSm3K+p8/R4ti8txjaMoOoDOSF2FU3+u9i2ulSZ/oeVTVzete1QmispTEqQiRSAWQZlOhlDnI5pY7ANYN0BeFOKjYqekvc/HiULKycv9AmVFGwr4QwxVhnzV3TjlR5WPYqXNtSGaiPPts9vkFCRQxSxuGVULW4LnNjoZuE0SMLESHQ9JmEBgzLEpuZj7R6th7fCCbZjktjzCifYDh58H4dwkzeNF4I4tWfXGsdhHa+xCFZVZ3BtrmqW0+dP3bNN6XowYH4cBH83vsRRygLfOuGXE2KXA/DeYeFcFn/s2P+GgXwm4YvOTDK2zna9/y4Q+hrrM7HO1pAIOn2BJG2XYhe3Gttaz0irIM4Ah7xZT4Ylw1ErJhX0WWRHbRTcstjUk6kqA5fEM4q3q61vtBph6n1OYnuFD1ydPD1kwFdzYDV1VeMt4VGjSfpIsUx5NUAJj41NhikhA8SYn3olgXY1QwG2NItJmIRZe33/Ul6N4IDvVKxt5noNeE2/HfBJSbHEq0Mc8DaF4VwbjiXGJJTVGyVeBJWpd0xcCza3gm8Ka6bkSr9X+KSkmPq8pJMgS8KCLaipC8ZsNzII1E1eTep1CtdDSm4NG7zYl/kQfY0F2y2ts+0GuGojLzlRki0z2Ix+g+yx5tJJMe6atal9BJ2+j/HXtx5NqL/44gssXbrUvG5lCPk/yHKbMbRVMuCr1SsjxH0nXBmaRhMWEIL/tBNgonHLv1Ji0A/7MAN+ReqOyqPw9IQRiKcYKaatZojDiSTJIyIXcMDHsGD5KXjjt9vg4cMI/KM1QgvkqtjKIYKsfDfCx3jHmmV5hGlop/LytLvsVBprgBOg/wcO7Za731Vg9A8gpocazKDIB35eGM50vxvhhhdlTCu2zMpQvwzIvTDCEwKFEQji6YKeIiIO+opFgjAfenKIOPSCSgJLEI9ObsZsCYIgcgwSW4IgCAsgsSUIgrAAEtssMW3aNHz//ffZ7gZBEBZBS7+yRCQSwfDwMCYmJiY/mCCInIfEliAIwgIojEAQBGEBJLYEQRAWQGJLEARhASS2BEEQFkBiSxAEYQEktgRBEBZAYksQBGEBJLYEQRAWkHtie74BV9bPk7btGBy1quFz4JV254E/b1W7BEE8CWREbO90bp+6II4ex9X1DUj6azcvHkZh1ziWdP0JRfP1hZIo7jyOO3EVtYJ5tXPc0PzNRiNBXQ6maxxLui7jmRfTGM+U6cV+mw0VH1n2NlHatNlssNkq0DJoYdOmkI1zRhCpYbrY3uncjpHu1yUxHEfhDuDeW5OIp1mcb8CV9X/BtB2/Migcx+DODfhhx2Us6RrHkiOHgfeWxXuo5xsQuVaLfEsENV3UYqjd9p81w345dgsCBKEH9WaYUzH6UQVsm1ugyODZ/XH97t2XbEyjaNmsKt/Xa3IPCSKzmCy25xB5D3hmdwVmSntmvunHMy8ewL3zgCh4Wo/xTud2XGk8B8XrfOttPMQBRNL2jM+BDyxEYVeN0raG882491UtZr05T/w8vwKz3gDunz6nteE7gHxv5dR+wmL0OK4m8ZinwqvFatddFkMBIy1uYFMzRqTPu1ea1qQF9GJ/+R7U98b6PfpRBVahB4I0HqG3HnvK90OW1N59hah8SS7vQX3dqoQerPacEcTjgbliO3oDP+Bl5Gvu9XnIL9GLmhHSNP3IYeShFrMlz9g4VJCg/qEKY6EFcGfgIvDGGsyVP3duR+QTANduKOGGm40bcP+NP4P5WSrtZRpRWNMX0ck8QJ13rPY2U7H+UYXK+5xaqKF33ypcaBnRjK3/WgfcJcWxHUXFcMt/D7bg3To3mreXSzvK8a8tbnSc+FzX96meM4LIPOaK7dC3ePjiQuTrducvMprWZwkpwTbS/ToKjxxG3lff4j4AjB7H7U9qMbt6+dRtz69Aadc4SmXvOQtoPcARNF/SeoCy0CkeZPtWpOwHDrbgj3hfqTvSAlTuSk+scXY/VqEHx3+rbbX8n+vRsbVQCh2MomVXJTr2rkM5AAz2o2NTBdYVxWwUbu0AjvajP522CSKLmCu2CxbGxEvF/RufIm/RQlObmhKfbMCVwEIxnnyoAjOVl8M4Bve/jen+GsXzzU168XldPXp+L3uA87F1V32cBxjvEaZI0VbsVonk/DUVcKcjeEcrUVgOVf9UrNwNQegBym2w2QpxfOMIBP1xgy2osNlgKwd6hB7U4wL6cy6JRzytmCu28xdhOi7ivuZJHsf9a8D0F7Ln7QHAzBdeBlCL2apQw52Bi0DJIswc/QuiXwH3fXKceBnuyZ8NVzU8pgz24wL2YJU6TFC+R3NI+e9H0IxKFE4psaYLUbxQiY50qm9qRk/LBawySm6d3Q+b7V0UD4gx2Ve3FmpDHEcrUfhCP/5dECAIu1E+2I8LeBXFRfGmCOJxxOQE2XI888anuLc/JlB3On24h8OYrYqD/jAgJZDON2DkvU+1JuYvwnTICTUT+dka5OMAIo1y7PgcIu99ivyfL1em/0uUTVzele+XPOBU28hAgix96tEjhwgMQwXzsbVd2j/QjAvlqQtu775CVCKWlBMGmmNx1RQp/u37caENYBQtB/fA3fI+thYBYuy1B/VHK/HHs5Dit240D+yG4usO9qNjUzGK9Q0QxGOK6Uu/5laPY3bJ2xiRVhOMdL+OQkWw5qFot7jk6sr6ebgSWIjZccu0loPx16q8zFRXI4grHa6snycK+FdSHxTPdDmYrj8j/5MNkt0NgH/8MUmGmUTROlRs2mPsORoeX4xX023jpWJJuKW4arr1MR9b20XPVS/yHddUAYmzn2MP3KLnWrQOFZs6VPFhSZw3rks93kwQ2UbINc4dFL7ecUz4LmsdGBMGdswV+s9lrQOCIAjCSItbwKZmYSS+RGjeBAGIbe4W+ageoR6JygRB6K3XlImbW2gekMoHmgW3qqy+pVlwo17omUp/pbYS903VrsG4NP0miBwg936D7HyDmORKZ3pvKuMY3LkME94nzCsmCCKj5N53IwCxEEFWvhtBTJ4RBEGkQ+55tgRBEDlIbnq2BEEQOQaJLUEQhAWQ2BIEQVgAiS1BEIQFkNgSBEFYQB4tRiAIgsgsgiCQZ0sQBGEFeTabLdt9IAiCeOLJA0QXlyAIgjAfQRDErySl/yAjCILIPJqYLekuQRCEOej1VPMjsjabTTmAYrkEQRDpk0hD/x8d+6pt17CiMAAAAABJRU5ErkJggg==" alt="1543955759448" data-v-336f4fea></code></span></td><td>Gets the name of a device number</td></tr><tr><td><code>torch.cuda.set_device(device)</code></td><td><span class="header" data-v-336f4fea><span class="badge tip top badge-code" data-v-336f4fea>#</span><code class="tooltip" style="left:20;top:20;" data-v-336f4fea><img src="data:image/png;base64,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" alt="1543955961561" data-v-336f4fea></code></span></td><td>Set the current GPU device</td></tr></tbody></table><h2 id="fast-ai"><a href="#fast-ai" aria-hidden="true" class="header-anchor">#</a> fast.ai <a href="https://github.com/fastai/fastai" target="_blank" title="https://github.com/fastai/fastai" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>github</span></a></h2><p>Fast.ai is a very popular library for deep learning based on the PyTorch. The library simplifies training fast and accurate neural nets using modern best practices. fast.ai doesn’t replace any base functionality from the PyTorch. It adds a lot of functions that can help you build a model faster.</p><div class="warning custom-block"><p class="custom-block-title">Version 0.7 and 1.0</p><p>Version 1.0 has completely different naming convention that is used in the below  sections and current available tutorial from 2018.  Below instructions are based on the version 0.7 and wouldn’t work with the installation from conda on the githup page.</p><p>I will update all examples to the new version from the beginning of 2019.</p></div><h3 id="installation-v-0-7"><a href="#installation-v-0-7" aria-hidden="true" class="header-anchor">#</a> installation (v 0.7)</h3><p>You can install fast.ai from the pip <code>pip install fastai==0.7.0</code> like in the google colab, but this is not the latest available version in the github.</p><p><span class="red" data-v-9e33b382>Requires Python &gt;=3.6</span> (<code>python --version</code>)</p><h4 id="linux-gpu-from-the-sources"><a href="#linux-gpu-from-the-sources" aria-hidden="true" class="header-anchor">#</a><strong>Linux GPU from the sources</strong></h4><p><a href="https://github.com/fastai/fastai/tree/master/old" target="_blank" rel="noopener noreferrer">https://github.com/fastai/fastai/tree/master/old<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><ol><li>clone git fastai repository</li></ol><div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">git</span> clone https://github.com/fastai/fastai.git
</code></pre></div><ol><li>Move into root folder</li></ol><div class="language-python extra-class"><pre class="language-python"><code>cd fastai
</code></pre></div><ol><li>Set up Python environment:</li></ol><div class="language-python extra-class"><pre class="language-python"><code>conda env update
</code></pre></div><ol><li>Activate Python environment</li></ol><div class="language-python extra-class"><pre class="language-python"><code>conda activate fastai
</code></pre></div><ol><li>If you want to run youpyter lab on the ssh. Run in the activate <code>fastai</code></li></ol><p><img src="/assets/img/1544123170872.afd10f68.png" alt="1544123170872"></p><p>Make sure that you have environment set to the <code>fastai</code>.</p><p><img src="data:image/png;base64,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" alt="1544123239627"></p><div class="tip custom-block"><p class="custom-block-title">running jupyter for the ssh</p><p>For run the notebook in the ssh please first on the ssh console run jupyter notebook</p><div class="language-bash extra-class"><pre class="language-bash"><code>ipython notebook --no-browser --port<span class="token operator">=</span>8002
</code></pre></div><p>Next on the local machine run ssh tunneling  (<code>localhost:8002</code> is local port, <code>localhost:8002</code> port run on the ipython notebook ,  <code>user</code> - user name, <code>ip_adress</code> - ip address for the ssh). You can set up both at the same port.</p><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ssh</span> -N -f -L localhost:8002:localhost:8002 user@ip_adress
</code></pre></div><p>next go to the selected (and replace running port <code>8000</code> with your local port <code>8002</code>)</p><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>I 11:59:16.597 NotebookApp<span class="token punctuation">]</span> The Jupyter Notebook is running at:
http://localhost:8000/?token<span class="token operator">=</span>c8de56fa4deed24899803e93c227592aef6538f93025fe01
</code></pre></div><p><img src="/assets/img/1544123827545.f14d43c0.png" alt="1544123827545"></p></div><ol><li>If you want to use in your own folder for the project you have to setup path to the old <code>fastai</code> library. In your notebook. For every new python script, or jupyter you have to add before import:</li></ol><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> sys
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">&quot;../fastai/old/&quot;</span><span class="token punctuation">)</span> <span class="token comment"># go to the old fastai folder</span>
</code></pre></div><p>Where <code>&quot;../fastai/old/&quot;</code> is path to the old folder of the fastai github library.</p><h4 id="using-pip-or-google-colab"><a href="#using-pip-or-google-colab" aria-hidden="true" class="header-anchor">#</a><strong>Using pip, or  Google COLAB :</strong></h4><p>Make sure that before you install everything change your Hardware Accelerator to <strong>GPU</strong>.</p><p><img src="/assets/img/1544122222151.9f80fa10.png" alt="1544122222151"></p><p><img src="/assets/img/1544122153030.406b00ac.png" alt="1544122153030"></p><div class="language-python extra-class"><pre class="language-python"><code>!pip install fastai<span class="token operator">==</span><span class="token number">0.7</span><span class="token number">.0</span>
<span class="token comment"># New version of torchtext returns this error: </span>
<span class="token comment"># AttributeError: module ‘torch’ has no attribute ‘float32’</span>
!pip install torchtext<span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.3</span> 
</code></pre></div><h4 id="additional-required-packackes-when-there-is-an-error-of-missed-package"><a href="#additional-required-packackes-when-there-is-an-error-of-missed-package" aria-hidden="true" class="header-anchor">#</a> Additional Required packackes (when there is an error of missed package) : <a href="https://medium.com/@GuruAtWork/fast-ai-lesson-1-7fc38e978d37" target="_blank" title="https://medium.com/@GuruAtWork/fast-ai-lesson-1-7fc38e978d37" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h4><p>This is happen when you don’t install by pip, or by <code>conda env update</code> command.</p><div class="language- extra-class"><pre class="language-text"><code>conda install -c anaconda bcolz
conda update -n base conda
pip install opencv-python
pip install graphviz
pip install sklearn_pandas
pip install isoweek
</code></pre></div><h3 id="libraries"><a href="#libraries" aria-hidden="true" class="header-anchor">#</a> Libraries</h3><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>imports <span class="token keyword">import</span> <span class="token operator">*</span>	<span class="token comment"># Import library</span>

<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>conv_learner <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>model <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>dataset <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>sgdr <span class="token keyword">import</span> <span class="token operator">*</span>	
<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>plots <span class="token keyword">import</span> <span class="token operator">*</span>
</code></pre></div><h2 id="fast-ai-help-functions"><a href="#fast-ai-help-functions" aria-hidden="true" class="header-anchor">#</a> fast.ai / Help functions</h2><h3 id="show-img"><a href="#show-img" aria-hidden="true" class="header-anchor">#</a> show_img</h3><p>Show images from the model dataset. Denormilze the image before.</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><strong>ims</strong></td><td>images dataset</td></tr><tr><td><strong>idx</strong></td><td>index of the image</td></tr><tr><td><strong>figsize</strong></td><td>figure size</td></tr><tr><td><strong>denorm</strong></td><td>denormalization function</td></tr><tr><td><strong>ax</strong></td><td>a</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">show_img</span><span class="token punctuation">(</span>ims<span class="token punctuation">,</span> idx<span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> denorm<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ax<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> ax <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span> fig<span class="token punctuation">,</span>ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span>figsize<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">not</span> denorm <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span> ims <span class="token operator">=</span> denorm<span class="token punctuation">(</span>ims<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>      ims <span class="token operator">=</span> np<span class="token punctuation">.</span>rollaxis<span class="token punctuation">(</span>to_np<span class="token punctuation">(</span>ims<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>ims<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="example"><a href="#example" aria-hidden="true" class="header-anchor">#</a> Example:</h4><div class="language-python extra-class"><pre class="language-python"><code>fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>md<span class="token punctuation">.</span>aug_dl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    show_img<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> denorm<span class="token operator">=</span> md<span class="token punctuation">.</span>val_ds<span class="token punctuation">.</span>denorm<span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">.</span>flat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token comment" data-v-54601d22># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>&quot;../fastai/old/&quot;</span>
FNAMES_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'../data/dogscats/valid/cats/'</span>
FNAME <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'cat.2209.jpg'</span>

<span class="token comment" data-v-54601d22># IMPORTS</span>
<span class="token keyword" data-v-54601d22>import</span> sys
<span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> cv2


<span class="token comment" data-v-54601d22># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>append<span class="token punctuation" data-v-54601d22>(</span>FASTAI_PATH<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># go to parent dir</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>transforms <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>conv_learner <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22># ARCHITECTURE</span>
arch <span class="token operator" data-v-54601d22>=</span> resnet34
sz <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>256</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span> 

<span class="token comment" data-v-54601d22># HELP FUNCTIONS/CLASSES</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>show_img</span><span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>,</span> idx<span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> denorm<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>,</span> ax<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>if</span> ax <span class="token keyword" data-v-54601d22>is</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>:</span> fig<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>figsize<span class="token operator" data-v-54601d22>=</span>figsize<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>if</span> <span class="token operator" data-v-54601d22>not</span> denorm <span class="token keyword" data-v-54601d22>is</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>:</span> ims <span class="token operator" data-v-54601d22>=</span> denorm<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>else</span><span class="token punctuation" data-v-54601d22>:</span>      ims <span class="token operator" data-v-54601d22>=</span> np<span class="token punctuation" data-v-54601d22>.</span>rollaxis<span class="token punctuation" data-v-54601d22>(</span>to_np<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>)</span>
    ax<span class="token punctuation" data-v-54601d22>.</span>imshow<span class="token punctuation" data-v-54601d22>(</span>np<span class="token punctuation" data-v-54601d22>.</span>clip<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span>idx<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
    ax<span class="token punctuation" data-v-54601d22>.</span>axis<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'off'</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>MatchedFilesDataset</span><span class="token punctuation" data-v-54601d22>(</span>FilesDataset<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># LOADER FOR THE IMAGES</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> fnames<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> transform<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        self<span class="token punctuation" data-v-54601d22>.</span>y<span class="token operator" data-v-54601d22>=</span>y
        <span class="token keyword" data-v-54601d22>assert</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>==</span><span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>,</span> transform<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_y</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> i<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> open_image<span class="token punctuation" data-v-54601d22>(</span>os<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>join<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>y<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_c</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>0</span>

<span class="token comment" data-v-54601d22># MAIN CODE</span>
aug_tfms <span class="token operator" data-v-54601d22>=</span> RandomLighting<span class="token punctuation" data-v-54601d22>(</span>b<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span> c<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> tfm_y<span class="token operator" data-v-54601d22>=</span>TfmType<span class="token punctuation" data-v-54601d22>.</span>NO<span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># RESULTS</span>
tfms <span class="token operator" data-v-54601d22>=</span> tfms_from_model<span class="token punctuation" data-v-54601d22>(</span>arch<span class="token punctuation" data-v-54601d22>,</span> sz<span class="token punctuation" data-v-54601d22>,</span> aug_tfms<span class="token operator" data-v-54601d22>=</span>aug_tfms<span class="token punctuation" data-v-54601d22>)</span>
datasets <span class="token operator" data-v-54601d22>=</span> ImageData<span class="token punctuation" data-v-54601d22>.</span>get_ds<span class="token punctuation" data-v-54601d22>(</span>MatchedFilesDataset<span class="token punctuation" data-v-54601d22>,</span> 
                            <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                            <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                            tfms<span class="token punctuation" data-v-54601d22>,</span> path<span class="token operator" data-v-54601d22>=</span>FNAMES_PATH<span class="token punctuation" data-v-54601d22>)</span>
md <span class="token operator" data-v-54601d22>=</span> ImageData<span class="token punctuation" data-v-54601d22>(</span>FNAMES_PATH<span class="token punctuation" data-v-54601d22>,</span> datasets<span class="token punctuation" data-v-54601d22>,</span> bs<span class="token punctuation" data-v-54601d22>,</span> num_workers<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>,</span> classes<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#only for tests</span>

<span class="token comment" data-v-54601d22># SHOW IMAGES</span>
fig<span class="token punctuation" data-v-54601d22>,</span> axes <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>18</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token builtin" data-v-54601d22>next</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>iter</span><span class="token punctuation" data-v-54601d22>(</span>md<span class="token punctuation" data-v-54601d22>.</span>aug_dl<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> i <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    show_img<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span> denorm<span class="token operator" data-v-54601d22>=</span> md<span class="token punctuation" data-v-54601d22>.</span>val_ds<span class="token punctuation" data-v-54601d22>.</span>denorm<span class="token punctuation" data-v-54601d22>,</span> ax<span class="token operator" data-v-54601d22>=</span>axes<span class="token punctuation" data-v-54601d22>.</span>flat<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544343317278.f7fc2c7f.png" alt="1544343317278"></p><h2 id="fast-ai-transforms-data"><a href="#fast-ai-transforms-data" aria-hidden="true" class="header-anchor">#</a> fast.ai / Transforms Data<a href="https://becominghuman.ai/data-augmentation-using-fastai-aefa88ca03f1" target="_blank" title="https://becominghuman.ai/data-augmentation-using-fastai-aefa88ca03f1" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h2><p>Group of functions that changes your data without changing the meaning of the data. Usefull to test your model when you want to add some data augmentation. For example little zoom on the image, flip the image,  rotate in a small range).</p><h3 id="tfms-from-model"><a href="#tfms-from-model" aria-hidden="true" class="header-anchor">#</a> tfms_from_model</h3><p>Returns separate transformers of images for training and validation.</p><div class="language-python extra-class"><pre class="language-python"><code>sz <span class="token operator">=</span> <span class="token number">224</span>
tfms <span class="token operator">=</span> tfms_from_model<span class="token punctuation">(</span>resnet34<span class="token punctuation">,</span> sz<span class="token punctuation">,</span> aug_tfms<span class="token operator">=</span>transforms_side_on<span class="token punctuation">,</span> max_zoom<span class="token operator">=</span><span class="token number">1.1</span><span class="token punctuation">)</span>
</code></pre></div><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>f_model</strong></td><td>Model used in the network (required), becuase different models normalize data in different ways.</td></tr><tr><td><strong>sz</strong></td><td>size of the image to be cropped (224x224). Image must be cropped to be square before any further analysis.  If your image is wide or tall the crop could miss your data.</td></tr><tr><td><strong>aug_tfms</strong></td><td>Augmentation used in your source image, (as list)</td></tr><tr><td><strong>max_zoom</strong></td><td>Maximum zoom used in the image</td></tr></tbody></table><h3 id="tfmtype"><a href="#tfmtype" aria-hidden="true" class="header-anchor">#</a> TfmType</h3><p>Parametr for transformation. type of transform</p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><strong>TfmType.NO</strong></td><td>the <strong>default</strong>, y does not get transformed when x is transformed.</td></tr><tr><td><strong>TfmType.PIXEL</strong></td><td>x and y are images and should be transformed in the same way. Example: image segmentation</td></tr><tr><td><strong>TfmType.COORD</strong></td><td>y are coordinates (i.e bounding boxes)</td></tr><tr><td><strong>TfmType.CLASS</strong></td><td>y are class labels (same behaviour as PIXEL, except no normalization)</td></tr></tbody></table><h3 id="randomrotate"><a href="#randomrotate" aria-hidden="true" class="header-anchor">#</a> RandomRotate</h3><p>Class for random rotation</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>deg</strong></td><td>degree of rotation</td></tr><tr><td><strong>p</strong></td><td>probability of rotation</td></tr><tr><td><strong>mode</strong></td><td>Flag defining what kind of border to be added. It can be following types<a href="https://docs.opencv.org/3.0-beta/doc/py_tutorials/py_core/py_basic_ops/py_basic_ops.html" target="_blank" title="https://docs.opencv.org/3.0-beta/doc/py_tutorials/py_core/py_basic_ops/py_basic_ops.html" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a><br>- <strong>cv2.BORDER_CONSTANT</strong> - Adds a constant colored border. The value should be given as next argument.<br>- <strong>cv2.BORDER_REFLECT</strong> - Border will be mirror reflection of the border elements, like this : fedcba<br>- <strong>cv2.BORDER_REFLECT_101</strong> or <strong>cv2.BORDER_DEFAULT</strong> - Same as above, but with a slight change, like this : gfedcb<br>- <strong>cv2.BORDER_REPLICATE</strong> - Last element is replicated throughout, like this: aaaaaa<br>- <strong>cv2.BORDER_WRAP</strong> - Can’t explain, it will look like this : cdefgh</td></tr><tr><td><strong>tfm_y</strong></td><td>Type of transformation.</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>aug_tfms <span class="token operator">=</span> RandomRotate<span class="token punctuation">(</span>deg<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> mode <span class="token operator">=</span> cv2<span class="token punctuation">.</span>BORDER_REFLECT<span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token comment" data-v-54601d22># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>&quot;../fastai/old/&quot;</span>
FNAMES_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'../data/dogscats/valid/cats/'</span>
FNAME <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'cat.2209.jpg'</span>

<span class="token comment" data-v-54601d22># IMPORTS</span>
<span class="token keyword" data-v-54601d22>import</span> sys
<span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> cv2


<span class="token comment" data-v-54601d22># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>append<span class="token punctuation" data-v-54601d22>(</span>FASTAI_PATH<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># go to parent dir</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>transforms <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>conv_learner <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22># ARCHITECTURE</span>
arch <span class="token operator" data-v-54601d22>=</span> resnet34
sz <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>256</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span> 

<span class="token comment" data-v-54601d22># HELP FUNCTIONS/CLASSES</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>show_img</span><span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>,</span> idx<span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> denorm<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>,</span> ax<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>if</span> ax <span class="token keyword" data-v-54601d22>is</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>:</span> fig<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>figsize<span class="token operator" data-v-54601d22>=</span>figsize<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>if</span> <span class="token operator" data-v-54601d22>not</span> denorm <span class="token keyword" data-v-54601d22>is</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>:</span> ims <span class="token operator" data-v-54601d22>=</span> denorm<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>else</span><span class="token punctuation" data-v-54601d22>:</span>      ims <span class="token operator" data-v-54601d22>=</span> np<span class="token punctuation" data-v-54601d22>.</span>rollaxis<span class="token punctuation" data-v-54601d22>(</span>to_np<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>)</span>
    ax<span class="token punctuation" data-v-54601d22>.</span>imshow<span class="token punctuation" data-v-54601d22>(</span>np<span class="token punctuation" data-v-54601d22>.</span>clip<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span>idx<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
    ax<span class="token punctuation" data-v-54601d22>.</span>axis<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'off'</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>MatchedFilesDataset</span><span class="token punctuation" data-v-54601d22>(</span>FilesDataset<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># LOADER FOR THE IMAGES</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> fnames<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> transform<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        self<span class="token punctuation" data-v-54601d22>.</span>y<span class="token operator" data-v-54601d22>=</span>y
        <span class="token keyword" data-v-54601d22>assert</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>==</span><span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>,</span> transform<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_y</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> i<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> open_image<span class="token punctuation" data-v-54601d22>(</span>os<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>join<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>y<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_c</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>0</span>

<span class="token comment" data-v-54601d22># MAIN CODE</span>
aug_tfms <span class="token operator" data-v-54601d22>=</span> RandomRotate<span class="token punctuation" data-v-54601d22>(</span>deg<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>120</span><span class="token punctuation" data-v-54601d22>,</span>p<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>50</span><span class="token punctuation" data-v-54601d22>,</span> mode <span class="token operator" data-v-54601d22>=</span> cv2<span class="token punctuation" data-v-54601d22>.</span>BORDER_REFLECT<span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># RESULTS</span>
tfms <span class="token operator" data-v-54601d22>=</span> tfms_from_model<span class="token punctuation" data-v-54601d22>(</span>arch<span class="token punctuation" data-v-54601d22>,</span> sz<span class="token punctuation" data-v-54601d22>,</span> aug_tfms<span class="token operator" data-v-54601d22>=</span>aug_tfms<span class="token punctuation" data-v-54601d22>)</span>
datasets <span class="token operator" data-v-54601d22>=</span> ImageData<span class="token punctuation" data-v-54601d22>.</span>get_ds<span class="token punctuation" data-v-54601d22>(</span>MatchedFilesDataset<span class="token punctuation" data-v-54601d22>,</span> 
                            <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                            <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                            tfms<span class="token punctuation" data-v-54601d22>,</span> path<span class="token operator" data-v-54601d22>=</span>FNAMES_PATH<span class="token punctuation" data-v-54601d22>)</span>
md <span class="token operator" data-v-54601d22>=</span> ImageData<span class="token punctuation" data-v-54601d22>(</span>FNAMES_PATH<span class="token punctuation" data-v-54601d22>,</span> datasets<span class="token punctuation" data-v-54601d22>,</span> bs<span class="token punctuation" data-v-54601d22>,</span> num_workers<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>,</span> classes<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#only for tests</span>

<span class="token comment" data-v-54601d22># SHOW IMAGES</span>
fig<span class="token punctuation" data-v-54601d22>,</span> axes <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>18</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token builtin" data-v-54601d22>next</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>iter</span><span class="token punctuation" data-v-54601d22>(</span>md<span class="token punctuation" data-v-54601d22>.</span>aug_dl<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> i <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    show_img<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span> denorm<span class="token operator" data-v-54601d22>=</span> md<span class="token punctuation" data-v-54601d22>.</span>val_ds<span class="token punctuation" data-v-54601d22>.</span>denorm<span class="token punctuation" data-v-54601d22>,</span> ax<span class="token operator" data-v-54601d22>=</span>axes<span class="token punctuation" data-v-54601d22>.</span>flat<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544349765110.b8a32e2e.png" alt="1544349765110"></p><h3 id="randomlighting"><a href="#randomlighting" aria-hidden="true" class="header-anchor">#</a> RandomLighting</h3><p>Class for random lighting</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>b</strong></td><td>balance (0 - no change)</td></tr><tr><td><strong>c</strong></td><td>contrast (0 - no change)</td></tr><tr><td><strong>tfm_y</strong></td><td>Type of transformation.</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>aug_tfms <span class="token operator">=</span> RandomLighting<span class="token punctuation">(</span>b<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token comment" data-v-54601d22># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>&quot;../fastai/old/&quot;</span>
FNAMES_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'../data/dogscats/valid/cats/'</span>
FNAME <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'cat.2209.jpg'</span>

<span class="token comment" data-v-54601d22># IMPORTS</span>
<span class="token keyword" data-v-54601d22>import</span> sys
<span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> cv2


<span class="token comment" data-v-54601d22># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>append<span class="token punctuation" data-v-54601d22>(</span>FASTAI_PATH<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># go to parent dir</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>transforms <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>conv_learner <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22># ARCHITECTURE</span>
arch <span class="token operator" data-v-54601d22>=</span> resnet34
sz <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>256</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span> 

<span class="token comment" data-v-54601d22># HELP FUNCTIONS/CLASSES</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>show_img</span><span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>,</span> idx<span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> denorm<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>,</span> ax<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>if</span> ax <span class="token keyword" data-v-54601d22>is</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>:</span> fig<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>figsize<span class="token operator" data-v-54601d22>=</span>figsize<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>if</span> <span class="token operator" data-v-54601d22>not</span> denorm <span class="token keyword" data-v-54601d22>is</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>:</span> ims <span class="token operator" data-v-54601d22>=</span> denorm<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>else</span><span class="token punctuation" data-v-54601d22>:</span>      ims <span class="token operator" data-v-54601d22>=</span> np<span class="token punctuation" data-v-54601d22>.</span>rollaxis<span class="token punctuation" data-v-54601d22>(</span>to_np<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>)</span>
    ax<span class="token punctuation" data-v-54601d22>.</span>imshow<span class="token punctuation" data-v-54601d22>(</span>np<span class="token punctuation" data-v-54601d22>.</span>clip<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span>idx<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
    ax<span class="token punctuation" data-v-54601d22>.</span>axis<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'off'</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>MatchedFilesDataset</span><span class="token punctuation" data-v-54601d22>(</span>FilesDataset<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># LOADER FOR THE IMAGES</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> fnames<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> transform<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        self<span class="token punctuation" data-v-54601d22>.</span>y<span class="token operator" data-v-54601d22>=</span>y
        <span class="token keyword" data-v-54601d22>assert</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>==</span><span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>,</span> transform<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_y</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> i<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> open_image<span class="token punctuation" data-v-54601d22>(</span>os<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>join<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>y<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_c</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>0</span>

<span class="token comment" data-v-54601d22># MAIN CODE</span>
aug_tfms <span class="token operator" data-v-54601d22>=</span> RandomLighting<span class="token punctuation" data-v-54601d22>(</span>b<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>,</span> c<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>0.5</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># RESULTS</span>
tfms <span class="token operator" data-v-54601d22>=</span> tfms_from_model<span class="token punctuation" data-v-54601d22>(</span>arch<span class="token punctuation" data-v-54601d22>,</span> sz<span class="token punctuation" data-v-54601d22>,</span> aug_tfms<span class="token operator" data-v-54601d22>=</span>aug_tfms<span class="token punctuation" data-v-54601d22>)</span>
datasets <span class="token operator" data-v-54601d22>=</span> ImageData<span class="token punctuation" data-v-54601d22>.</span>get_ds<span class="token punctuation" data-v-54601d22>(</span>MatchedFilesDataset<span class="token punctuation" data-v-54601d22>,</span> 
                            <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                            <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                            tfms<span class="token punctuation" data-v-54601d22>,</span> path<span class="token operator" data-v-54601d22>=</span>FNAMES_PATH<span class="token punctuation" data-v-54601d22>)</span>
md <span class="token operator" data-v-54601d22>=</span> ImageData<span class="token punctuation" data-v-54601d22>(</span>FNAMES_PATH<span class="token punctuation" data-v-54601d22>,</span> datasets<span class="token punctuation" data-v-54601d22>,</span> bs<span class="token punctuation" data-v-54601d22>,</span> num_workers<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>,</span> classes<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#only for tests</span>

<span class="token comment" data-v-54601d22># SHOW IMAGES</span>
fig<span class="token punctuation" data-v-54601d22>,</span> axes <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>18</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token builtin" data-v-54601d22>next</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>iter</span><span class="token punctuation" data-v-54601d22>(</span>md<span class="token punctuation" data-v-54601d22>.</span>aug_dl<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> i <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    show_img<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span> denorm<span class="token operator" data-v-54601d22>=</span> md<span class="token punctuation" data-v-54601d22>.</span>val_ds<span class="token punctuation" data-v-54601d22>.</span>denorm<span class="token punctuation" data-v-54601d22>,</span> ax<span class="token operator" data-v-54601d22>=</span>axes<span class="token punctuation" data-v-54601d22>.</span>flat<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544349877751.44b1cf42.png" alt="1544349877751"></p><h3 id="randomflip"><a href="#randomflip" aria-hidden="true" class="header-anchor">#</a> RandomFlip</h3><p>Random flip image.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>tfm_y</strong></td><td>Type of transformation.</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>aug_tfms <span class="token operator">=</span> RandomFlip<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token comment" data-v-54601d22># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>&quot;../fastai/old/&quot;</span>
FNAMES_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'../data/dogscats/valid/cats/'</span>
FNAME <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'cat.2209.jpg'</span>

<span class="token comment" data-v-54601d22># IMPORTS</span>
<span class="token keyword" data-v-54601d22>import</span> sys
<span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> cv2


<span class="token comment" data-v-54601d22># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>append<span class="token punctuation" data-v-54601d22>(</span>FASTAI_PATH<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># go to parent dir</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>transforms <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>conv_learner <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22># ARCHITECTURE</span>
arch <span class="token operator" data-v-54601d22>=</span> resnet34
sz <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>256</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>2</span> 

<span class="token comment" data-v-54601d22># HELP FUNCTIONS/CLASSES</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>show_img</span><span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>,</span> idx<span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>5</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> denorm<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>,</span> ax<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    <span class="token keyword" data-v-54601d22>if</span> ax <span class="token keyword" data-v-54601d22>is</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>:</span> fig<span class="token punctuation" data-v-54601d22>,</span>ax <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span>figsize<span class="token operator" data-v-54601d22>=</span>figsize<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>if</span> <span class="token operator" data-v-54601d22>not</span> denorm <span class="token keyword" data-v-54601d22>is</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>:</span> ims <span class="token operator" data-v-54601d22>=</span> denorm<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>else</span><span class="token punctuation" data-v-54601d22>:</span>      ims <span class="token operator" data-v-54601d22>=</span> np<span class="token punctuation" data-v-54601d22>.</span>rollaxis<span class="token punctuation" data-v-54601d22>(</span>to_np<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>4</span><span class="token punctuation" data-v-54601d22>)</span>
    ax<span class="token punctuation" data-v-54601d22>.</span>imshow<span class="token punctuation" data-v-54601d22>(</span>np<span class="token punctuation" data-v-54601d22>.</span>clip<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>[</span>idx<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
    ax<span class="token punctuation" data-v-54601d22>.</span>axis<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'off'</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>class</span> <span class="token class-name" data-v-54601d22>MatchedFilesDataset</span><span class="token punctuation" data-v-54601d22>(</span>FilesDataset<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token comment" data-v-54601d22># LOADER FOR THE IMAGES</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>__init__</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> fnames<span class="token punctuation" data-v-54601d22>,</span> y<span class="token punctuation" data-v-54601d22>,</span> transform<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        self<span class="token punctuation" data-v-54601d22>.</span>y<span class="token operator" data-v-54601d22>=</span>y
        <span class="token keyword" data-v-54601d22>assert</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>==</span><span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>y<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token builtin" data-v-54601d22>super</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>.</span>__init__<span class="token punctuation" data-v-54601d22>(</span>fnames<span class="token punctuation" data-v-54601d22>,</span> transform<span class="token punctuation" data-v-54601d22>,</span> path<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_y</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>,</span> i<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> open_image<span class="token punctuation" data-v-54601d22>(</span>os<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>join<span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>,</span> self<span class="token punctuation" data-v-54601d22>.</span>y<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>get_c</span><span class="token punctuation" data-v-54601d22>(</span>self<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> <span class="token number" data-v-54601d22>0</span>

<span class="token comment" data-v-54601d22># MAIN CODE</span>
aug_tfms <span class="token operator" data-v-54601d22>=</span> RandomFlip<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># RESULTS</span>
tfms <span class="token operator" data-v-54601d22>=</span> tfms_from_model<span class="token punctuation" data-v-54601d22>(</span>arch<span class="token punctuation" data-v-54601d22>,</span> sz<span class="token punctuation" data-v-54601d22>,</span> aug_tfms<span class="token operator" data-v-54601d22>=</span>aug_tfms<span class="token punctuation" data-v-54601d22>)</span>
datasets <span class="token operator" data-v-54601d22>=</span> ImageData<span class="token punctuation" data-v-54601d22>.</span>get_ds<span class="token punctuation" data-v-54601d22>(</span>MatchedFilesDataset<span class="token punctuation" data-v-54601d22>,</span> 
                            <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                            <span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>[</span>FNAME<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> 
                            tfms<span class="token punctuation" data-v-54601d22>,</span> path<span class="token operator" data-v-54601d22>=</span>FNAMES_PATH<span class="token punctuation" data-v-54601d22>)</span>
md <span class="token operator" data-v-54601d22>=</span> ImageData<span class="token punctuation" data-v-54601d22>(</span>FNAMES_PATH<span class="token punctuation" data-v-54601d22>,</span> datasets<span class="token punctuation" data-v-54601d22>,</span> bs<span class="token punctuation" data-v-54601d22>,</span> num_workers<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>,</span> classes<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#only for tests</span>

<span class="token comment" data-v-54601d22># SHOW IMAGES</span>
fig<span class="token punctuation" data-v-54601d22>,</span> axes <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>subplots<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>18</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>9</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
<span class="token keyword" data-v-54601d22>for</span> i<span class="token punctuation" data-v-54601d22>,</span><span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span>y<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>enumerate</span><span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>[</span><span class="token builtin" data-v-54601d22>next</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>iter</span><span class="token punctuation" data-v-54601d22>(</span>md<span class="token punctuation" data-v-54601d22>.</span>aug_dl<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> i <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    show_img<span class="token punctuation" data-v-54601d22>(</span>x<span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>,</span> denorm<span class="token operator" data-v-54601d22>=</span> md<span class="token punctuation" data-v-54601d22>.</span>val_ds<span class="token punctuation" data-v-54601d22>.</span>denorm<span class="token punctuation" data-v-54601d22>,</span> ax<span class="token operator" data-v-54601d22>=</span>axes<span class="token punctuation" data-v-54601d22>.</span>flat<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544350244740.ca57eb8b.png" alt="1544350244740"></p><h3 id="transforms-basic"><a href="#transforms-basic" aria-hidden="true" class="header-anchor">#</a> transforms_basic</h3><p>Contains two transforms for the image</p><div class="language-python extra-class"><pre class="language-python"><code>transform_basic <span class="token operator">=</span> <span class="token punctuation">[</span>RandomRotate<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RandomLighting<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="transforms-side-on"><a href="#transforms-side-on" aria-hidden="true" class="header-anchor">#</a> transforms_side_on</h3><div class="language-python extra-class"><pre class="language-python"><code>transforms_side_on <span class="token operator">=</span> <span class="token punctuation">[</span>RandomRotate<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RandomLighting<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RandomFlip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
</code></pre></div><h2 id="fast-ai-import-data"><a href="#fast-ai-import-data" aria-hidden="true" class="header-anchor">#</a> fast.ai / Import Data</h2><h3 id="imageclassifierdata"><a href="#imageclassifierdata" aria-hidden="true" class="header-anchor">#</a> ImageClassifierData</h3><p>Class for image classification tasks.</p><h4 id="imageclassifierdata-from-paths"><a href="#imageclassifierdata-from-paths" aria-hidden="true" class="header-anchor">#</a> ImageClassifierData.from_paths</h4><p>A function that returns class ImageClassifierData where each class has different folder (for examples <code>dogscat/dogs</code>, <code>dogscat/cats</code>).</p><p><img src="data:image/png;base64,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" alt="1544370816367"></p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><strong>path</strong></td><td>a root path of the data (used for storing trained models, precomputed values, etc)</td></tr><tr><td><strong>bs</strong></td><td>Batch size. Make as large as possible (preferably work with multiples of 2). Determines how many data points go into each loss value that gets backgrpagaed.  When it’s too big than you can run out of the memory. (default: <code>64</code>)</td></tr><tr><td><strong>tmfs</strong></td><td>transformations (for data agumentations), e.g. output of ‘tfms_from_model’</td></tr><tr><td><strong>trn_name</strong></td><td>a name of the folder that contatins training images (default: <code>train</code>)</td></tr><tr><td><strong>val_name</strong></td><td>a name of the folder that contatins validation images (default: <code>valid</code>)</td></tr><tr><td><strong>test_name</strong></td><td>a name of the folder that contatins test images (default: <code>None</code>)</td></tr><tr><td><strong>num_workers</strong></td><td>a number of workers (default: <code>8</code>)</td></tr></tbody></table><h2 id="fast-ai-learner"><a href="#fast-ai-learner" aria-hidden="true" class="header-anchor">#</a> fast.ai / Learner</h2><h3 id="basic-functions"><a href="#basic-functions" aria-hidden="true" class="header-anchor">#</a> Basic Functions</h3><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>learn.save('filename')</code></td><td>Save learner</td></tr><tr><td><code>learn.load('filename')</code></td><td>Load learner from the file</td></tr></tbody></table><h3 id="convlearner-pretrained"><a href="#convlearner-pretrained" aria-hidden="true" class="header-anchor">#</a> ConvLearner.pretrained()</h3><p>A function that load’s pretrained architectures as a class <strong>ConvLearner:</strong> (<em>Class used to train a chosen supported covnet model. Eg. ResNet-34, etc.</em> )</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><strong>cls</strong></td><td>a model creation function (e.g. resnet34, resnet50, vgg16, dn201…)</td></tr><tr><td><strong>data</strong></td><td>training data for model (e.g. ImageClassifierData)</td></tr><tr><td><strong>precompute</strong></td><td>bool to reuse precomputed activations</td></tr></tbody></table><h3 id="fit"><a href="#fit" aria-hidden="true" class="header-anchor">#</a> fit()</h3><p>function that train the model based on the train dataset.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>lrs</strong></td><td>Learning Rate</td></tr><tr><td><strong>n_cycle</strong></td><td>Number of cycles (or iterations) to fi the model for</td></tr></tbody></table><h3 id="predict"><a href="#predict" aria-hidden="true" class="header-anchor">#</a> predict()</h3><p>predict the test/validation dataset and returns  and array with the probability of each class. Prediction are in the log scale.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong>is_test</strong></td><td><code>False</code>: is validataion dataset <code>val_ds</code>, <code>True</code>: is train dataset <code>test_ds</code></td></tr></tbody></table><h3 id="lr-find"><a href="#lr-find" aria-hidden="true" class="header-anchor">#</a> lr_find() <a href="https://arxiv.org/abs/1506.01186" target="_blank" title="https://arxiv.org/abs/1506.01186" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></h3><p>Find best learning rate for a model. Determines how you update the weights or parameters.</p><div class="language-python extra-class"><pre class="language-python"><code>lrf<span class="token operator">=</span>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><strong><code>start_lr</code></strong></td><td>start learning rate <code>float</code> number or <code>numpy array</code> (for example <code>learn.lr_find(np.array([1e-4,1e-3,1e-2]))</code>)</td></tr><tr><td><strong><code>end_lr</code></strong></td><td>The maximum learning rate to try.</td></tr><tr><td><code>wbs</code></td><td>weight decay parameter(s) (specifies regularization in the neural network.) <a href="https://openreview.net/pdf?id=B1lz-3Rct7" target="_blank" title="https://openreview.net/pdf?id=B1lz-3Rct7" class="header" data-v-1356b875><span class="badge primary top badge-code" data-v-1356b875>more</span></a></td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>sched<span class="token punctuation">.</span>plot_lr<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>schedule plot for the learning rate.</p><p><img src="/assets/img/1544619773797.0c9dc24c.png" alt="1544619773797"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>sched<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Plots the loss function with respect to learning rate.</p><p><img src="/assets/img/1544619887418.ac4b2774.png" alt="1544619887418"></p><p>It’s good to chose the learning just  one order of magnitude before incerease.</p><p><img src="/assets/img/1544620113338.5becf0f8.png" alt="1544620113338"></p><h2 id="fast-ai-examples"><a href="#fast-ai-examples" aria-hidden="true" class="header-anchor">#</a> fast.ai / Examples</h2><h3 id="dog-cat-example"><a href="#dog-cat-example" aria-hidden="true" class="header-anchor">#</a> dog-cat example</h3><h4 id="download"><a href="#download" aria-hidden="true" class="header-anchor">#</a> download</h4><div class="language-python extra-class"><pre class="language-python"><code>!wget http<span class="token punctuation">:</span><span class="token operator">//</span>files<span class="token punctuation">.</span>fast<span class="token punctuation">.</span>ai<span class="token operator">/</span>data<span class="token operator">/</span>dogscats<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> unzip dogscats<span class="token punctuation">.</span><span class="token builtin">zip</span>
!ls dogscats<span class="token operator">/</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1544129618067"></p><h4 id="train-model"><a href="#train-model" aria-hidden="true" class="header-anchor">#</a> Train model</h4><p>Train the model based on the previous learned model: <em>resnet34</em> with <em>learning reate=0.01</em> and <em>2 cycles</em>.</p><div class="language-python extra-class"><pre class="language-python"><code>PATH <span class="token operator">=</span> <span class="token string">&quot;./dogscats/&quot;</span>

arch <span class="token operator">=</span> resnet34
sz <span class="token operator">=</span> <span class="token number">256</span>
bs <span class="token operator">=</span> <span class="token number">64</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>arch <span class="token operator">=</span> resnet34
data <span class="token operator">=</span> ImageClassifierData<span class="token punctuation">.</span>from_paths<span class="token punctuation">(</span>PATH<span class="token punctuation">,</span> bs<span class="token punctuation">,</span> tfms<span class="token operator">=</span>tfms_from_model<span class="token punctuation">(</span>arch<span class="token punctuation">,</span> sz<span class="token punctuation">)</span><span class="token punctuation">)</span>
learn <span class="token operator">=</span> ConvLearner<span class="token punctuation">.</span>pretrained<span class="token punctuation">(</span>arch<span class="token punctuation">,</span> data<span class="token punctuation">,</span> precompute<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>lrs<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>n_cycle<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token comment" data-v-54601d22># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>&quot;../fastai/old/&quot;</span>
PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>&quot;./dogscats/&quot;</span>

<span class="token comment" data-v-54601d22># IMPORTS</span>
<span class="token keyword" data-v-54601d22>import</span> sys
<span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> cv2

<span class="token comment" data-v-54601d22># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>append<span class="token punctuation" data-v-54601d22>(</span>FASTAI_PATH<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># go to parent dir</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>transforms <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>conv_learner <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22># ARCHITECTURE</span>
arch <span class="token operator" data-v-54601d22>=</span> resnet34
sz <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>256</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>

<span class="token comment" data-v-54601d22># MAIN CALCULATION</span>
data <span class="token operator" data-v-54601d22>=</span> ImageClassifierData<span class="token punctuation" data-v-54601d22>.</span>from_paths<span class="token punctuation" data-v-54601d22>(</span>PATH<span class="token punctuation" data-v-54601d22>,</span> bs<span class="token punctuation" data-v-54601d22>,</span> tfms<span class="token operator" data-v-54601d22>=</span>tfms_from_model<span class="token punctuation" data-v-54601d22>(</span>arch<span class="token punctuation" data-v-54601d22>,</span> sz<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
learn <span class="token operator" data-v-54601d22>=</span> ConvLearner<span class="token punctuation" data-v-54601d22>.</span>pretrained<span class="token punctuation" data-v-54601d22>(</span>arch<span class="token punctuation" data-v-54601d22>,</span> data<span class="token punctuation" data-v-54601d22>,</span> precompute<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.01</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="data:image/png;base64,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" alt="1544620798523"></p><h4 id="predict-validation-dataset"><a href="#predict-validation-dataset" aria-hidden="true" class="header-anchor">#</a> Predict validation dataset:</h4><div class="language-python extra-class"><pre class="language-python"><code>log_preds <span class="token operator">=</span> learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cat_preds <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>log_preds<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#predict for first class (cats)</span>
dog_preds <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>log_preds<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#predict for second class (dogs)</span>
preds <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>log_preds<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#prediction for binary class</span>

<span class="token comment">#how close is to the dog</span>
plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span>dog_preds<span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token comment" data-v-54601d22># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>&quot;../fastai/old/&quot;</span>
PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'../data/dogscats/'</span>

<span class="token comment" data-v-54601d22># IMPORTS</span>
<span class="token keyword" data-v-54601d22>import</span> sys
<span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> cv2

<span class="token comment" data-v-54601d22># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>append<span class="token punctuation" data-v-54601d22>(</span>FASTAI_PATH<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># go to parent dir</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>transforms <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>conv_learner <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22># ARCHITECTURE</span>
arch <span class="token operator" data-v-54601d22>=</span> resnet34
sz <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>256</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>

<span class="token comment" data-v-54601d22># MAIN CALCULATION</span>
data <span class="token operator" data-v-54601d22>=</span> ImageClassifierData<span class="token punctuation" data-v-54601d22>.</span>from_paths<span class="token punctuation" data-v-54601d22>(</span>PATH<span class="token punctuation" data-v-54601d22>,</span> bs<span class="token punctuation" data-v-54601d22>,</span> tfms<span class="token operator" data-v-54601d22>=</span>tfms_from_model<span class="token punctuation" data-v-54601d22>(</span>arch<span class="token punctuation" data-v-54601d22>,</span> sz<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>
learn <span class="token operator" data-v-54601d22>=</span> ConvLearner<span class="token punctuation" data-v-54601d22>.</span>pretrained<span class="token punctuation" data-v-54601d22>(</span>arch<span class="token punctuation" data-v-54601d22>,</span> data<span class="token punctuation" data-v-54601d22>,</span> precompute<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>fit<span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>0.01</span><span class="token punctuation" data-v-54601d22>,</span> <span class="token number" data-v-54601d22>2</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token comment" data-v-54601d22># HELP FUNCTIONS</span>
<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>load_img_id</span><span class="token punctuation" data-v-54601d22>(</span>ds<span class="token punctuation" data-v-54601d22>,</span> idx<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span> <span class="token keyword" data-v-54601d22>return</span> np<span class="token punctuation" data-v-54601d22>.</span>array<span class="token punctuation" data-v-54601d22>(</span>PIL<span class="token punctuation" data-v-54601d22>.</span>Image<span class="token punctuation" data-v-54601d22>.</span><span class="token builtin" data-v-54601d22>open</span><span class="token punctuation" data-v-54601d22>(</span>PATH<span class="token operator" data-v-54601d22>+</span>ds<span class="token punctuation" data-v-54601d22>.</span>fnames<span class="token punctuation" data-v-54601d22>[</span>idx<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plots</span><span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>12</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>6</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>,</span> titles<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    f <span class="token operator" data-v-54601d22>=</span> plt<span class="token punctuation" data-v-54601d22>.</span>figure<span class="token punctuation" data-v-54601d22>(</span>figsize<span class="token operator" data-v-54601d22>=</span>figsize<span class="token punctuation" data-v-54601d22>)</span>
    <span class="token keyword" data-v-54601d22>for</span> i <span class="token keyword" data-v-54601d22>in</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
        sp <span class="token operator" data-v-54601d22>=</span> f<span class="token punctuation" data-v-54601d22>.</span>add_subplot<span class="token punctuation" data-v-54601d22>(</span>rows<span class="token punctuation" data-v-54601d22>,</span> <span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>//</span>rows<span class="token punctuation" data-v-54601d22>,</span> i<span class="token operator" data-v-54601d22>+</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span>
        sp<span class="token punctuation" data-v-54601d22>.</span>axis<span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Off'</span><span class="token punctuation" data-v-54601d22>)</span>
        <span class="token keyword" data-v-54601d22>if</span> titles <span class="token keyword" data-v-54601d22>is</span> <span class="token operator" data-v-54601d22>not</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>:</span> sp<span class="token punctuation" data-v-54601d22>.</span>set_title<span class="token punctuation" data-v-54601d22>(</span>titles<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>,</span> fontsize<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>)</span>
        plt<span class="token punctuation" data-v-54601d22>.</span>imshow<span class="token punctuation" data-v-54601d22>(</span>ims<span class="token punctuation" data-v-54601d22>[</span>i<span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>

<span class="token keyword" data-v-54601d22>def</span> <span class="token function" data-v-54601d22>plot_with_preds</span><span class="token punctuation" data-v-54601d22>(</span>dataset<span class="token punctuation" data-v-54601d22>,</span> preds<span class="token punctuation" data-v-54601d22>,</span> idxs<span class="token punctuation" data-v-54601d22>,</span> y_truth <span class="token operator" data-v-54601d22>=</span> <span class="token boolean" data-v-54601d22>None</span><span class="token punctuation" data-v-54601d22>,</span> rows <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>:</span>
    imgs <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>load_img_id<span class="token punctuation" data-v-54601d22>(</span>dataset<span class="token punctuation" data-v-54601d22>,</span>x<span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> idxs<span class="token punctuation" data-v-54601d22>]</span>
    title_probs <span class="token operator" data-v-54601d22>=</span> <span class="token punctuation" data-v-54601d22>[</span>f<span class="token string" data-v-54601d22>'{x}:prob={preds[x]:.4f}'</span> <span class="token operator" data-v-54601d22>+</span> <span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>''</span> <span class="token keyword" data-v-54601d22>if</span> y_truth <span class="token keyword" data-v-54601d22>is</span> <span class="token boolean" data-v-54601d22>None</span> <span class="token keyword" data-v-54601d22>else</span> f<span class="token string" data-v-54601d22>', y={y_truth[x]}'</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>for</span> x <span class="token keyword" data-v-54601d22>in</span> idxs<span class="token punctuation" data-v-54601d22>]</span>
    <span class="token keyword" data-v-54601d22>return</span> plots<span class="token punctuation" data-v-54601d22>(</span>imgs<span class="token punctuation" data-v-54601d22>,</span> rows<span class="token operator" data-v-54601d22>=</span>rows<span class="token punctuation" data-v-54601d22>,</span> titles<span class="token operator" data-v-54601d22>=</span>title_probs<span class="token punctuation" data-v-54601d22>,</span> figsize<span class="token operator" data-v-54601d22>=</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>16</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>8</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token keyword" data-v-54601d22>if</span> <span class="token builtin" data-v-54601d22>len</span><span class="token punctuation" data-v-54601d22>(</span>imgs<span class="token punctuation" data-v-54601d22>)</span><span class="token operator" data-v-54601d22>&gt;</span><span class="token number" data-v-54601d22>0</span> <span class="token keyword" data-v-54601d22>else</span> <span class="token keyword" data-v-54601d22>print</span><span class="token punctuation" data-v-54601d22>(</span><span class="token string" data-v-54601d22>'Not Found.'</span><span class="token punctuation" data-v-54601d22>)</span>

log_preds <span class="token operator" data-v-54601d22>=</span> learn<span class="token punctuation" data-v-54601d22>.</span>predict<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>;</span>
cat_preds <span class="token operator" data-v-54601d22>=</span> np<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span>log_preds<span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>:</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>0</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22>#predict for first class (cats)</span>
dog_preds <span class="token operator" data-v-54601d22>=</span> np<span class="token punctuation" data-v-54601d22>.</span>exp<span class="token punctuation" data-v-54601d22>(</span>log_preds<span class="token punctuation" data-v-54601d22>[</span><span class="token punctuation" data-v-54601d22>:</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>]</span><span class="token punctuation" data-v-54601d22>)</span>  <span class="token comment" data-v-54601d22>#predict for second class (dogs)</span>
preds <span class="token operator" data-v-54601d22>=</span> np<span class="token punctuation" data-v-54601d22>.</span>argmax<span class="token punctuation" data-v-54601d22>(</span>log_preds<span class="token punctuation" data-v-54601d22>,</span> axis<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#prediction for binary class</span>

plot_with_preds<span class="token punctuation" data-v-54601d22>(</span>data<span class="token punctuation" data-v-54601d22>.</span>val_ds<span class="token punctuation" data-v-54601d22>,</span>dog_preds<span class="token punctuation" data-v-54601d22>,</span> <span class="token builtin" data-v-54601d22>range</span><span class="token punctuation" data-v-54601d22>(</span><span class="token number" data-v-54601d22>100</span><span class="token punctuation" data-v-54601d22>,</span><span class="token number" data-v-54601d22>104</span><span class="token punctuation" data-v-54601d22>)</span><span class="token punctuation" data-v-54601d22>,</span> data<span class="token punctuation" data-v-54601d22>.</span>val_y<span class="token punctuation" data-v-54601d22>,</span>rows <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>1</span><span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22>#how close is to the dog</span>
</code></pre></div></div></div><p><img src="/assets/img/1544379918611.40222976.png" alt="1544379918611"></p><h4 id="most-correct-incorrect"><a href="#most-correct-incorrect" aria-hidden="true" class="header-anchor">#</a> Most correct/incorrect</h4><p>Returns most correct or incorrect datasets</p><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td><strong>probs</strong></td><td>array of predictions for datasets</td></tr><tr><td><strong>y_truth</strong></td><td>True value for dataset</td></tr><tr><td><strong>y</strong></td><td>class of dataset (<code>0</code> - cat, <code>1</code> - dog)</td></tr><tr><td><strong>is_correct</strong></td><td><code>True</code> - most correct, <code>False</code> - most incorrect</td></tr></tbody></table><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">most_by_mask</span><span class="token punctuation">(</span>probs<span class="token punctuation">,</span> mask<span class="token punctuation">,</span> mult<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idxs <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> idxs<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>mult <span class="token operator">*</span> probs<span class="token punctuation">[</span>idxs<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">most_by_correct</span><span class="token punctuation">(</span>probs<span class="token punctuation">,</span> y_truth<span class="token punctuation">,</span> y<span class="token punctuation">,</span> is_correct<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    mult <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span>is_correct <span class="token keyword">else</span> <span class="token number">1</span>
    <span class="token keyword">return</span> most_by_mask<span class="token punctuation">(</span>probs<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>preds <span class="token operator">==</span> y_truth<span class="token punctuation">)</span><span class="token operator">==</span>is_correct<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>y_truth <span class="token operator">==</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> mult<span class="token punctuation">)</span>
</code></pre></div><h4 id="most-correct-cats"><a href="#most-correct-cats" aria-hidden="true" class="header-anchor">#</a> Most correct cats</h4><div class="language-python extra-class"><pre class="language-python"><code>plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span> dog_preds<span class="token punctuation">,</span> 
                most_by_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><p><img src="/assets/img/1544380350810.0b06d149.png" alt="1544380350810"></p><h4 id="most-correct-dogs"><a href="#most-correct-dogs" aria-hidden="true" class="header-anchor">#</a> Most correct dogs</h4><div class="language-python extra-class"><pre class="language-python"><code>plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span> dog_preds<span class="token punctuation">,</span> 
                most_by_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><p><img src="/assets/img/1544380396392.2068e557.png" alt="1544380396392"></p><h4 id="most-incorrect-cats"><a href="#most-incorrect-cats" aria-hidden="true" class="header-anchor">#</a> Most incorrect cats</h4><div class="language-python extra-class"><pre class="language-python"><code>plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span> dog_preds<span class="token punctuation">,</span> 
                most_by_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><p><img src="/assets/img/1544380456620.55c06fed.png" alt="1544380456620"></p><h4 id="most-incorrect-dogs"><a href="#most-incorrect-dogs" aria-hidden="true" class="header-anchor">#</a> Most incorrect dogs</h4><div class="language-python extra-class"><pre class="language-python"><code>plot_with_preds<span class="token punctuation">(</span>data<span class="token punctuation">.</span>val_ds<span class="token punctuation">,</span> dog_preds<span class="token punctuation">,</span> 
                most_by_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> data<span class="token punctuation">.</span>val_y<span class="token punctuation">,</span>rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> 
</code></pre></div><p><img src="/assets/img/1544380476885.8d894ea3.png" alt="1544380476885"></p><h4 id="improve-model"><a href="#improve-model" aria-hidden="true" class="header-anchor">#</a> Improve model</h4><ul><li>adding data augmentation</li><li>find better learn_fs</li></ul><div class="language-python extra-class"><pre class="language-python"><code>tfms <span class="token operator">=</span> tfms_from_model<span class="token punctuation">(</span>resnet34<span class="token punctuation">,</span> sz<span class="token punctuation">,</span> aug_tfms<span class="token operator">=</span>transforms_side_on<span class="token punctuation">,</span> max_zoom<span class="token operator">=</span><span class="token number">1.1</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>sched<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="step" data-v-54601d22><button class="accordion" data-v-54601d22><span class="badge secondary top badge-code" data-v-54601d22>Full code</span></button><div class="panel" style="display:none;" data-v-54601d22><div class="language-python extra-class" data-v-54601d22><pre class="language-python" data-v-54601d22><code data-v-54601d22><span class="token comment" data-v-54601d22># CONFIGURATION</span>
FASTAI_PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>&quot;../fastai/old/&quot;</span>
PATH <span class="token operator" data-v-54601d22>=</span> <span class="token string" data-v-54601d22>'../data/dogscats/'</span>

<span class="token comment" data-v-54601d22># IMPORTS</span>
<span class="token keyword" data-v-54601d22>import</span> sys
<span class="token keyword" data-v-54601d22>import</span> numpy <span class="token keyword" data-v-54601d22>as</span> np
<span class="token keyword" data-v-54601d22>import</span> cv2

<span class="token comment" data-v-54601d22># IMPORT FAST.AI</span>
sys<span class="token punctuation" data-v-54601d22>.</span>path<span class="token punctuation" data-v-54601d22>.</span>append<span class="token punctuation" data-v-54601d22>(</span>FASTAI_PATH<span class="token punctuation" data-v-54601d22>)</span> <span class="token comment" data-v-54601d22># go to parent dir</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>transforms <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>
<span class="token keyword" data-v-54601d22>from</span> fastai<span class="token punctuation" data-v-54601d22>.</span>conv_learner <span class="token keyword" data-v-54601d22>import</span> <span class="token operator" data-v-54601d22>*</span>

<span class="token comment" data-v-54601d22># ARCHITECTURE</span>
arch <span class="token operator" data-v-54601d22>=</span> resnet34
sz <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>256</span>
bs <span class="token operator" data-v-54601d22>=</span> <span class="token number" data-v-54601d22>64</span>



<span class="token comment" data-v-54601d22># MAIN CALCULATION</span>
tfms <span class="token operator" data-v-54601d22>=</span> tfms_from_model<span class="token punctuation" data-v-54601d22>(</span>resnet34<span class="token punctuation" data-v-54601d22>,</span> sz<span class="token punctuation" data-v-54601d22>,</span> aug_tfms<span class="token operator" data-v-54601d22>=</span>transforms_side_on<span class="token punctuation" data-v-54601d22>,</span> max_zoom<span class="token operator" data-v-54601d22>=</span><span class="token number" data-v-54601d22>1.1</span><span class="token punctuation" data-v-54601d22>)</span>
data <span class="token operator" data-v-54601d22>=</span> ImageClassifierData<span class="token punctuation" data-v-54601d22>.</span>from_paths<span class="token punctuation" data-v-54601d22>(</span>PATH<span class="token punctuation" data-v-54601d22>,</span> bs<span class="token punctuation" data-v-54601d22>,</span> tfms<span class="token operator" data-v-54601d22>=</span>tfms<span class="token punctuation" data-v-54601d22>)</span>
learn <span class="token operator" data-v-54601d22>=</span> ConvLearner<span class="token punctuation" data-v-54601d22>.</span>pretrained<span class="token punctuation" data-v-54601d22>(</span>arch<span class="token punctuation" data-v-54601d22>,</span> data<span class="token punctuation" data-v-54601d22>,</span> precompute<span class="token operator" data-v-54601d22>=</span><span class="token boolean" data-v-54601d22>True</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>lr_find<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
learn<span class="token punctuation" data-v-54601d22>.</span>sched<span class="token punctuation" data-v-54601d22>.</span>plot<span class="token punctuation" data-v-54601d22>(</span><span class="token punctuation" data-v-54601d22>)</span>
</code></pre></div></div></div><p><img src="/assets/img/1544620630913.3d40f085.png" alt="1544620630913"></p><div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="1544620891292"></p><p>Our model val improve from <code>0.024483</code> to <code>0.022073</code></p></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/36.8763a9aa.js" defer></script><script src="/assets/js/65.3edea211.js" defer></script><script src="/assets/js/53.36b7f8bc.js" defer></script><script src="/assets/js/57.3021bea5.js" defer></script><script src="/assets/js/55.15e44483.js" defer></script><script src="/assets/js/64.cea9ba65.js" defer></script><script src="/assets/js/63.d0f98b80.js" defer></script><script src="/assets/js/62.7376bc82.js" defer></script><script src="/assets/js/61.f89a0558.js" defer></script><script src="/assets/js/60.a834c108.js" defer></script><script src="/assets/js/59.3e053494.js" defer></script><script src="/assets/js/58.15f1fadc.js" defer></script><script src="/assets/js/50.b44f5c9b.js" defer></script><script src="/assets/js/68.2dc7a61f.js" defer></script><script src="/assets/js/52.843a3c03.js" defer></script><script src="/assets/js/app.90502cb8.js" defer></script>
  </body>
</html>
