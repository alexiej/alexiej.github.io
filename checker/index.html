<!DOCTYPE html>
<html lang="en-EN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deep Learning | One Page Knowledge</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.82341e2f.css" as="style"><link rel="preload" href="/assets/js/app.8fa22be7.js" as="script"><link rel="preload" href="/assets/js/38.6d2d6add.js" as="script"><link rel="prefetch" href="/assets/js/1.d062958e.js"><link rel="prefetch" href="/assets/js/2.da7a401b.js"><link rel="prefetch" href="/assets/js/3.5eb72074.js"><link rel="prefetch" href="/assets/js/4.d2cfe0aa.js"><link rel="prefetch" href="/assets/js/5.b0536bcf.js"><link rel="prefetch" href="/assets/js/6.86e68417.js"><link rel="prefetch" href="/assets/js/7.b3ba6d13.js"><link rel="prefetch" href="/assets/js/8.7bad17e8.js"><link rel="prefetch" href="/assets/js/9.7d9aff3c.js"><link rel="prefetch" href="/assets/js/10.0c8da252.js"><link rel="prefetch" href="/assets/js/11.ad569595.js"><link rel="prefetch" href="/assets/js/12.e97c8010.js"><link rel="prefetch" href="/assets/js/13.bca7396b.js"><link rel="prefetch" href="/assets/js/14.e2fa8044.js"><link rel="prefetch" href="/assets/js/15.6d14fcee.js"><link rel="prefetch" href="/assets/js/16.0834a93e.js"><link rel="prefetch" href="/assets/js/17.60fabda8.js"><link rel="prefetch" href="/assets/js/18.0325ed0a.js"><link rel="prefetch" href="/assets/js/19.0ed16655.js"><link rel="prefetch" href="/assets/js/20.dc799cb1.js"><link rel="prefetch" href="/assets/js/21.341e1d8e.js"><link rel="prefetch" href="/assets/js/22.ae10f158.js"><link rel="prefetch" href="/assets/js/23.187e5c9d.js"><link rel="prefetch" href="/assets/js/24.581a0912.js"><link rel="prefetch" href="/assets/js/25.e0219789.js"><link rel="prefetch" href="/assets/js/26.9553bc72.js"><link rel="prefetch" href="/assets/js/27.32d339af.js"><link rel="prefetch" href="/assets/js/28.8ff4f22e.js"><link rel="prefetch" href="/assets/js/29.0ae2e4c0.js"><link rel="prefetch" href="/assets/js/30.5a24f147.js"><link rel="prefetch" href="/assets/js/31.6c804cc3.js"><link rel="prefetch" href="/assets/js/32.c47254b2.js"><link rel="prefetch" href="/assets/js/33.bd4344de.js"><link rel="prefetch" href="/assets/js/34.b52679b2.js"><link rel="prefetch" href="/assets/js/35.ecd73d33.js"><link rel="prefetch" href="/assets/js/36.b818d001.js"><link rel="prefetch" href="/assets/js/37.4a868e5c.js"><link rel="prefetch" href="/assets/js/39.d8bde480.js"><link rel="prefetch" href="/assets/js/40.3e210f06.js"><link rel="prefetch" href="/assets/js/41.81e4a676.js"><link rel="prefetch" href="/assets/js/42.293c2616.js"><link rel="prefetch" href="/assets/js/43.5e050dfe.js"><link rel="prefetch" href="/assets/js/44.a9bd8722.js"><link rel="prefetch" href="/assets/js/45.dcf08f48.js"><link rel="prefetch" href="/assets/js/46.24f2257e.js"><link rel="prefetch" href="/assets/js/47.9f785e12.js"><link rel="prefetch" href="/assets/js/48.8991e566.js"><link rel="prefetch" href="/assets/js/49.e0491147.js"><link rel="prefetch" href="/assets/js/50.e9d1ab0c.js"><link rel="prefetch" href="/assets/js/51.94e562fe.js"><link rel="prefetch" href="/assets/js/52.a9c7c226.js"><link rel="prefetch" href="/assets/js/53.e08d3665.js"><link rel="prefetch" href="/assets/js/54.c68541aa.js"><link rel="prefetch" href="/assets/js/55.d68a4630.js"><link rel="prefetch" href="/assets/js/56.b12f8a13.js"><link rel="prefetch" href="/assets/js/57.7ea4a366.js"><link rel="prefetch" href="/assets/js/58.b9cabd9d.js"><link rel="prefetch" href="/assets/js/59.f15a2331.js"><link rel="prefetch" href="/assets/js/60.5dd170c7.js"><link rel="prefetch" href="/assets/js/61.6e21a8f0.js"><link rel="prefetch" href="/assets/js/62.3e550a96.js"><link rel="prefetch" href="/assets/js/63.33ad8019.js"><link rel="prefetch" href="/assets/js/64.39437532.js"><link rel="prefetch" href="/assets/js/65.2f98005f.js"><link rel="prefetch" href="/assets/js/66.a84ac3ba.js"><link rel="prefetch" href="/assets/js/67.aa15746d.js"><link rel="prefetch" href="/assets/js/68.e52c3dc5.js"><link rel="prefetch" href="/assets/js/69.aaa10e24.js"><link rel="prefetch" href="/assets/js/70.b71f9112.js"><link rel="prefetch" href="/assets/js/71.b27954ef.js"><link rel="prefetch" href="/assets/js/72.762fe7bd.js"><link rel="prefetch" href="/assets/js/73.07578c92.js"><link rel="prefetch" href="/assets/js/74.1ed4c4b6.js"><link rel="prefetch" href="/assets/js/75.702b22a5.js"><link rel="prefetch" href="/assets/js/76.b7693a38.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82341e2f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      One Page Knowledge
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Deep Learning</span><!----></p><ul class="sidebar-group-items"><li><a href="/checker/#check-bear-black-bear-teddy-bear" class="sidebar-link">Check Bear/Black Bear/ Teddy Bear</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/checker/#check-skin" class="sidebar-link">Check Skin</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/checker/#the-example" class="sidebar-link">The example</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"><h2 id="check-bear-black-bear-teddy-bear"><a href="#check-bear-black-bear-teddy-bear" aria-hidden="true" class="header-anchor">#</a> Check Bear/Black Bear/ Teddy Bear</h2><p>What it is: ??</p><p>This is a bear recognition sample. You can put a bear, black bear or teddy bear to recognize them. Images for bears can be found in the Google images (try search: Grizzly, black bear or teddy bear).</p><p><strong>If server doesnâ€™t work, please make sure that you enable script from untrusted source</strong></p><p><img src="data:image/png;base64,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" alt="1550050291956"></p><p><img src="/assets/img/1550050458898.bb596beb.png" alt="1550050458898"></p><!----><h2 id="check-skin"><a href="#check-skin" aria-hidden="true" class="header-anchor">#</a> Check Skin</h2><p>This is based on the skin recognition based on the ISIC-Archive. Images can be found in the webpage. <a href="https://www.isic-archive.com/" target="_blank" rel="noopener noreferrer">https://www.isic-archive.com/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.  Skin Imaging Collaboration: Melanoma Project. The algorithm can recognize if  the skin changes is benign or malignant.</p><!----><h2 id="the-example"><a href="#the-example" aria-hidden="true" class="header-anchor">#</a> The example</h2><ol><li>Server example</li></ol><div class="language-python extra-class"><pre class="language-python"><code>pip3 install starlette
pip3 install uvicorn
</code></pre></div><p><code>server.py</code> file:</p><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> starlette<span class="token punctuation">.</span>applications <span class="token keyword">import</span> Starlette
<span class="token keyword">from</span> starlette<span class="token punctuation">.</span>responses <span class="token keyword">import</span> JSONResponse
<span class="token keyword">from</span> starlette<span class="token punctuation">.</span>middleware<span class="token punctuation">.</span>cors <span class="token keyword">import</span> CORSMiddleware

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> ssl

<span class="token keyword">from</span> fastai<span class="token punctuation">.</span>vision <span class="token keyword">import</span> <span class="token operator">*</span>
defaults<span class="token punctuation">.</span>device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">'cpu'</span><span class="token punctuation">)</span>
learn_bear <span class="token operator">=</span> load_learner<span class="token punctuation">(</span><span class="token string">'bear'</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIO

<span class="token keyword">import</span> uvicorn
app <span class="token operator">=</span> Starlette<span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>add_middleware<span class="token punctuation">(</span>CORSMiddleware<span class="token punctuation">,</span> allow_origins<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">homepage</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'hello'</span><span class="token punctuation">:</span> <span class="token string">'world'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    
<span class="token keyword">def</span> <span class="token function">getI420FromBase64</span><span class="token punctuation">(</span>codec<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># get codec from http</span>
    <span class="token comment"># codec = codec.encode()</span>
    base64_data <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'^data:image/.+;base64,'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> codec<span class="token punctuation">)</span>
    byte_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>base64_data<span class="token punctuation">)</span>
    image_data <span class="token operator">=</span> BytesIO<span class="token punctuation">(</span>byte_data<span class="token punctuation">)</span>
    <span class="token comment">#img = Image.open(image_data)</span>
    <span class="token keyword">return</span> image_data
    
    
@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">&quot;/bear&quot;</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> <span class="token keyword">await</span> request<span class="token punctuation">.</span>form<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">]</span>
    img <span class="token operator">=</span> getI420FromBase64<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> predict_image_from_bytes<span class="token punctuation">(</span>img<span class="token punctuation">,</span> learn_bear<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">predict_image_from_bytes</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> learner<span class="token punctuation">)</span><span class="token punctuation">:</span>
    img <span class="token operator">=</span> open_image<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    pred<span class="token punctuation">,</span>_<span class="token punctuation">,</span>losses  <span class="token operator">=</span> learner<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    
    data <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>
            <span class="token builtin">zip</span><span class="token punctuation">(</span>learner<span class="token punctuation">.</span>data<span class="token punctuation">.</span>classes<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> losses<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            key<span class="token operator">=</span><span class="token keyword">lambda</span> p<span class="token punctuation">:</span> p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            reverse<span class="token operator">=</span><span class="token boolean">True</span>
        <span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> JSONResponse<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;predicted&quot;</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>pred<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;prob&quot;</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;learn&quot;</span><span class="token punctuation">:</span> data
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
        uvicorn<span class="token punctuation">.</span>run<span class="token punctuation">(</span>app<span class="token punctuation">,</span> 
                host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> 
                port<span class="token operator">=</span><span class="token number">8000</span>
                 <span class="token punctuation">)</span>

</code></pre></div><p>Run server without output. You can close your console now.</p><p><code>nohup python3 server.py &amp;</code></p><ol><li>Example for javascript as <code>.vue</code> template. (required vue-picture-input <a href="https://github.com/alessiomaffeis/vue-picture-input" target="_blank" rel="noopener noreferrer">https://github.com/alessiomaffeis/vue-picture-input<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</li></ol><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hello&quot;</span><span class="token operator">&gt;</span>   
    <span class="token operator">&lt;</span>h3 v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;working&quot;</span>  style<span class="token operator">=</span><span class="token string">&quot;color: green&quot;</span><span class="token operator">&gt;</span>Server is working <span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h3 v<span class="token operator">-</span><span class="token keyword">else</span> style<span class="token operator">=</span><span class="token string">&quot;color: red&quot;</span><span class="token operator">&gt;</span> Server is <span class="token constant">NOT</span> working<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>pictureinp 
      ref<span class="token operator">=</span><span class="token string">&quot;pictureInput&quot;</span>
      width<span class="token operator">=</span><span class="token string">&quot;600&quot;</span> 
      height<span class="token operator">=</span><span class="token string">&quot;600&quot;</span> 
      margin<span class="token operator">=</span><span class="token string">&quot;16&quot;</span> 
      accept<span class="token operator">=</span><span class="token string">&quot;image/jpeg,image/png&quot;</span> 
      size<span class="token operator">=</span><span class="token string">&quot;10&quot;</span> 
      button<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn&quot;</span>
      <span class="token punctuation">:</span>custom<span class="token operator">-</span>strings<span class="token operator">=</span>&quot;<span class="token punctuation">{</span>
        upload<span class="token punctuation">:</span> <span class="token string">'&lt;h1&gt;Bummer!&lt;/h1&gt;'</span><span class="token punctuation">,</span>
        drag<span class="token punctuation">:</span> <span class="token string">'Drag a Picture ðŸ˜º of a bear'</span>
      <span class="token punctuation">}</span>&quot;
      @change<span class="token operator">=</span><span class="token string">&quot;onChange&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>pictureinp<span class="token operator">&gt;</span> 

    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>This is<span class="token punctuation">:</span> <span class="token operator">&lt;</span>span style<span class="token operator">=</span><span class="token string">&quot;color: red&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token operator">&lt;</span>span style<span class="token operator">=</span><span class="token string">&quot;color: blue&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>pred<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">%</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>  sure<span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span> <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> PictureInput <span class="token keyword">from</span> <span class="token string">'vue-picture-input'</span>
<span class="token keyword">var</span> <span class="token constant">URL</span> <span class="token operator">=</span> <span class="token string">'http://!YOUR_IP!:800/bear'</span>

<span class="token keyword">function</span> <span class="token function">_base64ToArrayBuffer</span><span class="token punctuation">(</span>base64<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> binary_string <span class="token operator">=</span>  window<span class="token punctuation">.</span><span class="token function">atob</span><span class="token punctuation">(</span>base64<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> len <span class="token operator">=</span> binary_string<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">var</span> bytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span> len <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>
        bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> binary_string<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> bytes<span class="token punctuation">.</span>buffer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'app'</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">'??'</span><span class="token punctuation">,</span>
      pred<span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    pictureinp
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">onChange</span> <span class="token punctuation">(</span>image<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'New picture selected!'</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>image<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        v<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;??&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// console.log('Picture loaded.', image)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>image <span class="token operator">=</span> image
        <span class="token comment">// send image and get response</span>
        <span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          request<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> 
           <span class="token constant">URL</span><span class="token punctuation">,</span>
           <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">var</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span> image<span class="token punctuation">)</span><span class="token punctuation">;</span>
           request<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
             v<span class="token punctuation">.</span>name <span class="token operator">=</span> data<span class="token punctuation">.</span>predicted<span class="token punctuation">;</span>
            <span class="token keyword">let</span> pred <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>prob<span class="token operator">*</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
            v<span class="token punctuation">.</span>pred <span class="token operator">=</span> pred<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          request<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'FileReader API not supported: use the &lt;form&gt;, Luke!'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/38.6d2d6add.js" defer></script><script src="/assets/js/app.8fa22be7.js" defer></script>
  </body>
</html>
